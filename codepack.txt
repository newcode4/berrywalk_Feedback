===== META =====
Repo: https://github.com/newcode4/berrywalk_Feedback.git
Branch: main  |  Tag: 1.4.5  |  Commit: 9f6983a
Generated: 2025-09-18 14:32:29

===== FILE: codepack.txt (913574 bytes, 24583 lines) =====
`$ext
===== META =====
Repo: https://github.com/newcode4/berrywalk_Feedback.git
Branch: main  |  Tag: 1.4.5  |  Commit: 9f6983a
Generated: 2025-09-18 12:56:38

===== FILE: codepack.txt (601017 bytes, 15453 lines) =====
`$ext
===== META =====
Repo: https://github.com/newcode4/berrywalk_Feedback.git
Branch: main  |  Tag: 0.4.6  |  Commit: a0ab1a0
Generated: 2025-09-18 12:45:16

===== FILE: codepack.txt (289153 bytes, 6340 lines) =====
`$ext
===== FILE: codepack.txt (230957 bytes, 5055 lines) =====
`$ext
===== FILE: codepack.txt (175152 bytes, 3837 lines) =====
`$ext
===== FILE: codepack.txt (124674 bytes, 2751 lines) =====
`$ext
===== FILE: codepack.txt (82703 bytes, 1819 lines) =====
`$ext
===== FILE: codepack.txt (40900 bytes, 890 lines) =====
`$ext
===== FILE: pack-code.ps1 (4063 bytes, 113 lines) =====
`$ext
param(
  [string]$Root = ".",
  [string]$Out = "codepack.txt",
  [string]$IncludeExt = ".php,.js,.ts,.css,.scss,.html,.htm,.json,.md,.yml,.yaml,.xml,.sh,.ps1,.ini,.txt,.sql,.twig,.vue",
  # 제외할 디렉터리들 (쉼표로 구분)
  [string]$ExcludeDirs = "node_modules,dist,build,vendor,.git,.github,.idea,.vscode,.next,.cache,growth-checklist\plugin-update-checker",
  # 제외할 파일 패턴들 (쉼표로 구분)
  [string]$ExcludeFiles = "*.min.js,*.min.css,*.map,*.lock,*.zip,*.tar,*.gz,*.png,*.jpg,*.jpeg,*.gif,*.webp,*.svg,*.woff,*.woff2,*.ttf,*.eot,*.pdf",
  # 용량 한도
  [int]$MaxFileBytes = 1000000,    # 파일당 최대 1MB
  [int]$MaxTotalBytes = 20000000,  # 전체 최대 20MB
  # 변경 파일만 모드
  [switch]$ChangedOnly,
  [string]$GitRange = ""
)

$ErrorActionPreference = "Stop"
$Root = (Resolve-Path $Root).Path
$include = $IncludeExt.Split(",") | ForEach-Object { $_.Trim().ToLower() } | Where-Object { $_ -ne "" }
$exDirs  = $ExcludeDirs.Split(",")  | ForEach-Object { $_.Trim() }        | Where-Object { $_ -ne "" }
$exFiles = $ExcludeFiles.Split(",") | ForEach-Object { $_.Trim() }        | Where-Object { $_ -ne "" }

function IsTextExt($path) {
  $ext = [IO.Path]::GetExtension($path).ToLower()
  return $include -contains $ext
}
function IsExcludedDir($path) {
  foreach ($d in $exDirs) {
    if ($path -like "*$d*") { return $true }
  }
  return $false
}
function IsExcludedFile($file) {
  foreach ($p in $exFiles) {
    if ([IO.Path]::GetFileName($file) -like $p) { return $true }
  }
  return $false
}

# 파일 목록 수집
$files = @()
if ($ChangedOnly) {
  $gitArgs = @("diff","--name-only")
  if ($GitRange) { $gitArgs += $GitRange }
  $changed = & git @gitArgs 2>$null
  foreach ($rel in $changed) {
    $p = Join-Path $Root $rel
    if (Test-Path $p -PathType Leaf) { $files += (Resolve-Path $p).Path }
  }
} else {
  $files = Get-ChildItem -Path $Root -Recurse -File | ForEach-Object { $_.FullName }
}

# 필터링
$files = $files | Where-Object {
  -not (IsExcludedDir $_) -and
  -not (IsExcludedFile $_) -and
  (IsTextExt $_)
}

# 출력 빌드
$sb = New-Object System.Text.StringBuilder
$totalBytes = 0
$nl = [Environment]::NewLine

# 상단 메타
try {
  $repoUrl = (git -C $Root config --get remote.origin.url)
  $branch  = (git -C $Root rev-parse --abbrev-ref HEAD)
  $tag     = (git -C $Root describe --tags --abbrev=0) 2>$null
  $commit  = (git -C $Root rev-parse --short HEAD)
  $time    = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
  $null = $sb.AppendLine("===== META =====")
  $null = $sb.AppendLine("Repo: $repoUrl")
  $null = $sb.AppendLine("Branch: $branch  |  Tag: $tag  |  Commit: $commit")
  $null = $sb.AppendLine("Generated: $time")
  $null = $sb.AppendLine("")
} catch {}

foreach ($f in $files) {
  try {
    $fi = Get-Item $f
    $size = $fi.Length
    if ($size -gt $MaxFileBytes) {
      $rel = $f.Substring($Root.Length+1)
      $null = $sb.AppendLine("===== FILE: $rel ($size bytes) SKIPPED: > $MaxFileBytes =====$nl")
      continue
    }
    if (($totalBytes + $size) -gt $MaxTotalBytes) {
      $null = $sb.AppendLine("===== STOP: total size would exceed $MaxTotalBytes bytes. Remaining files omitted. =====$nl")
      break
    }

    $rel = $f.Substring($Root.Length+1)
    $content = (Get-Content -Path $f -Raw -Encoding UTF8)
    $lineCount = ($content -split "`r?`n").Count
    $ext = [IO.Path]::GetExtension($f).TrimStart(".").ToLower()
    if (-not $ext) { $ext = "text" }

    $null = $sb.AppendLine("===== FILE: $rel ($size bytes, $lineCount lines) =====")
    $null = $sb.AppendLine("```$ext")
    $null = $sb.AppendLine($content)
    $null = $sb.AppendLine("```$nl")

    $totalBytes += $size
  } catch {
    $null = $sb.AppendLine("===== FILE: $f ERROR: $($_.Exception.Message) =====$nl")
  }
}

[IO.File]::WriteAllText((Join-Path $Root $Out), $sb.ToString(), [Text.Encoding]::UTF8)
"생성 완료: $(Join-Path $Root $Out)  (총 approx $totalBytes bytes)"

`$nl
===== FILE: bw-owner-suite-acf\bw-owner-suite-acf.php (924 bytes, 26 lines) =====
`$ext
<?php
/**
 * Plugin Name: BW Owner Suite (light)
 */
if (!defined('ABSPATH')) exit;

define('BWOS_VER', '1.0.1');
define('BWOS_DIR', plugin_dir_path(__FILE__));
define('BWOS_URL', plugin_dir_url(__FILE__));

require_once BWOS_DIR.'includes/cpt-admin.php';
require_once BWOS_DIR.'includes/form.php';
require_once BWOS_DIR.'includes/signup.php';
require_once BWOS_DIR.'includes/save.php';
require_once BWOS_DIR.'includes/view-list.php';
require_once BWOS_DIR.'includes/acf-fields.php'; // 관리자 ACF 메타박스(5문항)

add_action('wp_enqueue_scripts', function(){
  $css = BWOS_URL.'assets/owner-form.css';
  $js  = BWOS_URL.'assets/owner-form.js';
  wp_register_style ('bwos-form', $css, [], BWOS_VER);
  wp_register_style ('bwf-forms', $css, [], BWOS_VER); // alias
  wp_register_script('bwos-form', $js,  ['jquery'], BWOS_VER, true);
  wp_register_script('bwf-forms', $js,  ['jquery'], BWOS_VER, true); // alias
});

`$nl
===== FILE: bw-owner-suite-acf\README.md (1409 bytes, 40 lines) =====
`$ext
# BW Owner Suite (ACF Minimal)

워드프레스 표준 + ACF만 사용하여
- 회원가입 → 프로필 수정
- 대표 질문(CPT) 작성/수정/보기/목록/복제/삭제
- 저장 알림(메일/텔레그램)

을 한 번에 처리하는 경량 플러그인입니다.

## 설치
1) `Advanced Custom Fields`(ACF) 플러그인을 활성화
2) 워드프레스 관리자 → 플러그인 → 새로 추가 → 플러그인 업로드 → 이 ZIP 업로드 후 활성화
3) 활성화 즉시 아래 페이지가 자동 생성됩니다.
   - `/owner-questions/` 작성
   - `/owner-edit/?id=글ID` 수정
   - `/my-question-view/?id=글ID` 보기
   - `/my-questions/` 내 저장본(보기/수정/복제/삭제)
   - `/my-profile/` 마이프로필
   - `/register/` 회원가입

## 텔레그램 알림(선택)
`wp-config.php`에 아래 상수를 추가하면 저장 시 텔레그램 알림이 전송됩니다.

```php
define('BWF_TG_BOT','123456:ABC...');       // 봇 토큰
define('BWF_TG_CHAT','-1001234567890');     // 채팅 ID
```

## 짧은코드(Shortcodes)
- [bw_register]
- [bw_profile_form]
- [bw_owner_form_acf]
- [bw_owner_edit id="123"]  (또는 /owner-edit/?id=123)
- [bwf_owner_view id="123"]
- [bw_my_questions]

## 주의
- 플러그인 동작을 위해 ACF가 필요합니다.
- 데이터는 CPT `bwf_owner_answer`에 저장되며 리비전이 활성화되어 되돌리기가 가능합니다.

`$nl
===== FILE: bw-owner-suite-acf\assets\owner-form.css (3568 bytes, 62 lines) =====
`$ext
:root{ --bw-font:16.5px; --bw-muted:#64748b; --bw-border:#e5e7eb; --bw-accent:#6366f1; }
body{ font-size:var(--bw-font); }

/* 공통 래퍼 */
.bwos-wrap{max-width:920px;margin:32px auto;padding:0 16px}

/* 제목/도움말 */
.bwf-title{font-size:28px;margin:8px 0 10px}
.bwf-help{color:var(--bw-muted);margin:0 0 18px}

/* 필드 */
.bwf-field{margin:20px 0}
.bwf-field label{display:block;font-weight:700;margin:0 0 10px;font-size:17px}
.bwf-field textarea,
.bwf-field input[type="text"],
.bwf-field select{
  width:100%;box-sizing:border-box;padding:12px 14px;border:1px solid #d1d5db;border-radius:12px;
  font-size:16px;background:#fff;outline:none
}
.bwf-field textarea:focus,.bwf-field input:focus,.bwf-field select:focus{border-color:var(--bw-accent)}
.bwos-field.bwos-error textarea,.bwos-field.bwos-error input,.bwos-field.bwos-error select{border-color:#ef4444;background:#fff1f2}
.bwos-count{display:inline-block;margin-top:6px;font-size:12px;color:var(--bw-muted)}
.bwf-desc{margin:10px 0 6px;padding-left:12px;border-left:3px solid var(--bw-border);color:#0f172a}
.bwf-examples{margin:6px 0 0;color:#0f172a}
.bwf-examples ul,.bwf-examples ol{margin:6px 0 0 18px}

/* 버튼 */
.bwf-btn{display:inline-block;padding:10px 16px;border-radius:12px;border:none;background:var(--bw-accent);color:#fff;text-decoration:none}
.bwf-btn-secondary{display:inline-block;padding:10px 16px;border-radius:12px;border:1px solid #cbd5e1;background:#fff;color:#0f172a;text-decoration:none}
.bwf-actions{display:flex;gap:8px;align-items:center;margin-top:12px}

/* sticky 진행바 */
.bwos-progress{position:sticky;top:64px;z-index:1000;margin:0 0 16px}
body.admin-bar .bwos-progress{top:96px}
.bwos-progress .bar{height:8px;background:#f1f5f9;border-radius:999px;overflow:hidden}
.bwos-progress .bar>span{display:block;height:100%;width:0%;background:linear-gradient(90deg,#0ea5e9,#6366f1);border-radius:999px;transition:width .2s}
.bwos-progress .status{font-size:12px;color:#475569;margin-top:6px}

/* 모달(중앙 상단, 여백) */
.bwos-modal{position:fixed;inset:0;display:none;align-items:flex-start;justify-content:center;padding-top:18vh;background:rgba(0,0,0,.4);z-index:100000}
body.admin-bar .bwos-modal{padding-top:calc(18vh + 32px)}
.bwos-modal.is-open{display:flex}
.bwos-modal-inner{background:#fff;max-width:520px;width:92vw;padding:20px;border-radius:14px;box-shadow:0 20px 40px rgba(2,6,23,.15)}
.bwos-modal-inner h4{margin:0 0 8px;font-size:18px}
.bwos-modal-inner p{margin:0 0 12px;color:#334155}

/* 보기 화면(카드) */
.bwf-card{border:1px solid var(--bw-border);background:#fff;border-radius:12px;padding:12px 14px}

/* 마이페이지 카드 + 페이지네이션 */
.bwos-list{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:14px}
.bwos-card{border:1px solid var(--bw-border);border-radius:12px;padding:14px 16px;background:#fff}
.bwos-card h4{margin:0 0 6px;font-size:16px}
.bwos-card .meta{font-size:12px;color:var(--bw-muted);margin-bottom:8px}
.bwos-card .row{display:flex;gap:8px;flex-wrap:wrap}
.bwos-card .row a{display:inline-block;padding:6px 10px;border-radius:10px;background:#f1f5f9;color:#0f172a;text-decoration:none}
@media (max-width:920px){ .bwos-list{grid-template-columns:1fr} }

.bwos-pg{margin:16px 0 4px}
.bwos-pg .page-numbers{display:inline-block;padding:6px 10px;border:1px solid var(--bw-border);border-radius:10px;margin-right:6px;text-decoration:none;color:#0f172a}
.bwos-pg .current{background:#0ea5e9;color:#fff;border-color:#0ea5e9}

`$nl
===== FILE: bw-owner-suite-acf\assets\owner-form.js (3268 bytes, 84 lines) =====
`$ext
(function($){
  const $form = $('.bwos-form').first();
  if(!$form.length) return;

  $form.attr('autocomplete','off');
  $form.find('input,textarea').attr({'autocomplete':'off','autocapitalize':'off','autocorrect':'off'});

  // 진행바(상단 고정)
  const $progress = $form.find('.bwos-progress');
  const reqs = []; // [{wrap,valid,update}]

  // 단일/그룹 필드 와이어
  function wire($wrap){
    const min = parseInt($wrap.data('min')||200,10);
    const $subs = $wrap.find('.bwf-sub textarea');      // 그룹?
    const isGroup = $subs.length > 0;

    // 카운터(단일일 때만)
    let $cnt = $wrap.find('.bwos-count');
    if(!isGroup && !$cnt.length) $cnt=$('<small class="bwos-count">0/'+min+'</small>').appendTo($wrap);

    const setError = (bad)=> $wrap.toggleClass('bwos-error', !!bad);

    const valid = ()=>{
      if(isGroup){
        let ok=true;
        $subs.each(function(){ if(($(this).val()||'').trim()==='') ok=false; });
        return ok;
      }else{
        return (($wrap.find('textarea,input[type="text"]').first().val()||'').trim().length >= min);
      }
    };

    const update = ()=>{
      if(isGroup){
        let anyEmpty=false;
        $subs.each(function(){ if(($(this).val()||'').trim()==='') anyEmpty=true; });
        setError(anyEmpty);
      }else{
        const $inp=$wrap.find('textarea,input[type="text"]').first();
        const v=($inp.val()||'').trim();
        if($cnt.length) $cnt.text(v.length+'/'+min);
        setError(v.length < min);
      }
      updateProgress();
    };

    if(isGroup) $subs.on('input blur', update);
    else        $wrap.find('textarea,input[type="text"]').first().on('input blur', update);

    reqs.push({wrap:$wrap, valid, update});
    update();
  }

  function updateProgress(){
    const total=reqs.length, done=reqs.filter(r=>r.valid()).length, pct= total?Math.round(done/total*100):0;
    $progress.find('.bar>span').css('width',pct+'%');
    $progress.find('.status').text('작성 '+done+'/'+total+' ('+pct+'%)');
  }

  // 모든 필수 섹션 와이어
  $form.find('.bwos-required').each(function(){ wire($(this)); });

  // 2줄 모달(가운데 상단, admin bar 여백 포함) - jQuery show() 안 쓰고 class 토글
  const $modal=$('<div class="bwos-modal"><div class="bwos-modal-inner"><h4>입력이 필요한 항목이 있어요</h4><p>필수 항목을 확인해 주세요.</p><button type="button" class="bwf-btn-secondary ok">확인</button></div></div>').appendTo('body');
  $modal.on('click','.ok',()=> $modal.removeClass('is-open'));

  let locked=false;
  $form.on('submit',function(e){
    let bad=false; reqs.forEach(r=>{ if(!r.valid()) bad=true; });
    if(bad){
      e.preventDefault();
      $modal.addClass('is-open');
      const $first = $form.find('.bwos-error').first();
      if($first.length) $('html,body').animate({scrollTop:$first.offset().top-120},200);
      return;
    }
    if(locked){ e.preventDefault(); return; }
    locked=true;
    $form.find('.bwos-submit').prop('disabled',true).text('저장 중…');
    setTimeout(()=>{ locked=false; $form.find('.bwos-submit').prop('disabled',false).text('저장'); }, 6000);
  });
})(jQuery);

`$nl
===== FILE: bw-owner-suite-acf\includes\acf-fields.php (3584 bytes, 76 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

add_action('acf/init', function(){
  if (!function_exists('acf_add_local_field_group')) return;

  acf_add_local_field_group([
    'key'=>'group_bwos_owner_v5','title'=>'대표 질문지',
    'fields'=>[
      ['key'=>'f_problem','label'=>'1) 지금, 우리 사업의 가장 큰 고민은 무엇인가요?','name'=>'_acf_problem','type'=>'textarea','required'=>1,'rows'=>8,'instructions'=>'최소 200자 권장'],
      ['key'=>'f_value','label'=>'2) 우리 서비스의 핵심 가치는 무엇인가요?','name'=>'_acf_value','type'=>'textarea','required'=>1,'rows'=>6],
      ['key'=>'f_whom','label'=>'3) 누가 이용해야 하나요? 왜 우리인가요?','name'=>'_acf_ideal_customer','type'=>'textarea','required'=>1,'rows'=>6],
      ['key'=>'f_ask1','label'=>'4-1) 고객에게 묻고 싶은 질문 #1','name'=>'_acf_cq1','type'=>'text'],
      ['key'=>'f_ask2','label'=>'4-2) 고객에게 묻고 싶은 질문 #2','name'=>'_acf_cq2','type'=>'text'],
      ['key'=>'f_ask3','label'=>'4-3) 고객에게 묻고 싶은 질문 #3','name'=>'_acf_cq3','type'=>'text'],
      ['key'=>'f_comp','label'=>'5) 경쟁사 대비 차별점','name'=>'_acf_competitors','type'=>'textarea','required'=>1,'rows'=>6],
    ],
    'location'=>[[['param'=>'post_type','operator'=>'==','value'=>'bwf_owner_answer']]],
    'position'=>'normal','style'=>'default','active'=>true,
  ]);
});


/** 200자 필드 서버 검증 */
add_filter('acf/validate_value', function($valid, $value, $field){
  if ($valid !== true) return $valid;
  $min200 = ['problem','core_value','target_customer','differentiation','sales_blockers','current_channels','growth_goal','next_action'];
  if (in_array($field['name'] ?? '', $min200, true)) {
    if (mb_strlen(trim((string)$value)) < 200) return '최소 200자 이상 작성해 주세요.';
  }
  return $valid;
}, 10, 3);
/* ------- ACF <-> bwf_answers 동기화 ------- */
function bwos_acf_meta_keys(){ // ACF 메타키(name) 매핑
  return [
    '_acf_problem'       => ['id'=>'problem'],
    '_acf_value'         => ['id'=>'value'],
    '_acf_ideal_customer'=> ['id'=>'ideal_customer'],
    '_acf_cq1'           => ['id'=>'ask3','sub'=>'q1'],
    '_acf_cq2'           => ['id'=>'ask3','sub'=>'q2'],
    '_acf_cq3'           => ['id'=>'ask3','sub'=>'q3'],
    '_acf_competitors'   => ['id'=>'competitors'],
  ];
}

/* 편집 화면 로드시 ACF 메타 채워넣기(관리자에서 비어 보이던 문제 해결) */
add_action('load-post.php', function(){
  $pid = isset($_GET['post']) ? (int)$_GET['post'] : 0;
  if(!$pid) return;
  $p = get_post($pid);
  if(!$p || $p->post_type!=='bwf_owner_answer') return;

  $ans = (array)get_post_meta($pid,'bwf_answers',true);
  foreach(bwos_acf_meta_keys() as $meta=>$m){
    $val = '';
    if(empty($m['sub'])) $val = (string)($ans[$m['id']] ?? '');
    else                 $val = (string)($ans[$m['id']][$m['sub']] ?? '');
    update_post_meta($pid, $meta, $val);
  }
});

/* 저장 시 ACF 값으로 bwf_answers 재생성(양방향 동기화) */
add_action('save_post_bwf_owner_answer', function($post_id){
  if(defined('DOING_AUTOSAVE') && DOING_AUTOSAVE) return;
  $ans = [];
  foreach(bwos_acf_meta_keys() as $meta=>$m){
    $v = (string)get_post_meta($post_id,$meta,true);
    if(empty($m['sub'])) $ans[$m['id']] = $v;
    else {
      if(empty($ans[$m['id']])) $ans[$m['id']] = [];
      $ans[$m['id']][$m['sub']] = $v;
    }
  }
  if($ans) update_post_meta($post_id,'bwf_answers',$ans);
}, 20);

`$nl
===== FILE: bw-owner-suite-acf\includes\cpt-admin.php (945 bytes, 21 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

add_action('init', function(){
  register_post_type('bwf_owner_answer', [
    'label'=>'대표 질문지','labels'=>['name'=>'대표 질문지','add_new_item'=>'새 대표 질문 생성','edit_item'=>'대표 질문 편집'],
    'public'=>false,'exclude_from_search'=>true,'publicly_queryable'=>false,'show_ui'=>true,'show_in_menu'=>true,
    'menu_icon'=>'dashicons-editor-help','supports'=>['author','custom-fields'],'map_meta_cap'=>true,
  ]);
});

add_filter('manage_bwf_owner_answer_posts_columns', function($c){
  return ['cb'=>$c['cb'],'title'=>'제목','author'=>'작성자','created'=>'저장 시각'];
});
add_action('manage_bwf_owner_answer_posts_custom_column', function($col,$post_id){
  if($col==='created'){
    $ts = get_post_timestamp($post_id,'date');            // ✔ 사이트 타임존 타임스탬프
    echo esc_html( wp_date('Y-m-d H:i', $ts) );
  }
}, 10, 2);

`$nl
===== FILE: bw-owner-suite-acf\includes\form.php (8178 bytes, 132 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

/** 빌더 구성: 5문항(설명/예시 그대로) */
function bwf_owner_cfg(){
  return [
    'title' => '대표님 핵심 질문지',
    'min'   => 200,
    'intro' => '사업의 본질을 파악하고 고객에게 정말 묻고 싶은 질문을 구체화합니다. 각 문항은 최소 <strong>{MIN}</strong>자입니다. <em>(단, <strong>“고객에게 물어보고 싶은 3가지”</strong>는 글자수 제한 없음)</em>',
    'qs' => [
      [
        'id'=>'problem','label'=>'1. 지금, 우리 사업의 가장 큰 고민은 무엇인가요?','required'=>true,'min'=>200,
        'desc'=>'설명: 현재 가장 답답하거나 성장이 정체되었다고 느끼는 구체적인 상황을 한두 문장으로 설명해 주세요. 예: “광고는 많이 했는데…” 등 숫자/행동 기반.',
        'ex'=>'<ul><li>“최근 인스타그램 광고 효율이 너무 안 나와요. 클릭은 많은데, 저희 웹사이트에 1분도 머물지 않고 나가는 사람이 많아요.”</li><li>“기존 고객들의 재구매율이 낮아서, 항상 새로운 고객을 찾아야 하는 부담이 큽니다.”</li></ul>'
      ],
      [
        'id'=>'value','label'=>'2. 우리 서비스는 고객의 ‘어떤 문제’를 해결해주고 있나요?','required'=>true,'min'=>200,
        'desc'=>'설명: 고객의 전/후 변화를 떠올려 가장 중요한 <strong>가치</strong>를 한 문장으로.',
        'ex'=>'<ol><li>“서류 작업을 5분 만에 자동화 → 본업 집중.”</li><li>“바쁜 직장인에게 집밥 같은 건강한 한 끼 제공.”</li></ol>'
      ],
      [
        'id'=>'ideal_customer','label'=>'3. 우리 서비스를 ‘누가’ 이용해야 하나요? 왜 우리를 선택하나요?','required'=>true,'min'=>200,
        'desc'=>'설명: 가장 잘 맞는 사람의 특징 + 우리를 고를 <strong>결정적 이유</strong>.',
        'ex'=>'<p>“시간·비용이 부족한 <strong>20대 대학생</strong> → 15분 홈트 영상으로 해결.”</p>'
      ],
      [
        'id'=>'ask3','type'=>'group','label'=>'4. 고객에게 물어보고 싶은 3가지','required'=>true,
        'desc'=>'대표님이 고객에게 직접 묻고 싶은 핵심 질문 3가지를 작성하세요. 경험한 내용을 바탕으로 구체적으로.',
        'ex'=>'<p><strong>상품</strong></p><ul><li>“처음 받았을 때 어떤 느낌이었나요? (포장/디자인/첫 경험)”</li><li>“가장 만족/아쉬웠던 점은?”</li></ul><p><strong>서비스</strong></p><ul><li>“무료체험 때 최고의 포인트/아쉬웠던 점?”</li></ul>',
        'sub'=>[
          ['id'=>'q1','label'=>'질문 1','ph'=>'예: 우리 서비스를 알게 된 경로는 무엇이었나요?','required'=>true],
          ['id'=>'q2','label'=>'질문 2','ph'=>'예: 결심 포인트는 무엇이었나요?','required'=>true],
          ['id'=>'q3','label'=>'질문 3','ph'=>'예: 사용 중 가장 불편했던 점은?','required'=>true],
        ]
      ],
      [
        'id'=>'competitors','label'=>'5. 현재 경쟁사는 어디이며, 그들과의 차별점은 무엇이라고 생각하시나요?','required'=>true,'min'=>200,
        'desc'=>'설명: 주요 경쟁사 1~2곳과 비교해 강·약점을 정리.',
        'ex'=>'<p>“A는 저렴하지만 품질이 낮고, B는 비싸지만 품질이 높다 → 우리는 <strong>적정 가격 + 높은 만족</strong>.”</p>'
      ],
    ]
  ];
}

/** 공용 URL */
function bwf_owner_view_url(){ return home_url('/my-question-view/'); }
function bwf_owner_edit_url(){ return home_url('/owner-edit/'); }
function bwf_owner_list_url(){ return home_url('/my-questions/'); }

/** 폼 렌더(신규/수정 공용) — 회사정보 입력 제거 */
function bwf_render_owner_form($args=[]){
  $cfg   = bwf_owner_cfg();
  $min   = (int)$cfg['min'];
  $mode  = $args['mode'] ?? 'create';
  $post  = $args['post'] ?? null;
  $saved = $args['saved'] ?? [];
  $errs  = $args['errs']  ?? [];

  // 수정 모드이면 기존 값
  if ($mode==='edit' && $post){
    $existing = (array)get_post_meta($post->ID,'bwf_answers',true);
    $saved = $saved ?: $existing;
  }

  wp_enqueue_style('bwf-forms');
  wp_enqueue_script('bwos-form');

  ob_start(); ?>
  <form id="bwfOwnerForm" class="bwf-form bwos-form" method="post" action="<?php echo esc_url(admin_url('admin-post.php')); ?>" novalidate>
    <input type="hidden" name="action" value="bwf_owner_save">
    <?php wp_nonce_field('bwf_owner_save','bwf_owner_nonce'); ?>
    <input type="hidden" name="post_id" value="<?php echo $post ? (int)$post->ID : 0; ?>">

    <div class="bwos-progress"><div class="bar"><span></span></div><div class="status">작성 0/0 (0%)</div></div>

    <h2 class="bwf-title"><?php echo esc_html($cfg['title']); ?></h2>
    <p class="bwf-help"><?php echo str_replace('{MIN}', $min, $cfg['intro']); ?></p>

    <?php foreach($cfg['qs'] as $q): $type=$q['type']??'textarea'; $id=$q['id']; ?>
      <div class="bwf-field bwos-field bwos-required" data-min="<?php echo (int)($q['min']??$min); ?>">
        <label><?php echo esc_html($q['label']); ?><?php if(!empty($q['required'])): ?><span class="bwf-required">*</span><?php endif; ?></label>

        <?php if($type==='group'): ?>
          <?php foreach(($q['sub']??[]) as $sub): $sid=$sub['id']; $v=$saved[$id][$sid]??''; ?>
            <div class="bwf-sub">
              <div class="bwf-help"><?php echo esc_html($sub['label']); ?></div>
              <textarea name="q[<?php echo esc_attr($id); ?>][<?php echo esc_attr($sid); ?>]" rows="4" placeholder="<?php echo esc_attr($sub['ph']??''); ?>"><?php echo esc_textarea($v); ?></textarea>
            </div>
          <?php endforeach; ?>
        <?php if(!empty($q['desc'])): ?><div class="bwf-desc"><?php echo $q['desc']; ?></div><?php endif; ?>
        <?php if(!empty($q['ex'])):   ?><div class="bwf-examples"><?php echo $q['ex'];   ?></div><?php endif; ?>
        <?php else: $v=$saved[$id]??''; ?>
          <textarea name="q[<?php echo esc_attr($id); ?>]" rows="6"><?php echo esc_textarea($v); ?></textarea>
          <small class="bwos-count">0/<?php echo (int)($q['min']??$min); ?></small>
        <?php endif; ?>

       
      </div>
    <?php endforeach; ?>

    <div class="bwf-actions">
      <button type="submit" class="bwf-btn bwos-submit"><?php echo $mode==='edit'?'수정 저장':'저장'; ?></button>
      <a class="bwf-btn-secondary" href="<?php echo esc_url(bwf_owner_list_url()); ?>">마이페이지</a>
    </div>
  </form>
  <?php return ob_get_clean();
}

/** 작성: [bwf_owner_questions] / 별칭 [bw_owner_form] */
add_shortcode('bwf_owner_questions', function(){
  if (!is_user_logged_in()) return '<div class="bwf-form">로그인이 필요합니다.</div>';
  $uid=get_current_user_id();
  $old=get_transient('bwf_owner_old_'.$uid)?:[]; delete_transient('bwf_owner_old_'.$uid);
  $err=get_transient('bwf_owner_err_'.$uid)?:[]; delete_transient('bwf_owner_err_'.$uid);
  return bwf_render_owner_form(['mode'=>'create','saved'=>$old,'errs'=>$err]);
});
add_shortcode('bw_owner_form', function(){ return do_shortcode('[bwf_owner_questions]'); });

/** 수정: [bw_owner_edit id=""] 또는 ?id= */
add_shortcode('bw_owner_edit', function($atts){
  if (!is_user_logged_in()) return '<div class="bwf-form">로그인이 필요합니다.</div>';
  $id=(int)($atts['id']??($_GET['id']??0));
  $post=get_post($id);
  if(!$post || $post->post_type!=='bwf_owner_answer') return '<div class="bwf-form">데이터가 없습니다.</div>';
  if((int)$post->post_author!==get_current_user_id() && !current_user_can('edit_post',$id)) return '<div class="bwf-form">권한이 없습니다.</div>';

  $uid=get_current_user_id();
  $old=get_transient('bwf_owner_old_'.$uid)?:[]; delete_transient('bwf_owner_old_'.$uid);
  $err=get_transient('bwf_owner_err_'.$uid)?:[]; delete_transient('bwf_owner_err_'.$uid);
  return bwf_render_owner_form(['mode'=>'edit','post'=>$post,'saved'=>$old,'errs'=>$err]);
});

`$nl
===== FILE: bw-owner-suite-acf\includes\save.php (2676 bytes, 74 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

add_action('admin_post_bwf_owner_save','bwf_owner_handle_save');
add_action('admin_post_nopriv_bwf_owner_save','bwf_owner_handle_save');

function bwf_owner_handle_save(){
  if(!is_user_logged_in()) { wp_safe_redirect(home_url('/')); exit; }
  if(empty($_POST['bwf_owner_nonce']) || !wp_verify_nonce($_POST['bwf_owner_nonce'],'bwf_owner_save')){
    wp_safe_redirect(wp_get_referer()?:home_url('/')); exit;
  }

  $uid  = get_current_user_id();
  $lock = 'bwf_owner_lock_'.$uid;
  if(get_transient($lock)) { wp_safe_redirect(home_url('/my-questions/')); exit; }
  set_transient($lock,1,8); // 8초 중복방지

  $cfg = bwf_owner_cfg();
  $min = (int)$cfg['min'];
  $src = $_POST['q'] ?? [];
  $ans = []; $err=[];

  foreach($cfg['qs'] as $q){
    $id=$q['id']; $type=$q['type']??'textarea';
    $req=!empty($q['required']); $m=(int)($q['min']??$min);

    if($type==='group'){
      $ans[$id]=[];
      foreach(($q['sub']??[]) as $sub){
        $sid=$sub['id']; $v=trim((string)($src[$id][$sid]??''));
        $ans[$id][$sid]=sanitize_textarea_field($v);
        if(!empty($sub['required']) && $v===''){ $err[$id][$sid]=true; }
      }
      if($req && !empty($err[$id])){/*표시용*/}
    }else{
      $v=trim((string)($src[$id]??'')); $ans[$id]=sanitize_textarea_field($v);
      if($req && mb_strlen($v)<$m){ $err[$id]=true; }
    }
  }

  if($err){
    set_transient('bwf_owner_old_'.$uid,$src,60);
    set_transient('bwf_owner_err_'.$uid,$err,60);
    delete_transient($lock);
    wp_safe_redirect(wp_get_referer()?:home_url('/owner-questions/')); exit;
  }

  $post_id = (int)($_POST['post_id']??0);
  $title   = '대표 질문지 - '.wp_date('Y-m-d H:i'); // 사이트 타임존

  if($post_id){
    $p=get_post($post_id);
    if($p && $p->post_type==='bwf_owner_answer' && ((int)$p->post_author===$uid || current_user_can('edit_post',$post_id))){
      update_post_meta($post_id,'bwf_answers',$ans);
      wp_update_post(['ID'=>$post_id,'post_title'=>$title,'post_status'=>'private']);
      delete_transient($lock);
      wp_safe_redirect(add_query_arg(['id'=>$post_id,'updated'=>1], bwf_owner_view_url())); exit;
    }
  }

  $new_id = wp_insert_post([
    'post_type'=>'bwf_owner_answer','post_status'=>'private','post_title'=>$title,'post_author'=>$uid,
  ], true);

  if(!is_wp_error($new_id)){
    update_post_meta($new_id,'bwf_answers',$ans);
    delete_transient($lock);
    wp_safe_redirect(add_query_arg(['id'=>$new_id,'saved'=>1], bwf_owner_view_url())); exit;
  }

  delete_transient($lock);
  wp_safe_redirect(bwf_owner_list_url()); exit;
}

`$nl
===== FILE: bw-owner-suite-acf\includes\signup.php (7387 bytes, 138 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

add_action('init', function(){
  if (!get_role('bw_owner')) add_role('bw_owner','대표',['read'=>true]);
});

function bwf_enqueue_form_style(){ wp_enqueue_style('bwf-forms'); }

/** 대표 회원가입: [bwf_signup_representative] */
add_shortcode('bwf_signup_representative', function () {
  bwf_enqueue_form_style();

  if (is_user_logged_in()) {
    $u = wp_get_current_user();
    return '<div class="bwf-form"><p><strong>'.esc_html($u->user_login).'</strong>로 로그인됨.</p>
            <p class="bwf-actions"><a class="bwf-btn" href="'.esc_url(home_url('/owner-questions/')).'">질문 등록하기</a></p></div>';
  }

  ob_start(); ?>
  <form method="post" class="bwf-form bwf-grid" id="bwf-signup-rep" novalidate>
    <input type="hidden" name="bwf_role" value="bw_owner">
    <?php wp_nonce_field('bwf_signup_rep','bwf_nonce'); ?>

    <h2 class="bwf-title bwf-col-full">대표 회원가입</h2>
    <p class="bwf-required-note bwf-col-full">* 표시는 필수 입력</p>

    <div><label>아이디 <span class="bwf-required">*</span></label>
      <input type="text" name="user_login" pattern="[A-Za-z0-9_\.\-]{4,32}" required></div>
    <div><label>비밀번호 <span class="bwf-required">*</span></label>
      <input type="password" name="user_pass" required></div>
    <div><label>이메일 <span class="bwf-required">*</span></label>
      <input type="email" name="user_email" required></div>
    <div><label>이름 <span class="bwf-required">*</span></label>
      <input type="text" name="first_name" required></div>

    <div><label>회사명 <span class="bwf-required">*</span></label>
      <input type="text" name="bw_company_name" required></div>
    <div><label>업종 <span class="bwf-required">*</span></label>
      <select name="bw_industry" required>
        <option value="">선택</option><option value="it">IT/서비스</option><option value="commerce">커머스</option><option value="etc">기타</option>
      </select></div>
    <div><label>직원 수 <span class="bwf-required">*</span></label>
      <input type="number" name="bw_employees" min="1" required></div>
    <div><label>홈페이지 URL</label>
      <input type="url" name="user_url" placeholder="https://"></div>

    <div><label>알게 된 경로 <span class="bwf-required">*</span></label>
      <select name="bw_discover" id="bwf-source" required>
        <option value="">선택</option><option value="search">검색</option><option value="sns">SNS</option><option value="ref">지인추천</option><option value="etc">기타</option>
      </select>
      <input type="text" name="source_etc" id="bwf-source-etc" placeholder="기타 경로" class="bwf-col-full bwf-hidden"></div>

    <div><label>휴대폰 번호 <span class="bwf-required">*</span></label>
      <input type="tel" name="bw_phone" id="bwf-phone" inputmode="numeric" placeholder="010-1234-5678"
             maxlength="13" pattern="^010-\d{4}-\d{4}$" required></div>
    <div><label>연락 가능한 시간대 <span class="bwf-required">*</span></label>
      <input type="text" name="bw_contact_window" placeholder="예: 평일 13:00~18:00" required></div>

    <div class="bwf-actions bwf-col-full">
      <button type="submit" name="bwf_register" class="bwf-btn">회원가입</button>
    </div>

    <!-- 모달(제출 시에만 뜸) -->
    <div class="bwf-modal" id="bwf-modal" aria-hidden="true">
      <div class="bwf-modal__card">
        <h3>입력이 필요한 항목이 있어요</h3>
        <p class="bwf-modal__msg">필수 항목을 확인해 주세요.</p>
        <div class="bwf-modal__actions"><button type="button" class="bwf-btn-secondary" id="bwf-modal-ok">확인</button></div>
      </div>
    </div>

    <script>
    (function(){
      const f=document.getElementById('bwf-signup-rep'), src=f.querySelector('#bwf-source'),
            etc=f.querySelector('#bwf-source-etc'), tel=f.querySelector('#bwf-phone'),
            modal=f.querySelector('#bwf-modal'), ok=modal.querySelector('#bwf-modal-ok');

      function showEtc(){ if(src.value==='etc'){ etc.classList.remove('bwf-hidden'); } else { etc.classList.add('bwf-hidden'); etc.value=''; } }
      src.addEventListener('change',showEtc); showEtc();

      function fmt(v){ const d=String(v||'').replace(/\D/g,'').slice(0,11);
        if(d.startsWith('010')){ if(d.length>=11) return d.replace(/^(\d{3})(\d{4})(\d{4}).*$/,'$1-$2-$3');
          if(d.length>=7) return d.replace(/^(\d{3})(\d{0,4})(\d{0,4}).*$/,(m,a,b,c)=>a+(b?'-'+b:'')+(c?'-'+c:'')); if(d.length>=4) return d.replace(/^(\d{3})(\d{0,4}).*$/,(m,a,b)=>a+'-'+b); }
        return d; }
      tel.addEventListener('input',()=>{ const b=tel.value; tel.value=fmt(b); tel.setSelectionRange(tel.value.length,tel.value.length); });

      function openModal(msg){ modal.classList.add('is-open'); modal.setAttribute('aria-hidden','false');
        modal.querySelector('.bwf-modal__msg').textContent=msg||'필수 항목을 확인해 주세요.'; }
      function closeModal(){ modal.classList.remove('is-open'); modal.setAttribute('aria-hidden','true'); }
      ok.addEventListener('click',closeModal);

      f.addEventListener('submit',function(ev){
        const req=[...f.querySelectorAll('[required]')]; let bad=false, first=null;
        req.forEach(el=>{ el.classList.remove('bwf-invalid'); el.setCustomValidity('');
          if(el.name==='bw_phone' && !/^010-\d{4}-\d{4}$/.test(el.value)){ el.setCustomValidity('휴대폰 번호는 010-1234-5678 형식'); }
          if(!el.checkValidity()){ bad=true; if(!first) first=el; el.classList.add('bwf-invalid'); }
        });
        if(bad){ ev.preventDefault(); openModal('누락된 필수 항목을 입력해 주세요.'); first.scrollIntoView({behavior:'smooth',block:'center'}); }
      });
    })();
    </script>
  </form>
  <?php
  return ob_get_clean();
});

/** 서버 처리 */
add_action('init', function(){
  if (!isset($_POST['bwf_register'])) return;
  $role = sanitize_text_field($_POST['bwf_role'] ?? '');
  $nonce= sanitize_text_field($_POST['bwf_nonce'] ?? '');
  $is_owner = in_array($role,['bw_owner','representative'],true);
  if ($is_owner && !wp_verify_nonce($nonce,'bwf_signup_rep')) return;

  $user_login=sanitize_user($_POST['user_login']??'');
  $user_email=sanitize_email($_POST['user_email']??'');
  $user_pass =$_POST['user_pass']??'';
  $first_name=sanitize_text_field($_POST['first_name']??'');
  if (!$user_login||!$user_email||!$user_pass||!$first_name) return;

  $uid = wp_insert_user([
    'user_login'=>$user_login,'user_email'=>$user_email,'user_pass'=>$user_pass,
    'first_name'=>$first_name,'role'=>'bw_owner','user_url'=>esc_url_raw($_POST['user_url']??'')
  ]);
  if (is_wp_error($uid)) return;

  // 메타 저장
  foreach(['bw_company_name','bw_industry','bw_employees','bw_contact_window','bw_discover','bw_phone'] as $k){
    if(isset($_POST[$k])) update_user_meta($uid,$k,sanitize_text_field($_POST[$k]));
  }
  if (($_POST['bw_discover']??'')==='etc' && !empty($_POST['source_etc'])) {
    update_user_meta($uid,'bw_discover','etc: '.sanitize_text_field($_POST['source_etc']));
  }
  wp_set_current_user($uid); wp_set_auth_cookie($uid);
  wp_redirect(home_url('/owner-questions/')); exit;
});

`$nl
===== FILE: bw-owner-suite-acf\includes\view-list.php (3861 bytes, 90 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

/** 단건 보기: [bw_owner_view id] / ?id= */
add_shortcode('bw_owner_view', function($atts){
  if(!is_user_logged_in()) return '<div class="bwf-form">로그인이 필요합니다.</div>';
  $id=(int)($atts['id']??($_GET['id']??0));
  $p=get_post($id);
  if(!$p || $p->post_type!=='bwf_owner_answer') return '<div class="bwf-form">데이터가 없습니다.</div>';
  if((int)$p->post_author!==get_current_user_id() && !current_user_can('read_post',$id)) return '<div class="bwf-form">권한이 없습니다.</div>';

  wp_enqueue_style('bwf-forms');
  $cfg=bwf_owner_cfg(); $ans=(array)get_post_meta($id,'bwf_answers',true);

  ob_start(); ?>
  <div class="bwos-wrap">
    <h2 class="bwf-title"><?php echo esc_html($cfg['title']); ?></h2>
    <?php foreach($cfg['qs'] as $q): $idk=$q['id']; ?>
      <div class="bwf-field">
        <label><?php echo esc_html($q['label']); ?></label>
        <?php if(($q['type']??'')==='group'): ?>
          <?php foreach(($q['sub']??[]) as $sub): $sid=$sub['id']; $v=trim((string)($ans[$idk][$sid]??'')); ?>
            <div class="bwf-sub"><div class="bwf-help"><?php echo esc_html($sub['label']); ?></div><div class="bwf-card"><?php echo nl2br(esc_html($v)); ?></div></div>
          <?php endforeach; ?>
        <?php else: $v=trim((string)($ans[$idk]??'')); ?>
          <div class="bwf-card"><?php echo nl2br(esc_html($v)); ?></div>
        <?php endif; ?>
      </div>
    <?php endforeach; ?>
    <div class="bwf-actions">
      <a class="bwf-btn" href="<?php echo esc_url(add_query_arg(['id'=>$p->ID], bwf_owner_edit_url())); ?>">수정</a>
      <a class="bwf-btn-secondary" href="<?php echo esc_url(bwf_owner_list_url()); ?>">목록</a>
    </div>
  </div>
  <?php return ob_get_clean();
});

/** 마이페이지: [bw_owner_list] / 별칭 [bw_my_questions] */
add_shortcode('bw_owner_list', function($atts){
  if(!is_user_logged_in()) return '<div class="bwf-form">로그인이 필요합니다.</div>';
  $a=shortcode_atts(['per_page'=>10,'paged'=>max(1,(int)($_GET['pg']??1))],$atts,'bw_owner_list');

  $q=new WP_Query([
    'post_type'=>'bwf_owner_answer','post_status'=>'private','author'=>get_current_user_id(),
    'posts_per_page'=>(int)$a['per_page'],'orderby'=>'date','order'=>'DESC','paged'=>(int)$a['paged']
  ]);
  wp_enqueue_style('bwf-forms');

  ob_start(); ?>
  <div class="bwos-wrap">
    <h2 class="bwf-title">마이페이지</h2>
    <div class="bwos-list">
      <?php if($q->have_posts()): while($q->have_posts()): $q->the_post();
        $id=get_the_ID();
        $ts=get_post_timestamp($id,'date'); // ✔ 사이트 타임존 기준
        $when=wp_date('Y-m-d H:i',$ts);
        $view=esc_url(add_query_arg(['id'=>$id], bwf_owner_view_url()));
        $edit=esc_url(add_query_arg(['id'=>$id], bwf_owner_edit_url()));
      ?>
        <div class="bwos-card">
          <h4>#<?php echo (int)$id; ?></h4>
          <div class="meta"><?php echo esc_html($when); ?></div>
          <div class="row">
            <a href="<?php echo $view; ?>">보기</a>
            <a href="<?php echo $edit; ?>">수정</a>
          </div>
        </div>
      <?php endwhile; else: ?>
        <p>작성한 내역이 없습니다.</p>
      <?php endif; wp_reset_postdata(); ?>
    </div>
    <?php
      $links = paginate_links([
        'total'=>max(1,(int)$q->max_num_pages),
        'current'=>(int)$a['paged'],
        'type'=>'array','prev_text'=>'이전','next_text'=>'다음',
        'format'=>'?pg=%#%'
      ]);
      if($links){
        echo '<div class="bwos-pg">';
        foreach($links as $l) echo $l.' ';
        echo '</div>';
      }
    ?>
  </div>
  <?php return ob_get_clean();
});

add_shortcode('bw_my_questions', fn($a)=>do_shortcode('[bw_owner_list]'));

`$nl

`$nl
===== FILE: pack-code.ps1 (4063 bytes, 113 lines) =====
`$ext
param(
  [string]$Root = ".",
  [string]$Out = "codepack.txt",
  [string]$IncludeExt = ".php,.js,.ts,.css,.scss,.html,.htm,.json,.md,.yml,.yaml,.xml,.sh,.ps1,.ini,.txt,.sql,.twig,.vue",
  # 제외할 디렉터리들 (쉼표로 구분)
  [string]$ExcludeDirs = "node_modules,dist,build,vendor,.git,.github,.idea,.vscode,.next,.cache,growth-checklist\plugin-update-checker",
  # 제외할 파일 패턴들 (쉼표로 구분)
  [string]$ExcludeFiles = "*.min.js,*.min.css,*.map,*.lock,*.zip,*.tar,*.gz,*.png,*.jpg,*.jpeg,*.gif,*.webp,*.svg,*.woff,*.woff2,*.ttf,*.eot,*.pdf",
  # 용량 한도
  [int]$MaxFileBytes = 1000000,    # 파일당 최대 1MB
  [int]$MaxTotalBytes = 20000000,  # 전체 최대 20MB
  # 변경 파일만 모드
  [switch]$ChangedOnly,
  [string]$GitRange = ""
)

$ErrorActionPreference = "Stop"
$Root = (Resolve-Path $Root).Path
$include = $IncludeExt.Split(",") | ForEach-Object { $_.Trim().ToLower() } | Where-Object { $_ -ne "" }
$exDirs  = $ExcludeDirs.Split(",")  | ForEach-Object { $_.Trim() }        | Where-Object { $_ -ne "" }
$exFiles = $ExcludeFiles.Split(",") | ForEach-Object { $_.Trim() }        | Where-Object { $_ -ne "" }

function IsTextExt($path) {
  $ext = [IO.Path]::GetExtension($path).ToLower()
  return $include -contains $ext
}
function IsExcludedDir($path) {
  foreach ($d in $exDirs) {
    if ($path -like "*$d*") { return $true }
  }
  return $false
}
function IsExcludedFile($file) {
  foreach ($p in $exFiles) {
    if ([IO.Path]::GetFileName($file) -like $p) { return $true }
  }
  return $false
}

# 파일 목록 수집
$files = @()
if ($ChangedOnly) {
  $gitArgs = @("diff","--name-only")
  if ($GitRange) { $gitArgs += $GitRange }
  $changed = & git @gitArgs 2>$null
  foreach ($rel in $changed) {
    $p = Join-Path $Root $rel
    if (Test-Path $p -PathType Leaf) { $files += (Resolve-Path $p).Path }
  }
} else {
  $files = Get-ChildItem -Path $Root -Recurse -File | ForEach-Object { $_.FullName }
}

# 필터링
$files = $files | Where-Object {
  -not (IsExcludedDir $_) -and
  -not (IsExcludedFile $_) -and
  (IsTextExt $_)
}

# 출력 빌드
$sb = New-Object System.Text.StringBuilder
$totalBytes = 0
$nl = [Environment]::NewLine

# 상단 메타
try {
  $repoUrl = (git -C $Root config --get remote.origin.url)
  $branch  = (git -C $Root rev-parse --abbrev-ref HEAD)
  $tag     = (git -C $Root describe --tags --abbrev=0) 2>$null
  $commit  = (git -C $Root rev-parse --short HEAD)
  $time    = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
  $null = $sb.AppendLine("===== META =====")
  $null = $sb.AppendLine("Repo: $repoUrl")
  $null = $sb.AppendLine("Branch: $branch  |  Tag: $tag  |  Commit: $commit")
  $null = $sb.AppendLine("Generated: $time")
  $null = $sb.AppendLine("")
} catch {}

foreach ($f in $files) {
  try {
    $fi = Get-Item $f
    $size = $fi.Length
    if ($size -gt $MaxFileBytes) {
      $rel = $f.Substring($Root.Length+1)
      $null = $sb.AppendLine("===== FILE: $rel ($size bytes) SKIPPED: > $MaxFileBytes =====$nl")
      continue
    }
    if (($totalBytes + $size) -gt $MaxTotalBytes) {
      $null = $sb.AppendLine("===== STOP: total size would exceed $MaxTotalBytes bytes. Remaining files omitted. =====$nl")
      break
    }

    $rel = $f.Substring($Root.Length+1)
    $content = (Get-Content -Path $f -Raw -Encoding UTF8)
    $lineCount = ($content -split "`r?`n").Count
    $ext = [IO.Path]::GetExtension($f).TrimStart(".").ToLower()
    if (-not $ext) { $ext = "text" }

    $null = $sb.AppendLine("===== FILE: $rel ($size bytes, $lineCount lines) =====")
    $null = $sb.AppendLine("```$ext")
    $null = $sb.AppendLine($content)
    $null = $sb.AppendLine("```$nl")

    $totalBytes += $size
  } catch {
    $null = $sb.AppendLine("===== FILE: $f ERROR: $($_.Exception.Message) =====$nl")
  }
}

[IO.File]::WriteAllText((Join-Path $Root $Out), $sb.ToString(), [Text.Encoding]::UTF8)
"생성 완료: $(Join-Path $Root $Out)  (총 approx $totalBytes bytes)"

`$nl
===== FILE: bw-owner-suite-acf\bw-owner-suite-acf.php (924 bytes, 26 lines) =====
`$ext
<?php
/**
 * Plugin Name: BW Owner Suite (light)
 */
if (!defined('ABSPATH')) exit;

define('BWOS_VER', '1.0.3');
define('BWOS_DIR', plugin_dir_path(__FILE__));
define('BWOS_URL', plugin_dir_url(__FILE__));

require_once BWOS_DIR.'includes/cpt-admin.php';
require_once BWOS_DIR.'includes/form.php';
require_once BWOS_DIR.'includes/signup.php';
require_once BWOS_DIR.'includes/save.php';
require_once BWOS_DIR.'includes/view-list.php';
require_once BWOS_DIR.'includes/acf-fields.php'; // 관리자 ACF 메타박스(5문항)

add_action('wp_enqueue_scripts', function(){
  $css = BWOS_URL.'assets/owner-form.css';
  $js  = BWOS_URL.'assets/owner-form.js';
  wp_register_style ('bwos-form', $css, [], BWOS_VER);
  wp_register_style ('bwf-forms', $css, [], BWOS_VER); // alias
  wp_register_script('bwos-form', $js,  ['jquery'], BWOS_VER, true);
  wp_register_script('bwf-forms', $js,  ['jquery'], BWOS_VER, true); // alias
});

`$nl
===== FILE: bw-owner-suite-acf\README.md (1409 bytes, 40 lines) =====
`$ext
# BW Owner Suite (ACF Minimal)

워드프레스 표준 + ACF만 사용하여
- 회원가입 → 프로필 수정
- 대표 질문(CPT) 작성/수정/보기/목록/복제/삭제
- 저장 알림(메일/텔레그램)

을 한 번에 처리하는 경량 플러그인입니다.

## 설치
1) `Advanced Custom Fields`(ACF) 플러그인을 활성화
2) 워드프레스 관리자 → 플러그인 → 새로 추가 → 플러그인 업로드 → 이 ZIP 업로드 후 활성화
3) 활성화 즉시 아래 페이지가 자동 생성됩니다.
   - `/owner-questions/` 작성
   - `/owner-edit/?id=글ID` 수정
   - `/my-question-view/?id=글ID` 보기
   - `/my-questions/` 내 저장본(보기/수정/복제/삭제)
   - `/my-profile/` 마이프로필
   - `/register/` 회원가입

## 텔레그램 알림(선택)
`wp-config.php`에 아래 상수를 추가하면 저장 시 텔레그램 알림이 전송됩니다.

```php
define('BWF_TG_BOT','123456:ABC...');       // 봇 토큰
define('BWF_TG_CHAT','-1001234567890');     // 채팅 ID
```

## 짧은코드(Shortcodes)
- [bw_register]
- [bw_profile_form]
- [bw_owner_form_acf]
- [bw_owner_edit id="123"]  (또는 /owner-edit/?id=123)
- [bwf_owner_view id="123"]
- [bw_my_questions]

## 주의
- 플러그인 동작을 위해 ACF가 필요합니다.
- 데이터는 CPT `bwf_owner_answer`에 저장되며 리비전이 활성화되어 되돌리기가 가능합니다.

`$nl
===== FILE: bw-owner-suite-acf\assets\owner-form.css (4196 bytes, 85 lines) =====
`$ext
:root{
  --bw-font:17.5px;
  --bw-muted:#64748b;
  --bw-border:#e5e7eb;
  --bw-accent:#6366f1;
}
body{font-size:var(--bw-font)}

/* 공통 래퍼 */
.bwos-wrap{max-width:920px;margin:32px auto;padding:0 16px}

/* 제목/도움말 */
.bwf-title{font-size:30px;line-height:1.25;margin:6px 0 12px}
.bwf-help{color:var(--bw-muted);margin:0 0 18px}

/* 필드 */
.bwf-field{margin:22px 0}
.bwf-field label{display:block;font-weight:700;margin:0 0 10px;font-size:18px}
.bwf-field textarea,
.bwf-field input[type="text"],
.bwf-field input[type="number"],
.bwf-field input[type="email"],
.bwf-field input[type="tel"],
.bwf-field input[type="url"],
.bwf-field select{
  width:100%;box-sizing:border-box;padding:12px 14px;border:1px solid #d1d5db;border-radius:12px;background:#fff;font-size:16.5px;outline:none
}
.bwf-field textarea:focus,
.bwf-field input:focus,
.bwf-field select:focus{border-color:var(--bw-accent)}
.bwos-field.bwos-error textarea,
.bwos-field.bwos-error input,
.bwos-field.bwos-error select{border-color:#ef4444;background:#fff1f2}
.bwf-invalid{border-color:#ef4444 !important;background:#fff1f2 !important}

.bwos-count{display:inline-block;margin-top:6px;font-size:12px;color:var(--bw-muted)}
.bwf-desc{margin:10px 0 6px;padding-left:12px;border-left:3px solid var(--bw-border);color:#0f172a}
.bwf-examples{margin:6px 0 0;color:#0f172a}
.bwf-examples ul,.bwf-examples ol{margin:6px 0 0 18px}

/* 버튼 */
.bwf-btn{display:inline-block;padding:10px 16px;border-radius:12px;border:none;background:var(--bw-accent);color:#fff;text-decoration:none}
.bwf-btn-secondary{display:inline-block;padding:10px 16px;border-radius:12px;border:1px solid #cbd5e1;background:#fff;color:#0f172a;text-decoration:none}
.bwf-actions{display:flex;gap:8px;align-items:center;margin-top:16px}

/* sticky 진행바 */
.bwos-progress{position:sticky;top:64px;z-index:1000;margin:0 0 16px}
body.admin-bar .bwos-progress{top:96px}
.bwos-progress .bar{height:8px;background:#f1f5f9;border-radius:999px;overflow:hidden}
.bwos-progress .bar>span{display:block;height:100%;width:0%;background:linear-gradient(90deg,#0ea5e9,#6366f1);border-radius:999px;transition:width .2s}
.bwos-progress .status{font-size:12px;color:#475569;margin-top:6px}

/* 모달(중앙 상단, 위 여백) — 회원가입/폼 공용 */
.bwos-modal, .bwf-modal{
  position:fixed;inset:0;display:none;align-items:flex-start;justify-content:center;padding-top:18vh;background:rgba(0,0,0,.4);z-index:100000
}
body.admin-bar .bwos-modal, body.admin-bar .bwf-modal{padding-top:calc(18vh + 32px)}
.bwos-modal.is-open, .bwf-modal.is-open{display:flex}
.bwos-modal-inner, .bwf-modal .bwf-modal__card{
  background:#fff;max-width:520px;width:92vw;padding:20px;border-radius:14px;box-shadow:0 20px 40px rgba(2,6,23,.15)
}
.bwos-modal-inner h4, .bwf-modal h3{margin:0 0 8px;font-size:18px}
.bwos-modal-inner p, .bwf-modal p{margin:0 0 12px;color:#334155}

/* 보기 화면(카드) */
.bwf-card{border:1px solid var(--bw-border);background:#fff;border-radius:12px;padding:12px 14px}

/* 마이페이지 카드 + 페이지네이션 */
.bwos-list{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:14px}
@media (max-width:920px){.bwos-list{grid-template-columns:1fr}}
.bwos-card{border:1px solid var(--bw-border);border-radius:12px;padding:14px 16px;background:#fff}
.bwos-card h4{margin:0 0 6px;font-size:16px}
.bwos-card .meta{font-size:12px;color:var(--bw-muted);margin-bottom:8px}
.bwos-card .row{display:flex;gap:8px;flex-wrap:wrap}
.bwos-card .row a{display:inline-block;padding:6px 10px;border-radius:10px;background:#f1f5f9;color:#0f172a;text-decoration:none}
.bwos-pg{margin:16px 0 4px}
.bwos-pg .page-numbers{display:inline-block;padding:6px 10px;border:1px solid var(--bw-border);border-radius:10px;margin-right:6px;text-decoration:none;color:#0f172a}
.bwos-pg .current{background:#0ea5e9;color:#fff;border-color:#0ea5e9}

/* 회원가입 2열 그리드 */
.bwf-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px 14px}
.bwf-col-full{grid-column:1/-1}
@media (max-width:720px){.bwf-grid{grid-template-columns:1fr}}
.bwf-hidden{display:none}

`$nl
===== FILE: bw-owner-suite-acf\assets\owner-form.js (3206 bytes, 86 lines) =====
`$ext
(function($){
  if(!$ || !$('.bwos-form').length) return;

  const $form = $('.bwos-form').first();
  $form.attr('autocomplete','off');
  $form.find('input,textarea').attr({'autocomplete':'off','autocapitalize':'off','autocorrect':'off'});

  const $progress = $form.find('.bwos-progress');
  const reqs = [];
  let submitted = false;

  function updateProgress(){
    const total=reqs.length, done=reqs.filter(r=>r.valid()).length, pct=total?Math.round(done/total*100):0;
    $progress.find('.bar>span').css('width',pct+'%');
    $progress.find('.status').text('작성 '+done+'/'+total+' ('+pct+'%)');
  }

  function wire($wrap){
    const min = parseInt($wrap.data('min')||200,10);
    const $subs = $wrap.find('.bwf-sub textarea');
    const isGroup = $subs.length>0;
    let $cnt = $wrap.find('.bwos-count');

    const setError = (bad)=>{
      // 처음에는 표시 X, 제출 후에만 표시
      $wrap.toggleClass('bwos-error', submitted && !!bad);
    };

    const valid = ()=>{
      if(isGroup){
        let ok=true;
        $subs.each(function(){ if(($(this).val()||'').trim()==='') ok=false; });
        return ok;
      }else{
        return (($wrap.find('textarea,input[type="text"]').first().val()||'').trim().length >= min);
      }
    };

    const update = ()=>{
      if(isGroup){
        let anyEmpty=false;
        $subs.each(function(){ if(($(this).val()||'').trim()==='') anyEmpty=true; });
        setError(anyEmpty);
      }else{
        const $inp=$wrap.find('textarea,input[type="text"]').first();
        const v=($inp.val()||'').trim();
        if(!$cnt.length){ $cnt=$('<small class="bwos-count"></small>').appendTo($wrap); }
        $cnt.text(v.length+'/'+min);
        setError(v.length < min);
      }
      updateProgress();
    };

    if(isGroup) $subs.on('input blur', update);
    else        $wrap.find('textarea,input[type="text"]').first().on('input blur', update);

    reqs.push({wrap:$wrap, valid, update});
    update();
  }

  // 모든 필수 섹션 와이어링
  $form.find('.bwos-required').each(function(){ wire($(this)); });
  updateProgress();

  // 중앙 상단 2줄 모달
  const $modal=$('<div class="bwos-modal"><div class="bwos-modal-inner"><h4>입력이 필요한 항목이 있어요</h4><p>필수 항목을 확인해 주세요.</p><button type="button" class="bwf-btn-secondary ok">확인</button></div></div>').appendTo('body');
  $modal.on('click','.ok',()=> $modal.removeClass('is-open'));

  let locked=false;
  $form.on('submit',function(e){
    submitted = true;
    let bad=false; reqs.forEach(r=>{ if(!r.valid()) bad=true; r.update(); });
    if(bad){
      e.preventDefault();
      $modal.addClass('is-open');
      const $first = $form.find('.bwos-error').first();
      if($first.length) $('html,body').animate({scrollTop:$first.offset().top-120},200);
      return;
    }
    if(locked){ e.preventDefault(); return; }
    locked=true;
    $form.find('.bwos-submit').prop('disabled',true).text('저장 중…');
    setTimeout(()=>{ locked=false; $form.find('.bwos-submit').prop('disabled',false).text('저장'); }, 5000);
  });
})(jQuery);

`$nl
===== FILE: bw-owner-suite-acf\includes\acf-fields.php (3584 bytes, 76 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

add_action('acf/init', function(){
  if (!function_exists('acf_add_local_field_group')) return;

  acf_add_local_field_group([
    'key'=>'group_bwos_owner_v5','title'=>'대표 질문지',
    'fields'=>[
      ['key'=>'f_problem','label'=>'1) 지금, 우리 사업의 가장 큰 고민은 무엇인가요?','name'=>'_acf_problem','type'=>'textarea','required'=>1,'rows'=>8,'instructions'=>'최소 200자 권장'],
      ['key'=>'f_value','label'=>'2) 우리 서비스의 핵심 가치는 무엇인가요?','name'=>'_acf_value','type'=>'textarea','required'=>1,'rows'=>6],
      ['key'=>'f_whom','label'=>'3) 누가 이용해야 하나요? 왜 우리인가요?','name'=>'_acf_ideal_customer','type'=>'textarea','required'=>1,'rows'=>6],
      ['key'=>'f_ask1','label'=>'4-1) 고객에게 묻고 싶은 질문 #1','name'=>'_acf_cq1','type'=>'text'],
      ['key'=>'f_ask2','label'=>'4-2) 고객에게 묻고 싶은 질문 #2','name'=>'_acf_cq2','type'=>'text'],
      ['key'=>'f_ask3','label'=>'4-3) 고객에게 묻고 싶은 질문 #3','name'=>'_acf_cq3','type'=>'text'],
      ['key'=>'f_comp','label'=>'5) 경쟁사 대비 차별점','name'=>'_acf_competitors','type'=>'textarea','required'=>1,'rows'=>6],
    ],
    'location'=>[[['param'=>'post_type','operator'=>'==','value'=>'bwf_owner_answer']]],
    'position'=>'normal','style'=>'default','active'=>true,
  ]);
});


/** 200자 필드 서버 검증 */
add_filter('acf/validate_value', function($valid, $value, $field){
  if ($valid !== true) return $valid;
  $min200 = ['problem','core_value','target_customer','differentiation','sales_blockers','current_channels','growth_goal','next_action'];
  if (in_array($field['name'] ?? '', $min200, true)) {
    if (mb_strlen(trim((string)$value)) < 200) return '최소 200자 이상 작성해 주세요.';
  }
  return $valid;
}, 10, 3);
/* ------- ACF <-> bwf_answers 동기화 ------- */
function bwos_acf_meta_keys(){ // ACF 메타키(name) 매핑
  return [
    '_acf_problem'       => ['id'=>'problem'],
    '_acf_value'         => ['id'=>'value'],
    '_acf_ideal_customer'=> ['id'=>'ideal_customer'],
    '_acf_cq1'           => ['id'=>'ask3','sub'=>'q1'],
    '_acf_cq2'           => ['id'=>'ask3','sub'=>'q2'],
    '_acf_cq3'           => ['id'=>'ask3','sub'=>'q3'],
    '_acf_competitors'   => ['id'=>'competitors'],
  ];
}

/* 편집 화면 로드시 ACF 메타 채워넣기(관리자에서 비어 보이던 문제 해결) */
add_action('load-post.php', function(){
  $pid = isset($_GET['post']) ? (int)$_GET['post'] : 0;
  if(!$pid) return;
  $p = get_post($pid);
  if(!$p || $p->post_type!=='bwf_owner_answer') return;

  $ans = (array)get_post_meta($pid,'bwf_answers',true);
  foreach(bwos_acf_meta_keys() as $meta=>$m){
    $val = '';
    if(empty($m['sub'])) $val = (string)($ans[$m['id']] ?? '');
    else                 $val = (string)($ans[$m['id']][$m['sub']] ?? '');
    update_post_meta($pid, $meta, $val);
  }
});

/* 저장 시 ACF 값으로 bwf_answers 재생성(양방향 동기화) */
add_action('save_post_bwf_owner_answer', function($post_id){
  if(defined('DOING_AUTOSAVE') && DOING_AUTOSAVE) return;
  $ans = [];
  foreach(bwos_acf_meta_keys() as $meta=>$m){
    $v = (string)get_post_meta($post_id,$meta,true);
    if(empty($m['sub'])) $ans[$m['id']] = $v;
    else {
      if(empty($ans[$m['id']])) $ans[$m['id']] = [];
      $ans[$m['id']][$m['sub']] = $v;
    }
  }
  if($ans) update_post_meta($post_id,'bwf_answers',$ans);
}, 20);

`$nl
===== FILE: bw-owner-suite-acf\includes\cpt-admin.php (945 bytes, 21 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

add_action('init', function(){
  register_post_type('bwf_owner_answer', [
    'label'=>'대표 질문지','labels'=>['name'=>'대표 질문지','add_new_item'=>'새 대표 질문 생성','edit_item'=>'대표 질문 편집'],
    'public'=>false,'exclude_from_search'=>true,'publicly_queryable'=>false,'show_ui'=>true,'show_in_menu'=>true,
    'menu_icon'=>'dashicons-editor-help','supports'=>['author','custom-fields'],'map_meta_cap'=>true,
  ]);
});

add_filter('manage_bwf_owner_answer_posts_columns', function($c){
  return ['cb'=>$c['cb'],'title'=>'제목','author'=>'작성자','created'=>'저장 시각'];
});
add_action('manage_bwf_owner_answer_posts_custom_column', function($col,$post_id){
  if($col==='created'){
    $ts = get_post_timestamp($post_id,'date');            // ✔ 사이트 타임존 타임스탬프
    echo esc_html( wp_date('Y-m-d H:i', $ts) );
  }
}, 10, 2);

`$nl
===== FILE: bw-owner-suite-acf\includes\form.php (8187 bytes, 130 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

/** 질문 구성(설명/예시 포함, 최소 200자) */
function bwf_owner_cfg(){
  return [
    'title' => '대표님 핵심 질문지',
    'min'   => 200,
    'intro' => '사업의 본질을 파악하고 고객에게 정말 묻고 싶은 질문을 구체화합니다. 각 문항은 최소 <strong>{MIN}</strong>자입니다. <em>(단, <strong>“고객에게 물어보고 싶은 3가지”</strong>는 글자수 제한 없음)</em>',
    'qs' => [
      [
        'id'=>'problem','label'=>'1. 지금, 우리 사업의 가장 큰 고민은 무엇인가요?','required'=>true,'min'=>200,
        'desc'=>'설명: 현재 가장 답답하거나 성장이 정체되었다고 느끼는 구체적인 상황을 한두 문장으로 설명해 주세요. 예: “광고는 많이 했는데…” 등 숫자/행동 기반.',
        'ex'=>'<ul><li>“최근 인스타그램 광고 효율이 너무 안 나와요. 클릭은 많은데, 저희 웹사이트에 1분도 머물지 않고 나가는 사람이 많아요.”</li><li>“기존 고객들의 재구매율이 낮아서, 항상 새로운 고객을 찾아야 하는 부담이 큽니다.”</li></ul>'
      ],
      [
        'id'=>'value','label'=>'2. 우리 서비스는 고객의 ‘어떤 문제’를 해결해주고 있나요?','required'=>true,'min'=>200,
        'desc'=>'설명: 고객의 전/후 변화를 떠올려 가장 중요한 <strong>가치</strong>를 한 문장으로.',
        'ex'=>'<ol><li>“서류 작업을 5분 만에 자동화 → 본업 집중.”</li><li>“바쁜 직장인에게 집밥 같은 건강한 한 끼 제공.”</li></ol>'
      ],
      [
        'id'=>'ideal_customer','label'=>'3. 우리 서비스를 ‘누가’ 이용해야 하나요? 왜 우리를 선택하나요?','required'=>true,'min'=>200,
        'desc'=>'설명: 가장 잘 맞는 사람의 특징 + 우리를 고를 <strong>결정적 이유</strong>.',
        'ex'=>'<p>“시간·비용이 부족한 <strong>20대 대학생</strong> → 15분 홈트 영상으로 해결.”</p>'
      ],
      [
        'id'=>'ask3','type'=>'group','label'=>'4. 고객에게 물어보고 싶은 3가지','required'=>true,
        'desc'=>'대표님이 고객에게 직접 묻고 싶은 핵심 질문 3가지를 작성하세요. 경험한 내용을 바탕으로 구체적으로.',
        'ex'=>'<p><strong>상품</strong></p><ul><li>“처음 받았을 때 어떤 느낌이었나요? (포장/디자인/첫 경험)”</li><li>“가장 만족/아쉬웠던 점은?”</li></ul><p><strong>서비스</strong></p><ul><li>“무료체험 때 최고의 포인트/아쉬웠던 점?”</li></ul>',
        'sub'=>[
          ['id'=>'q1','label'=>'질문 1','ph'=>'예: 우리 서비스를 알게 된 경로는 무엇이었나요?','required'=>true],
          ['id'=>'q2','label'=>'질문 2','ph'=>'예: 결심 포인트는 무엇이었나요?','required'=>true],
          ['id'=>'q3','label'=>'질문 3','ph'=>'예: 사용 중 가장 불편했던 점은?','required'=>true],
        ]
      ],
      [
        'id'=>'competitors','label'=>'5. 현재 경쟁사는 어디이며, 그들과의 차별점은 무엇이라고 생각하시나요?','required'=>true,'min'=>200,
        'desc'=>'설명: 주요 경쟁사 1~2곳과 비교해 강·약점을 정리.',
        'ex'=>'<p>“A는 저렴하지만 품질이 낮고, B는 비싸지만 품질이 높다 → 우리는 <strong>적정 가격 + 높은 만족</strong>.”</p>'
      ],
    ]
  ];
}

/** 공용 URL */
function bwf_owner_view_url(){ return home_url('/my-question-view/'); }
function bwf_owner_edit_url(){ return home_url('/owner-edit/'); }
function bwf_owner_list_url(){ return home_url('/my-questions/'); }

/** 폼 렌더(신규/수정) — 회사정보 제거, 마이페이지 버튼 제거 */
function bwf_render_owner_form($args=[]){
  $cfg   = bwf_owner_cfg();
  $min   = (int)$cfg['min'];
  $mode  = $args['mode'] ?? 'create';
  $post  = $args['post'] ?? null;
  $saved = $args['saved'] ?? [];
  $errs  = $args['errs']  ?? [];

  if ($mode==='edit' && $post){
    $existing = (array)get_post_meta($post->ID,'bwf_answers',true);
    $saved = $saved ?: $existing;
  }

  wp_enqueue_style('bwf-forms');
  wp_enqueue_script('bwos-form');

  ob_start(); ?>
  <form id="bwfOwnerForm" class="bwf-form bwos-form" method="post" action="<?php echo esc_url(admin_url('admin-post.php')); ?>" novalidate>
    <input type="hidden" name="action" value="bwf_owner_save">
    <?php wp_nonce_field('bwf_owner_save','bwf_owner_nonce'); ?>
    <input type="hidden" name="post_id" value="<?php echo $post ? (int)$post->ID : 0; ?>">

    <div class="bwos-progress"><div class="bar"><span></span></div><div class="status">작성 0/0 (0%)</div></div>

    <h2 class="bwf-title"><?php echo esc_html($cfg['title']); ?></h2>
    <p class="bwf-help"><?php echo str_replace('{MIN}', $min, $cfg['intro']); ?></p>

    <?php foreach($cfg['qs'] as $q): $type=$q['type']??'textarea'; $id=$q['id']; ?>
      <div class="bwf-field bwos-field bwos-required" data-min="<?php echo (int)($q['min']??$min); ?>">
        <label><?php echo esc_html($q['label']); ?><?php if(!empty($q['required'])): ?><span class="bwf-required">*</span><?php endif; ?></label>

        <?php if($type==='group'): ?>
          <?php foreach(($q['sub']??[]) as $sub): $sid=$sub['id']; $v=$saved[$id][$sid]??''; ?>
            <div class="bwf-sub">
              <div class="bwf-help"><?php echo esc_html($sub['label']); ?></div>
              <textarea name="q[<?php echo esc_attr($id); ?>][<?php echo esc_attr($sid); ?>]" rows="4" placeholder="<?php echo esc_attr($sub['ph']??''); ?>"><?php echo esc_textarea($v); ?></textarea>
            </div>
          <?php endforeach; ?>
          <?php if(!empty($q['desc'])): ?><div class="bwf-desc"><?php echo $q['desc']; ?></div><?php endif; ?>
          <?php if(!empty($q['ex'])):   ?><div class="bwf-examples"><?php echo $q['ex']; ?></div><?php endif; ?>
        <?php else: $v=$saved[$id]??''; ?>
          <textarea name="q[<?php echo esc_attr($id); ?>]" rows="6"><?php echo esc_textarea($v); ?></textarea>
          <small class="bwos-count">0/<?php echo (int)($q['min']??$min); ?></small>
          <?php if(!empty($q['desc'])): ?><div class="bwf-desc"><?php echo $q['desc']; ?></div><?php endif; ?>
          <?php if(!empty($q['ex'])):   ?><div class="bwf-examples"><?php echo $q['ex']; ?></div><?php endif; ?>
        <?php endif; ?>
      </div>
    <?php endforeach; ?>

    <div class="bwf-actions">
      <button type="submit" class="bwf-btn bwos-submit"><?php echo $mode==='edit'?'수정 저장':'저장'; ?></button>
    </div>
  </form>
  <?php return ob_get_clean();
}

/** 작성 */
add_shortcode('bwf_owner_questions', function(){
  if (!is_user_logged_in()) return '<div class="bwf-form">로그인이 필요합니다.</div>';
  $uid=get_current_user_id();
  $old=get_transient('bwf_owner_old_'.$uid)?:[]; delete_transient('bwf_owner_old_'.$uid);
  $err=get_transient('bwf_owner_err_'.$uid)?:[]; delete_transient('bwf_owner_err_'.$uid);
  return bwf_render_owner_form(['mode'=>'create','saved'=>$old,'errs'=>$err]);
});
add_shortcode('bw_owner_form', function(){ return do_shortcode('[bwf_owner_questions]'); });

/** 수정 */
add_shortcode('bw_owner_edit', function($atts){
  if (!is_user_logged_in()) return '<div class="bwf-form">로그인이 필요합니다.</div>';
  $id=(int)($atts['id']??($_GET['id']??0));
  $post=get_post($id);
  if(!$post || $post->post_type!=='bwf_owner_answer') return '<div class="bwf-form">데이터가 없습니다.</div>';
  if((int)$post->post_author!==get_current_user_id() && !current_user_can('edit_post',$id)) return '<div class="bwf-form">권한이 없습니다.</div>';

  $uid=get_current_user_id();
  $old=get_transient('bwf_owner_old_'.$uid)?:[]; delete_transient('bwf_owner_old_'.$uid);
  $err=get_transient('bwf_owner_err_'.$uid)?:[]; delete_transient('bwf_owner_err_'.$uid);
  return bwf_render_owner_form(['mode'=>'edit','post'=>$post,'saved'=>$old,'errs'=>$err]);
});

`$nl
===== FILE: bw-owner-suite-acf\includes\save.php (2676 bytes, 74 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

add_action('admin_post_bwf_owner_save','bwf_owner_handle_save');
add_action('admin_post_nopriv_bwf_owner_save','bwf_owner_handle_save');

function bwf_owner_handle_save(){
  if(!is_user_logged_in()) { wp_safe_redirect(home_url('/')); exit; }
  if(empty($_POST['bwf_owner_nonce']) || !wp_verify_nonce($_POST['bwf_owner_nonce'],'bwf_owner_save')){
    wp_safe_redirect(wp_get_referer()?:home_url('/')); exit;
  }

  $uid  = get_current_user_id();
  $lock = 'bwf_owner_lock_'.$uid;
  if(get_transient($lock)) { wp_safe_redirect(home_url('/my-questions/')); exit; }
  set_transient($lock,1,8); // 8초 중복방지

  $cfg = bwf_owner_cfg();
  $min = (int)$cfg['min'];
  $src = $_POST['q'] ?? [];
  $ans = []; $err=[];

  foreach($cfg['qs'] as $q){
    $id=$q['id']; $type=$q['type']??'textarea';
    $req=!empty($q['required']); $m=(int)($q['min']??$min);

    if($type==='group'){
      $ans[$id]=[];
      foreach(($q['sub']??[]) as $sub){
        $sid=$sub['id']; $v=trim((string)($src[$id][$sid]??''));
        $ans[$id][$sid]=sanitize_textarea_field($v);
        if(!empty($sub['required']) && $v===''){ $err[$id][$sid]=true; }
      }
      if($req && !empty($err[$id])){/*표시용*/}
    }else{
      $v=trim((string)($src[$id]??'')); $ans[$id]=sanitize_textarea_field($v);
      if($req && mb_strlen($v)<$m){ $err[$id]=true; }
    }
  }

  if($err){
    set_transient('bwf_owner_old_'.$uid,$src,60);
    set_transient('bwf_owner_err_'.$uid,$err,60);
    delete_transient($lock);
    wp_safe_redirect(wp_get_referer()?:home_url('/owner-questions/')); exit;
  }

  $post_id = (int)($_POST['post_id']??0);
  $title   = '대표 질문지 - '.wp_date('Y-m-d H:i'); // 사이트 타임존

  if($post_id){
    $p=get_post($post_id);
    if($p && $p->post_type==='bwf_owner_answer' && ((int)$p->post_author===$uid || current_user_can('edit_post',$post_id))){
      update_post_meta($post_id,'bwf_answers',$ans);
      wp_update_post(['ID'=>$post_id,'post_title'=>$title,'post_status'=>'private']);
      delete_transient($lock);
      wp_safe_redirect(add_query_arg(['id'=>$post_id,'updated'=>1], bwf_owner_view_url())); exit;
    }
  }

  $new_id = wp_insert_post([
    'post_type'=>'bwf_owner_answer','post_status'=>'private','post_title'=>$title,'post_author'=>$uid,
  ], true);

  if(!is_wp_error($new_id)){
    update_post_meta($new_id,'bwf_answers',$ans);
    delete_transient($lock);
    wp_safe_redirect(add_query_arg(['id'=>$new_id,'saved'=>1], bwf_owner_view_url())); exit;
  }

  delete_transient($lock);
  wp_safe_redirect(bwf_owner_list_url()); exit;
}

`$nl
===== FILE: bw-owner-suite-acf\includes\signup.php (7613 bytes, 149 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

add_action('init', function(){
  if (!get_role('bw_owner')) add_role('bw_owner','대표',['read'=>true]);
});
function bwf_enqueue_form_style(){ wp_enqueue_style('bwf-forms'); }

/** 대표 회원가입: [bwf_signup_representative] */
add_shortcode('bwf_signup_representative', function () {
  bwf_enqueue_form_style();

  if (is_user_logged_in()) {
    $u = wp_get_current_user();
    return '<div class="bwf-form"><p><strong>'.esc_html($u->user_login).'</strong>로 로그인됨.</p>
            <p class="bwf-actions"><a class="bwf-btn" href="'.esc_url(home_url('/owner-questions/')).'">질문 등록하기</a></p></div>';
  }

  ob_start(); ?>
  <form method="post" class="bwf-form bwf-grid" id="bwf-signup-rep" novalidate>
    <input type="hidden" name="bwf_role" value="bw_owner">
    <?php wp_nonce_field('bwf_signup_rep','bwf_nonce'); ?>

    <h2 class="bwf-title bwf-col-full">대표 회원가입</h2>
    <p class="bwf-required-note bwf-col-full">* 표시는 필수 입력</p>

    <div><label>아이디 <span class="bwf-required">*</span></label>
      <input type="text" name="user_login" pattern="[A-Za-z0-9_\.\-]{4,32}" required></div>
    <div><label>비밀번호 <span class="bwf-required">*</span></label>
      <input type="password" name="user_pass" required></div>
    <div><label>이메일 <span class="bwf-required">*</span></label>
      <input type="email" name="user_email" required></div>
    <div><label>이름 <span class="bwf-required">*</span></label>
      <input type="text" name="first_name" required></div>

    <div><label>회사명 <span class="bwf-required">*</span></label>
      <input type="text" name="bw_company_name" required></div>
    <div><label>업종 <span class="bwf-required">*</span></label>
      <select name="bw_industry" required>
        <option value="">선택</option><option value="it">IT/서비스</option><option value="commerce">커머스</option><option value="etc">기타</option>
      </select></div>
    <div><label>직원 수 <span class="bwf-required">*</span></label>
      <input type="number" name="bw_employees" min="1" required></div>
    <div><label>홈페이지 URL</label>
      <input type="url" name="user_url" placeholder="https://"></div>

    <div><label>알게 된 경로 <span class="bwf-required">*</span></label>
      <select name="bw_discover" id="bwf-source" required>
        <option value="">선택</option><option value="search">검색</option><option value="sns">SNS</option><option value="ref">지인추천</option><option value="etc">기타</option>
      </select>
      <input type="text" name="source_etc" id="bwf-source-etc" placeholder="기타 경로" class="bwf-col-full bwf-hidden"></div>

    <div><label>휴대폰 번호 <span class="bwf-required">*</span></label>
      <input type="tel" name="bw_phone" id="bwf-phone" inputmode="numeric" placeholder="010-1234-5678"
             maxlength="13" pattern="^010-\d{4}-\d{4}$" required></div>
    <div><label>연락 가능한 시간대 <span class="bwf-required">*</span></label>
      <input type="text" name="bw_contact_window" placeholder="예: 평일 13:00~18:00" required></div>

    <div class="bwf-actions bwf-col-full">
      <button type="submit" name="bwf_register" class="bwf-btn">회원가입</button>
    </div>

    <!-- 제출 시에만 나타나는 중앙 상단 모달 -->
    <div class="bwf-modal" id="bwf-modal" aria-hidden="true">
      <div class="bwf-modal__card">
        <h3>입력이 필요한 항목이 있어요</h3>
        <p class="bwf-modal__msg">필수 항목을 확인해 주세요.</p>
        <div class="bwf-modal__actions"><button type="button" class="bwf-btn-secondary" id="bwf-modal-ok">확인</button></div>
      </div>
    </div>

    <script>
    (function(){
      const f=document.getElementById('bwf-signup-rep'),
            src=f.querySelector('#bwf-source'),
            etc=f.querySelector('#bwf-source-etc'),
            tel=f.querySelector('#bwf-phone'),
            modal=f.querySelector('#bwf-modal'),
            ok=modal.querySelector('#bwf-modal-ok');

      function showEtc(){ if(src.value==='etc'){ etc.classList.remove('bwf-hidden'); } else { etc.classList.add('bwf-hidden'); etc.value=''; } }
      src.addEventListener('change',showEtc); showEtc();

      // 휴대폰 자동 하이픈
      function fmt(v){ const d=String(v||'').replace(/\D/g,'').slice(0,11);
        if(d.startsWith('010')){ if(d.length>=11) return d.replace(/^(\d{3})(\d{4})(\d{4}).*$/,'$1-$2-$3');
          if(d.length>=7) return d.replace(/^(\d{3})(\d{0,4})(\d{0,4}).*$/,(m,a,b,c)=>a+(b?'-'+b:'')+(c?'-'+c:'')); if(d.length>=4) return d.replace(/^(\d{3})(\d{0,4}).*$/,(m,a,b)=>a+'-'+b); }
        return d; }
      tel.addEventListener('input',()=>{ const b=tel.value; tel.value=fmt(b); tel.setSelectionRange(tel.value.length,tel.value.length); });

      function openModal(msg){
        modal.classList.add('is-open'); modal.setAttribute('aria-hidden','false');
        modal.querySelector('.bwf-modal__msg').textContent=msg||'필수 항목을 확인해 주세요.';
      }
      function closeModal(){ modal.classList.remove('is-open'); modal.setAttribute('aria-hidden','true'); }
      ok.addEventListener('click',closeModal);

      // 제출 시 검증 → 미기입이면 페이지 이동 없이 모달
      f.addEventListener('submit',function(ev){
        const req=[...f.querySelectorAll('[required]')]; let bad=false, first=null;
        req.forEach(el=>{
          el.classList.remove('bwf-invalid'); el.setCustomValidity('');
          if(el.name==='bw_phone' && !/^010-\d{4}-\d{4}$/.test(el.value)){ el.setCustomValidity('휴대폰 번호는 010-1234-5678 형식'); }
          if(!el.checkValidity()){ bad=true; if(!first) first=el; el.classList.add('bwf-invalid'); }
        });
        if(bad){
          ev.preventDefault();
          openModal('누락된 필수 항목을 입력해 주세요.');
          first.scrollIntoView({behavior:'smooth',block:'center'});
        }
      });
    })();
    </script>
  </form>
  <?php
  return ob_get_clean();
});

/** 서버 처리 */
add_action('init', function(){
  if (!isset($_POST['bwf_register'])) return;
  $role = sanitize_text_field($_POST['bwf_role'] ?? '');
  $nonce= sanitize_text_field($_POST['bwf_nonce'] ?? '');
  $is_owner = in_array($role,['bw_owner','representative'],true);
  if ($is_owner && !wp_verify_nonce($nonce,'bwf_signup_rep')) return;

  $user_login=sanitize_user($_POST['user_login']??'');
  $user_email=sanitize_email($_POST['user_email']??'');
  $user_pass =$_POST['user_pass']??'';
  $first_name=sanitize_text_field($_POST['first_name']??'');
  if (!$user_login||!$user_email||!$user_pass||!$first_name) return;

  $uid = wp_insert_user([
    'user_login'=>$user_login,'user_email'=>$user_email,'user_pass'=>$user_pass,
    'first_name'=>$first_name,'role'=>'bw_owner','user_url'=>esc_url_raw($_POST['user_url']??'')
  ]);
  if (is_wp_error($uid)) return;

  foreach(['bw_company_name','bw_industry','bw_employees','bw_contact_window','bw_discover','bw_phone'] as $k){
    if(isset($_POST[$k])) update_user_meta($uid,$k,sanitize_text_field($_POST[$k]));
  }
  if (($_POST['bw_discover']??'')==='etc' && !empty($_POST['source_etc'])) {
    update_user_meta($uid,'bw_discover','etc: '.sanitize_text_field($_POST['source_etc']));
  }

  wp_set_current_user($uid); wp_set_auth_cookie($uid);
  wp_redirect(home_url('/owner-questions/')); exit;
});

`$nl
===== FILE: bw-owner-suite-acf\includes\view-list.php (3894 bytes, 92 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

/** 단건 보기: [bw_owner_view id] / ?id= */
add_shortcode('bw_owner_view', function($atts){
  if(!is_user_logged_in()) return '<div class="bwf-form">로그인이 필요합니다.</div>';
  $id=(int)($atts['id']??($_GET['id']??0));
  $p=get_post($id);
  if(!$p || $p->post_type!=='bwf_owner_answer') return '<div class="bwf-form">데이터가 없습니다.</div>';
  if((int)$p->post_author!==get_current_user_id() && !current_user_can('read_post',$id)) return '<div class="bwf-form">권한이 없습니다.</div>';

  wp_enqueue_style('bwf-forms');
  $cfg=bwf_owner_cfg(); $ans=(array)get_post_meta($id,'bwf_answers',true);

  ob_start(); ?>
  <div class="bwos-wrap">
    <h2 class="bwf-title"><?php echo esc_html($cfg['title']); ?></h2>
    <?php foreach($cfg['qs'] as $q): $idk=$q['id']; ?>
      <div class="bwf-field">
        <label><?php echo esc_html($q['label']); ?></label>
        <?php if(($q['type']??'')==='group'): ?>
          <?php foreach(($q['sub']??[]) as $sub): $sid=$sub['id']; $v=trim((string)($ans[$idk][$sid]??'')); ?>
            <div class="bwf-sub">
              <div class="bwf-help"><?php echo esc_html($sub['label']); ?></div>
              <div class="bwf-card"><?php echo nl2br(esc_html($v)); ?></div>
            </div>
          <?php endforeach; ?>
        <?php else: $v=trim((string)($ans[$idk]??'')); ?>
          <div class="bwf-card"><?php echo nl2br(esc_html($v)); ?></div>
        <?php endif; ?>
      </div>
    <?php endforeach; ?>
    <div class="bwf-actions">
      <a class="bwf-btn" href="<?php echo esc_url(add_query_arg(['id'=>$p->ID], bwf_owner_edit_url())); ?>">수정</a>
      <a class="bwf-btn-secondary" href="<?php echo esc_url(bwf_owner_list_url()); ?>">목록</a>
    </div>
  </div>
  <?php return ob_get_clean();
});

/** 마이페이지: [bw_owner_list] / 별칭 [bw_my_questions] */
add_shortcode('bw_owner_list', function($atts){
  if(!is_user_logged_in()) return '<div class="bwf-form">로그인이 필요합니다.</div>';
  $a=shortcode_atts(['per_page'=>10,'paged'=>max(1,(int)($_GET['pg']??1))],$atts,'bw_owner_list');

  $q=new WP_Query([
    'post_type'=>'bwf_owner_answer','post_status'=>'private','author'=>get_current_user_id(),
    'posts_per_page'=>(int)$a['per_page'],'orderby'=>'date','order'=>'DESC','paged'=>(int)$a['paged']
  ]);
  wp_enqueue_style('bwf-forms');

  ob_start(); ?>
  <div class="bwos-wrap">
    <h2 class="bwf-title">마이페이지</h2>
    <div class="bwos-list">
      <?php if($q->have_posts()): while($q->have_posts()): $q->the_post();
        $id=get_the_ID();
        $ts=get_post_timestamp($id,'date'); // 사이트 타임존
        $when=wp_date('Y-m-d H:i',$ts);
        $view=esc_url(add_query_arg(['id'=>$id], bwf_owner_view_url()));
        $edit=esc_url(add_query_arg(['id'=>$id], bwf_owner_edit_url()));
      ?>
        <div class="bwos-card">
          <h4>#<?php echo (int)$id; ?></h4>
          <div class="meta"><?php echo esc_html($when); ?></div>
          <div class="row">
            <a href="<?php echo $view; ?>">보기</a>
            <a href="<?php echo $edit; ?>">수정</a>
          </div>
        </div>
      <?php endwhile; else: ?>
        <p>작성한 내역이 없습니다.</p>
      <?php endif; wp_reset_postdata(); ?>
    </div>
    <?php
      $links = paginate_links([
        'total'=>max(1,(int)$q->max_num_pages),
        'current'=>(int)$a['paged'],
        'type'=>'array','prev_text'=>'이전','next_text'=>'다음',
        'format'=>'?pg=%#%'
      ]);
      if($links){
        echo '<div class="bwos-pg">';
        foreach($links as $l) echo $l.' ';
        echo '</div>';
      }
    ?>
  </div>
  <?php return ob_get_clean();
});
add_shortcode('bw_my_questions', fn($a)=>do_shortcode('[bw_owner_list]'));

`$nl

`$nl
===== FILE: pack-code.ps1 (4063 bytes, 113 lines) =====
`$ext
param(
  [string]$Root = ".",
  [string]$Out = "codepack.txt",
  [string]$IncludeExt = ".php,.js,.ts,.css,.scss,.html,.htm,.json,.md,.yml,.yaml,.xml,.sh,.ps1,.ini,.txt,.sql,.twig,.vue",
  # 제외할 디렉터리들 (쉼표로 구분)
  [string]$ExcludeDirs = "node_modules,dist,build,vendor,.git,.github,.idea,.vscode,.next,.cache,growth-checklist\plugin-update-checker",
  # 제외할 파일 패턴들 (쉼표로 구분)
  [string]$ExcludeFiles = "*.min.js,*.min.css,*.map,*.lock,*.zip,*.tar,*.gz,*.png,*.jpg,*.jpeg,*.gif,*.webp,*.svg,*.woff,*.woff2,*.ttf,*.eot,*.pdf",
  # 용량 한도
  [int]$MaxFileBytes = 1000000,    # 파일당 최대 1MB
  [int]$MaxTotalBytes = 20000000,  # 전체 최대 20MB
  # 변경 파일만 모드
  [switch]$ChangedOnly,
  [string]$GitRange = ""
)

$ErrorActionPreference = "Stop"
$Root = (Resolve-Path $Root).Path
$include = $IncludeExt.Split(",") | ForEach-Object { $_.Trim().ToLower() } | Where-Object { $_ -ne "" }
$exDirs  = $ExcludeDirs.Split(",")  | ForEach-Object { $_.Trim() }        | Where-Object { $_ -ne "" }
$exFiles = $ExcludeFiles.Split(",") | ForEach-Object { $_.Trim() }        | Where-Object { $_ -ne "" }

function IsTextExt($path) {
  $ext = [IO.Path]::GetExtension($path).ToLower()
  return $include -contains $ext
}
function IsExcludedDir($path) {
  foreach ($d in $exDirs) {
    if ($path -like "*$d*") { return $true }
  }
  return $false
}
function IsExcludedFile($file) {
  foreach ($p in $exFiles) {
    if ([IO.Path]::GetFileName($file) -like $p) { return $true }
  }
  return $false
}

# 파일 목록 수집
$files = @()
if ($ChangedOnly) {
  $gitArgs = @("diff","--name-only")
  if ($GitRange) { $gitArgs += $GitRange }
  $changed = & git @gitArgs 2>$null
  foreach ($rel in $changed) {
    $p = Join-Path $Root $rel
    if (Test-Path $p -PathType Leaf) { $files += (Resolve-Path $p).Path }
  }
} else {
  $files = Get-ChildItem -Path $Root -Recurse -File | ForEach-Object { $_.FullName }
}

# 필터링
$files = $files | Where-Object {
  -not (IsExcludedDir $_) -and
  -not (IsExcludedFile $_) -and
  (IsTextExt $_)
}

# 출력 빌드
$sb = New-Object System.Text.StringBuilder
$totalBytes = 0
$nl = [Environment]::NewLine

# 상단 메타
try {
  $repoUrl = (git -C $Root config --get remote.origin.url)
  $branch  = (git -C $Root rev-parse --abbrev-ref HEAD)
  $tag     = (git -C $Root describe --tags --abbrev=0) 2>$null
  $commit  = (git -C $Root rev-parse --short HEAD)
  $time    = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
  $null = $sb.AppendLine("===== META =====")
  $null = $sb.AppendLine("Repo: $repoUrl")
  $null = $sb.AppendLine("Branch: $branch  |  Tag: $tag  |  Commit: $commit")
  $null = $sb.AppendLine("Generated: $time")
  $null = $sb.AppendLine("")
} catch {}

foreach ($f in $files) {
  try {
    $fi = Get-Item $f
    $size = $fi.Length
    if ($size -gt $MaxFileBytes) {
      $rel = $f.Substring($Root.Length+1)
      $null = $sb.AppendLine("===== FILE: $rel ($size bytes) SKIPPED: > $MaxFileBytes =====$nl")
      continue
    }
    if (($totalBytes + $size) -gt $MaxTotalBytes) {
      $null = $sb.AppendLine("===== STOP: total size would exceed $MaxTotalBytes bytes. Remaining files omitted. =====$nl")
      break
    }

    $rel = $f.Substring($Root.Length+1)
    $content = (Get-Content -Path $f -Raw -Encoding UTF8)
    $lineCount = ($content -split "`r?`n").Count
    $ext = [IO.Path]::GetExtension($f).TrimStart(".").ToLower()
    if (-not $ext) { $ext = "text" }

    $null = $sb.AppendLine("===== FILE: $rel ($size bytes, $lineCount lines) =====")
    $null = $sb.AppendLine("```$ext")
    $null = $sb.AppendLine($content)
    $null = $sb.AppendLine("```$nl")

    $totalBytes += $size
  } catch {
    $null = $sb.AppendLine("===== FILE: $f ERROR: $($_.Exception.Message) =====$nl")
  }
}

[IO.File]::WriteAllText((Join-Path $Root $Out), $sb.ToString(), [Text.Encoding]::UTF8)
"생성 완료: $(Join-Path $Root $Out)  (총 approx $totalBytes bytes)"

`$nl
===== FILE: bw-owner-suite-acf\bw-owner-suite-acf.php (1077 bytes, 29 lines) =====
`$ext
<?php
/**
 * Plugin Name: BW Owner Suite (light)
 * Description: 대표 질문지 + 회원가입(대표 전용) + 마이페이지. ACF 기반 경량 플러그인.
 * Version: 1.0.4
 * Author: Berrywalk
 */
if (!defined('ABSPATH')) exit;

define('BWOS_VER', '1.2.0');
define('BWOS_DIR', plugin_dir_path(__FILE__));
define('BWOS_URL', plugin_dir_url(__FILE__));

require_once BWOS_DIR.'includes/cpt-admin.php';
require_once BWOS_DIR.'includes/form.php';
require_once BWOS_DIR.'includes/signup.php';
require_once BWOS_DIR.'includes/save.php';
require_once BWOS_DIR.'includes/view-list.php';
require_once BWOS_DIR.'includes/acf-fields.php'; // 관리자 ACF 메타박스(5문항)

add_action('wp_enqueue_scripts', function(){
  $css = BWOS_URL.'assets/owner-form.css';
  $js  = BWOS_URL.'assets/owner-form.js';
  wp_register_style ('bwos-form', $css, [], BWOS_VER);
  wp_register_style ('bwf-forms', $css, [], BWOS_VER); // alias
  wp_register_script('bwos-form', $js,  ['jquery'], BWOS_VER, true);
  wp_register_script('bwf-forms', $js,  ['jquery'], BWOS_VER, true); // alias
});

`$nl
===== FILE: bw-owner-suite-acf\README.md (1409 bytes, 40 lines) =====
`$ext
# BW Owner Suite (ACF Minimal)

워드프레스 표준 + ACF만 사용하여
- 회원가입 → 프로필 수정
- 대표 질문(CPT) 작성/수정/보기/목록/복제/삭제
- 저장 알림(메일/텔레그램)

을 한 번에 처리하는 경량 플러그인입니다.

## 설치
1) `Advanced Custom Fields`(ACF) 플러그인을 활성화
2) 워드프레스 관리자 → 플러그인 → 새로 추가 → 플러그인 업로드 → 이 ZIP 업로드 후 활성화
3) 활성화 즉시 아래 페이지가 자동 생성됩니다.
   - `/owner-questions/` 작성
   - `/owner-edit/?id=글ID` 수정
   - `/my-question-view/?id=글ID` 보기
   - `/my-questions/` 내 저장본(보기/수정/복제/삭제)
   - `/my-profile/` 마이프로필
   - `/register/` 회원가입

## 텔레그램 알림(선택)
`wp-config.php`에 아래 상수를 추가하면 저장 시 텔레그램 알림이 전송됩니다.

```php
define('BWF_TG_BOT','123456:ABC...');       // 봇 토큰
define('BWF_TG_CHAT','-1001234567890');     // 채팅 ID
```

## 짧은코드(Shortcodes)
- [bw_register]
- [bw_profile_form]
- [bw_owner_form_acf]
- [bw_owner_edit id="123"]  (또는 /owner-edit/?id=123)
- [bwf_owner_view id="123"]
- [bw_my_questions]

## 주의
- 플러그인 동작을 위해 ACF가 필요합니다.
- 데이터는 CPT `bwf_owner_answer`에 저장되며 리비전이 활성화되어 되돌리기가 가능합니다.

`$nl
===== FILE: bw-owner-suite-acf\assets\owner-form.css (4583 bytes, 99 lines) =====
`$ext
/* /assets/owner-form.css */

/* ====== Base ====== */
:root{
  --bw-font:17.5px;
  --bw-muted:#64748b;
  --bw-border:#e5e7eb;
  --bw-accent:#6366f1;
  --bw-ok:#16a34a;
  --bw-warn:#ef4444;
  --bw-bg:#f8fafc;
}
body{font-size:var(--bw-font);background:var(--bw-bg)}
.bwos-wrap{max-width:920px;margin:40px auto;padding:0 16px}               /* ⬆ 여백 확대 */
.bwf-title{font-size:30px;line-height:1.25;margin:22px 0 16px}
.bwf-help{color:#0f172a;margin:0 0 18px}

/* ====== Sticky progress (카드형, 배경/테두리 추가) ====== */
.bwos-progress{
  position:sticky;top:64px;z-index:1000;margin:0 0 18px;
  background:#ffffff; border:1px solid var(--bw-border); border-radius:14px;
  padding:12px 14px; box-shadow:0 6px 18px rgba(2,6,23,.06);
}
body.admin-bar .bwos-progress{top:96px}
.bwos-progress .bar{height:10px;background:#f2f4f7;border-radius:999px;overflow:hidden}
.bwos-progress .bar>span{display:block;height:100%;width:0%;background:linear-gradient(90deg,#22d3ee,#6366f1);border-radius:999px;transition:width .2s}
.bwos-progress .status{font-size:12px;color:#334155;margin-top:8px}

/* ====== Field ====== */
.bwf-field{margin:28px 0}                                                  /* ⬆ 여백 확대 */
.bwf-field label{display:block;font-weight:800;margin:0 0 12px;font-size:18px}
.bwf-field textarea,
.bwf-field input[type="text"],
.bwf-field input[type="number"],
.bwf-field input[type="email"],
.bwf-field input[type="tel"],
.bwf-field input[type="url"],
.bwf-field select{
  width:100%;box-sizing:border-box;padding:13px 14px;border:1px solid #d1d5db;border-radius:12px;background:#fff;font-size:16.5px;outline:none
}
.bwf-field textarea:focus,
.bwf-field input:focus,
.bwf-field select:focus{border-color:var(--bw-accent);box-shadow:0 0 0 3px rgba(99,102,241,.15)}

.bwos-field.bwos-error textarea,
.bwos-field.bwos-error input,
.bwos-field.bwos-error select{border-color:var(--bw-warn);background:#fff1f2}
.bwf-invalid{border-color:var(--bw-warn) !important;background:#fff1f2 !important}

/* ====== 설명/예시 – 한국형 카드 스타일 ====== */
.bwf-desc, .bwf-examples{
  margin:10px 0 10px;padding:12px 14px;border:1px dashed #dbe1ea;border-radius:12px;background:#fbfdff
}
.bwf-desc::before{
  content:"설명"; display:inline-block; font-size:12px; font-weight:800; color:#0ea5e9;
  background:#e6f6fb; border:1px solid #bde7f4; border-radius:999px; padding:2px 8px; margin-right:8px
}
.bwf-examples::before{
  content:"예시"; display:inline-block; font-size:12px; font-weight:800; color:#6366f1;
  background:#eef0ff; border:1px solid #dfe3ff; border-radius:999px; padding:2px 8px; margin-right:8px
}
.bwf-examples ul,.bwf-examples ol{margin:6px 0 0 18px}

/* ====== Counter ====== */
.bwos-count{
  display:inline-block;margin-top:8px;font-size:12px;font-weight:700;
  color:var(--bw-muted);background:#f3f4f6;border:1px solid #e5e7eb;border-radius:999px;padding:4px 8px
}
.bwos-count.ok{color:#065f46;background:#ecfdf5;border-color:#bbf7d0}
.bwos-count.need{color:#7c2d12;background:#fff7ed;border-color:#fed7aa}

/* ====== Buttons ====== */
.bwf-actions{display:flex;gap:10px;align-items:center;justify-content:center;margin:22px 0 6px}
.bwf-btn{display:inline-block;padding:12px 18px;border-radius:14px;border:none;background:var(--bw-accent);color:#fff;text-decoration:none;font-weight:700}
.bwf-btn-secondary{display:inline-block;padding:12px 18px;border-radius:14px;border:1px solid #cbd5e1;background:#fff;color:#0f172a;text-decoration:none;font-weight:700}


/* ====== Modal (공용) ====== */
.bwos-modal, .bwf-modal{
  position:fixed;inset:0;display:none;align-items:flex-start;justify-content:center;padding-top:18vh;background:rgba(0,0,0,.45);z-index:100000
}
body.admin-bar .bwos-modal, body.admin-bar .bwf-modal{padding-top:calc(18vh + 32px)}
.bwos-modal.is-open, .bwf-modal.is-open{display:flex}
.bwos-modal-inner, .bwf-modal .bwf-modal__card{
  background:#fff;max-width:560px;width:92vw;padding:22px;border-radius:16px;box-shadow:0 22px 44px rgba(2,6,23,.18)
}
.bwos-modal-inner h4, .bwf-modal h3{margin:0 0 10px;font-size:18px}
.bwos-modal-inner p, .bwf-modal p{margin:0 0 12px;color:#334155}
.bwf-modal__list{margin:6px 0 0 18px;font-size:14px;color:#1f2937}

/* ====== List / View ====== */
.bwf-card{border:1px solid var(--bw-border);background:#fff;border-radius:12px;padding:12px 14px}

/* ====== Signup grid ====== */
.bwf-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px 14px}
.bwf-col-full{grid-column:1/-1}
@media (max-width:720px){.bwf-grid{grid-template-columns:1fr}}
.bwf-hidden{display:none}

`$nl
===== FILE: bw-owner-suite-acf\assets\owner-form.js (3695 bytes, 79 lines) =====
`$ext
/* /assets/owner-form.js  (카운터 텍스트 – "몇자 남음" 친절 메시지로) */
(function($){
  if(!$ || !$('.bwos-form').length) return;

  const $form = $('.bwos-form').first();
  const $progress = $form.find('.bwos-progress');
  const reqs = []; let submitted=false;

  function updateProgress(){
    const total=reqs.length, done=reqs.filter(r=>r.valid()).length, pct=total?Math.round(done/total*100):0;
    $progress.find('.bar>span').css('width',pct+'%');
    $progress.find('.status').text('작성 '+done+'/'+total+' ('+pct+'%)');
  }

  function wire($wrap){
    const min = parseInt($wrap.data('min')||200,10);
    const $subs = $wrap.find('.bwf-sub textarea');
    const isGroup = $subs.length>0;
    let $cnt = $wrap.find('.bwos-count'); if(!$cnt.length) $cnt=$('<small class="bwos-count"></small>').appendTo($wrap);

    const setError = bad => $wrap.toggleClass('bwos-error', submitted && !!bad);
    const valid = ()=>{
      if(isGroup){ let ok=true; $subs.each(function(){ if(($(this).val()||'').trim()==='') ok=false; }); return ok; }
      return (($wrap.find('textarea,input[type="text"]').first().val()||'').trim().length >= min);
    };

    const update = ()=>{
      if(isGroup){
        let anyEmpty=false; $subs.each(function(){ if(($(this).val()||'').trim()==='') anyEmpty=true; });
        $cnt.text(anyEmpty ? '질문 3개 모두 작성' : '충족').toggleClass('need',anyEmpty).toggleClass('ok',!anyEmpty);
        setError(anyEmpty);
      }else{
        const v=($wrap.find('textarea,input[type="text"]').first().val()||'').trim();
        const diff = min - v.length;
        if(diff>0){ $cnt.text(diff+'자 남음'); $cnt.removeClass('ok').addClass('need'); }
        else      { $cnt.text('충족'); $cnt.removeClass('need').addClass('ok'); }
        setError(v.length < min);
      }
      updateProgress();
    };

    (isGroup ? $subs : $wrap.find('textarea,input[type="text"]').first()).on('input blur', update);
    reqs.push({wrap:$wrap, valid, update, min}); update();
  }

  $form.find('.bwos-required').each(function(){ wire($(this)); });
  updateProgress();

  const $modal=$('<div class="bwos-modal"><div class="bwos-modal-inner"><h4>입력이 필요한 항목이 있어요</h4><p>아래 항목을 확인해 주세요.</p><ul class="bwf-modal__list"></ul><button type="button" class="bwf-btn-secondary ok">확인</button></div></div>').appendTo('body');
  $modal.on('click','.ok',()=> $modal.removeClass('is-open'));

  let locked=false;
  $form.on('submit',function(e){
    submitted=true; let bad=false; const items=[];
    reqs.forEach(r=>{
      if(!r.valid()){
        bad=true; const lab=r.wrap.find('label').first().text().replace(/\*.*$/,'').trim();
        if(r.wrap.find('.bwf-sub').length){ items.push('· '+lab+' — 3개 질문 모두 작성'); }
        else{
          const len=($r=r.wrap.find('textarea,input[type="text"]').first()).val().trim().length;
          const diff=(r.min||200)-len; items.push('· '+lab+' — 최소 글자수 부족 ('+diff+'자 남음)');
        }
        r.update();
      }
    });
    if(bad){
      e.preventDefault();
      const ul=$modal.find('.bwf-modal__list').empty();
      items.forEach(t=> $('<li/>').text(t).appendTo(ul));
      $modal.addClass('is-open');
      const $first=$form.find('.bwos-error').first(); if($first.length) $('html,body').animate({scrollTop:$first.offset().top-120},180);
      return;
    }
    if(locked){ e.preventDefault(); return; }
    locked=true; $form.find('.bwos-submit').prop('disabled',true).text('저장 중…');
    setTimeout(()=>{ locked=false; $form.find('.bwos-submit').prop('disabled',false).text('저장'); }, 6000);
  });
})(jQuery);

`$nl
===== FILE: bw-owner-suite-acf\includes\acf-fields.php (3509 bytes, 76 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

add_action('acf/init', function(){
  if (!function_exists('acf_add_local_field_group')) return;

  acf_add_local_field_group([
    'key'=>'group_bwos_owner_v5','title'=>'대표 질문지',
    'fields'=>[
      ['key'=>'f_problem','label'=>'1) 지금, 우리 사업의 가장 큰 고민은 무엇인가요?','name'=>'_acf_problem','type'=>'textarea','required'=>1,'rows'=>8,'instructions'=>'최소 200자 권장'],
      ['key'=>'f_value','label'=>'2) 우리 서비스의 핵심 가치는 무엇인가요?','name'=>'_acf_value','type'=>'textarea','required'=>1,'rows'=>6],
      ['key'=>'f_whom','label'=>'3) 누가 이용해야 하나요? 왜 우리인가요?','name'=>'_acf_ideal_customer','type'=>'textarea','required'=>1,'rows'=>6],
      ['key'=>'f_ask1','label'=>'4-1) 고객에게 묻고 싶은 질문 #1','name'=>'_acf_cq1','type'=>'text'],
      ['key'=>'f_ask2','label'=>'4-2) 고객에게 묻고 싶은 질문 #2','name'=>'_acf_cq2','type'=>'text'],
      ['key'=>'f_ask3','label'=>'4-3) 고객에게 묻고 싶은 질문 #3','name'=>'_acf_cq3','type'=>'text'],
      ['key'=>'f_comp','label'=>'5) 경쟁사 대비 차별점','name'=>'_acf_competitors','type'=>'textarea','required'=>1,'rows'=>6],
    ],
    'location'=>[[['param'=>'post_type','operator'=>'==','value'=>'bwf_owner_answer']]],
    'position'=>'normal','style'=>'default','active'=>true,
  ]);
});


/** 200자 필드 서버 검증 */
add_filter('acf/validate_value', function($valid, $value, $field){
  if ($valid !== true) return $valid;
  $min200 = ['problem','core_value','target_customer','differentiation','sales_blockers','current_channels','growth_goal','next_action'];
  if (in_array($field['name'] ?? '', $min200, true)) {
    if (mb_strlen(trim((string)$value)) < 200) return '최소 200자 이상 작성해 주세요.';
  }
  return $valid;
}, 10, 3);
/* ------- ACF <-> bwf_answers 동기화 ------- */
function bwos_acf_meta_keys(){ // ACF 메타키(name) 매핑
  return [
    '_acf_problem'       => ['id'=>'problem'],
    '_acf_value'         => ['id'=>'value'],
    '_acf_ideal_customer'=> ['id'=>'ideal_customer'],
    '_acf_cq1'           => ['id'=>'ask3','sub'=>'q1'],
    '_acf_cq2'           => ['id'=>'ask3','sub'=>'q2'],
    '_acf_cq3'           => ['id'=>'ask3','sub'=>'q3'],
    '_acf_competitors'   => ['id'=>'competitors'],
  ];
}

/* 편집 화면 로드시 ACF 메타 채워넣기(관리자에서 비어 보이던 문제 해결) */
add_action('load-post.php', function(){
  $pid = isset($_GET['post']) ? (int)$_GET['post'] : 0;
  if(!$pid) return;
  $p = get_post($pid);
  if(!$p || $p->post_type!=='bwf_owner_answer') return;

  $ans = (array)get_post_meta($pid,'bwf_answers',true);
  foreach(bwos_acf_meta_keys() as $meta=>$m){
    $val = '';
    if(empty($m['sub'])) $val = (string)($ans[$m['id']] ?? '');
    else                 $val = (string)($ans[$m['id']][$m['sub']] ?? '');
    update_post_meta($pid, $meta, $val);
  }
});

/* 저장 시 ACF 값으로 bwf_answers 재생성(양방향 동기화) */
add_action('save_post_bwf_owner_answer', function($post_id){
  if(defined('DOING_AUTOSAVE') && DOING_AUTOSAVE) return;
  $ans = [];
  foreach(bwos_acf_meta_keys() as $meta=>$m){
    $v = (string)get_post_meta($post_id,$meta,true);
    if(empty($m['sub'])) $ans[$m['id']] = $v;
    else {
      if(empty($ans[$m['id']])) $ans[$m['id']] = [];
      $ans[$m['id']][$m['sub']] = $v;
    }
  }
  if($ans) update_post_meta($post_id,'bwf_answers',$ans);
}, 20);

`$nl
===== FILE: bw-owner-suite-acf\includes\cpt-admin.php (871 bytes, 21 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

add_action('init', function(){
  register_post_type('bwf_owner_answer', [
    'label'=>'대표 질문지','labels'=>['name'=>'대표 질문지','add_new_item'=>'새 대표 질문 생성','edit_item'=>'대표 질문 편집'],
    'public'=>false,'exclude_from_search'=>true,'publicly_queryable'=>false,'show_ui'=>true,'show_in_menu'=>true,
    'menu_icon'=>'dashicons-editor-help','supports'=>['author','custom-fields'],'map_meta_cap'=>true,
  ]);
});

add_filter('manage_bwf_owner_answer_posts_columns', function($c){
  return ['cb'=>$c['cb'],'title'=>'제목','author'=>'작성자','created'=>'저장 시각'];
});
add_action('manage_bwf_owner_answer_posts_custom_column', function($col,$post_id){
  if($col==='created'){
    $ts = get_post_timestamp($post_id,'date');
    echo esc_html( wp_date('Y-m-d H:i', $ts) );
  }
}, 10, 2);

`$nl
===== FILE: bw-owner-suite-acf\includes\form.php (7330 bytes, 121 lines) =====
`$ext
<?php
/* /includes/form.php (핵심 변경만) */
if (!defined('ABSPATH')) exit;

function bwf_owner_cfg(){
  return [
    'title'=>'대표님 핵심 질문지',
    'min'=>200,
    'intro'=>'사업의 본질을 파악하고 고객에게 정말 묻고 싶은 질문을 구체화합니다. 각 문항은 최소 <strong>{MIN}</strong>자입니다. <em>(단, <strong>“고객에게 물어보고 싶은 3가지”</strong>는 글자수 제한 없음)</em>',
    'qs'=>[
      [
        'id'=>'problem','label'=>'1. 지금, 우리 사업의 가장 큰 고민은 무엇인가요?','required'=>true,'min'=>200,
        'desc'=>'성장이 정체되었다고 느낀 **구체적 상황**을 한두 문장으로. 숫자/행동 기반이면 좋아요.',
        'ex'=>'<ul><li>“클릭은 많은데 체류 30초 미만 이탈이 많아요.”</li><li>“재구매율이 낮아 신규 유입 의존도가 큽니다.”</li></ul>'
      ],
      [
        'id'=>'value','label'=>'2. 우리 서비스는 고객의 어떤 문제를 해결하나요?','required'=>true,'min'=>200,
        'desc'=>'고객의 **전/후 변화**를 한 문장으로 요약.',
        'ex'=>'<ol><li>“반복 서류작업을 5분 자동화 → 본업 집중”</li><li>“바쁜 직장인도 집밥처럼 건강한 한 끼 확보”</li></ol>'
      ],
      [
        'id'=>'ideal_customer','label'=>'3. 누가 이용해야 하나요? 왜 우리여야 하나요?','required'=>true,'min'=>200,
        'desc'=>'핵심 타깃의 특징 + 우리를 선택할 **결정적 이유**.',
        'ex'=>'<p>“시간/비용이 부족한 20대 대학생 → 15분 홈트 영상으로 꾸준함 확보.”</p>'
      ],
      [
        'id'=>'ask3','type'=>'group','label'=>'4. 고객에게 물어보고 싶은 3가지','required'=>true,
        'desc'=>'실제 경험 기반으로 **구체적인 질문 3개**를 작성.',
        'ex'=>'<p><strong>예)</strong> 첫인상/결심포인트/아쉬운점</p>',
        'sub'=>[
          ['id'=>'q1','label'=>'질문 1','ph'=>'예: 어떻게 알게 되었나요?','required'=>true],
          ['id'=>'q2','label'=>'질문 2','ph'=>'예: 결심 포인트는 무엇이었나요?','required'=>true],
          ['id'=>'q3','label'=>'질문 3','ph'=>'예: 가장 아쉬웠던 점은?','required'=>true],
        ]
      ],
      [
        'id'=>'competitors','label'=>'5. 경쟁사와의 차별점은?','required'=>true,'min'=>200,
        'desc'=>'주요 경쟁사 1~2곳과 비교해 강/약점 정리.',
        'ex'=>'<p>“A는 저렴하지만 CS 느림 / B는 비싸지만 품질 우수 → 우리는 적정가+빠른 CS”</p>'
      ],
    ]
  ];
}

function bwf_owner_view_url(){ return home_url('/my-question-view/'); }
function bwf_owner_edit_url(){ return home_url('/owner-edit/'); }
function bwf_owner_list_url(){ return home_url('/my-questions/'); }

function bwf_render_owner_form($args=[]){
  $cfg=bwf_owner_cfg(); $min=(int)$cfg['min']; $mode=$args['mode']??'create';
  $post=$args['post']??null; $saved=$args['saved']??[]; $errs=$args['errs']??[];
  if($mode==='edit' && $post){ $existing=(array)get_post_meta($post->ID,'bwf_answers',true); $saved=$saved ?: $existing; }
  wp_enqueue_style('bwf-forms'); wp_enqueue_script('bwos-form');

  ob_start(); ?>
  <form id="bwfOwnerForm" class="bwf-form bwos-form" method="post" action="<?php echo esc_url(admin_url('admin-post.php')); ?>" novalidate>
    <input type="hidden" name="action" value="bwf_owner_save">
    <?php wp_nonce_field('bwf_owner_save','bwf_owner_nonce'); ?>
    <input type="hidden" name="post_id" value="<?php echo $post ? (int)$post->ID : 0; ?>">

    <div class="bwos-progress"><div class="bar"><span></span></div><div class="status">작성 0/0 (0%)</div></div>

    <h2 class="bwf-title"><?php echo esc_html($cfg['title']); ?></h2>
    <p class="bwf-help"><?php echo str_replace('{MIN}', $min, $cfg['intro']); ?></p>

    <?php foreach($cfg['qs'] as $q): $type=$q['type']??'textarea'; $id=$q['id']; ?>
      <div class="bwf-field bwos-field bwos-required" data-min="<?php echo (int)($q['min']??$min); ?>">
        <label><?php echo esc_html($q['label']); ?><?php if(!empty($q['required'])): ?><span class="bwf-required">*</span><?php endif; ?></label>

        <?php if(!empty($q['desc'])): ?><div class="bwf-desc"><?php echo wp_kses_post($q['desc']); ?></div><?php endif; ?>
        <?php if(!empty($q['ex'])):   ?><div class="bwf-examples"><?php echo wp_kses_post($q['ex']); ?></div><?php endif; ?>

        <?php if($type==='group'): ?>
          <?php foreach(($q['sub']??[]) as $sub): $sid=$sub['id']; $v=$saved[$id][$sid]??''; ?>
            <div class="bwf-sub">
              <div class="bwf-help" style="margin:6px 0 6px;"><?php echo esc_html($sub['label']); ?></div>
              <textarea name="q[<?php echo esc_attr($id); ?>][<?php echo esc_attr($sid); ?>]" rows="4" placeholder="<?php echo esc_attr($sub['ph']??''); ?>"><?php echo esc_textarea($v); ?></textarea>
            </div>
          <?php endforeach; ?>
        <?php else: $v=$saved[$id]??''; ?>
          <textarea name="q[<?php echo esc_attr($id); ?>]" rows="6"><?php echo esc_textarea($v); ?></textarea>
          <small class="bwos-count">0/<?php echo (int)($q['min']??$min); ?></small>
        <?php endif; ?>
      </div>
    <?php endforeach; ?>

    <div class="bwf-actions">
      <button type="submit" class="bwf-btn bwos-submit"><?php echo $mode==='edit'?'수정 저장':'저장'; ?></button>
      <!-- 마이페이지 버튼 제거 요청 반영 -->
    </div>
  </form>
  <?php return ob_get_clean();
}

add_shortcode('bwf_owner_questions', function(){
  wp_enqueue_style('bwf-forms');

  if (!is_user_logged_in()) {
    $signup = esc_url('https://berrywalk.co.kr/bwf-owner-signup/');
    $login  = esc_url( wp_login_url( home_url('/owner-questions/') ) );
    return '<div class="bwos-wrap"><div class="bwf-need-login"><p>대표님 핵심 질문지를 작성하려면 로그인이 필요합니다.</p><div class="bwf-login-actions"><a class="bwf-btn" href="'.$login.'">로그인하러 가기</a><a class="bwf-btn-secondary" href="'.$signup.'">회원가입하러 가기</a></div></div></div>';
  }

  $uid=get_current_user_id();
  $old=get_transient('bwf_owner_old_'.$uid)?:[]; delete_transient('bwf_owner_old_'.$uid);
  $err=get_transient('bwf_owner_err_'.$uid)?:[]; delete_transient('bwf_owner_err_'.$uid);
  return bwf_render_owner_form(['mode'=>'create','saved'=>$old,'errs'=>$err]);
});
add_shortcode('bw_owner_form', fn()=>do_shortcode('[bwf_owner_questions]'));
add_shortcode('bw_owner_edit', function($atts){
  if (!is_user_logged_in()) return '<div class="bwf-form">로그인이 필요합니다.</div>';
  $id=(int)($atts['id']??($_GET['id']??0));
  $post=get_post($id);
  if(!$post || $post->post_type!=='bwf_owner_answer') return '<div class="bwf-form">데이터가 없습니다.</div>';
  if((int)$post->post_author!==get_current_user_id() && !current_user_can('edit_post',$id)) return '<div class="bwf-form">권한이 없습니다.</div>';
  $uid=get_current_user_id();
  $old=get_transient('bwf_owner_old_'.$uid)?:[]; delete_transient('bwf_owner_old_'.$uid);
  $err=get_transient('bwf_owner_err_'.$uid)?:[]; delete_transient('bwf_owner_err_'.$uid);
  return bwf_render_owner_form(['mode'=>'edit','post'=>$post,'saved'=>$old,'errs'=>$err]);
});

`$nl
===== FILE: bw-owner-suite-acf\includes\save.php (2603 bytes, 74 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

add_action('admin_post_bwf_owner_save','bwf_owner_handle_save');
add_action('admin_post_nopriv_bwf_owner_save','bwf_owner_handle_save');

function bwf_owner_handle_save(){
  if(!is_user_logged_in()) { wp_safe_redirect(home_url('/')); exit; }
  if(empty($_POST['bwf_owner_nonce']) || !wp_verify_nonce($_POST['bwf_owner_nonce'],'bwf_owner_save')){
    wp_safe_redirect(wp_get_referer()?:home_url('/')); exit;
  }

  $uid  = get_current_user_id();
  $lock = 'bwf_owner_lock_'.$uid;
  if(get_transient($lock)) { wp_safe_redirect(home_url('/my-questions/')); exit; }
  set_transient($lock,1,8); // 8초 중복방지

  $cfg = bwf_owner_cfg();
  $min = (int)$cfg['min'];
  $src = $_POST['q'] ?? [];
  $ans = []; $err=[];

  foreach($cfg['qs'] as $q){
    $id=$q['id']; $type=$q['type']??'textarea';
    $req=!empty($q['required']); $m=(int)($q['min']??$min);

    if($type==='group'){
      $ans[$id]=[];
      foreach(($q['sub']??[]) as $sub){
        $sid=$sub['id']; $v=trim((string)($src[$id][$sid]??''));
        $ans[$id][$sid]=sanitize_textarea_field($v);
        if(!empty($sub['required']) && $v===''){ $err[$id][$sid]=true; }
      }
      if($req && !empty($err[$id])){/*표시용*/}
    }else{
      $v=trim((string)($src[$id]??'')); $ans[$id]=sanitize_textarea_field($v);
      if($req && mb_strlen($v)<$m){ $err[$id]=true; }
    }
  }

  if($err){
    set_transient('bwf_owner_old_'.$uid,$src,60);
    set_transient('bwf_owner_err_'.$uid,$err,60);
    delete_transient($lock);
    wp_safe_redirect(wp_get_referer()?:home_url('/owner-questions/')); exit;
  }

  $post_id = (int)($_POST['post_id']??0);
  $title   = '대표 질문지 - '.wp_date('Y-m-d H:i'); // 사이트 타임존

  if($post_id){
    $p=get_post($post_id);
    if($p && $p->post_type==='bwf_owner_answer' && ((int)$p->post_author===$uid || current_user_can('edit_post',$post_id))){
      update_post_meta($post_id,'bwf_answers',$ans);
      wp_update_post(['ID'=>$post_id,'post_title'=>$title,'post_status'=>'private']);
      delete_transient($lock);
      wp_safe_redirect(add_query_arg(['id'=>$post_id,'updated'=>1], bwf_owner_view_url())); exit;
    }
  }

  $new_id = wp_insert_post([
    'post_type'=>'bwf_owner_answer','post_status'=>'private','post_title'=>$title,'post_author'=>$uid,
  ], true);

  if(!is_wp_error($new_id)){
    update_post_meta($new_id,'bwf_answers',$ans);
    delete_transient($lock);
    wp_safe_redirect(add_query_arg(['id'=>$new_id,'saved'=>1], bwf_owner_view_url())); exit;
  }

  delete_transient($lock);
  wp_safe_redirect(bwf_owner_list_url()); exit;
}

`$nl
===== FILE: bw-owner-suite-acf\includes\signup.php (8814 bytes, 170 lines) =====
`$ext
<?php
/* /includes/signup.php  (로그인 상태 화면 강화 + 휴대폰 자동포맷 보강) */
if (!defined('ABSPATH')) exit;

add_action('init', function(){ if (!get_role('bw_owner')) add_role('bw_owner','대표',['read'=>true]); });

add_shortcode('bwf_signup_representative', function () {
  wp_enqueue_style('bwf-forms');

  if (is_user_logged_in()) {
    // 로그인 상태 – 심심함 해소: 두 개 CTA 제공
    return '<div class="bwos-wrap"><div class="bwf-need-login"><p><strong>로그인되었습니다.</strong></p><div class="bwf-login-actions"><a class="bwf-btn" href="'.esc_url(home_url('/owner-questions/')).'">질문 등록하기</a><a class="bwf-btn-secondary" href="'.esc_url(home_url('/my-questions/')).'">내 질문 목록 보기</a></div></div></div>';
  }

  ob_start(); ?>
  <form method="post" class="bwf-form bwf-grid" id="bwf-signup-rep" action="<?php echo esc_url(admin_url('admin-post.php')); ?>" novalidate>
    <input type="hidden" name="action" value="bwf_signup_rep">
    <input type="hidden" name="bwf_role" value="bw_owner">
    <?php wp_nonce_field('bwf_signup_rep','bwf_nonce'); ?>

    <h2 class="bwf-title bwf-col-full">대표 회원가입</h2>
    <p class="bwf-required-note bwf-col-full">* 표시는 필수 입력</p>

    <div><label>아이디 *</label><input type="text" name="user_login" pattern="[A-Za-z0-9_\\.\\-]{4,32}" required></div>
    <div><label>비밀번호 *</label><input type="password" name="user_pass" required></div>
    <div><label>이메일 *</label><input type="email" name="user_email" required></div>
    <div><label>이름 *</label><input type="text" name="first_name" required></div>

    <div><label>회사명 *</label><input type="text" name="bw_company_name" required></div>
    <div><label>업종 *</label>
      <select name="bw_industry" required>
        <option value="">선택</option><option value="it">IT/서비스</option><option value="commerce">커머스</option><option value="etc">기타</option>
      </select>
    </div>
    <div><label>직원 수 *</label><input type="number" name="bw_employees" min="1" required></div>
    <div><label>홈페이지 URL</label><input type="url" name="user_url" placeholder="https://"></div>

    <div class="bwf-col-full"><label>알게 된 경로 *</label>
      <select name="bw_discover" id="bwf-source" required>
        <option value="">선택</option><option value="search">검색</option><option value="sns">SNS</option><option value="ref">지인추천</option><option value="etc">기타</option>
      </select>
      <input type="text" name="source_etc" id="bwf-source-etc" placeholder="기타 경로" class="bwf-col-full bwf-hidden" style="margin-top:8px">
    </div>

    <div><label>휴대폰 번호 *</label>
      <input type="tel" name="bw_phone" id="bwf-phone" inputmode="numeric" placeholder="010-1234-5678"
             maxlength="13" pattern="^010-\\d{4}-\\d{4}$" required>
    </div>
    <div><label>연락 가능한 시간대 *</label><input type="text" name="bw_contact_window" placeholder="예: 평일 13:00~18:00" required></div>

    <div class="bwf-actions bwf-col-full">
      <button type="submit" name="bwf_register" class="bwf-btn">회원가입</button>
      <span id="bwf-hint" style="font-size:13px;color:#475569"></span>
    </div>

    <!-- 친절 모달 -->
    <div class="bwf-modal" id="bwf-modal" aria-hidden="true">
      <div class="bwf-modal__card">
        <h3>입력이 필요한 항목이 있어요</h3>
        <p class="bwf-modal__msg">필수 항목을 확인해 주세요.</p>
        <ul class="bwf-modal__list"></ul>
        <div class="bwf-modal__actions" style="margin-top:8px">
          <button type="button" class="bwf-btn-secondary" id="bwf-modal-ok">확인</button>
        </div>
      </div>
    </div>

    <script>
    (function(){
      const f=document.getElementById('bwf-signup-rep'),
            src=f.querySelector('#bwf-source'),
            etc=f.querySelector('#bwf-source-etc'),
            tel=f.querySelector('#bwf-phone'),
            modal=f.querySelector('#bwf-modal'),
            ok=modal.querySelector('#bwf-modal-ok'),
            list=modal.querySelector('.bwf-modal__list'),
            hint=document.getElementById('bwf-hint');

      function showEtc(){ if(src.value==='etc'){ etc.classList.remove('bwf-hidden'); } else { etc.classList.add('bwf-hidden'); etc.value=''; } }
      src.addEventListener('change',showEtc); showEtc();

      /* 휴대폰 자동 포맷 – 모든 입력 경로 대응 */
      function onlyDigits(s){return String(s||'').replace(/\\D/g,'');}
      function formatPhone(raw){
        const d=onlyDigits(raw).slice(0,11);
        if(d.startsWith('010')){
          if(d.length>=11) return d.replace(/^(\\d{3})(\\d{4})(\\d{4}).*$/,'$1-$2-$3');
          if(d.length>=7)  return d.replace(/^(\\d{3})(\\d{0,4})(\\d{0,4}).*$/,(m,a,b,c)=>a+(b?'-'+b:'')+(c?'-'+c:'')); 
          if(d.length>=4)  return d.replace(/^(\\d{3})(\\d{0,4}).*$/,(m,a,b)=>a+'-'+b);
        }
        return d;
      }
      function caretToEnd(el){ try{ el.setSelectionRange(el.value.length,el.value.length); }catch(e){} }
      ['input','keyup','change','blur','paste','beforeinput'].forEach(ev=>{
        tel.addEventListener(ev,()=>{ tel.value=formatPhone(tel.value); caretToEnd(tel); });
      });

      function openModal(msg, items){
        modal.classList.add('is-open'); modal.setAttribute('aria-hidden','false');
        modal.querySelector('.bwf-modal__msg').textContent = msg || '필수 항목을 확인해 주세요.';
        list.innerHTML=''; (items||[]).forEach(t=>{ const li=document.createElement('li'); li.textContent=t; list.appendChild(li); });
      }
      function closeModal(){ modal.classList.remove('is-open'); modal.setAttribute('aria-hidden','true'); }
      ok.addEventListener('click',closeModal);

      f.addEventListener('submit',function(ev){
        // 제출 직전에 한 번 더 포맷/보정
        tel.value = formatPhone(tel.value);

        const req=[...f.querySelectorAll('[required]')]; let bad=false, first=null, items=[];
        req.forEach(el=>{
          el.classList.remove('bwf-invalid'); el.setCustomValidity('');
          if(el.name==='bw_phone' && !/^010-\\d{4}-\\d{4}$/.test(el.value)){ el.setCustomValidity('휴대폰 번호는 010-1234-5678 형식'); }
          if(el.name==='bw_discover' && el.value==='etc' && (etc.value||'').trim()===''){ el.setCustomValidity('기타 경로를 입력해 주세요'); }
          if(!el.checkValidity()){
            bad=true; if(!first) first=el; el.classList.add('bwf-invalid');
            const lab = el.closest('div').querySelector('label')?.textContent?.replace('*','').trim() || el.name;
            items.push('· '+lab);
          }
        });
        if(bad){
          ev.preventDefault();
          openModal('다음 항목을 확인해 주세요.', items);
          hint.textContent='입력이 필요한 항목이 있어요.'; hint.style.color='#ef4444';
          first.scrollIntoView({behavior:'smooth',block:'center'});
        }else{
          hint.textContent='제출 중입니다…'; hint.style.color='#475569';
        }
      });
    })();
    </script>
  </form>
  <?php
  return ob_get_clean();
});

/* 서버 처리 – 대표 역할 강제 */
add_action('admin_post_nopriv_bwf_signup_rep','bwf_handle_signup_rep');
add_action('admin_post_bwf_signup_rep','bwf_handle_signup_rep');
function bwf_handle_signup_rep(){
  $nonce = sanitize_text_field($_POST['bwf_nonce'] ?? '');
  if (!wp_verify_nonce($nonce,'bwf_signup_rep')) { wp_safe_redirect(wp_get_referer()?:home_url('/')); exit; }

  $user_login=sanitize_user($_POST['user_login']??'');
  $user_email=sanitize_email($_POST['user_email']??'');
  $user_pass =$_POST['user_pass']??'';
  $first_name=sanitize_text_field($_POST['first_name']??'');

  if (!$user_login||!$user_email||!$user_pass||!$first_name){ wp_safe_redirect(wp_get_referer()?:home_url('/')); exit; }

  $uid = wp_insert_user([
    'user_login'=>$user_login,'user_email'=>$user_email,'user_pass'=>$user_pass,
    'first_name'=>$first_name,'user_url'=>esc_url_raw($_POST['user_url']??'')
  ]);
  if (is_wp_error($uid)) { wp_safe_redirect(wp_get_referer()?:home_url('/')); exit; }

  // 대표 역할을 반드시 부여
  $u=new WP_User($uid); $u->set_role('bw_owner');

  foreach(['bw_company_name','bw_industry','bw_employees','bw_contact_window','bw_discover','bw_phone'] as $k){
    if(isset($_POST[$k])) update_user_meta($uid,$k,sanitize_text_field($_POST[$k]));
  }
  if (($_POST['bw_discover']??'')==='etc' && !empty($_POST['source_etc'])) {
    update_user_meta($uid,'bw_discover','etc: '.sanitize_text_field($_POST['source_etc']));
  }

  wp_set_current_user($uid); wp_set_auth_cookie($uid);
  wp_safe_redirect(home_url('/owner-questions/')); exit;
}

`$nl
===== FILE: bw-owner-suite-acf\includes\view-list.php (2909 bytes, 73 lines) =====
`$ext
<?php
/* /includes/view-list.php  (마이페이지 카드/CTA 강화 + 스타일 확실히 로드) */
if (!defined('ABSPATH')) exit;

/* 단건 보기 동일 (생략 가능) */

/* 마이페이지 */
add_shortcode('bw_owner_list', function($atts){
  if(!is_user_logged_in()){
    wp_enqueue_style('bwf-forms');
    $signup = esc_url('https://berrywalk.co.kr/bwf-owner-signup/');
    $login  = esc_url( wp_login_url( home_url('/my-questions/') ) );
    return '<div class="bwos-wrap"><div class="bwf-need-login"><p>내 질문 저장본을 보려면 로그인이 필요합니다.</p><div class="bwf-login-actions"><a class="bwf-btn" href="'.$login.'">로그인</a><a class="bwf-btn-secondary" href="'.$signup.'">회원가입</a></div></div></div>';
  }

  $a=shortcode_atts(['per_page'=>10,'paged'=>max(1,(int)($_GET['pg']??1))],$atts,'bw_owner_list');

  $q=new WP_Query([
    'post_type'=>'bwf_owner_answer','post_status'=>'private','author'=>get_current_user_id(),
    'posts_per_page'=>(int)$a['per_page'],'orderby'=>'date','order'=>'DESC','paged'=>(int)$a['paged']
  ]);
  wp_enqueue_style('bwf-forms');

  ob_start(); ?>
  <div class="bwos-wrap">
    <h2 class="bwf-title">마이페이지</h2>

    <!-- 상단 CTA -->
    <div class="bwf-actions">
      <a class="bwf-btn" href="<?php echo esc_url(home_url('/owner-questions/')); ?>">질문 등록하기</a>
      <a class="bwf-btn-secondary" href="<?php echo esc_url(home_url('/my-questions/')); ?>">내 질문 목록 보기</a>
    </div>

    <div class="bwos-list">
      <?php if($q->have_posts()): while($q->have_posts()): $q->the_post();
        $id=get_the_ID();
        $ts=get_post_timestamp($id,'date');
        $when=wp_date('Y-m-d H:i',$ts);
        $view=esc_url(add_query_arg(['id'=>$id], home_url('/my-question-view/')));
        $edit=esc_url(add_query_arg(['id'=>$id], home_url('/owner-edit/')));
      ?>
        <div class="bwos-card">
          <h4>#<?php echo (int)$id; ?></h4>
          <div class="meta"><?php echo esc_html($when); ?></div>
          <div class="row">
            <a href="<?php echo $view; ?>">보기</a>
            <a href="<?php echo $edit; ?>">수정</a>
          </div>
        </div>
      <?php endwhile; else: ?>
        <p>작성한 내역이 없습니다. 상단의 <strong>질문 등록하기</strong>를 눌러 첫 저장본을 만들어 보세요.</p>
      <?php endif; wp_reset_postdata(); ?>
    </div>
    <?php
      $links = paginate_links([
        'total'=>max(1,(int)$q->max_num_pages),
        'current'=>(int)$a['paged'],
        'type'=>'array','prev_text'=>'이전','next_text'=>'다음',
        'format'=>'?pg=%#%'
      ]);
      if($links){
        echo '<div class="bwos-pg">';
        foreach($links as $l) echo $l.' ';
        echo '</div>';
      }
    ?>
  </div>
  <?php return ob_get_clean();
});


add_shortcode('bw_my_questions', fn($a)=>do_shortcode('[bw_owner_list]'));

`$nl

`$nl
===== FILE: pack-code.ps1 (4063 bytes, 113 lines) =====
`$ext
param(
  [string]$Root = ".",
  [string]$Out = "codepack.txt",
  [string]$IncludeExt = ".php,.js,.ts,.css,.scss,.html,.htm,.json,.md,.yml,.yaml,.xml,.sh,.ps1,.ini,.txt,.sql,.twig,.vue",
  # 제외할 디렉터리들 (쉼표로 구분)
  [string]$ExcludeDirs = "node_modules,dist,build,vendor,.git,.github,.idea,.vscode,.next,.cache,growth-checklist\plugin-update-checker",
  # 제외할 파일 패턴들 (쉼표로 구분)
  [string]$ExcludeFiles = "*.min.js,*.min.css,*.map,*.lock,*.zip,*.tar,*.gz,*.png,*.jpg,*.jpeg,*.gif,*.webp,*.svg,*.woff,*.woff2,*.ttf,*.eot,*.pdf",
  # 용량 한도
  [int]$MaxFileBytes = 1000000,    # 파일당 최대 1MB
  [int]$MaxTotalBytes = 20000000,  # 전체 최대 20MB
  # 변경 파일만 모드
  [switch]$ChangedOnly,
  [string]$GitRange = ""
)

$ErrorActionPreference = "Stop"
$Root = (Resolve-Path $Root).Path
$include = $IncludeExt.Split(",") | ForEach-Object { $_.Trim().ToLower() } | Where-Object { $_ -ne "" }
$exDirs  = $ExcludeDirs.Split(",")  | ForEach-Object { $_.Trim() }        | Where-Object { $_ -ne "" }
$exFiles = $ExcludeFiles.Split(",") | ForEach-Object { $_.Trim() }        | Where-Object { $_ -ne "" }

function IsTextExt($path) {
  $ext = [IO.Path]::GetExtension($path).ToLower()
  return $include -contains $ext
}
function IsExcludedDir($path) {
  foreach ($d in $exDirs) {
    if ($path -like "*$d*") { return $true }
  }
  return $false
}
function IsExcludedFile($file) {
  foreach ($p in $exFiles) {
    if ([IO.Path]::GetFileName($file) -like $p) { return $true }
  }
  return $false
}

# 파일 목록 수집
$files = @()
if ($ChangedOnly) {
  $gitArgs = @("diff","--name-only")
  if ($GitRange) { $gitArgs += $GitRange }
  $changed = & git @gitArgs 2>$null
  foreach ($rel in $changed) {
    $p = Join-Path $Root $rel
    if (Test-Path $p -PathType Leaf) { $files += (Resolve-Path $p).Path }
  }
} else {
  $files = Get-ChildItem -Path $Root -Recurse -File | ForEach-Object { $_.FullName }
}

# 필터링
$files = $files | Where-Object {
  -not (IsExcludedDir $_) -and
  -not (IsExcludedFile $_) -and
  (IsTextExt $_)
}

# 출력 빌드
$sb = New-Object System.Text.StringBuilder
$totalBytes = 0
$nl = [Environment]::NewLine

# 상단 메타
try {
  $repoUrl = (git -C $Root config --get remote.origin.url)
  $branch  = (git -C $Root rev-parse --abbrev-ref HEAD)
  $tag     = (git -C $Root describe --tags --abbrev=0) 2>$null
  $commit  = (git -C $Root rev-parse --short HEAD)
  $time    = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
  $null = $sb.AppendLine("===== META =====")
  $null = $sb.AppendLine("Repo: $repoUrl")
  $null = $sb.AppendLine("Branch: $branch  |  Tag: $tag  |  Commit: $commit")
  $null = $sb.AppendLine("Generated: $time")
  $null = $sb.AppendLine("")
} catch {}

foreach ($f in $files) {
  try {
    $fi = Get-Item $f
    $size = $fi.Length
    if ($size -gt $MaxFileBytes) {
      $rel = $f.Substring($Root.Length+1)
      $null = $sb.AppendLine("===== FILE: $rel ($size bytes) SKIPPED: > $MaxFileBytes =====$nl")
      continue
    }
    if (($totalBytes + $size) -gt $MaxTotalBytes) {
      $null = $sb.AppendLine("===== STOP: total size would exceed $MaxTotalBytes bytes. Remaining files omitted. =====$nl")
      break
    }

    $rel = $f.Substring($Root.Length+1)
    $content = (Get-Content -Path $f -Raw -Encoding UTF8)
    $lineCount = ($content -split "`r?`n").Count
    $ext = [IO.Path]::GetExtension($f).TrimStart(".").ToLower()
    if (-not $ext) { $ext = "text" }

    $null = $sb.AppendLine("===== FILE: $rel ($size bytes, $lineCount lines) =====")
    $null = $sb.AppendLine("```$ext")
    $null = $sb.AppendLine($content)
    $null = $sb.AppendLine("```$nl")

    $totalBytes += $size
  } catch {
    $null = $sb.AppendLine("===== FILE: $f ERROR: $($_.Exception.Message) =====$nl")
  }
}

[IO.File]::WriteAllText((Join-Path $Root $Out), $sb.ToString(), [Text.Encoding]::UTF8)
"생성 완료: $(Join-Path $Root $Out)  (총 approx $totalBytes bytes)"

`$nl
===== FILE: bw-owner-suite-acf\bw-owner-suite-acf.php (1077 bytes, 29 lines) =====
`$ext
<?php
/**
 * Plugin Name: BW Owner Suite (light)
 * Description: 대표 질문지 + 회원가입(대표 전용) + 마이페이지. ACF 기반 경량 플러그인.
 * Version: 1.0.4
 * Author: Berrywalk
 */
if (!defined('ABSPATH')) exit;

define('BWOS_VER', '1.2.2');
define('BWOS_DIR', plugin_dir_path(__FILE__));
define('BWOS_URL', plugin_dir_url(__FILE__));

require_once BWOS_DIR.'includes/cpt-admin.php';
require_once BWOS_DIR.'includes/form.php';
require_once BWOS_DIR.'includes/signup.php';
require_once BWOS_DIR.'includes/save.php';
require_once BWOS_DIR.'includes/view-list.php';
require_once BWOS_DIR.'includes/acf-fields.php'; // 관리자 ACF 메타박스(5문항)

add_action('wp_enqueue_scripts', function(){
  $css = BWOS_URL.'assets/owner-form.css';
  $js  = BWOS_URL.'assets/owner-form.js';
  wp_register_style ('bwos-form', $css, [], BWOS_VER);
  wp_register_style ('bwf-forms', $css, [], BWOS_VER); // alias
  wp_register_script('bwos-form', $js,  ['jquery'], BWOS_VER, true);
  wp_register_script('bwf-forms', $js,  ['jquery'], BWOS_VER, true); // alias
});

`$nl
===== FILE: bw-owner-suite-acf\README.md (1409 bytes, 40 lines) =====
`$ext
# BW Owner Suite (ACF Minimal)

워드프레스 표준 + ACF만 사용하여
- 회원가입 → 프로필 수정
- 대표 질문(CPT) 작성/수정/보기/목록/복제/삭제
- 저장 알림(메일/텔레그램)

을 한 번에 처리하는 경량 플러그인입니다.

## 설치
1) `Advanced Custom Fields`(ACF) 플러그인을 활성화
2) 워드프레스 관리자 → 플러그인 → 새로 추가 → 플러그인 업로드 → 이 ZIP 업로드 후 활성화
3) 활성화 즉시 아래 페이지가 자동 생성됩니다.
   - `/owner-questions/` 작성
   - `/owner-edit/?id=글ID` 수정
   - `/my-question-view/?id=글ID` 보기
   - `/my-questions/` 내 저장본(보기/수정/복제/삭제)
   - `/my-profile/` 마이프로필
   - `/register/` 회원가입

## 텔레그램 알림(선택)
`wp-config.php`에 아래 상수를 추가하면 저장 시 텔레그램 알림이 전송됩니다.

```php
define('BWF_TG_BOT','123456:ABC...');       // 봇 토큰
define('BWF_TG_CHAT','-1001234567890');     // 채팅 ID
```

## 짧은코드(Shortcodes)
- [bw_register]
- [bw_profile_form]
- [bw_owner_form_acf]
- [bw_owner_edit id="123"]  (또는 /owner-edit/?id=123)
- [bwf_owner_view id="123"]
- [bw_my_questions]

## 주의
- 플러그인 동작을 위해 ACF가 필요합니다.
- 데이터는 CPT `bwf_owner_answer`에 저장되며 리비전이 활성화되어 되돌리기가 가능합니다.

`$nl
===== FILE: bw-owner-suite-acf\assets\owner-form.css (5415 bytes, 109 lines) =====
`$ext
/* /assets/owner-form.css */

/* ====== Base ====== */
:root{
  --bw-font:17.5px;
  --bw-muted:#64748b;
  --bw-border:#e5e7eb;
  --bw-accent:#6366f1;
  --bw-ok:#16a34a;
  --bw-warn:#ef4444;
  --bw-bg:#f8fafc;
}
body{font-size:var(--bw-font);background:var(--bw-bg)}
.bwos-wrap{max-width:920px;margin:40px auto;padding:0 16px}               /* ⬆ 여백 확대 */
.bwf-title{font-size:30px;line-height:1.25;margin:22px 0 16px}
.bwf-help{color:#0f172a;margin:0 0 18px}

/* ====== Sticky progress (카드형, 배경/테두리 추가) ====== */
.bwos-progress{
  position:sticky;top:64px;z-index:1000;margin:0 0 18px;
  background:#ffffff; border:1px solid var(--bw-border); border-radius:14px;
  padding:12px 14px; box-shadow:0 6px 18px rgba(2,6,23,.06);
}
body.admin-bar .bwos-progress{top:96px}
.bwos-progress .bar{height:10px;background:#f2f4f7;border-radius:999px;overflow:hidden}
.bwos-progress .bar>span{display:block;height:100%;width:0%;background:linear-gradient(90deg,#22d3ee,#6366f1);border-radius:999px;transition:width .2s}
.bwos-progress .status{font-size:12px;color:#334155;margin-top:8px}

/* ====== Field ====== */
.bwf-field{margin:28px 0}                                                  /* ⬆ 여백 확대 */
.bwf-field label{display:block;font-weight:700;margin:0 0 14px;font-size:18px}
.bwf-field textarea,
.bwf-field input[type="text"],
.bwf-field input[type="number"],
.bwf-field input[type="email"],
.bwf-field input[type="tel"],
.bwf-field input[type="url"],
.bwf-field select{
  width:100%;box-sizing:border-box;padding:13px 14px;border:1px solid #d1d5db;border-radius:12px;background:#fff;font-size:16.5px;outline:none
}
.bwf-field textarea:focus,
.bwf-field input:focus,
.bwf-field select:focus{border-color:var(--bw-accent);box-shadow:0 0 0 3px rgba(99,102,241,.15)}

.bwos-field.bwos-error textarea,
.bwos-field.bwos-error input,
.bwos-field.bwos-error select{border-color:var(--bw-warn);background:#fff1f2}
.bwf-invalid{border-color:var(--bw-warn) !important;background:#fff1f2 !important}

/* ====== 설명/예시 – 한국형 카드 스타일 ====== */
.bwf-desc, .bwf-examples{
  margin:10px 0 10px;padding:12px 14px;border:1px dashed #dbe1ea;border-radius:12px;background:#fbfdff
}
.bwf-desc::before{
  content:"설명"; display:inline-block; font-size:12px; font-weight:800; color:#0ea5e9;
  background:#e6f6fb; border:1px solid #bde7f4; border-radius:999px; padding:2px 8px; margin-right:8px
}
.bwf-examples::before{
  content:"예시"; display:inline-block; font-size:12px; font-weight:800; color:#6366f1;
  background:#eef0ff; border:1px solid #dfe3ff; border-radius:999px; padding:2px 8px; margin-right:8px
}
.bwf-examples ul,.bwf-examples ol{margin:6px 0 0 18px}

/* ====== Counter ====== */
.bwos-count{
  display:inline-block;margin-top:8px;font-size:12px;font-weight:700;
  color:var(--bw-muted);background:#f3f4f6;border:1px solid #e5e7eb;border-radius:999px;padding:4px 8px
}
.bwos-count.ok{color:#065f46;background:#ecfdf5;border-color:#bbf7d0}
.bwos-count.need{color:#7c2d12;background:#fff7ed;border-color:#fed7aa}

/* ====== Buttons ====== */
.bwf-actions{display:flex;gap:10px;align-items:center;justify-content:center;margin-top:20px}
.bwf-btn{display:inline-block;padding:12px 18px;border-radius:14px;border:none;background:var(--bw-accent);color:#fff;text-decoration:none;font-weight:700}
.bwf-btn-secondary{display:inline-block;padding:12px 18px;border-radius:14px;border:1px solid #cbd5e1;background:#fff;color:#0f172a;text-decoration:none;font-weight:700}


/* ====== Modal (공용) ====== */
.bwos-modal, .bwf-modal{
  position:fixed;inset:0;display:none;align-items:flex-start;justify-content:center;padding-top:18vh;background:rgba(0,0,0,.45);z-index:100000
}
body.admin-bar .bwos-modal, body.admin-bar .bwf-modal{padding-top:calc(18vh + 32px)}
.bwos-modal.is-open, .bwf-modal.is-open{display:flex}
.bwos-modal-inner, .bwf-modal .bwf-modal__card{
  background:#fff;max-width:560px;width:92vw;padding:22px;border-radius:16px;box-shadow:0 22px 44px rgba(2,6,23,.18)
}
.bwos-modal-inner h4, .bwf-modal h3{margin:0 0 10px;font-size:18px}
.bwos-modal-inner p, .bwf-modal p{margin:0 0 12px;color:#334155}
.bwf-modal__list{margin:6px 0 0 18px;font-size:14px;color:#1f2937}

/* ====== List / View ====== */
.bwf-card{border:1px solid var(--bw-border);background:#fff;border-radius:12px;padding:12px 14px}

/* ====== Signup grid ====== */
.bwf-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px 14px}
.bwf-col-full{grid-column:1/-1}
@media (max-width:720px){.bwf-grid{grid-template-columns:1fr}}
.bwf-hidden{display:none}

/* 마이페이지 카드 & 페이지네이션 */
.bwos-list{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:16px}
@media (max-width:920px){.bwos-list{grid-template-columns:1fr}}
.bwos-card{border:1px solid #e5e7eb;border-radius:14px;padding:14px 16px;background:#fff;box-shadow:0 6px 14px rgba(2,6,23,.05)}
.bwos-card h4{margin:0 0 6px;font-size:17px}
.bwos-card .meta{font-size:12px;color:#64748b;margin-bottom:10px}
.bwos-card .row a{display:inline-block;padding:8px 12px;border-radius:10px;background:#f1f5f9;text-decoration:none;color:#0f172a}
.bwos-pg{margin:18px 0 8px;text-align:center}
.bwos-pg .page-numbers{display:inline-block;padding:8px 12px;border:1px solid #e5e7eb;border-radius:10px;margin:0 3px;text-decoration:none;color:#0f172a}
.bwos-pg .current{background:#6366f1;color:#fff;border-color:#6366f1}
`$nl
===== FILE: bw-owner-suite-acf\assets\owner-form.js (4147 bytes, 94 lines) =====
`$ext
/* /assets/owner-form.js  (카운터 텍스트 – "몇자 남음" 친절 메시지로) */
(function($){
  if(!$ || !$('.bwos-form').length) return;

  const $form = $('.bwos-form').first();
  const $progress = $form.find('.bwos-progress');
  const reqs = []; let submitted=false;

  function updateProgress(){
    const total=reqs.length, done=reqs.filter(r=>r.valid()).length, pct=total?Math.round(done/total*100):0;
    $progress.find('.bar>span').css('width',pct+'%');
    $progress.find('.status').text('작성 '+done+'/'+total+' ('+pct+'%)');
  }

  function wire($wrap){
    const min = parseInt($wrap.data('min')||200,10);
    const $subs = $wrap.find('.bwf-sub textarea');
    const isGroup = $subs.length>0;
    let $cnt = $wrap.find('.bwos-count'); if(!$cnt.length) $cnt=$('<small class="bwos-count"></small>').appendTo($wrap);

    const setError = bad => $wrap.toggleClass('bwos-error', submitted && !!bad);
    const valid = ()=>{
      if(isGroup){ let ok=true; $subs.each(function(){ if(($(this).val()||'').trim()==='') ok=false; }); return ok; }
      return (($wrap.find('textarea,input[type="text"]').first().val()||'').trim().length >= min);
    };

    const update = ()=>{
      if(isGroup){
        let anyEmpty=false; $subs.each(function(){ if(($(this).val()||'').trim()==='') anyEmpty=true; });
        $cnt.text(anyEmpty ? '질문 3개 모두 작성' : '충족').toggleClass('need',anyEmpty).toggleClass('ok',!anyEmpty);
        setError(anyEmpty);
      }else{
        const v=($wrap.find('textarea,input[type="text"]').first().val()||'').trim();
        const diff = min - v.length;
        if(diff>0){ $cnt.text(diff+'자 남음'); $cnt.removeClass('ok').addClass('need'); }
        else      { $cnt.text('충족'); $cnt.removeClass('need').addClass('ok'); }
        setError(v.length < min);
      }
      updateProgress();
    };

    (isGroup ? $subs : $wrap.find('textarea,input[type="text"]').first()).on('input blur', update);
    reqs.push({wrap:$wrap, valid, update, min}); update();
  }

  $form.find('.bwos-required').each(function(){ wire($(this)); });
  updateProgress();

  const $modal=$('<div class="bwos-modal"><div class="bwos-modal-inner"><h4>입력이 필요한 항목이 있어요</h4><p>아래 항목을 확인해 주세요.</p><ul class="bwf-modal__list"></ul><button type="button" class="bwf-btn-secondary ok">확인</button></div></div>').appendTo('body');
  $modal.on('click','.ok',()=> $modal.removeClass('is-open'));

  let locked=false;
  $form.on('submit',function(e){
    submitted=true; let bad=false; const items=[];
    reqs.forEach(r=>{
      if(!r.valid()){
        bad=true; const lab=r.wrap.find('label').first().text().replace(/\*.*$/,'').trim();
        if(r.wrap.find('.bwf-sub').length){ items.push('· '+lab+' — 3개 질문 모두 작성'); }
        else{
          const len=($r=r.wrap.find('textarea,input[type="text"]').first()).val().trim().length;
          const diff=(r.min||200)-len; items.push('· '+lab+' — 최소 글자수 부족 ('+diff+'자 남음)');
        }
        r.update();
      }
    });
    if(bad){
      e.preventDefault();
      const ul=$modal.find('.bwf-modal__list').empty();
      items.forEach(t=> $('<li/>').text(t).appendTo(ul));
      $modal.addClass('is-open');
      const $first=$form.find('.bwos-error').first(); if($first.length) $('html,body').animate({scrollTop:$first.offset().top-120},180);
      return;
    }
    if(locked){ e.preventDefault(); return; }
    locked=true; $form.find('.bwos-submit').prop('disabled',true).text('저장 중…');
    setTimeout(()=>{ locked=false; $form.find('.bwos-submit').prop('disabled',false).text('저장'); }, 6000);
  });
})(jQuery);

/* === Tab 이동: textarea에서 Tab 누르면 다음 필드로 포커스 === */
(function($){
  const $areas = $('.bwos-form textarea:visible');
  $areas.on('keydown', function(e){
    if(e.key === 'Tab' && !e.shiftKey){
      const list = $('.bwos-form textarea:visible');
      const idx = list.index(this);
      if(idx > -1 && idx < list.length - 1){
        e.preventDefault();
        list.eq(idx + 1).focus();
      }
    }
  });
})(jQuery);

`$nl
===== FILE: bw-owner-suite-acf\includes\acf-fields.php (3509 bytes, 76 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

add_action('acf/init', function(){
  if (!function_exists('acf_add_local_field_group')) return;

  acf_add_local_field_group([
    'key'=>'group_bwos_owner_v5','title'=>'대표 질문지',
    'fields'=>[
      ['key'=>'f_problem','label'=>'1) 지금, 우리 사업의 가장 큰 고민은 무엇인가요?','name'=>'_acf_problem','type'=>'textarea','required'=>1,'rows'=>8,'instructions'=>'최소 200자 권장'],
      ['key'=>'f_value','label'=>'2) 우리 서비스의 핵심 가치는 무엇인가요?','name'=>'_acf_value','type'=>'textarea','required'=>1,'rows'=>6],
      ['key'=>'f_whom','label'=>'3) 누가 이용해야 하나요? 왜 우리인가요?','name'=>'_acf_ideal_customer','type'=>'textarea','required'=>1,'rows'=>6],
      ['key'=>'f_ask1','label'=>'4-1) 고객에게 묻고 싶은 질문 #1','name'=>'_acf_cq1','type'=>'text'],
      ['key'=>'f_ask2','label'=>'4-2) 고객에게 묻고 싶은 질문 #2','name'=>'_acf_cq2','type'=>'text'],
      ['key'=>'f_ask3','label'=>'4-3) 고객에게 묻고 싶은 질문 #3','name'=>'_acf_cq3','type'=>'text'],
      ['key'=>'f_comp','label'=>'5) 경쟁사 대비 차별점','name'=>'_acf_competitors','type'=>'textarea','required'=>1,'rows'=>6],
    ],
    'location'=>[[['param'=>'post_type','operator'=>'==','value'=>'bwf_owner_answer']]],
    'position'=>'normal','style'=>'default','active'=>true,
  ]);
});


/** 200자 필드 서버 검증 */
add_filter('acf/validate_value', function($valid, $value, $field){
  if ($valid !== true) return $valid;
  $min200 = ['problem','core_value','target_customer','differentiation','sales_blockers','current_channels','growth_goal','next_action'];
  if (in_array($field['name'] ?? '', $min200, true)) {
    if (mb_strlen(trim((string)$value)) < 200) return '최소 200자 이상 작성해 주세요.';
  }
  return $valid;
}, 10, 3);
/* ------- ACF <-> bwf_answers 동기화 ------- */
function bwos_acf_meta_keys(){ // ACF 메타키(name) 매핑
  return [
    '_acf_problem'       => ['id'=>'problem'],
    '_acf_value'         => ['id'=>'value'],
    '_acf_ideal_customer'=> ['id'=>'ideal_customer'],
    '_acf_cq1'           => ['id'=>'ask3','sub'=>'q1'],
    '_acf_cq2'           => ['id'=>'ask3','sub'=>'q2'],
    '_acf_cq3'           => ['id'=>'ask3','sub'=>'q3'],
    '_acf_competitors'   => ['id'=>'competitors'],
  ];
}

/* 편집 화면 로드시 ACF 메타 채워넣기(관리자에서 비어 보이던 문제 해결) */
add_action('load-post.php', function(){
  $pid = isset($_GET['post']) ? (int)$_GET['post'] : 0;
  if(!$pid) return;
  $p = get_post($pid);
  if(!$p || $p->post_type!=='bwf_owner_answer') return;

  $ans = (array)get_post_meta($pid,'bwf_answers',true);
  foreach(bwos_acf_meta_keys() as $meta=>$m){
    $val = '';
    if(empty($m['sub'])) $val = (string)($ans[$m['id']] ?? '');
    else                 $val = (string)($ans[$m['id']][$m['sub']] ?? '');
    update_post_meta($pid, $meta, $val);
  }
});

/* 저장 시 ACF 값으로 bwf_answers 재생성(양방향 동기화) */
add_action('save_post_bwf_owner_answer', function($post_id){
  if(defined('DOING_AUTOSAVE') && DOING_AUTOSAVE) return;
  $ans = [];
  foreach(bwos_acf_meta_keys() as $meta=>$m){
    $v = (string)get_post_meta($post_id,$meta,true);
    if(empty($m['sub'])) $ans[$m['id']] = $v;
    else {
      if(empty($ans[$m['id']])) $ans[$m['id']] = [];
      $ans[$m['id']][$m['sub']] = $v;
    }
  }
  if($ans) update_post_meta($post_id,'bwf_answers',$ans);
}, 20);

`$nl
===== FILE: bw-owner-suite-acf\includes\cpt-admin.php (871 bytes, 21 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

add_action('init', function(){
  register_post_type('bwf_owner_answer', [
    'label'=>'대표 질문지','labels'=>['name'=>'대표 질문지','add_new_item'=>'새 대표 질문 생성','edit_item'=>'대표 질문 편집'],
    'public'=>false,'exclude_from_search'=>true,'publicly_queryable'=>false,'show_ui'=>true,'show_in_menu'=>true,
    'menu_icon'=>'dashicons-editor-help','supports'=>['author','custom-fields'],'map_meta_cap'=>true,
  ]);
});

add_filter('manage_bwf_owner_answer_posts_columns', function($c){
  return ['cb'=>$c['cb'],'title'=>'제목','author'=>'작성자','created'=>'저장 시각'];
});
add_action('manage_bwf_owner_answer_posts_custom_column', function($col,$post_id){
  if($col==='created'){
    $ts = get_post_timestamp($post_id,'date');
    echo esc_html( wp_date('Y-m-d H:i', $ts) );
  }
}, 10, 2);

`$nl
===== FILE: bw-owner-suite-acf\includes\form.php (7363 bytes, 121 lines) =====
`$ext
<?php
/* /includes/form.php (핵심 변경만) */
if (!defined('ABSPATH')) exit;

function bwf_owner_cfg(){
  return [
    'title'=>'대표님 핵심 질문지',
    'min'=>200,
    'intro'=>'사업의 본질을 파악하고 고객에게 정말 묻고 싶은 질문을 구체화합니다. 각 문항은 최소 <strong>{MIN}</strong>자입니다. <em>(단, <strong>“고객에게 물어보고 싶은 3가지”</strong>는 글자수 제한 없음)</em>',
    'qs'=>[
      [
        'id'=>'problem','label'=>'1. 지금, 우리 사업의 가장 큰 고민은 무엇인가요?','required'=>true,'min'=>200,
        'desc'=>'성장이 정체되었다고 느낀 **구체적 상황**을 한두 문장으로. 숫자/행동 기반이면 좋아요.',
        'ex'=>'<ul><li>“클릭은 많은데 체류 30초 미만 이탈이 많아요.”</li><li>“재구매율이 낮아 신규 유입 의존도가 큽니다.”</li></ul>'
      ],
      [
        'id'=>'value','label'=>'2. 우리 서비스는 고객의 어떤 문제를 해결하나요?','required'=>true,'min'=>200,
        'desc'=>'고객의 **전/후 변화**를 한 문장으로 요약.',
        'ex'=>'<ol><li>“반복 서류작업을 5분 자동화 → 본업 집중”</li><li>“바쁜 직장인도 집밥처럼 건강한 한 끼 확보”</li></ol>'
      ],
      [
        'id'=>'ideal_customer','label'=>'3. 누가 이용해야 하나요? 왜 우리여야 하나요?','required'=>true,'min'=>200,
        'desc'=>'핵심 타깃의 특징 + 우리를 선택할 **결정적 이유**.',
        'ex'=>'<p>“시간/비용이 부족한 20대 대학생 → 15분 홈트 영상으로 꾸준함 확보.”</p>'
      ],
      [
        'id'=>'ask3','type'=>'group','label'=>'4. 고객에게 물어보고 싶은 3가지','required'=>true,
        'desc'=>'실제 경험 기반으로 **구체적인 질문 3개**를 작성.',
        'ex'=>'<p><strong>예)</strong> 첫인상/결심포인트/아쉬운점</p>',
        'sub'=>[
          ['id'=>'q1','label'=>'질문 1','ph'=>'예: 어떻게 알게 되었나요?','required'=>true],
          ['id'=>'q2','label'=>'질문 2','ph'=>'예: 결심 포인트는 무엇이었나요?','required'=>true],
          ['id'=>'q3','label'=>'질문 3','ph'=>'예: 가장 아쉬웠던 점은?','required'=>true],
        ]
      ],
      [
        'id'=>'competitors','label'=>'5. 경쟁사와의 차별점은?','required'=>true,'min'=>200,
        'desc'=>'주요 경쟁사 1~2곳과 비교해 강/약점 정리.',
        'ex'=>'<p>“A는 저렴하지만 CS 느림 / B는 비싸지만 품질 우수 → 우리는 적정가+빠른 CS”</p>'
      ],
    ]
  ];
}

function bwf_owner_view_url(){ return home_url('/my-question-view/'); }
function bwf_owner_edit_url(){ return home_url('/owner-edit/'); }
function bwf_owner_list_url(){ return home_url('/my-questions/'); }

function bwf_render_owner_form($args=[]){
  $cfg=bwf_owner_cfg(); $min=(int)$cfg['min']; $mode=$args['mode']??'create';
  $post=$args['post']??null; $saved=$args['saved']??[]; $errs=$args['errs']??[];
  if($mode==='edit' && $post){ $existing=(array)get_post_meta($post->ID,'bwf_answers',true); $saved=$saved ?: $existing; }
  wp_enqueue_style('bwf-forms'); wp_enqueue_script('bwos-form');

  ob_start(); ?>
  <form id="bwfOwnerForm" class="bwf-form bwos-form" method="post" action="<?php echo esc_url(admin_url('admin-post.php')); ?>" novalidate>
    <input type="hidden" name="action" value="bwf_owner_save">
    <?php wp_nonce_field('bwf_owner_save','bwf_owner_nonce'); ?>
    <input type="hidden" name="post_id" value="<?php echo $post ? (int)$post->ID : 0; ?>">

    <div class="bwos-progress"><div class="bar"><span></span></div><div class="status">작성 0/0 (0%)</div></div>

    <h2 class="bwf-title"><?php echo esc_html($cfg['title']); ?></h2>
    <p class="bwf-help"><?php echo str_replace('{MIN}', $min, $cfg['intro']); ?></p>

    <?php foreach($cfg['qs'] as $q): $type=$q['type']??'textarea'; $id=$q['id']; ?>
      <div class="bwf-field bwos-field bwos-required" data-min="<?php echo (int)($q['min']??$min); ?>">
        <label><?php echo esc_html($q['label']); ?><?php if(!empty($q['required'])): ?><span class="bwf-required">*</span><?php endif; ?></label>

        <?php if(!empty($q['desc'])): ?><div class="bwf-desc"><?php echo wp_kses_post($q['desc']); ?></div><?php endif; ?>
        <?php if(!empty($q['ex'])):   ?><div class="bwf-examples"><?php echo wp_kses_post($q['ex']); ?></div><?php endif; ?>

        <?php if($type==='group'): ?>
          <?php foreach(($q['sub']??[]) as $sub): $sid=$sub['id']; $v=$saved[$id][$sid]??''; ?>
            <div class="bwf-sub">
              <div class="bwf-help" style="margin:6px 0 6px;"><?php echo esc_html($sub['label']); ?></div>
              <textarea name="q[<?php echo esc_attr($id); ?>][<?php echo esc_attr($sid); ?>]" rows="4" placeholder="<?php echo esc_attr($sub['ph']??''); ?>"><?php echo esc_textarea($v); ?></textarea>
            </div>
          <?php endforeach; ?>
        <?php else: $v=$saved[$id]??''; ?>
          <textarea name="q[<?php echo esc_attr($id); ?>]" rows="6"><?php echo esc_textarea($v); ?></textarea>
          <small class="bwos-count">0/<?php echo (int)($q['min']??$min); ?></small>
        <?php endif; ?>
      </div>
    <?php endforeach; ?>

    <div class="bwf-actions">
      <button type="submit" class="bwf-btn bwos-submit"><?php echo $mode==='edit'?'수정 저장':'저장'; ?></button>
      <!-- 마이페이지 버튼 제거 요청 반영 -->
    </div>
  </form>
  <?php return ob_get_clean();
}

add_shortcode('bwf_owner_questions', function(){
  wp_enqueue_style('bwf-forms');

  if (!is_user_logged_in()){
    wp_enqueue_style('bwf-forms');
    $signup = esc_url('https://berrywalk.co.kr/bwf-owner-signup/');
    $login  = esc_url( wp_login_url( home_url('/owner-questions/') ) );
    return '<div class="bwos-wrap"><div class="bwf-need-login"><p>대표님 핵심 질문지를 작성하려면 로그인이 필요합니다.</p><div class="bwf-login-actions"><a class="bwf-btn" href="'.$login.'">로그인하러 가기</a><a class="bwf-btn-secondary" href="'.$signup.'">회원가입하러 가기</a></div></div></div>';
  }
  $uid=get_current_user_id();
  $old=get_transient('bwf_owner_old_'.$uid)?:[]; delete_transient('bwf_owner_old_'.$uid);
  $err=get_transient('bwf_owner_err_'.$uid)?:[]; delete_transient('bwf_owner_err_'.$uid);
  return bwf_render_owner_form(['mode'=>'create','saved'=>$old,'errs'=>$err]);
});
add_shortcode('bw_owner_form', fn()=>do_shortcode('[bwf_owner_questions]'));
add_shortcode('bw_owner_edit', function($atts){
  if (!is_user_logged_in()) return '<div class="bwf-form">로그인이 필요합니다.</div>';
  $id=(int)($atts['id']??($_GET['id']??0));
  $post=get_post($id);
  if(!$post || $post->post_type!=='bwf_owner_answer') return '<div class="bwf-form">데이터가 없습니다.</div>';
  if((int)$post->post_author!==get_current_user_id() && !current_user_can('edit_post',$id)) return '<div class="bwf-form">권한이 없습니다.</div>';
  $uid=get_current_user_id();
  $old=get_transient('bwf_owner_old_'.$uid)?:[]; delete_transient('bwf_owner_old_'.$uid);
  $err=get_transient('bwf_owner_err_'.$uid)?:[]; delete_transient('bwf_owner_err_'.$uid);
  return bwf_render_owner_form(['mode'=>'edit','post'=>$post,'saved'=>$old,'errs'=>$err]);
});

`$nl
===== FILE: bw-owner-suite-acf\includes\save.php (3633 bytes, 109 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

add_action('admin_post_bwf_owner_save','bwf_owner_handle_save');
add_action('admin_post_nopriv_bwf_owner_save','bwf_owner_handle_save');

function bwf_owner_handle_save(){
  if(!is_user_logged_in()) { wp_safe_redirect(home_url('/')); exit; }
  if(empty($_POST['bwf_owner_nonce']) || !wp_verify_nonce($_POST['bwf_owner_nonce'],'bwf_owner_save')){
    wp_safe_redirect(wp_get_referer()?:home_url('/')); exit;
  }

  $uid  = get_current_user_id();
  $lock = 'bwf_owner_lock_'.$uid;
  if(get_transient($lock)) { wp_safe_redirect(home_url('/my-questions/')); exit; }
  set_transient($lock,1,8); // 8초 중복방지

  $cfg = bwf_owner_cfg();
  $min = (int)$cfg['min'];
  $src = $_POST['q'] ?? [];
  $ans = []; $err=[];

  foreach($cfg['qs'] as $q){
    $id=$q['id']; $type=$q['type']??'textarea';
    $req=!empty($q['required']); $m=(int)($q['min']??$min);

    if($type==='group'){
      $ans[$id]=[];
      foreach(($q['sub']??[]) as $sub){
        $sid=$sub['id']; $v=trim((string)($src[$id][$sid]??''));
        $ans[$id][$sid]=sanitize_textarea_field($v);
        if(!empty($sub['required']) && $v===''){ $err[$id][$sid]=true; }
      }
      if($req && !empty($err[$id])){/*표시용*/}
    }else{
      $v=trim((string)($src[$id]??'')); $ans[$id]=sanitize_textarea_field($v);
      if($req && mb_strlen($v)<$m){ $err[$id]=true; }
    }
  }

  if($err){
    set_transient('bwf_owner_old_'.$uid,$src,60);
    set_transient('bwf_owner_err_'.$uid,$err,60);
    delete_transient($lock);
    wp_safe_redirect(wp_get_referer()?:home_url('/owner-questions/')); exit;
  }

  $post_id = (int)($_POST['post_id']??0);
  $title   = '대표 질문지 - '.wp_date('Y-m-d H:i'); // 사이트 타임존

  if($post_id){
    $p=get_post($post_id);
    if($p && $p->post_type==='bwf_owner_answer' && ((int)$p->post_author===$uid || current_user_can('edit_post',$post_id))){
      update_post_meta($post_id,'bwf_answers',$ans);
      wp_update_post(['ID'=>$post_id,'post_title'=>$title,'post_status'=>'private']);
      delete_transient($lock);
      wp_safe_redirect(add_query_arg(['id'=>$post_id,'updated'=>1], bwf_owner_view_url())); exit;
    }
  }

  $new_id = wp_insert_post([
    'post_type'=>'bwf_owner_answer','post_status'=>'private','post_title'=>$title,'post_author'=>$uid,
  ], true);

  if(!is_wp_error($new_id)){
    update_post_meta($new_id,'bwf_answers',$ans);
    delete_transient($lock);
    wp_safe_redirect(add_query_arg(['id'=>$new_id,'saved'=>1], bwf_owner_view_url())); exit;
  }

  delete_transient($lock);
  wp_safe_redirect(bwf_owner_list_url()); exit;
}


function bwf_owner_save(){
  if(!is_user_logged_in()) wp_die('로그인이 필요합니다.');
  check_admin_referer('bwf_owner_save','bwf_owner_nonce');

  $uid     = get_current_user_id();
  $post_id = (int)($_POST['post_id']??0);
  $answers = (array)($_POST['q']??[]);

  // 제목 생성 규칙
  $au      = wp_get_current_user();
  $q1      = trim((string)($answers['problem']??''));
  $head    = $q1 ? mb_substr(preg_replace('/\s+/', ' ', $q1), 0, 16).'…' : current_time('mysql');
  $title   = sprintf('%s – %s', $au->user_login, $head);

  $postarr = [
    'post_type'   => 'bwf_owner_answer',
    'post_status' => 'private',
    'post_title'  => $title,
    'post_author' => $uid,
  ];

  if($post_id){
    $postarr['ID'] = $post_id;
    $pid = wp_update_post($postarr, true);
  }else{
    $pid = wp_insert_post($postarr, true);
  }
  if(is_wp_error($pid)) wp_die($pid);

  update_post_meta($pid, 'bwf_answers', $answers);

  wp_safe_redirect( add_query_arg(['id'=>$pid], home_url('/my-question-view/')) );
  exit;
}
`$nl
===== FILE: bw-owner-suite-acf\includes\signup.php (11628 bytes, 190 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

/* 역할 보장 */
add_action('init', function(){
  if (!get_role('bw_owner')) add_role('bw_owner','대표',['read'=>true]);
});

/* --- 관리자 사용자 목록 컬럼 + 프로필 편집 영역 --- */
add_filter('manage_users_columns', function($cols){ $cols['bw_owner_meta']='대표 인적사항'; return $cols; });
add_filter('manage_users_custom_column', function($out,$col,$user_id){
  if($col!=='bw_owner_meta') return $out;
  $f = function($k){ return get_user_meta(get_current_user_id(), $k, true); };
  $pairs = [
    '회사'     => get_user_meta($user_id,'bw_company_name',true),
    '업종'     => get_user_meta($user_id,'bw_industry',true),
    '직원 수'  => get_user_meta($user_id,'bw_employees',true),
    '휴대폰'   => get_user_meta($user_id,'bw_phone',true),
    '연락시간' => get_user_meta($user_id,'bw_contact_window',true),
    '유입경로' => get_user_meta($user_id,'bw_discover',true),
  ];
  $html='<div style="line-height:1.5">'; foreach($pairs as $k=>$v){ if($v) $html.="<div><strong>{$k}</strong> {$v}</div>"; } $html.='</div>';
  return $html;
},10,3);

/* 프로필 편집 폼 */
add_action('show_user_profile','bwf_owner_profile_fields');
add_action('edit_user_profile','bwf_owner_profile_fields');
function bwf_owner_profile_fields($user){
  ?>
  <h2>대표 인적사항</h2>
  <table class="form-table" role="presentation">
    <tr><th><label>회사명</label></th><td><input type="text" name="bw_company_name" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_company_name',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>업종</label></th><td><input type="text" name="bw_industry" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_industry',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>직원 수</label></th><td><input type="number" name="bw_employees" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_employees',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>휴대폰</label></th><td><input type="text" name="bw_phone" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_phone',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>연락 가능한 시간대</label></th><td><input type="text" name="bw_contact_window" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_contact_window',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>알게 된 경로</label></th><td><input type="text" name="bw_discover" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_discover',true)); ?>" class="regular-text"></td></tr>
  </table>
  <?php
}
add_action('personal_options_update','bwf_owner_profile_save');
add_action('edit_user_profile_update','bwf_owner_profile_save');
function bwf_owner_profile_save($user_id){
  foreach(['bw_company_name','bw_industry','bw_employees','bw_phone','bw_contact_window','bw_discover'] as $k){
    if(isset($_POST[$k])) update_user_meta($user_id,$k, sanitize_text_field($_POST[$k]));
  }
}

/* --- 대표 회원가입 폼 --- */
add_shortcode('bwf_signup_representative', function () {
  wp_enqueue_style('bwf-forms');

  // 에러/이전값 표시
  $err = get_transient('bwf_signup_err'); delete_transient('bwf_signup_err');
  $old = get_transient('bwf_signup_old'); delete_transient('bwf_signup_old');

  if (is_user_logged_in()) {
    return '<div class="bwos-wrap" style="margin-top:40px;margin-bottom:24px">
      <p style="margin:0 0 18px;font-weight:700">로그인되었습니다.</p>
      <div class="bwf-actions" style="margin-top:0">
        <a class="bwf-btn" href="'.esc_url(home_url('/owner-questions/')).'">질문 등록하기</a>
        <a class="bwf-btn-secondary" href="'.esc_url(home_url('/my-questions/')).'">내 질문 목록 보기</a>
      </div>
    </div>';
  }

  ob_start(); ?>
  <form method="post" class="bwf-form bwf-grid" id="bwf-signup-rep" action="<?php echo esc_url(admin_url('admin-post.php')); ?>" novalidate>
    <input type="hidden" name="action" value="bwf_signup_rep">
    <?php wp_nonce_field('bwf_signup_rep','bwf_nonce'); ?>

    <h2 class="bwf-title bwf-col-full" style="margin-top:8px;margin-bottom:10px">대표 회원가입</h2>
    <?php if($err): ?>
      <div class="bwf-card bwf-col-full" style="border-color:#fecaca;background:#fff1f2;color:#7f1d1d;margin-bottom:10px"><?php echo esc_html($err); ?></div>
    <?php endif; ?>
    <p class="bwf-required-note bwf-col-full" style="margin-top:0;margin-bottom:14px">* 표시는 필수 입력</p>

    <div><label style="margin-bottom:14px">아이디 *</label><input type="text" name="user_login" value="<?php echo esc_attr($old['user_login']??''); ?>" pattern="[A-Za-z0-9_\.\-]{4,32}" required></div>
    <div><label style="margin-bottom:14px">비밀번호 *</label><input type="password" name="user_pass" required></div>
    <div><label style="margin-bottom:14px">이메일 *</label><input type="email" name="user_email" value="<?php echo esc_attr($old['user_email']??''); ?>" required></div>
    <div><label style="margin-bottom:14px">이름 *</label><input type="text" name="first_name" value="<?php echo esc_attr($old['first_name']??''); ?>" required></div>

    <div><label style="margin-bottom:14px">회사명 *</label><input type="text" name="bw_company_name" value="<?php echo esc_attr($old['bw_company_name']??''); ?>" required></div>
    <div><label style="margin-bottom:14px">업종 *</label>
      <select name="bw_industry" required>
        <?php $sel = $old['bw_industry']??''; ?>
        <option value="">선택</option>
        <option value="IT/서비스" <?php selected($sel,'IT/서비스'); ?>>IT/서비스</option>
        <option value="커머스" <?php selected($sel,'커머스'); ?>>커머스</option>
        <option value="기타" <?php selected($sel,'기타'); ?>>기타</option>
      </select>
    </div>
    <div><label style="margin-bottom:14px">직원 수 *</label><input type="number" name="bw_employees" value="<?php echo esc_attr($old['bw_employees']??''); ?>" min="1" required></div>
    <div><label style="margin-bottom:14px">홈페이지 URL</label><input type="url" name="user_url" value="<?php echo esc_attr($old['user_url']??''); ?>" placeholder="https://"></div>

    <div class="bwf-col-full">
      <label style="margin-bottom:14px">알게 된 경로 *</label>
      <?php $srcSel = $old['bw_discover']??''; ?>
      <select name="bw_discover" id="bwf-source" required>
        <option value="">선택</option><option value="검색" <?php selected($srcSel,'검색'); ?>>검색</option><option value="SNS" <?php selected($srcSel,'SNS'); ?>>SNS</option><option value="지인추천" <?php selected($srcSel,'지인추천'); ?>>지인추천</option><option value="기타" <?php selected($srcSel,'기타'); ?>>기타</option>
      </select>
      <input type="text" name="source_etc" id="bwf-source-etc" placeholder="기타 경로" class="bwf-col-full <?php echo ($srcSel==='기타'?'':'bwf-hidden'); ?>" style="margin-top:8px" value="<?php echo esc_attr($old['source_etc']??''); ?>">
    </div>

    <div><label style="margin-bottom:14px">휴대폰 번호 *</label>
      <input type="tel" name="bw_phone" id="bwf-phone" inputmode="numeric" placeholder="010-1234-5678" maxlength="13" value="<?php echo esc_attr($old['bw_phone']??''); ?>" required>
    </div>
    <div><label style="margin-bottom:14px">연락 가능한 시간대 *</label><input type="text" name="bw_contact_window" value="<?php echo esc_attr($old['bw_contact_window']??''); ?>" placeholder="예: 평일 13:00~18:00" required></div>

    <div class="bwf-actions bwf-col-full" style="margin-top:18px">
      <button type="submit" name="bwf_register" class="bwf-btn">회원가입</button>
      <span id="bwf-hint" style="font-size:13px;color:#475569"></span>
    </div>

    <script>
    (function(){
      const f=document.getElementById('bwf-signup-rep'),
            src=f.querySelector('#bwf-source'),
            etc=f.querySelector('#bwf-source-etc'),
            tel=f.querySelector('#bwf-phone'),
            hint=document.getElementById('bwf-hint');

      function showEtc(){ if(src.value==='기타'){ etc.classList.remove('bwf-hidden'); } else { etc.classList.add('bwf-hidden'); etc.value=''; } }
      src.addEventListener('change',showEtc); showEtc();

      const dig=s=>String(s||'').replace(/\D/g,'');
      function fmt(raw){ const d=dig(raw).slice(0,11); if(d.length<=3) return d; if(d.length<=7) return d.replace(/^(\d{3})(\d{0,4})$/,'$1-$2'); return d.replace(/^(\d{3})(\d{4})(\d{0,4}).*$/,'$1-$2-$3'); }
      function norm(){ tel.value=fmt(tel.value); try{ tel.setSelectionRange(tel.value.length,tel.value.length);}catch(e){} }
      ['input','keyup','change','paste','blur','focus'].forEach(ev=> tel.addEventListener(ev,norm)); norm();

      f.addEventListener('submit',function(ev){
        norm();
        // 필수항목 검증
        const must=[...f.querySelectorAll('[required]')]; let ok=true; let first=null;
        must.forEach(el=>{
          el.classList.remove('bwf-invalid'); el.setCustomValidity('');
          if(el===tel && !/^010-\d{3,4}-\d{4}$/.test(tel.value)){ el.setCustomValidity('휴대폰 번호는 010-1234-5678 형식'); }
          if(el.name==='bw_discover' && src.value==='기타' && (etc.value||'').trim()===''){ el.setCustomValidity('기타 경로를 입력해 주세요'); }
          if(!el.checkValidity()){ ok=false; if(!first) first=el; el.classList.add('bwf-invalid'); }
        });
        if(!ok){ ev.preventDefault(); hint.textContent='입력이 필요한 항목이 있어요.'; hint.style.color='#ef4444'; first.scrollIntoView({behavior:'smooth',block:'center'}); }
        else   { hint.textContent='제출 중입니다…'; hint.style.color='#475569'; }
      });
    })();
    </script>
  </form>
  <?php
  return ob_get_clean();
});

/* 제출 처리 */
add_action('admin_post_nopriv_bwf_signup_rep','bwf_handle_signup_rep');
function bwf_handle_signup_rep(){
  $old = $_POST; unset($old['action'],$old['bwf_nonce'],$old['user_pass']);
  set_transient('bwf_signup_old',$old,60);

  $nonce = sanitize_text_field($_POST['bwf_nonce'] ?? '');
  if (!wp_verify_nonce($nonce,'bwf_signup_rep')) { set_transient('bwf_signup_err','유효하지 않은 요청입니다.',60); wp_safe_redirect(wp_get_referer()?:home_url('/')); exit; }

  $user_login=sanitize_user($_POST['user_login']??'');
  $user_email=sanitize_email($_POST['user_email']??'');
  $user_pass =$_POST['user_pass']??'';
  $first_name=sanitize_text_field($_POST['first_name']??'');

  if (!$user_login||!$user_email||!$user_pass||!$first_name){ set_transient('bwf_signup_err','필수 항목이 누락되었습니다.',60); wp_safe_redirect(wp_get_referer()?:home_url('/')); exit; }

  $uid = wp_insert_user([
    'user_login'=>$user_login,'user_email'=>$user_email,'user_pass'=>$user_pass,
    'first_name'=>$first_name,'role'=>'bw_owner','user_url'=>esc_url_raw($_POST['user_url']??'')
  ]);

  if (is_wp_error($uid)) {
    set_transient('bwf_signup_err', $uid->get_error_message(), 60);
    wp_safe_redirect(wp_get_referer()?:home_url('/')); exit;
  }

  foreach(['bw_company_name','bw_industry','bw_employees','bw_contact_window','bw_discover','bw_phone'] as $k){
    if(isset($_POST[$k])) update_user_meta($uid,$k,sanitize_text_field($_POST[$k]));
  }
  if (($_POST['bw_discover']??'')==='기타' && !empty($_POST['source_etc'])) {
    update_user_meta($uid,'bw_discover','etc: '.sanitize_text_field($_POST['source_etc']));
  }

  delete_transient('bwf_signup_old');

  wp_set_current_user($uid); wp_set_auth_cookie($uid);
  wp_safe_redirect(home_url('/owner-questions/')); exit;
}

`$nl
===== FILE: bw-owner-suite-acf\includes\view-list.php (6250 bytes, 147 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

/** 공통 */
function bwf_owner_view_url(){ return home_url('/my-question-view/'); }
function bwf_owner_edit_url(){ return home_url('/owner-edit/'); }
function bwf_owner_list_url(){ return home_url('/my-questions/'); }

/** 단건 보기: [bw_owner_view] / [bwf_owner_view] */
function bwos_render_single_view($atts){
  if(!is_user_logged_in()) return '<div class="bwf-form">로그인이 필요합니다.</div>';
  $id=(int)($atts['id']??($_GET['id']??0));
  $p=get_post($id);
  if(!$p || $p->post_type!=='bwf_owner_answer') return '<div class="bwf-form">데이터가 없습니다.</div>';
  if((int)$p->post_author!==get_current_user_id() && !current_user_can('read_post',$id)) return '<div class="bwf-form">권한이 없습니다.</div>';

  wp_enqueue_style('bwf-forms');
  $cfg = function_exists('bwf_owner_cfg') ? bwf_owner_cfg() : ['title'=>'대표 질문지'];
  $ans = (array)get_post_meta($id,'bwf_answers',true);

  // 작성자/회사 정보 블록
  $au   = get_userdata($p->post_author);
  $meta = [
    '이름'     => $au ? ($au->first_name ?: $au->display_name) : '',
    '아이디'   => $au ? $au->user_login : '',
    '회사명'   => get_user_meta($p->post_author,'bw_company_name',true),
    '업종'     => get_user_meta($p->post_author,'bw_industry',true),
    '휴대폰'   => get_user_meta($p->post_author,'bw_phone',true),
    '연락시간' => get_user_meta($p->post_author,'bw_contact_window',true),
  ];

  ob_start(); ?>
  <div class="bwos-wrap">
    <h2 class="bwf-title"><?php echo esc_html($cfg['title']); ?></h2>

    <div class="bwf-card" style="margin-bottom:14px">
      <strong>작성자 정보</strong>
      <div style="display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:6px 14px;margin-top:8px">
        <?php foreach($meta as $k=>$v){ if(!$v) continue; ?>
          <div><span style="color:#64748b"><?php echo esc_html($k); ?></span> : <?php echo esc_html($v); ?></div>
        <?php } ?>
      </div>
    </div>

    <?php foreach(($cfg['qs']??[]) as $q): $idk=$q['id']??''; if(!$idk) continue; ?>
      <div class="bwf-field">
        <label><?php echo esc_html($q['label']); ?></label>
        <?php if(($q['type']??'')==='group'): ?>
          <?php foreach(($q['sub']??[]) as $sub): $sid=$sub['id']; $v=trim((string)($ans[$idk][$sid]??'')); ?>
            <div class="bwf-sub">
              <div class="bwf-help"><?php echo esc_html($sub['label']); ?></div>
              <div class="bwf-card"><?php echo nl2br(esc_html($v)); ?></div>
            </div>
          <?php endforeach; ?>
        <?php else: $v=trim((string)($ans[$idk]??'')); ?>
          <div class="bwf-card"><?php echo nl2br(esc_html($v)); ?></div>
        <?php endif; ?>
      </div>
    <?php endforeach; ?>

    <div class="bwf-actions" style="justify-content:center">
      <a class="bwf-btn" href="<?php echo esc_url(add_query_arg(['id'=>$p->ID], bwf_owner_edit_url())); ?>">수정</a>
      <a class="bwf-btn-secondary" href="<?php echo esc_url(bwf_owner_list_url()); ?>">목록</a>
    </div>
  </div>
  <?php return ob_get_clean();
}
add_shortcode('bw_owner_view','bwos_render_single_view');
add_shortcode('bwf_owner_view','bwos_render_single_view'); // 별칭 지원

/** 마이페이지: [bw_owner_list] / [bw_my_questions] */
add_shortcode('bw_owner_list', function($atts){
  if(!is_user_logged_in()) return '<div class="bwf-form">로그인이 필요합니다.</div>';

  $paged = max(1, (int)get_query_var('paged', 0));
  if(!$paged) $paged = max(1, (int)($_GET['pg'] ?? 1)); // 쿼리스트링/퍼말링크 모두 지원

  $q=new WP_Query([
    'post_type'      => 'bwf_owner_answer',
    'post_status'    => 'private',
    'author'         => get_current_user_id(),
    'posts_per_page' => 8,
    'orderby'        => 'date',
    'order'          => 'DESC',
    'paged'          => $paged
  ]);
  wp_enqueue_style('bwf-forms');

  ob_start(); ?>
  <div class="bwos-wrap">
    <h2 class="bwf-title" style="margin-bottom:16px">마이페이지</h2>

    <div class="bwf-actions" style="justify-content:flex-start;margin:0 0 14px">
      <a class="bwf-btn" href="<?php echo esc_url(home_url('/owner-questions/')); ?>">새 피드백 질문하기</a>
    </div>

    <div class="bwos-list">
      <?php if($q->have_posts()): while($q->have_posts()): $q->the_post();
        $id   = get_the_ID();

        // 제목 규칙: {user_login} – 1번 질문 첫 16자 (없으면 날짜)
        $au     = wp_get_current_user();
        $ans    = (array)get_post_meta($id,'bwf_answers',true);
        $q1     = trim((string)($ans['problem']??''));
        $head   = $q1 ? mb_substr(preg_replace('/\s+/', ' ', $q1), 0, 16).'…' : get_the_date('Y-m-d H:i', $id);
        $title  = sprintf('%s – %s', $au->user_login, $head);

        // 시간대 보정: 사이트 설정(일반설정)의 시간대에 맞춰 표시
        $when = get_the_date('Y-m-d H:i', $id);

        $view = esc_url(add_query_arg(['id'=>$id], bwf_owner_view_url()));
        $edit = esc_url(add_query_arg(['id'=>$id], bwf_owner_edit_url()));
      ?>
        <div class="bwos-card">
          <h4><?php echo esc_html($title); ?></h4>
          <div class="meta"><?php echo esc_html($when); ?></div>
          <div class="row">
            <a href="<?php echo $view; ?>">보기</a>
            <a href="<?php echo $edit; ?>">수정</a>
          </div>
        </div>
      <?php endwhile; else: ?>
        <p>작성한 내역이 없습니다. <a href="<?php echo esc_url(home_url('/owner-questions/')); ?>">새 피드백 질문하기</a>를 눌러 첫 저장본을 만들어 보세요.</p>
      <?php endif; wp_reset_postdata(); ?>
    </div>

    <?php
      $links = paginate_links([
        'total'   => max(1,(int)$q->max_num_pages),
        'current' => $paged,
        'type'    => 'array',
        'mid_size'=> 2,
        'prev_text'=>'이전',
        'next_text'=>'다음',
        'add_args'=> [], // 퍼말링크/일반 모두 OK
      ]);
      if($links){
        echo '<div class="bwos-pg">';
        foreach($links as $l) echo $l.' ';
        echo '</div>';
      }
    ?>
  </div>
  <?php return ob_get_clean();
});
add_shortcode('bw_my_questions', fn($a)=>do_shortcode('[bw_owner_list]'));

`$nl

`$nl
===== FILE: pack-code.ps1 (4063 bytes, 113 lines) =====
`$ext
param(
  [string]$Root = ".",
  [string]$Out = "codepack.txt",
  [string]$IncludeExt = ".php,.js,.ts,.css,.scss,.html,.htm,.json,.md,.yml,.yaml,.xml,.sh,.ps1,.ini,.txt,.sql,.twig,.vue",
  # 제외할 디렉터리들 (쉼표로 구분)
  [string]$ExcludeDirs = "node_modules,dist,build,vendor,.git,.github,.idea,.vscode,.next,.cache,growth-checklist\plugin-update-checker",
  # 제외할 파일 패턴들 (쉼표로 구분)
  [string]$ExcludeFiles = "*.min.js,*.min.css,*.map,*.lock,*.zip,*.tar,*.gz,*.png,*.jpg,*.jpeg,*.gif,*.webp,*.svg,*.woff,*.woff2,*.ttf,*.eot,*.pdf",
  # 용량 한도
  [int]$MaxFileBytes = 1000000,    # 파일당 최대 1MB
  [int]$MaxTotalBytes = 20000000,  # 전체 최대 20MB
  # 변경 파일만 모드
  [switch]$ChangedOnly,
  [string]$GitRange = ""
)

$ErrorActionPreference = "Stop"
$Root = (Resolve-Path $Root).Path
$include = $IncludeExt.Split(",") | ForEach-Object { $_.Trim().ToLower() } | Where-Object { $_ -ne "" }
$exDirs  = $ExcludeDirs.Split(",")  | ForEach-Object { $_.Trim() }        | Where-Object { $_ -ne "" }
$exFiles = $ExcludeFiles.Split(",") | ForEach-Object { $_.Trim() }        | Where-Object { $_ -ne "" }

function IsTextExt($path) {
  $ext = [IO.Path]::GetExtension($path).ToLower()
  return $include -contains $ext
}
function IsExcludedDir($path) {
  foreach ($d in $exDirs) {
    if ($path -like "*$d*") { return $true }
  }
  return $false
}
function IsExcludedFile($file) {
  foreach ($p in $exFiles) {
    if ([IO.Path]::GetFileName($file) -like $p) { return $true }
  }
  return $false
}

# 파일 목록 수집
$files = @()
if ($ChangedOnly) {
  $gitArgs = @("diff","--name-only")
  if ($GitRange) { $gitArgs += $GitRange }
  $changed = & git @gitArgs 2>$null
  foreach ($rel in $changed) {
    $p = Join-Path $Root $rel
    if (Test-Path $p -PathType Leaf) { $files += (Resolve-Path $p).Path }
  }
} else {
  $files = Get-ChildItem -Path $Root -Recurse -File | ForEach-Object { $_.FullName }
}

# 필터링
$files = $files | Where-Object {
  -not (IsExcludedDir $_) -and
  -not (IsExcludedFile $_) -and
  (IsTextExt $_)
}

# 출력 빌드
$sb = New-Object System.Text.StringBuilder
$totalBytes = 0
$nl = [Environment]::NewLine

# 상단 메타
try {
  $repoUrl = (git -C $Root config --get remote.origin.url)
  $branch  = (git -C $Root rev-parse --abbrev-ref HEAD)
  $tag     = (git -C $Root describe --tags --abbrev=0) 2>$null
  $commit  = (git -C $Root rev-parse --short HEAD)
  $time    = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
  $null = $sb.AppendLine("===== META =====")
  $null = $sb.AppendLine("Repo: $repoUrl")
  $null = $sb.AppendLine("Branch: $branch  |  Tag: $tag  |  Commit: $commit")
  $null = $sb.AppendLine("Generated: $time")
  $null = $sb.AppendLine("")
} catch {}

foreach ($f in $files) {
  try {
    $fi = Get-Item $f
    $size = $fi.Length
    if ($size -gt $MaxFileBytes) {
      $rel = $f.Substring($Root.Length+1)
      $null = $sb.AppendLine("===== FILE: $rel ($size bytes) SKIPPED: > $MaxFileBytes =====$nl")
      continue
    }
    if (($totalBytes + $size) -gt $MaxTotalBytes) {
      $null = $sb.AppendLine("===== STOP: total size would exceed $MaxTotalBytes bytes. Remaining files omitted. =====$nl")
      break
    }

    $rel = $f.Substring($Root.Length+1)
    $content = (Get-Content -Path $f -Raw -Encoding UTF8)
    $lineCount = ($content -split "`r?`n").Count
    $ext = [IO.Path]::GetExtension($f).TrimStart(".").ToLower()
    if (-not $ext) { $ext = "text" }

    $null = $sb.AppendLine("===== FILE: $rel ($size bytes, $lineCount lines) =====")
    $null = $sb.AppendLine("```$ext")
    $null = $sb.AppendLine($content)
    $null = $sb.AppendLine("```$nl")

    $totalBytes += $size
  } catch {
    $null = $sb.AppendLine("===== FILE: $f ERROR: $($_.Exception.Message) =====$nl")
  }
}

[IO.File]::WriteAllText((Join-Path $Root $Out), $sb.ToString(), [Text.Encoding]::UTF8)
"생성 완료: $(Join-Path $Root $Out)  (총 approx $totalBytes bytes)"

`$nl
===== FILE: bw-owner-suite-acf\bw-owner-suite-acf.php (1308 bytes, 33 lines) =====
`$ext
<?php
/**
 * Plugin Name: BW Owner Suite (light)
 * Description: 대표 질문지 + 회원가입(대표 전용) + 마이페이지. ACF 기반 경량 플러그인.
 * Version: 1.0.4
 * Author: Berrywalk
 */
if (!defined('ABSPATH')) exit;

define('BWOS_VER', '1.2.2');
define('BWOS_DIR', plugin_dir_path(__FILE__));
define('BWOS_URL', plugin_dir_url(__FILE__));

// 텔레그램
define('BW_TG_BOT_TOKEN', '8060380419:AAFDlmr9TmX1K5Ocagl6WafN5s2O6oVnvdw');  // BotFather에서 발급
define('BW_TG_CHAT_ID',  '@berrywalk_ownerfeedback');                  // 개인(@me) 또는 채널/그룹 ID

require_once BWOS_DIR.'includes/cpt-admin.php';
require_once BWOS_DIR.'includes/form.php';
require_once BWOS_DIR.'includes/signup.php';
require_once BWOS_DIR.'includes/save.php';
require_once BWOS_DIR.'includes/view-list.php';
require_once BWOS_DIR.'includes/acf-fields.php'; // 관리자 ACF 메타박스(5문항)

add_action('wp_enqueue_scripts', function(){
  $css = BWOS_URL.'assets/owner-form.css';
  $js  = BWOS_URL.'assets/owner-form.js';
  wp_register_style ('bwos-form', $css, [], BWOS_VER);
  wp_register_style ('bwf-forms', $css, [], BWOS_VER); // alias
  wp_register_script('bwos-form', $js,  ['jquery'], BWOS_VER, true);
  wp_register_script('bwf-forms', $js,  ['jquery'], BWOS_VER, true); // alias
});

`$nl
===== FILE: bw-owner-suite-acf\README.md (1409 bytes, 40 lines) =====
`$ext
# BW Owner Suite (ACF Minimal)

워드프레스 표준 + ACF만 사용하여
- 회원가입 → 프로필 수정
- 대표 질문(CPT) 작성/수정/보기/목록/복제/삭제
- 저장 알림(메일/텔레그램)

을 한 번에 처리하는 경량 플러그인입니다.

## 설치
1) `Advanced Custom Fields`(ACF) 플러그인을 활성화
2) 워드프레스 관리자 → 플러그인 → 새로 추가 → 플러그인 업로드 → 이 ZIP 업로드 후 활성화
3) 활성화 즉시 아래 페이지가 자동 생성됩니다.
   - `/owner-questions/` 작성
   - `/owner-edit/?id=글ID` 수정
   - `/my-question-view/?id=글ID` 보기
   - `/my-questions/` 내 저장본(보기/수정/복제/삭제)
   - `/my-profile/` 마이프로필
   - `/register/` 회원가입

## 텔레그램 알림(선택)
`wp-config.php`에 아래 상수를 추가하면 저장 시 텔레그램 알림이 전송됩니다.

```php
define('BWF_TG_BOT','123456:ABC...');       // 봇 토큰
define('BWF_TG_CHAT','-1001234567890');     // 채팅 ID
```

## 짧은코드(Shortcodes)
- [bw_register]
- [bw_profile_form]
- [bw_owner_form_acf]
- [bw_owner_edit id="123"]  (또는 /owner-edit/?id=123)
- [bwf_owner_view id="123"]
- [bw_my_questions]

## 주의
- 플러그인 동작을 위해 ACF가 필요합니다.
- 데이터는 CPT `bwf_owner_answer`에 저장되며 리비전이 활성화되어 되돌리기가 가능합니다.

`$nl
===== FILE: bw-owner-suite-acf\assets\owner-form.css (5415 bytes, 109 lines) =====
`$ext
/* /assets/owner-form.css */

/* ====== Base ====== */
:root{
  --bw-font:17.5px;
  --bw-muted:#64748b;
  --bw-border:#e5e7eb;
  --bw-accent:#6366f1;
  --bw-ok:#16a34a;
  --bw-warn:#ef4444;
  --bw-bg:#f8fafc;
}
body{font-size:var(--bw-font);background:var(--bw-bg)}
.bwos-wrap{max-width:920px;margin:40px auto;padding:0 16px}               /* ⬆ 여백 확대 */
.bwf-title{font-size:30px;line-height:1.25;margin:22px 0 16px}
.bwf-help{color:#0f172a;margin:0 0 18px}

/* ====== Sticky progress (카드형, 배경/테두리 추가) ====== */
.bwos-progress{
  position:sticky;top:64px;z-index:1000;margin:0 0 18px;
  background:#ffffff; border:1px solid var(--bw-border); border-radius:14px;
  padding:12px 14px; box-shadow:0 6px 18px rgba(2,6,23,.06);
}
body.admin-bar .bwos-progress{top:96px}
.bwos-progress .bar{height:10px;background:#f2f4f7;border-radius:999px;overflow:hidden}
.bwos-progress .bar>span{display:block;height:100%;width:0%;background:linear-gradient(90deg,#22d3ee,#6366f1);border-radius:999px;transition:width .2s}
.bwos-progress .status{font-size:12px;color:#334155;margin-top:8px}

/* ====== Field ====== */
.bwf-field{margin:28px 0}                                                  /* ⬆ 여백 확대 */
.bwf-field label{display:block;font-weight:700;margin:0 0 14px;font-size:18px}
.bwf-field textarea,
.bwf-field input[type="text"],
.bwf-field input[type="number"],
.bwf-field input[type="email"],
.bwf-field input[type="tel"],
.bwf-field input[type="url"],
.bwf-field select{
  width:100%;box-sizing:border-box;padding:13px 14px;border:1px solid #d1d5db;border-radius:12px;background:#fff;font-size:16.5px;outline:none
}
.bwf-field textarea:focus,
.bwf-field input:focus,
.bwf-field select:focus{border-color:var(--bw-accent);box-shadow:0 0 0 3px rgba(99,102,241,.15)}

.bwos-field.bwos-error textarea,
.bwos-field.bwos-error input,
.bwos-field.bwos-error select{border-color:var(--bw-warn);background:#fff1f2}
.bwf-invalid{border-color:var(--bw-warn) !important;background:#fff1f2 !important}

/* ====== 설명/예시 – 한국형 카드 스타일 ====== */
.bwf-desc, .bwf-examples{
  margin:10px 0 10px;padding:12px 14px;border:1px dashed #dbe1ea;border-radius:12px;background:#fbfdff
}
.bwf-desc::before{
  content:"설명"; display:inline-block; font-size:12px; font-weight:800; color:#0ea5e9;
  background:#e6f6fb; border:1px solid #bde7f4; border-radius:999px; padding:2px 8px; margin-right:8px
}
.bwf-examples::before{
  content:"예시"; display:inline-block; font-size:12px; font-weight:800; color:#6366f1;
  background:#eef0ff; border:1px solid #dfe3ff; border-radius:999px; padding:2px 8px; margin-right:8px
}
.bwf-examples ul,.bwf-examples ol{margin:6px 0 0 18px}

/* ====== Counter ====== */
.bwos-count{
  display:inline-block;margin-top:8px;font-size:12px;font-weight:700;
  color:var(--bw-muted);background:#f3f4f6;border:1px solid #e5e7eb;border-radius:999px;padding:4px 8px
}
.bwos-count.ok{color:#065f46;background:#ecfdf5;border-color:#bbf7d0}
.bwos-count.need{color:#7c2d12;background:#fff7ed;border-color:#fed7aa}

/* ====== Buttons ====== */
.bwf-actions{display:flex;gap:10px;align-items:center;justify-content:center;margin-top:20px}
.bwf-btn{display:inline-block;padding:12px 18px;border-radius:14px;border:none;background:var(--bw-accent);color:#fff;text-decoration:none;font-weight:700}
.bwf-btn-secondary{display:inline-block;padding:12px 18px;border-radius:14px;border:1px solid #cbd5e1;background:#fff;color:#0f172a;text-decoration:none;font-weight:700}


/* ====== Modal (공용) ====== */
.bwos-modal, .bwf-modal{
  position:fixed;inset:0;display:none;align-items:flex-start;justify-content:center;padding-top:18vh;background:rgba(0,0,0,.45);z-index:100000
}
body.admin-bar .bwos-modal, body.admin-bar .bwf-modal{padding-top:calc(18vh + 32px)}
.bwos-modal.is-open, .bwf-modal.is-open{display:flex}
.bwos-modal-inner, .bwf-modal .bwf-modal__card{
  background:#fff;max-width:560px;width:92vw;padding:22px;border-radius:16px;box-shadow:0 22px 44px rgba(2,6,23,.18)
}
.bwos-modal-inner h4, .bwf-modal h3{margin:0 0 10px;font-size:18px}
.bwos-modal-inner p, .bwf-modal p{margin:0 0 12px;color:#334155}
.bwf-modal__list{margin:6px 0 0 18px;font-size:14px;color:#1f2937}

/* ====== List / View ====== */
.bwf-card{border:1px solid var(--bw-border);background:#fff;border-radius:12px;padding:12px 14px}

/* ====== Signup grid ====== */
.bwf-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px 14px}
.bwf-col-full{grid-column:1/-1}
@media (max-width:720px){.bwf-grid{grid-template-columns:1fr}}
.bwf-hidden{display:none}

/* 마이페이지 카드 & 페이지네이션 */
.bwos-list{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:16px}
@media (max-width:920px){.bwos-list{grid-template-columns:1fr}}
.bwos-card{border:1px solid #e5e7eb;border-radius:14px;padding:14px 16px;background:#fff;box-shadow:0 6px 14px rgba(2,6,23,.05)}
.bwos-card h4{margin:0 0 6px;font-size:17px}
.bwos-card .meta{font-size:12px;color:#64748b;margin-bottom:10px}
.bwos-card .row a{display:inline-block;padding:8px 12px;border-radius:10px;background:#f1f5f9;text-decoration:none;color:#0f172a}
.bwos-pg{margin:18px 0 8px;text-align:center}
.bwos-pg .page-numbers{display:inline-block;padding:8px 12px;border:1px solid #e5e7eb;border-radius:10px;margin:0 3px;text-decoration:none;color:#0f172a}
.bwos-pg .current{background:#6366f1;color:#fff;border-color:#6366f1}
`$nl
===== FILE: bw-owner-suite-acf\assets\owner-form.js (4147 bytes, 94 lines) =====
`$ext
/* /assets/owner-form.js  (카운터 텍스트 – "몇자 남음" 친절 메시지로) */
(function($){
  if(!$ || !$('.bwos-form').length) return;

  const $form = $('.bwos-form').first();
  const $progress = $form.find('.bwos-progress');
  const reqs = []; let submitted=false;

  function updateProgress(){
    const total=reqs.length, done=reqs.filter(r=>r.valid()).length, pct=total?Math.round(done/total*100):0;
    $progress.find('.bar>span').css('width',pct+'%');
    $progress.find('.status').text('작성 '+done+'/'+total+' ('+pct+'%)');
  }

  function wire($wrap){
    const min = parseInt($wrap.data('min')||200,10);
    const $subs = $wrap.find('.bwf-sub textarea');
    const isGroup = $subs.length>0;
    let $cnt = $wrap.find('.bwos-count'); if(!$cnt.length) $cnt=$('<small class="bwos-count"></small>').appendTo($wrap);

    const setError = bad => $wrap.toggleClass('bwos-error', submitted && !!bad);
    const valid = ()=>{
      if(isGroup){ let ok=true; $subs.each(function(){ if(($(this).val()||'').trim()==='') ok=false; }); return ok; }
      return (($wrap.find('textarea,input[type="text"]').first().val()||'').trim().length >= min);
    };

    const update = ()=>{
      if(isGroup){
        let anyEmpty=false; $subs.each(function(){ if(($(this).val()||'').trim()==='') anyEmpty=true; });
        $cnt.text(anyEmpty ? '질문 3개 모두 작성' : '충족').toggleClass('need',anyEmpty).toggleClass('ok',!anyEmpty);
        setError(anyEmpty);
      }else{
        const v=($wrap.find('textarea,input[type="text"]').first().val()||'').trim();
        const diff = min - v.length;
        if(diff>0){ $cnt.text(diff+'자 남음'); $cnt.removeClass('ok').addClass('need'); }
        else      { $cnt.text('충족'); $cnt.removeClass('need').addClass('ok'); }
        setError(v.length < min);
      }
      updateProgress();
    };

    (isGroup ? $subs : $wrap.find('textarea,input[type="text"]').first()).on('input blur', update);
    reqs.push({wrap:$wrap, valid, update, min}); update();
  }

  $form.find('.bwos-required').each(function(){ wire($(this)); });
  updateProgress();

  const $modal=$('<div class="bwos-modal"><div class="bwos-modal-inner"><h4>입력이 필요한 항목이 있어요</h4><p>아래 항목을 확인해 주세요.</p><ul class="bwf-modal__list"></ul><button type="button" class="bwf-btn-secondary ok">확인</button></div></div>').appendTo('body');
  $modal.on('click','.ok',()=> $modal.removeClass('is-open'));

  let locked=false;
  $form.on('submit',function(e){
    submitted=true; let bad=false; const items=[];
    reqs.forEach(r=>{
      if(!r.valid()){
        bad=true; const lab=r.wrap.find('label').first().text().replace(/\*.*$/,'').trim();
        if(r.wrap.find('.bwf-sub').length){ items.push('· '+lab+' — 3개 질문 모두 작성'); }
        else{
          const len=($r=r.wrap.find('textarea,input[type="text"]').first()).val().trim().length;
          const diff=(r.min||200)-len; items.push('· '+lab+' — 최소 글자수 부족 ('+diff+'자 남음)');
        }
        r.update();
      }
    });
    if(bad){
      e.preventDefault();
      const ul=$modal.find('.bwf-modal__list').empty();
      items.forEach(t=> $('<li/>').text(t).appendTo(ul));
      $modal.addClass('is-open');
      const $first=$form.find('.bwos-error').first(); if($first.length) $('html,body').animate({scrollTop:$first.offset().top-120},180);
      return;
    }
    if(locked){ e.preventDefault(); return; }
    locked=true; $form.find('.bwos-submit').prop('disabled',true).text('저장 중…');
    setTimeout(()=>{ locked=false; $form.find('.bwos-submit').prop('disabled',false).text('저장'); }, 6000);
  });
})(jQuery);

/* === Tab 이동: textarea에서 Tab 누르면 다음 필드로 포커스 === */
(function($){
  const $areas = $('.bwos-form textarea:visible');
  $areas.on('keydown', function(e){
    if(e.key === 'Tab' && !e.shiftKey){
      const list = $('.bwos-form textarea:visible');
      const idx = list.index(this);
      if(idx > -1 && idx < list.length - 1){
        e.preventDefault();
        list.eq(idx + 1).focus();
      }
    }
  });
})(jQuery);

`$nl
===== FILE: bw-owner-suite-acf\includes\acf-fields.php (3509 bytes, 76 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

add_action('acf/init', function(){
  if (!function_exists('acf_add_local_field_group')) return;

  acf_add_local_field_group([
    'key'=>'group_bwos_owner_v5','title'=>'대표 질문지',
    'fields'=>[
      ['key'=>'f_problem','label'=>'1) 지금, 우리 사업의 가장 큰 고민은 무엇인가요?','name'=>'_acf_problem','type'=>'textarea','required'=>1,'rows'=>8,'instructions'=>'최소 200자 권장'],
      ['key'=>'f_value','label'=>'2) 우리 서비스의 핵심 가치는 무엇인가요?','name'=>'_acf_value','type'=>'textarea','required'=>1,'rows'=>6],
      ['key'=>'f_whom','label'=>'3) 누가 이용해야 하나요? 왜 우리인가요?','name'=>'_acf_ideal_customer','type'=>'textarea','required'=>1,'rows'=>6],
      ['key'=>'f_ask1','label'=>'4-1) 고객에게 묻고 싶은 질문 #1','name'=>'_acf_cq1','type'=>'text'],
      ['key'=>'f_ask2','label'=>'4-2) 고객에게 묻고 싶은 질문 #2','name'=>'_acf_cq2','type'=>'text'],
      ['key'=>'f_ask3','label'=>'4-3) 고객에게 묻고 싶은 질문 #3','name'=>'_acf_cq3','type'=>'text'],
      ['key'=>'f_comp','label'=>'5) 경쟁사 대비 차별점','name'=>'_acf_competitors','type'=>'textarea','required'=>1,'rows'=>6],
    ],
    'location'=>[[['param'=>'post_type','operator'=>'==','value'=>'bwf_owner_answer']]],
    'position'=>'normal','style'=>'default','active'=>true,
  ]);
});


/** 200자 필드 서버 검증 */
add_filter('acf/validate_value', function($valid, $value, $field){
  if ($valid !== true) return $valid;
  $min200 = ['problem','core_value','target_customer','differentiation','sales_blockers','current_channels','growth_goal','next_action'];
  if (in_array($field['name'] ?? '', $min200, true)) {
    if (mb_strlen(trim((string)$value)) < 200) return '최소 200자 이상 작성해 주세요.';
  }
  return $valid;
}, 10, 3);
/* ------- ACF <-> bwf_answers 동기화 ------- */
function bwos_acf_meta_keys(){ // ACF 메타키(name) 매핑
  return [
    '_acf_problem'       => ['id'=>'problem'],
    '_acf_value'         => ['id'=>'value'],
    '_acf_ideal_customer'=> ['id'=>'ideal_customer'],
    '_acf_cq1'           => ['id'=>'ask3','sub'=>'q1'],
    '_acf_cq2'           => ['id'=>'ask3','sub'=>'q2'],
    '_acf_cq3'           => ['id'=>'ask3','sub'=>'q3'],
    '_acf_competitors'   => ['id'=>'competitors'],
  ];
}

/* 편집 화면 로드시 ACF 메타 채워넣기(관리자에서 비어 보이던 문제 해결) */
add_action('load-post.php', function(){
  $pid = isset($_GET['post']) ? (int)$_GET['post'] : 0;
  if(!$pid) return;
  $p = get_post($pid);
  if(!$p || $p->post_type!=='bwf_owner_answer') return;

  $ans = (array)get_post_meta($pid,'bwf_answers',true);
  foreach(bwos_acf_meta_keys() as $meta=>$m){
    $val = '';
    if(empty($m['sub'])) $val = (string)($ans[$m['id']] ?? '');
    else                 $val = (string)($ans[$m['id']][$m['sub']] ?? '');
    update_post_meta($pid, $meta, $val);
  }
});

/* 저장 시 ACF 값으로 bwf_answers 재생성(양방향 동기화) */
add_action('save_post_bwf_owner_answer', function($post_id){
  if(defined('DOING_AUTOSAVE') && DOING_AUTOSAVE) return;
  $ans = [];
  foreach(bwos_acf_meta_keys() as $meta=>$m){
    $v = (string)get_post_meta($post_id,$meta,true);
    if(empty($m['sub'])) $ans[$m['id']] = $v;
    else {
      if(empty($ans[$m['id']])) $ans[$m['id']] = [];
      $ans[$m['id']][$m['sub']] = $v;
    }
  }
  if($ans) update_post_meta($post_id,'bwf_answers',$ans);
}, 20);

`$nl
===== FILE: bw-owner-suite-acf\includes\cpt-admin.php (871 bytes, 21 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

add_action('init', function(){
  register_post_type('bwf_owner_answer', [
    'label'=>'대표 질문지','labels'=>['name'=>'대표 질문지','add_new_item'=>'새 대표 질문 생성','edit_item'=>'대표 질문 편집'],
    'public'=>false,'exclude_from_search'=>true,'publicly_queryable'=>false,'show_ui'=>true,'show_in_menu'=>true,
    'menu_icon'=>'dashicons-editor-help','supports'=>['author','custom-fields'],'map_meta_cap'=>true,
  ]);
});

add_filter('manage_bwf_owner_answer_posts_columns', function($c){
  return ['cb'=>$c['cb'],'title'=>'제목','author'=>'작성자','created'=>'저장 시각'];
});
add_action('manage_bwf_owner_answer_posts_custom_column', function($col,$post_id){
  if($col==='created'){
    $ts = get_post_timestamp($post_id,'date');
    echo esc_html( wp_date('Y-m-d H:i', $ts) );
  }
}, 10, 2);

`$nl
===== FILE: bw-owner-suite-acf\includes\form.php (7759 bytes, 127 lines) =====
`$ext
<?php
/* /includes/form.php (핵심 변경만) */
if (!defined('ABSPATH')) exit;

/** 공용 URL (중복 선언 방지) */
if (!function_exists('bwf_owner_view_url'))  { function bwf_owner_view_url(){ return home_url('/my-question-view/'); } }
if (!function_exists('bwf_owner_edit_url'))  { function bwf_owner_edit_url(){ return home_url('/owner-edit/'); } }
if (!function_exists('bwf_owner_list_url'))  { function bwf_owner_list_url(){ return home_url('/my-questions/'); } }


function bwf_owner_cfg(){
  return [
    'title'=>'대표님 핵심 질문지',
    'min'=>200,
    'intro'=>'사업의 본질을 파악하고 고객에게 정말 묻고 싶은 질문을 구체화합니다. 각 문항은 최소 <strong>{MIN}</strong>자입니다. <em>(단, <strong>“고객에게 물어보고 싶은 3가지”</strong>는 글자수 제한 없음)</em>',
    'qs'=>[
      [
        'id'=>'problem','label'=>'1. 지금, 우리 사업의 가장 큰 고민은 무엇인가요?','required'=>true,'min'=>200,
        'desc'=>'성장이 정체되었다고 느낀 **구체적 상황**을 한두 문장으로. 숫자/행동 기반이면 좋아요.',
        'ex'=>'<ul><li>“클릭은 많은데 체류 30초 미만 이탈이 많아요.”</li><li>“재구매율이 낮아 신규 유입 의존도가 큽니다.”</li></ul>'
      ],
      [
        'id'=>'value','label'=>'2. 우리 서비스는 고객의 어떤 문제를 해결하나요?','required'=>true,'min'=>200,
        'desc'=>'고객의 **전/후 변화**를 한 문장으로 요약.',
        'ex'=>'<ol><li>“반복 서류작업을 5분 자동화 → 본업 집중”</li><li>“바쁜 직장인도 집밥처럼 건강한 한 끼 확보”</li></ol>'
      ],
      [
        'id'=>'ideal_customer','label'=>'3. 누가 이용해야 하나요? 왜 우리여야 하나요?','required'=>true,'min'=>200,
        'desc'=>'핵심 타깃의 특징 + 우리를 선택할 **결정적 이유**.',
        'ex'=>'<p>“시간/비용이 부족한 20대 대학생 → 15분 홈트 영상으로 꾸준함 확보.”</p>'
      ],
      [
        'id'=>'ask3','type'=>'group','label'=>'4. 고객에게 물어보고 싶은 3가지','required'=>true,
        'desc'=>'실제 경험 기반으로 **구체적인 질문 3개**를 작성.',
        'ex'=>'<p><strong>예)</strong> 첫인상/결심포인트/아쉬운점</p>',
        'sub'=>[
          ['id'=>'q1','label'=>'질문 1','ph'=>'예: 어떻게 알게 되었나요?','required'=>true],
          ['id'=>'q2','label'=>'질문 2','ph'=>'예: 결심 포인트는 무엇이었나요?','required'=>true],
          ['id'=>'q3','label'=>'질문 3','ph'=>'예: 가장 아쉬웠던 점은?','required'=>true],
        ]
      ],
      [
        'id'=>'competitors','label'=>'5. 경쟁사와의 차별점은?','required'=>true,'min'=>200,
        'desc'=>'주요 경쟁사 1~2곳과 비교해 강/약점 정리.',
        'ex'=>'<p>“A는 저렴하지만 CS 느림 / B는 비싸지만 품질 우수 → 우리는 적정가+빠른 CS”</p>'
      ],
    ]
  ];
}

function bwf_owner_view_url(){ return home_url('/my-question-view/'); }
function bwf_owner_edit_url(){ return home_url('/owner-edit/'); }
function bwf_owner_list_url(){ return home_url('/my-questions/'); }

function bwf_render_owner_form($args=[]){
  $cfg=bwf_owner_cfg(); $min=(int)$cfg['min']; $mode=$args['mode']??'create';
  $post=$args['post']??null; $saved=$args['saved']??[]; $errs=$args['errs']??[];
  if($mode==='edit' && $post){ $existing=(array)get_post_meta($post->ID,'bwf_answers',true); $saved=$saved ?: $existing; }
  wp_enqueue_style('bwf-forms'); wp_enqueue_script('bwos-form');

  ob_start(); ?>
  <form id="bwfOwnerForm" class="bwf-form bwos-form" method="post" action="<?php echo esc_url(admin_url('admin-post.php')); ?>" novalidate>
    <input type="hidden" name="action" value="bwf_owner_save">
    <?php wp_nonce_field('bwf_owner_save','bwf_owner_nonce'); ?>
    <input type="hidden" name="post_id" value="<?php echo $post ? (int)$post->ID : 0; ?>">

    <div class="bwos-progress"><div class="bar"><span></span></div><div class="status">작성 0/0 (0%)</div></div>

    <h2 class="bwf-title"><?php echo esc_html($cfg['title']); ?></h2>
    <p class="bwf-help"><?php echo str_replace('{MIN}', $min, $cfg['intro']); ?></p>

    <?php foreach($cfg['qs'] as $q): $type=$q['type']??'textarea'; $id=$q['id']; ?>
      <div class="bwf-field bwos-field bwos-required" data-min="<?php echo (int)($q['min']??$min); ?>">
        <label><?php echo esc_html($q['label']); ?><?php if(!empty($q['required'])): ?><span class="bwf-required">*</span><?php endif; ?></label>

        <?php if(!empty($q['desc'])): ?><div class="bwf-desc"><?php echo wp_kses_post($q['desc']); ?></div><?php endif; ?>
        <?php if(!empty($q['ex'])):   ?><div class="bwf-examples"><?php echo wp_kses_post($q['ex']); ?></div><?php endif; ?>

        <?php if($type==='group'): ?>
          <?php foreach(($q['sub']??[]) as $sub): $sid=$sub['id']; $v=$saved[$id][$sid]??''; ?>
            <div class="bwf-sub">
              <div class="bwf-help" style="margin:6px 0 6px;"><?php echo esc_html($sub['label']); ?></div>
              <textarea name="q[<?php echo esc_attr($id); ?>][<?php echo esc_attr($sid); ?>]" rows="4" placeholder="<?php echo esc_attr($sub['ph']??''); ?>"><?php echo esc_textarea($v); ?></textarea>
            </div>
          <?php endforeach; ?>
        <?php else: $v=$saved[$id]??''; ?>
          <textarea name="q[<?php echo esc_attr($id); ?>]" rows="6"><?php echo esc_textarea($v); ?></textarea>
          <small class="bwos-count">0/<?php echo (int)($q['min']??$min); ?></small>
        <?php endif; ?>
      </div>
    <?php endforeach; ?>

    <div class="bwf-actions">
      <button type="submit" class="bwf-btn bwos-submit"><?php echo $mode==='edit'?'수정 저장':'저장'; ?></button>
      <!-- 마이페이지 버튼 제거 요청 반영 -->
    </div>
  </form>
  <?php return ob_get_clean();
}

add_shortcode('bwf_owner_questions', function(){
  wp_enqueue_style('bwf-forms');

  if (!is_user_logged_in()){
    wp_enqueue_style('bwf-forms');
    $signup = esc_url('https://berrywalk.co.kr/bwf-owner-signup/');
    $login  = esc_url( wp_login_url( home_url('/owner-questions/') ) );
    return '<div class="bwos-wrap"><div class="bwf-need-login"><p>대표님 핵심 질문지를 작성하려면 로그인이 필요합니다.</p><div class="bwf-login-actions"><a class="bwf-btn" href="'.$login.'">로그인하러 가기</a><a class="bwf-btn-secondary" href="'.$signup.'">회원가입하러 가기</a></div></div></div>';
  }
  $uid=get_current_user_id();
  $old=get_transient('bwf_owner_old_'.$uid)?:[]; delete_transient('bwf_owner_old_'.$uid);
  $err=get_transient('bwf_owner_err_'.$uid)?:[]; delete_transient('bwf_owner_err_'.$uid);
  return bwf_render_owner_form(['mode'=>'create','saved'=>$old,'errs'=>$err]);
});
add_shortcode('bw_owner_form', fn()=>do_shortcode('[bwf_owner_questions]'));
add_shortcode('bw_owner_edit', function($atts){
  if (!is_user_logged_in()) return '<div class="bwf-form">로그인이 필요합니다.</div>';
  $id=(int)($atts['id']??($_GET['id']??0));
  $post=get_post($id);
  if(!$post || $post->post_type!=='bwf_owner_answer') return '<div class="bwf-form">데이터가 없습니다.</div>';
  if((int)$post->post_author!==get_current_user_id() && !current_user_can('edit_post',$id)) return '<div class="bwf-form">권한이 없습니다.</div>';
  $uid=get_current_user_id();
  $old=get_transient('bwf_owner_old_'.$uid)?:[]; delete_transient('bwf_owner_old_'.$uid);
  $err=get_transient('bwf_owner_err_'.$uid)?:[]; delete_transient('bwf_owner_err_'.$uid);
  return bwf_render_owner_form(['mode'=>'edit','post'=>$post,'saved'=>$old,'errs'=>$err]);
});

`$nl
===== FILE: bw-owner-suite-acf\includes\save.php (6209 bytes, 175 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

add_action('admin_post_bwf_owner_save','bwf_owner_handle_save');
add_action('admin_post_nopriv_bwf_owner_save','bwf_owner_handle_save');

function bwf_owner_handle_save(){
  if(!is_user_logged_in()) { wp_safe_redirect(home_url('/')); exit; }
  if(empty($_POST['bwf_owner_nonce']) || !wp_verify_nonce($_POST['bwf_owner_nonce'],'bwf_owner_save')){
    wp_safe_redirect(wp_get_referer()?:home_url('/')); exit;
  }

  $uid  = get_current_user_id();
  $lock = 'bwf_owner_lock_'.$uid;
  if(get_transient($lock)) { wp_safe_redirect(home_url('/my-questions/')); exit; }
  set_transient($lock,1,8); // 8초 중복방지

  $cfg = bwf_owner_cfg();
  $min = (int)$cfg['min'];
  $src = $_POST['q'] ?? [];
  $ans = []; $err=[];

  foreach($cfg['qs'] as $q){
    $id=$q['id']; $type=$q['type']??'textarea';
    $req=!empty($q['required']); $m=(int)($q['min']??$min);

    if($type==='group'){
      $ans[$id]=[];
      foreach(($q['sub']??[]) as $sub){
        $sid=$sub['id']; $v=trim((string)($src[$id][$sid]??''));
        $ans[$id][$sid]=sanitize_textarea_field($v);
        if(!empty($sub['required']) && $v===''){ $err[$id][$sid]=true; }
      }
      if($req && !empty($err[$id])){/*표시용*/}
    }else{
      $v=trim((string)($src[$id]??'')); $ans[$id]=sanitize_textarea_field($v);
      if($req && mb_strlen($v)<$m){ $err[$id]=true; }
    }
  }

  if($err){
    set_transient('bwf_owner_old_'.$uid,$src,60);
    set_transient('bwf_owner_err_'.$uid,$err,60);
    delete_transient($lock);
    wp_safe_redirect(wp_get_referer()?:home_url('/owner-questions/')); exit;
  }

  $post_id = (int)($_POST['post_id']??0);
  $title   = '대표 질문지 - '.wp_date('Y-m-d H:i'); // 사이트 타임존

  if($post_id){
    $p=get_post($post_id);
    if($p && $p->post_type==='bwf_owner_answer' && ((int)$p->post_author===$uid || current_user_can('edit_post',$post_id))){
      update_post_meta($post_id,'bwf_answers',$ans);
      wp_update_post(['ID'=>$post_id,'post_title'=>$title,'post_status'=>'private']);
      delete_transient($lock);
      wp_safe_redirect(add_query_arg(['id'=>$post_id,'updated'=>1], bwf_owner_view_url())); exit;
    }
  }

  $new_id = wp_insert_post([
    'post_type'=>'bwf_owner_answer','post_status'=>'private','post_title'=>$title,'post_author'=>$uid,
  ], true);

  if(!is_wp_error($new_id)){
    update_post_meta($new_id,'bwf_answers',$ans);
    delete_transient($lock);
    wp_safe_redirect(add_query_arg(['id'=>$new_id,'saved'=>1], bwf_owner_view_url())); exit;
  }

  delete_transient($lock);
  wp_safe_redirect(bwf_owner_list_url()); exit;
}


function bwf_owner_save(){
  if(!is_user_logged_in()) wp_die('로그인이 필요합니다.');
  check_admin_referer('bwf_owner_save','bwf_owner_nonce');

  $uid     = get_current_user_id();
  $post_id = (int)($_POST['post_id']??0);
  $answers = (array)($_POST['q']??[]);

  // 표시용 제목 규칙: "회사명 - #N 피드백" (N은 해당 사용자의 저장본 카운트)
  $company = trim((string)get_user_meta($uid,'bw_company_name',true));
  if($company==='') $company = wp_get_current_user()->display_name;

  $is_new = $post_id === 0;
  if ($is_new) {
    // 현재 사용자 저장본 수 + 1
    $count = (int) (new WP_Query([
      'post_type'      => 'bwf_owner_answer',
      'post_status'    => 'any',
      'author'         => $uid,
      'fields'         => 'ids',
      'posts_per_page' => -1
    ]))->found_posts;
    $seq = $count + 1;
    $title = sprintf('%s - #%d 피드백', $company, $seq);
  } else {
    // 수정 시에는 기존 제목 유지
    $title = get_the_title($post_id);
  }

  $postarr = [
    'post_type'   => 'bwf_owner_answer',
    'post_status' => 'private',
    'post_title'  => $title,
    'post_author' => $uid,
  ];
  if($post_id){ $postarr['ID']=$post_id; $pid=wp_update_post($postarr, true); }
  else{ $pid=wp_insert_post($postarr, true); }

  if(is_wp_error($pid)) wp_die($pid);

  update_post_meta($pid,'bwf_answers',$answers);

  // 텔레그램 알림
  bwf_send_telegram_notice($pid, $uid, $is_new);

  wp_safe_redirect( add_query_arg(['id'=>$pid], home_url('/my-question-view/')) );
  exit;
}

/** 텔레그램 보내기 (핸들/URL/숫자ID 모두 허용, 자동 보정) */
function bwf_send_telegram_notice($post_id, $user_id, $is_new){
  if(!defined('BW_TG_BOT_TOKEN') || !defined('BW_TG_CHAT_ID')) return;

  // --- chat_id 정규화 ---
  $chat = trim(BW_TG_CHAT_ID);
  // t.me/ 링크면 핸들만 추출
  if (preg_match('~t\.me/([A-Za-z0-9_]+)$~i', $chat, $m)) $chat = '@'.$m[1];
  // 숫자 ID가 아니고 @가 없다면 자동으로 @ 붙임(채널 핸들 가정)
  if ($chat[0] !== '@' && $chat[0] !== '-' && !preg_match('~^-?\d+$~', $chat)) $chat = '@'.$chat;
  // 봇 아이디(…bot)로 넣은 경우는 실패하므로 메시지 전송을 중단
  if (preg_match('~bot$~i', $chat)) return;

  // --- 메시지 구성 ---
  $u = get_userdata($user_id);
  $company = get_user_meta($user_id,'bw_company_name',true);
  $phone   = get_user_meta($user_id,'bw_phone',true);
  $title   = $post_id ? get_the_title($post_id) : '테스트';
  $url     = $post_id ? add_query_arg(['id'=>$post_id], home_url('/my-question-view/')) : home_url('/');
  $verb    = $is_new ? '새 피드백 작성' : '피드백 수정';

  $lines = [
    "✅ {$verb}",
    "제목: {$title}",
    "대표: {$u->display_name} (@{$u->user_login})",
    "회사: " . ($company ?: '—'),
    "연락처: " . ($phone ?: '—'),
    "보기: {$url}"
  ];
  $text = implode("\n", $lines);

  $endpoint = 'https://api.telegram.org/bot'.BW_TG_BOT_TOKEN.'/sendMessage';
  $args = [
    'timeout' => 10,
    'body'    => [
      'chat_id'    => $chat,
      'text'       => $text,
      'parse_mode' => 'HTML',
      'disable_web_page_preview' => true,
    ]
  ];
  wp_remote_post($endpoint, $args);
}

/* 관리자 전용 테스트: /wp-admin/?bw_tg_test=1 접속 시 즉시 전송 */
add_action('admin_init', function(){
  if (current_user_can('manage_options') && isset($_GET['bw_tg_test'])) {
    bwf_send_telegram_notice(0, get_current_user_id(), true);
    wp_die('텔레그램 테스트 전송 완료(설정이 올바르면 채널에 메시지가 도착).');
  }
});
`$nl
===== FILE: bw-owner-suite-acf\includes\signup.php (13817 bytes, 246 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

/* 역할 보장 */
add_action('init', function(){
  if (!get_role('bw_owner')) add_role('bw_owner','대표',['read'=>true]);
});

/* --- 관리자 사용자 목록 컬럼 + 프로필 편집 영역 --- */
add_filter('manage_users_columns', function($cols){
  $cols['bw_owner_meta'] = '대표 인적사항';
  return $cols;
});
add_filter('manage_users_custom_column', function($out, $col, $user_id){
  if ($col !== 'bw_owner_meta') return $out;
  $u = get_userdata($user_id);
  $pairs = [
    '회사'     => get_user_meta($user_id,'bw_company_name',true),
    '업종'     => get_user_meta($user_id,'bw_industry',true),
    '직원 수'  => get_user_meta($user_id,'bw_employees',true),
    '휴대폰'   => get_user_meta($user_id,'bw_phone',true),
    '연락시간' => get_user_meta($user_id,'bw_contact_window',true),
    '유입경로' => get_user_meta($user_id,'bw_discover',true),
    '웹사이트' => $u ? $u->user_url : '',
  ];
  $html  = '<div style="line-height:1.5">';
  foreach($pairs as $k=>$v){
    $val = ($v === '' ? '—' : $v);
    $html .= '<div><strong>'.$k.'</strong> '.$val.'</div>';
  }
  $html .= '</div>';
  return $html;
}, 10, 3);

/* 프로필 편집 폼 */
add_action('show_user_profile','bwf_owner_profile_fields');
add_action('edit_user_profile','bwf_owner_profile_fields');
function bwf_owner_profile_fields($user){
  ?>
  <h2>대표 인적사항</h2>
  <table class="form-table" role="presentation">
    <tr><th><label>회사명</label></th><td><input type="text" name="bw_company_name" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_company_name',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>업종</label></th><td><input type="text" name="bw_industry" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_industry',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>직원 수</label></th><td><input type="number" name="bw_employees" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_employees',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>휴대폰</label></th><td><input type="text" name="bw_phone" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_phone',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>연락 가능한 시간대</label></th><td><input type="text" name="bw_contact_window" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_contact_window',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>알게 된 경로</label></th><td><input type="text" name="bw_discover" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_discover',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>웹사이트 URL</label></th><td><input type="url" name="user_url_bwf" value="<?php echo esc_attr(get_userdata($user->ID)->user_url); ?>" class="regular-text" placeholder="https://"></td></tr>
  </table>
  <?php
}
add_action('personal_options_update','bwf_owner_profile_save');
add_action('edit_user_profile_update','bwf_owner_profile_save');
function bwf_owner_profile_save($user_id){
  foreach(['bw_company_name','bw_industry','bw_employees','bw_phone','bw_contact_window','bw_discover'] as $k){
    if(isset($_POST[$k])) update_user_meta($user_id,$k, sanitize_text_field($_POST[$k]));
  }
  if(isset($_POST['user_url_bwf'])){
    wp_update_user(['ID'=>$user_id,'user_url'=>esc_url_raw($_POST['user_url_bwf'])]);
  }
}

/* --- 대표 회원가입 폼 --- */
add_shortcode('bwf_signup_representative', function () {
  wp_enqueue_style('bwf-forms');

  // 에러/이전값 표시
  $err = get_transient('bwf_signup_err'); delete_transient('bwf_signup_err');
  $old = get_transient('bwf_signup_old'); delete_transient('bwf_signup_old');

  if (is_user_logged_in()) {
    return '<div class="bwos-wrap" style="margin-top:40px;margin-bottom:24px">
      <p style="margin:0 0 18px;font-weight:700">로그인되었습니다.</p>
      <div class="bwf-actions" style="margin-top:0">
        <a class="bwf-btn" href="'.esc_url(home_url('/owner-questions/')).'">질문 등록하기</a>
        <a class="bwf-btn-secondary" href="'.esc_url(home_url('/my-questions/')).'">내 질문 목록 보기</a>
      </div>
    </div>';
  }

  ob_start(); ?>
  <form method="post" class="bwf-form bwf-grid" id="bwf-signup-rep" action="<?php echo esc_url(admin_url('admin-post.php')); ?>" novalidate>
    <input type="hidden" name="action" value="bwf_signup_rep">
    <?php wp_nonce_field('bwf_signup_rep','bwf_nonce'); ?>

    <h2 class="bwf-title bwf-col-full" style="margin-top:8px;margin-bottom:10px">대표 회원가입</h2>
    <?php if($err): ?>
      <div class="bwf-card bwf-col-full" style="border-color:#fecaca;background:#fff1f2;color:#7f1d1d;margin-bottom:10px"><?php echo esc_html($err); ?></div>
    <?php endif; ?>
    <p class="bwf-required-note bwf-col-full" style="margin-top:0;margin-bottom:14px">* 표시는 필수 입력</p>

    <div><label style="margin-bottom:14px">아이디 *</label><input type="text" name="user_login" value="<?php echo esc_attr($old['user_login']??''); ?>" pattern="[A-Za-z0-9_\.\-]{4,32}" required></div>
    <div><label style="margin-bottom:14px">비밀번호 *</label><input type="password" name="user_pass" required></div>
    <div><label style="margin-bottom:14px">이메일 *</label><input type="email" name="user_email" value="<?php echo esc_attr($old['user_email']??''); ?>" required></div>
    <div><label style="margin-bottom:14px">이름 *</label><input type="text" name="first_name" value="<?php echo esc_attr($old['first_name']??''); ?>" required></div>

    <div><label style="margin-bottom:14px">회사명 *</label><input type="text" name="bw_company_name" value="<?php echo esc_attr($old['bw_company_name']??''); ?>" required></div>
    <div><label style="margin-bottom:14px">업종 *</label>
      <select name="bw_industry" required>
        <?php $sel = $old['bw_industry']??''; ?>
        <option value="">선택</option>
        <option value="IT/서비스" <?php selected($sel,'IT/서비스'); ?>>IT/서비스</option>
        <option value="커머스" <?php selected($sel,'커머스'); ?>>커머스</option>
        <option value="기타" <?php selected($sel,'기타'); ?>>기타</option>
      </select>
    </div>
    <div><label style="margin-bottom:14px">직원 수 *</label><input type="number" name="bw_employees" value="<?php echo esc_attr($old['bw_employees']??''); ?>" min="1" required></div>
    <div><label style="margin-bottom:14px">홈페이지 URL</label><input type="url" name="user_url" value="<?php echo esc_attr($old['user_url']??''); ?>" placeholder="https://"></div>

    <div class="bwf-col-full">
      <label style="margin-bottom:14px">알게 된 경로 *</label>
      <?php $srcSel = $old['bw_discover']??''; ?>
      <select name="bw_discover" id="bwf-source" required>
        <option value="">선택</option><option value="검색" <?php selected($srcSel,'검색'); ?>>검색</option><option value="SNS" <?php selected($srcSel,'SNS'); ?>>SNS</option><option value="지인추천" <?php selected($srcSel,'지인추천'); ?>>지인추천</option><option value="기타" <?php selected($srcSel,'기타'); ?>>기타</option>
      </select>
      <input type="text" name="source_etc" id="bwf-source-etc" placeholder="기타 경로" class="bwf-col-full <?php echo ($srcSel==='기타'?'':'bwf-hidden'); ?>" style="margin-top:8px" value="<?php echo esc_attr($old['source_etc']??''); ?>">
    </div>

    <div><label style="margin-bottom:14px">휴대폰 번호 *</label>
      <input type="tel" name="bw_phone" id="bwf-phone" inputmode="numeric" placeholder="010-1234-5678" maxlength="13" value="<?php echo esc_attr($old['bw_phone']??''); ?>" required>
    </div>
    <div><label style="margin-bottom:14px">연락 가능한 시간대 *</label><input type="text" name="bw_contact_window" value="<?php echo esc_attr($old['bw_contact_window']??''); ?>" placeholder="예: 평일 13:00~18:00" required></div>

    <div class="bwf-actions bwf-col-full" style="margin-top:18px">
      <button type="submit" name="bwf_register" class="bwf-btn">회원가입</button>
      <span id="bwf-hint" style="font-size:13px;color:#475569"></span>
    </div>

    <script>
    (function(){
      const f=document.getElementById('bwf-signup-rep'),
            src=f.querySelector('#bwf-source'),
            etc=f.querySelector('#bwf-source-etc'),
            tel=f.querySelector('#bwf-phone'),
            hint=document.getElementById('bwf-hint');

      function showEtc(){ if(src.value==='기타'){ etc.classList.remove('bwf-hidden'); } else { etc.classList.add('bwf-hidden'); etc.value=''; } }
      src.addEventListener('change',showEtc); showEtc();

      const dig=s=>String(s||'').replace(/\D/g,'');
      function fmt(raw){ const d=dig(raw).slice(0,11); if(d.length<=3) return d; if(d.length<=7) return d.replace(/^(\d{3})(\d{0,4})$/,'$1-$2'); return d.replace(/^(\d{3})(\d{4})(\d{0,4}).*$/,'$1-$2-$3'); }
      function norm(){ tel.value=fmt(tel.value); try{ tel.setSelectionRange(tel.value.length,tel.value.length);}catch(e){} }
      ['input','keyup','change','paste','blur','focus'].forEach(ev=> tel.addEventListener(ev,norm)); norm();

      f.addEventListener('submit',function(ev){
        norm();
        // 필수항목 검증
        const must=[...f.querySelectorAll('[required]')]; let ok=true; let first=null;
        must.forEach(el=>{
          el.classList.remove('bwf-invalid'); el.setCustomValidity('');
          if(el===tel && !/^010-\d{3,4}-\d{4}$/.test(tel.value)){ el.setCustomValidity('휴대폰 번호는 010-1234-5678 형식'); }
          if(el.name==='bw_discover' && src.value==='기타' && (etc.value||'').trim()===''){ el.setCustomValidity('기타 경로를 입력해 주세요'); }
          if(!el.checkValidity()){ ok=false; if(!first) first=el; el.classList.add('bwf-invalid'); }
        });
        if(!ok){ ev.preventDefault(); hint.textContent='입력이 필요한 항목이 있어요.'; hint.style.color='#ef4444'; first.scrollIntoView({behavior:'smooth',block:'center'}); }
        else   { hint.textContent='제출 중입니다…'; hint.style.color='#475569'; }
      });
    })();
    </script>
  </form>
  <?php
  return ob_get_clean();
});

/* 제출 처리 */
add_action('admin_post_nopriv_bwf_signup_rep','bwf_handle_signup_rep');
function bwf_handle_signup_rep(){
  $old = $_POST; unset($old['action'],$old['bwf_nonce'],$old['user_pass']);
  set_transient('bwf_signup_old',$old,60);

  $nonce = sanitize_text_field($_POST['bwf_nonce'] ?? '');
  if (!wp_verify_nonce($nonce,'bwf_signup_rep')) { set_transient('bwf_signup_err','유효하지 않은 요청입니다.',60); wp_safe_redirect(wp_get_referer()?:home_url('/')); exit; }

  $user_login=sanitize_user($_POST['user_login']??'');
  $user_email=sanitize_email($_POST['user_email']??'');
  $user_pass =$_POST['user_pass']??'';
  $first_name=sanitize_text_field($_POST['first_name']??'');

  if (!$user_login||!$user_email||!$user_pass||!$first_name){ set_transient('bwf_signup_err','필수 항목이 누락되었습니다.',60); wp_safe_redirect(wp_get_referer()?:home_url('/')); exit; }

  $uid = wp_insert_user([
    'user_login'=>$user_login,'user_email'=>$user_email,'user_pass'=>$user_pass,
    'first_name'=>$first_name,'role'=>'bw_owner','user_url'=>esc_url_raw($_POST['user_url']??'')
  ]);

  if (is_wp_error($uid)) {
    set_transient('bwf_signup_err', $uid->get_error_message(), 60);
    wp_safe_redirect(wp_get_referer()?:home_url('/')); exit;
  }

  foreach(['bw_company_name','bw_industry','bw_employees','bw_contact_window','bw_discover','bw_phone'] as $k){
    if(isset($_POST[$k])) update_user_meta($uid,$k,sanitize_text_field($_POST[$k]));
  }
  if (($_POST['bw_discover']??'')==='기타' && !empty($_POST['source_etc'])) {
    update_user_meta($uid,'bw_discover','etc: '.sanitize_text_field($_POST['source_etc']));
  }

  delete_transient('bwf_signup_old');

  wp_set_current_user($uid); wp_set_auth_cookie($uid);
  wp_safe_redirect(home_url('/owner-questions/')); exit;
}


/* ===== 관리자 > 대표 질문지( CPT ) 목록 컬럼/제목 ===== */
add_filter('manage_edit-bwf_owner_answer_columns', function($cols){
  $new = [];
  $new['cb']      = $cols['cb'];
  $new['title']   = '제목';
  $new['author']  = '작성자';
  $new['company'] = '회사명';
  $new['website'] = '웹사이트';
  $new['date']    = '저장 시각';
  return $new;
});
add_action('manage_bwf_owner_answer_posts_custom_column', function($col, $post_id){
  if($col==='company'){
    $author = (int)get_post_field('post_author',$post_id);
    echo esc_html( get_user_meta($author,'bw_company_name',true) ?: '—' );
  } elseif($col==='website'){
    $author = (int)get_post_field('post_author',$post_id);
    $url = get_userdata($author)->user_url;
    echo $url ? '<a href="'.esc_url($url).'" target="_blank" rel="noopener">열기</a>' : '—';
  }
},10,2);

/* 관리자 목록에서 예전 글도 보기 좋은 제목으로 표시 */
add_filter('the_title', function($title, $post_id){
  if (!is_admin()) return $title;
  $p = get_post($post_id);
  if(!$p || $p->post_type!=='bwf_owner_answer') return $title;

  // 이미 새 규칙이면 그대로
  if (strpos($title,'#')!==false && strpos($title,'피드백')!==false) return $title;

  $author  = (int)$p->post_author;
  $company = get_user_meta($author,'bw_company_name',true);
  if($company==='') $company = get_userdata($author)->display_name;

  // 사용자 기준 순번 계산 (오래된 순서)
  $ids = get_posts(['post_type'=>'bwf_owner_answer','author'=>$author,'post_status'=>'any','fields'=>'ids','numberposts'=>-1,'orderby'=>'date','order'=>'ASC']);
  $pos = array_search($post_id, $ids, true);
  $idx = ($pos===false? count($ids): $pos) + 1;

  return sprintf('%s - #%d 피드백', $company, $idx);
},10,2);
`$nl
===== FILE: bw-owner-suite-acf\includes\view-list.php (6185 bytes, 147 lines) =====
`$ext
<?php
/**
 * /wp-content/plugins/bw-owner-suite-acf/includes/view-list.php
 */
if (!defined('ABSPATH')) exit;

/* === 공용 URL 헬퍼 (중복 선언 방지) === */
if (!function_exists('bwf_owner_view_url'))  { function bwf_owner_view_url(){ return home_url('/my-question-view/'); } }
if (!function_exists('bwf_owner_edit_url'))  { function bwf_owner_edit_url(){ return home_url('/owner-edit/'); } }
if (!function_exists('bwf_owner_list_url'))  { function bwf_owner_list_url(){ return home_url('/my-questions/'); } }

/* 이미 등록된 쇼트코드가 있으면 정리 후 재등록 */
if (shortcode_exists('bw_owner_view'))   remove_shortcode('bw_owner_view');
if (shortcode_exists('bwf_owner_view'))  remove_shortcode('bwf_owner_view');
if (shortcode_exists('bw_owner_list'))   remove_shortcode('bw_owner_list');
if (shortcode_exists('bw_my_questions')) remove_shortcode('bw_my_questions');

/* =========================================================
 * 단건 보기: [bw_owner_view] / [bwf_owner_view]
 *  - 작성자 정보 카드 제거
 *  - 질문/답변만 깔끔히 표기
 * =======================================================*/
function bwos_render_single_view($atts){
  if(!is_user_logged_in()) return '<div class="bwf-form">로그인이 필요합니다.</div>';

  $id = (int)($atts['id'] ?? ($_GET['id'] ?? 0));
  $p  = get_post($id);

  if(!$p || $p->post_type!=='bwf_owner_answer') return '<div class="bwf-form">데이터가 없습니다.</div>';
  if((int)$p->post_author!==get_current_user_id() && !current_user_can('read_post',$id))
    return '<div class="bwf-form">권한이 없습니다.</div>';

  wp_enqueue_style('bwf-forms');

  $cfg = function_exists('bwf_owner_cfg') ? bwf_owner_cfg() : ['title'=>'대표님 핵심 질문지','qs'=>[]];
  $ans = (array)get_post_meta($id,'bwf_answers',true);

  ob_start(); ?>
  <div class="bwos-wrap">
    <h2 class="bwf-title">내 질문 보기</h2>
    <h3 class="bwf-title" style="margin-top:4px"><?php echo esc_html($cfg['title']); ?></h3>

    <?php foreach(($cfg['qs']??[]) as $q): $key=$q['id']??''; if(!$key) continue; ?>
      <div class="bwf-field">
        <label><?php echo esc_html($q['label']); ?></label>

        <?php if(($q['type']??'')==='group'): ?>
          <?php foreach(($q['sub']??[]) as $sub): $sid=$sub['id']; $v=trim((string)($ans[$key][$sid]??'')); ?>
            <div class="bwf-sub">
              <div class="bwf-help"><?php echo esc_html($sub['label']); ?></div>
              <div class="bwf-card"><?php echo nl2br(esc_html($v)); ?></div>
            </div>
          <?php endforeach; ?>
        <?php else: $v=trim((string)($ans[$key]??'')); ?>
          <div class="bwf-card"><?php echo nl2br(esc_html($v)); ?></div>
        <?php endif; ?>

      </div>
    <?php endforeach; ?>

    <div class="bwf-actions" style="justify-content:center">
      <a class="bwf-btn" href="<?php echo esc_url(add_query_arg(['id'=>$p->ID], bwf_owner_edit_url())); ?>">수정</a>
      <a class="bwf-btn-secondary" href="<?php echo esc_url(bwf_owner_list_url()); ?>">목록</a>
    </div>
  </div>
  <?php
  return ob_get_clean();
}
add_shortcode('bw_owner_view','bwos_render_single_view');
add_shortcode('bwf_owner_view','bwos_render_single_view');


/* =========================================================
 * 마이페이지(목록): [bw_owner_list] / [bw_my_questions]
 *  - 저장된 제목 그대로 사용 (예: 회사명 - #N 피드백)
 *  - 퍼말링크/쿼리스트링 모두 지원하는 페이지네이션
 * =======================================================*/
function bwos_render_owner_list($atts){
  if(!is_user_logged_in()) return '<div class="bwf-form">로그인이 필요합니다.</div>';

  // paged는 퍼말링크 기반, pg는 쿼리스트링 기반 모두 지원
  $paged = max(1, (int)get_query_var('paged', 0));
  if(!$paged) $paged = max(1, (int)($_GET['pg'] ?? 1));

  $q = new WP_Query([
    'post_type'      => 'bwf_owner_answer',
    'post_status'    => 'private',
    'author'         => get_current_user_id(),
    'posts_per_page' => 8,
    'orderby'        => 'date',
    'order'          => 'DESC',
    'paged'          => $paged,
  ]);

  wp_enqueue_style('bwf-forms');

  ob_start(); ?>
  <div class="bwos-wrap">
    <h2 class="bwf-title" style="margin-bottom:16px">마이페이지</h2>

    <div class="bwf-actions" style="justify-content:flex-start;margin:0 0 14px">
      <a class="bwf-btn" href="<?php echo esc_url(home_url('/owner-questions/')); ?>">새 피드백 질문하기</a>
    </div>

    <div class="bwos-list">
      <?php if($q->have_posts()): while($q->have_posts()): $q->the_post();
        $id    = get_the_ID();
        $title = get_the_title($id);                     // 저장된 제목 사용 (회사명 - #N 피드백)
        $when  = get_the_date('Y-m-d H:i', $id);         // 사이트 시간대에 맞게 표시
        $view  = esc_url(add_query_arg(['id'=>$id], bwf_owner_view_url()));
        $edit  = esc_url(add_query_arg(['id'=>$id], bwf_owner_edit_url()));
      ?>
        <div class="bwos-card">
          <h4><?php echo esc_html($title); ?></h4>
          <div class="meta"><?php echo esc_html($when); ?></div>
          <div class="row">
            <a href="<?php echo $view; ?>">보기</a>
            <a href="<?php echo $edit; ?>">수정</a>
          </div>
        </div>
      <?php endwhile; else: ?>
        <p>작성한 내역이 없습니다. <a href="<?php echo esc_url(home_url('/owner-questions/')); ?>">새 피드백 질문하기</a>로 첫 저장본을 만들어 보세요.</p>
      <?php endif; wp_reset_postdata(); ?>
    </div>

    <?php
      $links = paginate_links([
        'total'     => max(1,(int)$q->max_num_pages),
        'current'   => $paged,
        'type'      => 'array',
        'mid_size'  => 2,
        'prev_text' => '이전',
        'next_text' => '다음',
      ]);
      if($links){
        echo '<div class="bwos-pg">';
        foreach($links as $l) echo $l.' ';
        echo '</div>';
      }
    ?>
  </div>
  <?php
  return ob_get_clean();
}
add_shortcode('bw_owner_list','bwos_render_owner_list');
add_shortcode('bw_my_questions','bwos_render_owner_list');

`$nl

`$nl
===== FILE: pack-code.ps1 (4063 bytes, 113 lines) =====
`$ext
param(
  [string]$Root = ".",
  [string]$Out = "codepack.txt",
  [string]$IncludeExt = ".php,.js,.ts,.css,.scss,.html,.htm,.json,.md,.yml,.yaml,.xml,.sh,.ps1,.ini,.txt,.sql,.twig,.vue",
  # 제외할 디렉터리들 (쉼표로 구분)
  [string]$ExcludeDirs = "node_modules,dist,build,vendor,.git,.github,.idea,.vscode,.next,.cache,growth-checklist\plugin-update-checker",
  # 제외할 파일 패턴들 (쉼표로 구분)
  [string]$ExcludeFiles = "*.min.js,*.min.css,*.map,*.lock,*.zip,*.tar,*.gz,*.png,*.jpg,*.jpeg,*.gif,*.webp,*.svg,*.woff,*.woff2,*.ttf,*.eot,*.pdf",
  # 용량 한도
  [int]$MaxFileBytes = 1000000,    # 파일당 최대 1MB
  [int]$MaxTotalBytes = 20000000,  # 전체 최대 20MB
  # 변경 파일만 모드
  [switch]$ChangedOnly,
  [string]$GitRange = ""
)

$ErrorActionPreference = "Stop"
$Root = (Resolve-Path $Root).Path
$include = $IncludeExt.Split(",") | ForEach-Object { $_.Trim().ToLower() } | Where-Object { $_ -ne "" }
$exDirs  = $ExcludeDirs.Split(",")  | ForEach-Object { $_.Trim() }        | Where-Object { $_ -ne "" }
$exFiles = $ExcludeFiles.Split(",") | ForEach-Object { $_.Trim() }        | Where-Object { $_ -ne "" }

function IsTextExt($path) {
  $ext = [IO.Path]::GetExtension($path).ToLower()
  return $include -contains $ext
}
function IsExcludedDir($path) {
  foreach ($d in $exDirs) {
    if ($path -like "*$d*") { return $true }
  }
  return $false
}
function IsExcludedFile($file) {
  foreach ($p in $exFiles) {
    if ([IO.Path]::GetFileName($file) -like $p) { return $true }
  }
  return $false
}

# 파일 목록 수집
$files = @()
if ($ChangedOnly) {
  $gitArgs = @("diff","--name-only")
  if ($GitRange) { $gitArgs += $GitRange }
  $changed = & git @gitArgs 2>$null
  foreach ($rel in $changed) {
    $p = Join-Path $Root $rel
    if (Test-Path $p -PathType Leaf) { $files += (Resolve-Path $p).Path }
  }
} else {
  $files = Get-ChildItem -Path $Root -Recurse -File | ForEach-Object { $_.FullName }
}

# 필터링
$files = $files | Where-Object {
  -not (IsExcludedDir $_) -and
  -not (IsExcludedFile $_) -and
  (IsTextExt $_)
}

# 출력 빌드
$sb = New-Object System.Text.StringBuilder
$totalBytes = 0
$nl = [Environment]::NewLine

# 상단 메타
try {
  $repoUrl = (git -C $Root config --get remote.origin.url)
  $branch  = (git -C $Root rev-parse --abbrev-ref HEAD)
  $tag     = (git -C $Root describe --tags --abbrev=0) 2>$null
  $commit  = (git -C $Root rev-parse --short HEAD)
  $time    = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
  $null = $sb.AppendLine("===== META =====")
  $null = $sb.AppendLine("Repo: $repoUrl")
  $null = $sb.AppendLine("Branch: $branch  |  Tag: $tag  |  Commit: $commit")
  $null = $sb.AppendLine("Generated: $time")
  $null = $sb.AppendLine("")
} catch {}

foreach ($f in $files) {
  try {
    $fi = Get-Item $f
    $size = $fi.Length
    if ($size -gt $MaxFileBytes) {
      $rel = $f.Substring($Root.Length+1)
      $null = $sb.AppendLine("===== FILE: $rel ($size bytes) SKIPPED: > $MaxFileBytes =====$nl")
      continue
    }
    if (($totalBytes + $size) -gt $MaxTotalBytes) {
      $null = $sb.AppendLine("===== STOP: total size would exceed $MaxTotalBytes bytes. Remaining files omitted. =====$nl")
      break
    }

    $rel = $f.Substring($Root.Length+1)
    $content = (Get-Content -Path $f -Raw -Encoding UTF8)
    $lineCount = ($content -split "`r?`n").Count
    $ext = [IO.Path]::GetExtension($f).TrimStart(".").ToLower()
    if (-not $ext) { $ext = "text" }

    $null = $sb.AppendLine("===== FILE: $rel ($size bytes, $lineCount lines) =====")
    $null = $sb.AppendLine("```$ext")
    $null = $sb.AppendLine($content)
    $null = $sb.AppendLine("```$nl")

    $totalBytes += $size
  } catch {
    $null = $sb.AppendLine("===== FILE: $f ERROR: $($_.Exception.Message) =====$nl")
  }
}

[IO.File]::WriteAllText((Join-Path $Root $Out), $sb.ToString(), [Text.Encoding]::UTF8)
"생성 완료: $(Join-Path $Root $Out)  (총 approx $totalBytes bytes)"

`$nl
===== FILE: bw-owner-suite-acf\bw-owner-suite-acf.php (1308 bytes, 33 lines) =====
`$ext
<?php
/**
 * Plugin Name: BW Owner Suite (light)
 * Description: 대표 질문지 + 회원가입(대표 전용) + 마이페이지. ACF 기반 경량 플러그인.
 * Version: 1.0.4
 * Author: Berrywalk
 */
if (!defined('ABSPATH')) exit;

define('BWOS_VER', '1.2.2');
define('BWOS_DIR', plugin_dir_path(__FILE__));
define('BWOS_URL', plugin_dir_url(__FILE__));

// 텔레그램
define('BW_TG_BOT_TOKEN', '8060380419:AAFDlmr9TmX1K5Ocagl6WafN5s2O6oVnvdw');  // BotFather에서 발급
define('BW_TG_CHAT_ID',  '@berrywalk_ownerfeedback');                  // 개인(@me) 또는 채널/그룹 ID

require_once BWOS_DIR.'includes/cpt-admin.php';
require_once BWOS_DIR.'includes/form.php';
require_once BWOS_DIR.'includes/signup.php';
require_once BWOS_DIR.'includes/save.php';
require_once BWOS_DIR.'includes/view-list.php';
require_once BWOS_DIR.'includes/acf-fields.php'; // 관리자 ACF 메타박스(5문항)

add_action('wp_enqueue_scripts', function(){
  $css = BWOS_URL.'assets/owner-form.css';
  $js  = BWOS_URL.'assets/owner-form.js';
  wp_register_style ('bwos-form', $css, [], BWOS_VER);
  wp_register_style ('bwf-forms', $css, [], BWOS_VER); // alias
  wp_register_script('bwos-form', $js,  ['jquery'], BWOS_VER, true);
  wp_register_script('bwf-forms', $js,  ['jquery'], BWOS_VER, true); // alias
});

`$nl
===== FILE: bw-owner-suite-acf\README.md (1409 bytes, 40 lines) =====
`$ext
# BW Owner Suite (ACF Minimal)

워드프레스 표준 + ACF만 사용하여
- 회원가입 → 프로필 수정
- 대표 질문(CPT) 작성/수정/보기/목록/복제/삭제
- 저장 알림(메일/텔레그램)

을 한 번에 처리하는 경량 플러그인입니다.

## 설치
1) `Advanced Custom Fields`(ACF) 플러그인을 활성화
2) 워드프레스 관리자 → 플러그인 → 새로 추가 → 플러그인 업로드 → 이 ZIP 업로드 후 활성화
3) 활성화 즉시 아래 페이지가 자동 생성됩니다.
   - `/owner-questions/` 작성
   - `/owner-edit/?id=글ID` 수정
   - `/my-question-view/?id=글ID` 보기
   - `/my-questions/` 내 저장본(보기/수정/복제/삭제)
   - `/my-profile/` 마이프로필
   - `/register/` 회원가입

## 텔레그램 알림(선택)
`wp-config.php`에 아래 상수를 추가하면 저장 시 텔레그램 알림이 전송됩니다.

```php
define('BWF_TG_BOT','123456:ABC...');       // 봇 토큰
define('BWF_TG_CHAT','-1001234567890');     // 채팅 ID
```

## 짧은코드(Shortcodes)
- [bw_register]
- [bw_profile_form]
- [bw_owner_form_acf]
- [bw_owner_edit id="123"]  (또는 /owner-edit/?id=123)
- [bwf_owner_view id="123"]
- [bw_my_questions]

## 주의
- 플러그인 동작을 위해 ACF가 필요합니다.
- 데이터는 CPT `bwf_owner_answer`에 저장되며 리비전이 활성화되어 되돌리기가 가능합니다.

`$nl
===== FILE: bw-owner-suite-acf\assets\owner-form.css (5415 bytes, 109 lines) =====
`$ext
/* /assets/owner-form.css */

/* ====== Base ====== */
:root{
  --bw-font:17.5px;
  --bw-muted:#64748b;
  --bw-border:#e5e7eb;
  --bw-accent:#6366f1;
  --bw-ok:#16a34a;
  --bw-warn:#ef4444;
  --bw-bg:#f8fafc;
}
body{font-size:var(--bw-font);background:var(--bw-bg)}
.bwos-wrap{max-width:920px;margin:40px auto;padding:0 16px}               /* ⬆ 여백 확대 */
.bwf-title{font-size:30px;line-height:1.25;margin:22px 0 16px}
.bwf-help{color:#0f172a;margin:0 0 18px}

/* ====== Sticky progress (카드형, 배경/테두리 추가) ====== */
.bwos-progress{
  position:sticky;top:64px;z-index:1000;margin:0 0 18px;
  background:#ffffff; border:1px solid var(--bw-border); border-radius:14px;
  padding:12px 14px; box-shadow:0 6px 18px rgba(2,6,23,.06);
}
body.admin-bar .bwos-progress{top:96px}
.bwos-progress .bar{height:10px;background:#f2f4f7;border-radius:999px;overflow:hidden}
.bwos-progress .bar>span{display:block;height:100%;width:0%;background:linear-gradient(90deg,#22d3ee,#6366f1);border-radius:999px;transition:width .2s}
.bwos-progress .status{font-size:12px;color:#334155;margin-top:8px}

/* ====== Field ====== */
.bwf-field{margin:28px 0}                                                  /* ⬆ 여백 확대 */
.bwf-field label{display:block;font-weight:700;margin:0 0 14px;font-size:18px}
.bwf-field textarea,
.bwf-field input[type="text"],
.bwf-field input[type="number"],
.bwf-field input[type="email"],
.bwf-field input[type="tel"],
.bwf-field input[type="url"],
.bwf-field select{
  width:100%;box-sizing:border-box;padding:13px 14px;border:1px solid #d1d5db;border-radius:12px;background:#fff;font-size:16.5px;outline:none
}
.bwf-field textarea:focus,
.bwf-field input:focus,
.bwf-field select:focus{border-color:var(--bw-accent);box-shadow:0 0 0 3px rgba(99,102,241,.15)}

.bwos-field.bwos-error textarea,
.bwos-field.bwos-error input,
.bwos-field.bwos-error select{border-color:var(--bw-warn);background:#fff1f2}
.bwf-invalid{border-color:var(--bw-warn) !important;background:#fff1f2 !important}

/* ====== 설명/예시 – 한국형 카드 스타일 ====== */
.bwf-desc, .bwf-examples{
  margin:10px 0 10px;padding:12px 14px;border:1px dashed #dbe1ea;border-radius:12px;background:#fbfdff
}
.bwf-desc::before{
  content:"설명"; display:inline-block; font-size:12px; font-weight:800; color:#0ea5e9;
  background:#e6f6fb; border:1px solid #bde7f4; border-radius:999px; padding:2px 8px; margin-right:8px
}
.bwf-examples::before{
  content:"예시"; display:inline-block; font-size:12px; font-weight:800; color:#6366f1;
  background:#eef0ff; border:1px solid #dfe3ff; border-radius:999px; padding:2px 8px; margin-right:8px
}
.bwf-examples ul,.bwf-examples ol{margin:6px 0 0 18px}

/* ====== Counter ====== */
.bwos-count{
  display:inline-block;margin-top:8px;font-size:12px;font-weight:700;
  color:var(--bw-muted);background:#f3f4f6;border:1px solid #e5e7eb;border-radius:999px;padding:4px 8px
}
.bwos-count.ok{color:#065f46;background:#ecfdf5;border-color:#bbf7d0}
.bwos-count.need{color:#7c2d12;background:#fff7ed;border-color:#fed7aa}

/* ====== Buttons ====== */
.bwf-actions{display:flex;gap:10px;align-items:center;justify-content:center;margin-top:20px}
.bwf-btn{display:inline-block;padding:12px 18px;border-radius:14px;border:none;background:var(--bw-accent);color:#fff;text-decoration:none;font-weight:700}
.bwf-btn-secondary{display:inline-block;padding:12px 18px;border-radius:14px;border:1px solid #cbd5e1;background:#fff;color:#0f172a;text-decoration:none;font-weight:700}


/* ====== Modal (공용) ====== */
.bwos-modal, .bwf-modal{
  position:fixed;inset:0;display:none;align-items:flex-start;justify-content:center;padding-top:18vh;background:rgba(0,0,0,.45);z-index:100000
}
body.admin-bar .bwos-modal, body.admin-bar .bwf-modal{padding-top:calc(18vh + 32px)}
.bwos-modal.is-open, .bwf-modal.is-open{display:flex}
.bwos-modal-inner, .bwf-modal .bwf-modal__card{
  background:#fff;max-width:560px;width:92vw;padding:22px;border-radius:16px;box-shadow:0 22px 44px rgba(2,6,23,.18)
}
.bwos-modal-inner h4, .bwf-modal h3{margin:0 0 10px;font-size:18px}
.bwos-modal-inner p, .bwf-modal p{margin:0 0 12px;color:#334155}
.bwf-modal__list{margin:6px 0 0 18px;font-size:14px;color:#1f2937}

/* ====== List / View ====== */
.bwf-card{border:1px solid var(--bw-border);background:#fff;border-radius:12px;padding:12px 14px}

/* ====== Signup grid ====== */
.bwf-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px 14px}
.bwf-col-full{grid-column:1/-1}
@media (max-width:720px){.bwf-grid{grid-template-columns:1fr}}
.bwf-hidden{display:none}

/* 마이페이지 카드 & 페이지네이션 */
.bwos-list{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:16px}
@media (max-width:920px){.bwos-list{grid-template-columns:1fr}}
.bwos-card{border:1px solid #e5e7eb;border-radius:14px;padding:14px 16px;background:#fff;box-shadow:0 6px 14px rgba(2,6,23,.05)}
.bwos-card h4{margin:0 0 6px;font-size:17px}
.bwos-card .meta{font-size:12px;color:#64748b;margin-bottom:10px}
.bwos-card .row a{display:inline-block;padding:8px 12px;border-radius:10px;background:#f1f5f9;text-decoration:none;color:#0f172a}
.bwos-pg{margin:18px 0 8px;text-align:center}
.bwos-pg .page-numbers{display:inline-block;padding:8px 12px;border:1px solid #e5e7eb;border-radius:10px;margin:0 3px;text-decoration:none;color:#0f172a}
.bwos-pg .current{background:#6366f1;color:#fff;border-color:#6366f1}
`$nl
===== FILE: bw-owner-suite-acf\assets\owner-form.js (4147 bytes, 94 lines) =====
`$ext
/* /assets/owner-form.js  (카운터 텍스트 – "몇자 남음" 친절 메시지로) */
(function($){
  if(!$ || !$('.bwos-form').length) return;

  const $form = $('.bwos-form').first();
  const $progress = $form.find('.bwos-progress');
  const reqs = []; let submitted=false;

  function updateProgress(){
    const total=reqs.length, done=reqs.filter(r=>r.valid()).length, pct=total?Math.round(done/total*100):0;
    $progress.find('.bar>span').css('width',pct+'%');
    $progress.find('.status').text('작성 '+done+'/'+total+' ('+pct+'%)');
  }

  function wire($wrap){
    const min = parseInt($wrap.data('min')||200,10);
    const $subs = $wrap.find('.bwf-sub textarea');
    const isGroup = $subs.length>0;
    let $cnt = $wrap.find('.bwos-count'); if(!$cnt.length) $cnt=$('<small class="bwos-count"></small>').appendTo($wrap);

    const setError = bad => $wrap.toggleClass('bwos-error', submitted && !!bad);
    const valid = ()=>{
      if(isGroup){ let ok=true; $subs.each(function(){ if(($(this).val()||'').trim()==='') ok=false; }); return ok; }
      return (($wrap.find('textarea,input[type="text"]').first().val()||'').trim().length >= min);
    };

    const update = ()=>{
      if(isGroup){
        let anyEmpty=false; $subs.each(function(){ if(($(this).val()||'').trim()==='') anyEmpty=true; });
        $cnt.text(anyEmpty ? '질문 3개 모두 작성' : '충족').toggleClass('need',anyEmpty).toggleClass('ok',!anyEmpty);
        setError(anyEmpty);
      }else{
        const v=($wrap.find('textarea,input[type="text"]').first().val()||'').trim();
        const diff = min - v.length;
        if(diff>0){ $cnt.text(diff+'자 남음'); $cnt.removeClass('ok').addClass('need'); }
        else      { $cnt.text('충족'); $cnt.removeClass('need').addClass('ok'); }
        setError(v.length < min);
      }
      updateProgress();
    };

    (isGroup ? $subs : $wrap.find('textarea,input[type="text"]').first()).on('input blur', update);
    reqs.push({wrap:$wrap, valid, update, min}); update();
  }

  $form.find('.bwos-required').each(function(){ wire($(this)); });
  updateProgress();

  const $modal=$('<div class="bwos-modal"><div class="bwos-modal-inner"><h4>입력이 필요한 항목이 있어요</h4><p>아래 항목을 확인해 주세요.</p><ul class="bwf-modal__list"></ul><button type="button" class="bwf-btn-secondary ok">확인</button></div></div>').appendTo('body');
  $modal.on('click','.ok',()=> $modal.removeClass('is-open'));

  let locked=false;
  $form.on('submit',function(e){
    submitted=true; let bad=false; const items=[];
    reqs.forEach(r=>{
      if(!r.valid()){
        bad=true; const lab=r.wrap.find('label').first().text().replace(/\*.*$/,'').trim();
        if(r.wrap.find('.bwf-sub').length){ items.push('· '+lab+' — 3개 질문 모두 작성'); }
        else{
          const len=($r=r.wrap.find('textarea,input[type="text"]').first()).val().trim().length;
          const diff=(r.min||200)-len; items.push('· '+lab+' — 최소 글자수 부족 ('+diff+'자 남음)');
        }
        r.update();
      }
    });
    if(bad){
      e.preventDefault();
      const ul=$modal.find('.bwf-modal__list').empty();
      items.forEach(t=> $('<li/>').text(t).appendTo(ul));
      $modal.addClass('is-open');
      const $first=$form.find('.bwos-error').first(); if($first.length) $('html,body').animate({scrollTop:$first.offset().top-120},180);
      return;
    }
    if(locked){ e.preventDefault(); return; }
    locked=true; $form.find('.bwos-submit').prop('disabled',true).text('저장 중…');
    setTimeout(()=>{ locked=false; $form.find('.bwos-submit').prop('disabled',false).text('저장'); }, 6000);
  });
})(jQuery);

/* === Tab 이동: textarea에서 Tab 누르면 다음 필드로 포커스 === */
(function($){
  const $areas = $('.bwos-form textarea:visible');
  $areas.on('keydown', function(e){
    if(e.key === 'Tab' && !e.shiftKey){
      const list = $('.bwos-form textarea:visible');
      const idx = list.index(this);
      if(idx > -1 && idx < list.length - 1){
        e.preventDefault();
        list.eq(idx + 1).focus();
      }
    }
  });
})(jQuery);

`$nl
===== FILE: bw-owner-suite-acf\includes\acf-fields.php (3509 bytes, 76 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

add_action('acf/init', function(){
  if (!function_exists('acf_add_local_field_group')) return;

  acf_add_local_field_group([
    'key'=>'group_bwos_owner_v5','title'=>'대표 질문지',
    'fields'=>[
      ['key'=>'f_problem','label'=>'1) 지금, 우리 사업의 가장 큰 고민은 무엇인가요?','name'=>'_acf_problem','type'=>'textarea','required'=>1,'rows'=>8,'instructions'=>'최소 200자 권장'],
      ['key'=>'f_value','label'=>'2) 우리 서비스의 핵심 가치는 무엇인가요?','name'=>'_acf_value','type'=>'textarea','required'=>1,'rows'=>6],
      ['key'=>'f_whom','label'=>'3) 누가 이용해야 하나요? 왜 우리인가요?','name'=>'_acf_ideal_customer','type'=>'textarea','required'=>1,'rows'=>6],
      ['key'=>'f_ask1','label'=>'4-1) 고객에게 묻고 싶은 질문 #1','name'=>'_acf_cq1','type'=>'text'],
      ['key'=>'f_ask2','label'=>'4-2) 고객에게 묻고 싶은 질문 #2','name'=>'_acf_cq2','type'=>'text'],
      ['key'=>'f_ask3','label'=>'4-3) 고객에게 묻고 싶은 질문 #3','name'=>'_acf_cq3','type'=>'text'],
      ['key'=>'f_comp','label'=>'5) 경쟁사 대비 차별점','name'=>'_acf_competitors','type'=>'textarea','required'=>1,'rows'=>6],
    ],
    'location'=>[[['param'=>'post_type','operator'=>'==','value'=>'bwf_owner_answer']]],
    'position'=>'normal','style'=>'default','active'=>true,
  ]);
});


/** 200자 필드 서버 검증 */
add_filter('acf/validate_value', function($valid, $value, $field){
  if ($valid !== true) return $valid;
  $min200 = ['problem','core_value','target_customer','differentiation','sales_blockers','current_channels','growth_goal','next_action'];
  if (in_array($field['name'] ?? '', $min200, true)) {
    if (mb_strlen(trim((string)$value)) < 200) return '최소 200자 이상 작성해 주세요.';
  }
  return $valid;
}, 10, 3);
/* ------- ACF <-> bwf_answers 동기화 ------- */
function bwos_acf_meta_keys(){ // ACF 메타키(name) 매핑
  return [
    '_acf_problem'       => ['id'=>'problem'],
    '_acf_value'         => ['id'=>'value'],
    '_acf_ideal_customer'=> ['id'=>'ideal_customer'],
    '_acf_cq1'           => ['id'=>'ask3','sub'=>'q1'],
    '_acf_cq2'           => ['id'=>'ask3','sub'=>'q2'],
    '_acf_cq3'           => ['id'=>'ask3','sub'=>'q3'],
    '_acf_competitors'   => ['id'=>'competitors'],
  ];
}

/* 편집 화면 로드시 ACF 메타 채워넣기(관리자에서 비어 보이던 문제 해결) */
add_action('load-post.php', function(){
  $pid = isset($_GET['post']) ? (int)$_GET['post'] : 0;
  if(!$pid) return;
  $p = get_post($pid);
  if(!$p || $p->post_type!=='bwf_owner_answer') return;

  $ans = (array)get_post_meta($pid,'bwf_answers',true);
  foreach(bwos_acf_meta_keys() as $meta=>$m){
    $val = '';
    if(empty($m['sub'])) $val = (string)($ans[$m['id']] ?? '');
    else                 $val = (string)($ans[$m['id']][$m['sub']] ?? '');
    update_post_meta($pid, $meta, $val);
  }
});

/* 저장 시 ACF 값으로 bwf_answers 재생성(양방향 동기화) */
add_action('save_post_bwf_owner_answer', function($post_id){
  if(defined('DOING_AUTOSAVE') && DOING_AUTOSAVE) return;
  $ans = [];
  foreach(bwos_acf_meta_keys() as $meta=>$m){
    $v = (string)get_post_meta($post_id,$meta,true);
    if(empty($m['sub'])) $ans[$m['id']] = $v;
    else {
      if(empty($ans[$m['id']])) $ans[$m['id']] = [];
      $ans[$m['id']][$m['sub']] = $v;
    }
  }
  if($ans) update_post_meta($post_id,'bwf_answers',$ans);
}, 20);

`$nl
===== FILE: bw-owner-suite-acf\includes\cpt-admin.php (871 bytes, 21 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

add_action('init', function(){
  register_post_type('bwf_owner_answer', [
    'label'=>'대표 질문지','labels'=>['name'=>'대표 질문지','add_new_item'=>'새 대표 질문 생성','edit_item'=>'대표 질문 편집'],
    'public'=>false,'exclude_from_search'=>true,'publicly_queryable'=>false,'show_ui'=>true,'show_in_menu'=>true,
    'menu_icon'=>'dashicons-editor-help','supports'=>['author','custom-fields'],'map_meta_cap'=>true,
  ]);
});

add_filter('manage_bwf_owner_answer_posts_columns', function($c){
  return ['cb'=>$c['cb'],'title'=>'제목','author'=>'작성자','created'=>'저장 시각'];
});
add_action('manage_bwf_owner_answer_posts_custom_column', function($col,$post_id){
  if($col==='created'){
    $ts = get_post_timestamp($post_id,'date');
    echo esc_html( wp_date('Y-m-d H:i', $ts) );
  }
}, 10, 2);

`$nl
===== FILE: bw-owner-suite-acf\includes\form.php (7759 bytes, 127 lines) =====
`$ext
<?php
/* /includes/form.php (핵심 변경만) */
if (!defined('ABSPATH')) exit;

/** 공용 URL (중복 선언 방지) */
if (!function_exists('bwf_owner_view_url'))  { function bwf_owner_view_url(){ return home_url('/my-question-view/'); } }
if (!function_exists('bwf_owner_edit_url'))  { function bwf_owner_edit_url(){ return home_url('/owner-edit/'); } }
if (!function_exists('bwf_owner_list_url'))  { function bwf_owner_list_url(){ return home_url('/my-questions/'); } }


function bwf_owner_cfg(){
  return [
    'title'=>'대표님 핵심 질문지',
    'min'=>200,
    'intro'=>'사업의 본질을 파악하고 고객에게 정말 묻고 싶은 질문을 구체화합니다. 각 문항은 최소 <strong>{MIN}</strong>자입니다. <em>(단, <strong>“고객에게 물어보고 싶은 3가지”</strong>는 글자수 제한 없음)</em>',
    'qs'=>[
      [
        'id'=>'problem','label'=>'1. 지금, 우리 사업의 가장 큰 고민은 무엇인가요?','required'=>true,'min'=>200,
        'desc'=>'성장이 정체되었다고 느낀 **구체적 상황**을 한두 문장으로. 숫자/행동 기반이면 좋아요.',
        'ex'=>'<ul><li>“클릭은 많은데 체류 30초 미만 이탈이 많아요.”</li><li>“재구매율이 낮아 신규 유입 의존도가 큽니다.”</li></ul>'
      ],
      [
        'id'=>'value','label'=>'2. 우리 서비스는 고객의 어떤 문제를 해결하나요?','required'=>true,'min'=>200,
        'desc'=>'고객의 **전/후 변화**를 한 문장으로 요약.',
        'ex'=>'<ol><li>“반복 서류작업을 5분 자동화 → 본업 집중”</li><li>“바쁜 직장인도 집밥처럼 건강한 한 끼 확보”</li></ol>'
      ],
      [
        'id'=>'ideal_customer','label'=>'3. 누가 이용해야 하나요? 왜 우리여야 하나요?','required'=>true,'min'=>200,
        'desc'=>'핵심 타깃의 특징 + 우리를 선택할 **결정적 이유**.',
        'ex'=>'<p>“시간/비용이 부족한 20대 대학생 → 15분 홈트 영상으로 꾸준함 확보.”</p>'
      ],
      [
        'id'=>'ask3','type'=>'group','label'=>'4. 고객에게 물어보고 싶은 3가지','required'=>true,
        'desc'=>'실제 경험 기반으로 **구체적인 질문 3개**를 작성.',
        'ex'=>'<p><strong>예)</strong> 첫인상/결심포인트/아쉬운점</p>',
        'sub'=>[
          ['id'=>'q1','label'=>'질문 1','ph'=>'예: 어떻게 알게 되었나요?','required'=>true],
          ['id'=>'q2','label'=>'질문 2','ph'=>'예: 결심 포인트는 무엇이었나요?','required'=>true],
          ['id'=>'q3','label'=>'질문 3','ph'=>'예: 가장 아쉬웠던 점은?','required'=>true],
        ]
      ],
      [
        'id'=>'competitors','label'=>'5. 경쟁사와의 차별점은?','required'=>true,'min'=>200,
        'desc'=>'주요 경쟁사 1~2곳과 비교해 강/약점 정리.',
        'ex'=>'<p>“A는 저렴하지만 CS 느림 / B는 비싸지만 품질 우수 → 우리는 적정가+빠른 CS”</p>'
      ],
    ]
  ];
}

function bwf_owner_view_url(){ return home_url('/my-question-view/'); }
function bwf_owner_edit_url(){ return home_url('/owner-edit/'); }
function bwf_owner_list_url(){ return home_url('/my-questions/'); }

function bwf_render_owner_form($args=[]){
  $cfg=bwf_owner_cfg(); $min=(int)$cfg['min']; $mode=$args['mode']??'create';
  $post=$args['post']??null; $saved=$args['saved']??[]; $errs=$args['errs']??[];
  if($mode==='edit' && $post){ $existing=(array)get_post_meta($post->ID,'bwf_answers',true); $saved=$saved ?: $existing; }
  wp_enqueue_style('bwf-forms'); wp_enqueue_script('bwos-form');

  ob_start(); ?>
  <form id="bwfOwnerForm" class="bwf-form bwos-form" method="post" action="<?php echo esc_url(admin_url('admin-post.php')); ?>" novalidate>
    <input type="hidden" name="action" value="bwf_owner_save">
    <?php wp_nonce_field('bwf_owner_save','bwf_owner_nonce'); ?>
    <input type="hidden" name="post_id" value="<?php echo $post ? (int)$post->ID : 0; ?>">

    <div class="bwos-progress"><div class="bar"><span></span></div><div class="status">작성 0/0 (0%)</div></div>

    <h2 class="bwf-title"><?php echo esc_html($cfg['title']); ?></h2>
    <p class="bwf-help"><?php echo str_replace('{MIN}', $min, $cfg['intro']); ?></p>

    <?php foreach($cfg['qs'] as $q): $type=$q['type']??'textarea'; $id=$q['id']; ?>
      <div class="bwf-field bwos-field bwos-required" data-min="<?php echo (int)($q['min']??$min); ?>">
        <label><?php echo esc_html($q['label']); ?><?php if(!empty($q['required'])): ?><span class="bwf-required">*</span><?php endif; ?></label>

        <?php if(!empty($q['desc'])): ?><div class="bwf-desc"><?php echo wp_kses_post($q['desc']); ?></div><?php endif; ?>
        <?php if(!empty($q['ex'])):   ?><div class="bwf-examples"><?php echo wp_kses_post($q['ex']); ?></div><?php endif; ?>

        <?php if($type==='group'): ?>
          <?php foreach(($q['sub']??[]) as $sub): $sid=$sub['id']; $v=$saved[$id][$sid]??''; ?>
            <div class="bwf-sub">
              <div class="bwf-help" style="margin:6px 0 6px;"><?php echo esc_html($sub['label']); ?></div>
              <textarea name="q[<?php echo esc_attr($id); ?>][<?php echo esc_attr($sid); ?>]" rows="4" placeholder="<?php echo esc_attr($sub['ph']??''); ?>"><?php echo esc_textarea($v); ?></textarea>
            </div>
          <?php endforeach; ?>
        <?php else: $v=$saved[$id]??''; ?>
          <textarea name="q[<?php echo esc_attr($id); ?>]" rows="6"><?php echo esc_textarea($v); ?></textarea>
          <small class="bwos-count">0/<?php echo (int)($q['min']??$min); ?></small>
        <?php endif; ?>
      </div>
    <?php endforeach; ?>

    <div class="bwf-actions">
      <button type="submit" class="bwf-btn bwos-submit"><?php echo $mode==='edit'?'수정 저장':'저장'; ?></button>
      <!-- 마이페이지 버튼 제거 요청 반영 -->
    </div>
  </form>
  <?php return ob_get_clean();
}

add_shortcode('bwf_owner_questions', function(){
  wp_enqueue_style('bwf-forms');

  if (!is_user_logged_in()){
    wp_enqueue_style('bwf-forms');
    $signup = esc_url('https://berrywalk.co.kr/bwf-owner-signup/');
    $login  = esc_url( wp_login_url( home_url('/owner-questions/') ) );
    return '<div class="bwos-wrap"><div class="bwf-need-login"><p>대표님 핵심 질문지를 작성하려면 로그인이 필요합니다.</p><div class="bwf-login-actions"><a class="bwf-btn" href="'.$login.'">로그인하러 가기</a><a class="bwf-btn-secondary" href="'.$signup.'">회원가입하러 가기</a></div></div></div>';
  }
  $uid=get_current_user_id();
  $old=get_transient('bwf_owner_old_'.$uid)?:[]; delete_transient('bwf_owner_old_'.$uid);
  $err=get_transient('bwf_owner_err_'.$uid)?:[]; delete_transient('bwf_owner_err_'.$uid);
  return bwf_render_owner_form(['mode'=>'create','saved'=>$old,'errs'=>$err]);
});
add_shortcode('bw_owner_form', fn()=>do_shortcode('[bwf_owner_questions]'));
add_shortcode('bw_owner_edit', function($atts){
  if (!is_user_logged_in()) return '<div class="bwf-form">로그인이 필요합니다.</div>';
  $id=(int)($atts['id']??($_GET['id']??0));
  $post=get_post($id);
  if(!$post || $post->post_type!=='bwf_owner_answer') return '<div class="bwf-form">데이터가 없습니다.</div>';
  if((int)$post->post_author!==get_current_user_id() && !current_user_can('edit_post',$id)) return '<div class="bwf-form">권한이 없습니다.</div>';
  $uid=get_current_user_id();
  $old=get_transient('bwf_owner_old_'.$uid)?:[]; delete_transient('bwf_owner_old_'.$uid);
  $err=get_transient('bwf_owner_err_'.$uid)?:[]; delete_transient('bwf_owner_err_'.$uid);
  return bwf_render_owner_form(['mode'=>'edit','post'=>$post,'saved'=>$old,'errs'=>$err]);
});

`$nl
===== FILE: bw-owner-suite-acf\includes\save.php (7163 bytes, 203 lines) =====
`$ext
<?php
/**
 * 대표 질문지 저장 + 텔레그램 알림(디버그 포함)
 */
if (!defined('ABSPATH')) exit;

/* 혹시 남아있을지 모르는 이전 핸들러 제거 */
remove_action('admin_post_bwf_owner_save',     'bwf_owner_handle_save');
remove_action('admin_post_nopriv_bwf_owner_save','bwf_owner_handle_save');

/* 저장 엔드포인트 */
add_action('admin_post_bwf_owner_save',      'bwf_owner_save');
add_action('admin_post_nopriv_bwf_owner_save','bwf_owner_save');

function bwf_owner_save(){
  if (!is_user_logged_in()) { wp_safe_redirect(home_url('/')); exit; }
  check_admin_referer('bwf_owner_save','bwf_owner_nonce');

  $uid = get_current_user_id();

  /** 중복 제출 잠금(8초) */
  $lock_key = 'bwf_owner_lock_'.$uid;
  if (get_transient($lock_key)) { wp_safe_redirect(home_url('/my-questions/')); exit; }
  set_transient($lock_key, 1, 8);

  /** 폼 값 */
  $post_id = (int)($_POST['post_id'] ?? 0);
  $src     = (array)($_POST['q'] ?? []);

  /** 질문 정의/검증 */
  $cfg = function_exists('bwf_owner_cfg') ? bwf_owner_cfg() : ['qs'=>[], 'min'=>200];
  $min = (int)($cfg['min'] ?? 200);
  $ans = []; $err = [];

  foreach ($cfg['qs'] as $q) {
    $id   = $q['id'];
    $type = $q['type'] ?? 'textarea';
    $req  = !empty($q['required']);
    $m    = (int)($q['min'] ?? $min);

    if ($type === 'group') {
      $ans[$id] = [];
      foreach (($q['sub'] ?? []) as $sub) {
        $sid = $sub['id'];
        $v   = trim((string)($src[$id][$sid] ?? ''));
        $ans[$id][$sid] = sanitize_textarea_field($v);
        if (!empty($sub['required']) && $v==='') { $err[$id][$sid] = true; }
      }
    } else {
      $v = trim((string)($src[$id] ?? ''));
      $ans[$id] = sanitize_textarea_field($v);
      if ($req && mb_strlen($v) < $m) { $err[$id] = true; }
    }
  }

  /** 검증 실패 → 폼으로 되돌리기 */
  if (!empty($err)) {
    set_transient('bwf_owner_old_'.$uid, $src, 60);
    set_transient('bwf_owner_err_'.$uid, $err, 60);
    delete_transient($lock_key);
    wp_safe_redirect(wp_get_referer() ?: home_url('/owner-questions/'));
    exit;
  }

  /** 제목 규칙: "회사명 - #N 피드백" (새로 만들 때만 계산) */
  $company = trim((string)get_user_meta($uid,'bw_company_name',true));
  if ($company==='') $company = wp_get_current_user()->display_name;

  $is_new = ($post_id === 0);
  if ($is_new) {
    $count = (int) (new WP_Query([
      'post_type'      => 'bwf_owner_answer',
      'post_status'    => 'any',
      'author'         => $uid,
      'fields'         => 'ids',
      'posts_per_page' => -1
    ]))->found_posts;
    $seq   = $count + 1;
    $title = sprintf('%s - #%d 피드백', $company, $seq);
  } else {
    $title = get_post_field('post_title', $post_id);
  }

  /** 저장/수정 */
  $postarr = [
    'post_type'   => 'bwf_owner_answer',
    'post_status' => 'private',
    'post_title'  => $title,
    'post_author' => $uid,
  ];
  if ($post_id) { $postarr['ID'] = $post_id; $pid = wp_update_post($postarr, true); }
  else          { $pid = wp_insert_post($postarr, true); }

  if (is_wp_error($pid)) { delete_transient($lock_key); wp_die($pid); }

  update_post_meta($pid, 'bwf_answers', $ans);

  // 번호 캐시(목록 보정용)
  if ($is_new && preg_match('~#(\d+)~', $title, $m)) {
    update_post_meta($pid, '_bw_seq_cache', (int)$m[1]);
  }

  /** 텔레그램 알림 */
  bwf_send_telegram_notice($pid, $uid, $is_new);

  delete_transient($lock_key);
  wp_safe_redirect( add_query_arg(['id'=>$pid], home_url('/my-question-view/')) );
  exit;
}


/* ===================== 텔레그램 전송 + 디버그 ===================== */
/**
 * 상수(둘 중 아무 세트나 사용 가능):
 *   define('BWF_TG_BOT',  '123456789:BOT_TOKEN');
 *   define('BWF_TG_CHAT', '@your_channel_or_-100xxxxxxxxxx');
 *  또는
 *   define('BW_TG_BOT_TOKEN', '123456789:BOT_TOKEN');
 *   define('BW_TG_CHAT_ID',   '@your_channel_or_-100xxxxxxxxxx');
 */

function bwf__tg_conf(){
  $bot  = defined('BWF_TG_BOT')       ? BWF_TG_BOT
        : (defined('BW_TG_BOT_TOKEN') ? BW_TG_BOT_TOKEN : '');
  $chat = defined('BWF_TG_CHAT')      ? BWF_TG_CHAT
        : (defined('BW_TG_CHAT_ID')   ? BW_TG_CHAT_ID   : '');
  return [$bot, $chat];
}
function bwf__tg_log($data){
  set_transient('bwf_tg_debug', $data, 120);
  error_log('[BWF_TG] '.print_r($data, true));
}

/** 전송 */
function bwf_send_telegram_notice($post_id, $user_id, $is_new){
  list($BOT, $CHAT_RAW) = bwf__tg_conf();
  if (!$BOT || !$CHAT_RAW) { bwf__tg_log(['stage'=>'skip','reason'=>'missing_bot_or_chat']); return; }

  // chat_id 정규화
  $chat = trim($CHAT_RAW);
  if (preg_match('~t\.me/([A-Za-z0-9_]+)$~i', $chat, $m)) $chat = '@'.$m[1];
  if ($chat !== '' && $chat[0] !== '@' && $chat[0] !== '-' && !preg_match('~^-?\d+$~', $chat)) $chat = '@'.$chat;
  if (preg_match('~bot$~i', $chat)) { bwf__tg_log(['stage'=>'abort','reason'=>'chat_is_bot_username','chat'=>$chat]); return; }

  $u       = get_userdata($user_id);
  $company = get_user_meta($user_id,'bw_company_name',true);
  $phone   = get_user_meta($user_id,'bw_phone',true);
  $title   = $post_id ? get_post_field('post_title', $post_id) : '테스트';
  $url     = $post_id ? add_query_arg(['id'=>$post_id], home_url('/my-question-view/')) : home_url('/');
  $verb    = $is_new ? '새 피드백 작성' : '피드백 수정';

  $lines = [
    "✅ {$verb}",
    "제목: {$title}",
    "대표: {$u->display_name} (@{$u->user_login})",
    "회사: " . ($company ?: '—'),
    "연락처: " . ($phone ?: '—'),
    "보기: {$url}",
  ];
  $text = implode("\n", $lines);

  $endpoint = 'https://api.telegram.org/bot'.$BOT.'/sendMessage';
  $args = [
    'timeout' => 15,
    'headers' => ['Accept'=>'application/json'],
    'body'    => [
      'chat_id'                 => $chat,
      'text'                    => $text,
      'parse_mode'              => 'HTML',
      'disable_web_page_preview'=> true,
    ]
  ];

  $res = wp_remote_post($endpoint, $args);

  if (is_wp_error($res)) {
    bwf__tg_log(['stage'=>'request','ok'=>false,'error'=>$res->get_error_message(),'chat'=>$chat]);
  } else {
    $code = wp_remote_retrieve_response_code($res);
    $body = wp_remote_retrieve_body($res);
    $json = json_decode($body, true);
    bwf__tg_log(['stage'=>'request','ok'=>($code===200 && !empty($json['ok'])),'code'=>$code,'chat'=>$chat,'body'=>$body]);
  }
}

/** 관리자에게 1회성 디버그 알림 */
add_action('admin_notices', function(){
  if (!current_user_can('manage_options')) return;
  $d = get_transient('bwf_tg_debug'); if(!$d) return;
  delete_transient('bwf_tg_debug');
  echo '<div class="notice notice-info"><p><strong>텔레그램 전송 디버그</strong></p><pre style="white-space:pre-wrap">';
  echo esc_html(print_r($d, true));
  echo '</pre></div>';
});

/** 전송 테스트: /wp-admin/?bw_tg_test=1 */
add_action('admin_init', function(){
  if (current_user_can('manage_options') && isset($_GET['bw_tg_test'])) {
    bwf_send_telegram_notice(0, get_current_user_id(), true);
    wp_die('텔레그램 테스트 전송 시도 완료 — 관리자 알림 또는 PHP error_log에서 결과 확인');
  }
});

`$nl
===== FILE: bw-owner-suite-acf\includes\signup.php (13817 bytes, 246 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

/* 역할 보장 */
add_action('init', function(){
  if (!get_role('bw_owner')) add_role('bw_owner','대표',['read'=>true]);
});

/* --- 관리자 사용자 목록 컬럼 + 프로필 편집 영역 --- */
add_filter('manage_users_columns', function($cols){
  $cols['bw_owner_meta'] = '대표 인적사항';
  return $cols;
});
add_filter('manage_users_custom_column', function($out, $col, $user_id){
  if ($col !== 'bw_owner_meta') return $out;
  $u = get_userdata($user_id);
  $pairs = [
    '회사'     => get_user_meta($user_id,'bw_company_name',true),
    '업종'     => get_user_meta($user_id,'bw_industry',true),
    '직원 수'  => get_user_meta($user_id,'bw_employees',true),
    '휴대폰'   => get_user_meta($user_id,'bw_phone',true),
    '연락시간' => get_user_meta($user_id,'bw_contact_window',true),
    '유입경로' => get_user_meta($user_id,'bw_discover',true),
    '웹사이트' => $u ? $u->user_url : '',
  ];
  $html  = '<div style="line-height:1.5">';
  foreach($pairs as $k=>$v){
    $val = ($v === '' ? '—' : $v);
    $html .= '<div><strong>'.$k.'</strong> '.$val.'</div>';
  }
  $html .= '</div>';
  return $html;
}, 10, 3);

/* 프로필 편집 폼 */
add_action('show_user_profile','bwf_owner_profile_fields');
add_action('edit_user_profile','bwf_owner_profile_fields');
function bwf_owner_profile_fields($user){
  ?>
  <h2>대표 인적사항</h2>
  <table class="form-table" role="presentation">
    <tr><th><label>회사명</label></th><td><input type="text" name="bw_company_name" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_company_name',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>업종</label></th><td><input type="text" name="bw_industry" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_industry',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>직원 수</label></th><td><input type="number" name="bw_employees" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_employees',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>휴대폰</label></th><td><input type="text" name="bw_phone" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_phone',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>연락 가능한 시간대</label></th><td><input type="text" name="bw_contact_window" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_contact_window',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>알게 된 경로</label></th><td><input type="text" name="bw_discover" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_discover',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>웹사이트 URL</label></th><td><input type="url" name="user_url_bwf" value="<?php echo esc_attr(get_userdata($user->ID)->user_url); ?>" class="regular-text" placeholder="https://"></td></tr>
  </table>
  <?php
}
add_action('personal_options_update','bwf_owner_profile_save');
add_action('edit_user_profile_update','bwf_owner_profile_save');
function bwf_owner_profile_save($user_id){
  foreach(['bw_company_name','bw_industry','bw_employees','bw_phone','bw_contact_window','bw_discover'] as $k){
    if(isset($_POST[$k])) update_user_meta($user_id,$k, sanitize_text_field($_POST[$k]));
  }
  if(isset($_POST['user_url_bwf'])){
    wp_update_user(['ID'=>$user_id,'user_url'=>esc_url_raw($_POST['user_url_bwf'])]);
  }
}

/* --- 대표 회원가입 폼 --- */
add_shortcode('bwf_signup_representative', function () {
  wp_enqueue_style('bwf-forms');

  // 에러/이전값 표시
  $err = get_transient('bwf_signup_err'); delete_transient('bwf_signup_err');
  $old = get_transient('bwf_signup_old'); delete_transient('bwf_signup_old');

  if (is_user_logged_in()) {
    return '<div class="bwos-wrap" style="margin-top:40px;margin-bottom:24px">
      <p style="margin:0 0 18px;font-weight:700">로그인되었습니다.</p>
      <div class="bwf-actions" style="margin-top:0">
        <a class="bwf-btn" href="'.esc_url(home_url('/owner-questions/')).'">질문 등록하기</a>
        <a class="bwf-btn-secondary" href="'.esc_url(home_url('/my-questions/')).'">내 질문 목록 보기</a>
      </div>
    </div>';
  }

  ob_start(); ?>
  <form method="post" class="bwf-form bwf-grid" id="bwf-signup-rep" action="<?php echo esc_url(admin_url('admin-post.php')); ?>" novalidate>
    <input type="hidden" name="action" value="bwf_signup_rep">
    <?php wp_nonce_field('bwf_signup_rep','bwf_nonce'); ?>

    <h2 class="bwf-title bwf-col-full" style="margin-top:8px;margin-bottom:10px">대표 회원가입</h2>
    <?php if($err): ?>
      <div class="bwf-card bwf-col-full" style="border-color:#fecaca;background:#fff1f2;color:#7f1d1d;margin-bottom:10px"><?php echo esc_html($err); ?></div>
    <?php endif; ?>
    <p class="bwf-required-note bwf-col-full" style="margin-top:0;margin-bottom:14px">* 표시는 필수 입력</p>

    <div><label style="margin-bottom:14px">아이디 *</label><input type="text" name="user_login" value="<?php echo esc_attr($old['user_login']??''); ?>" pattern="[A-Za-z0-9_\.\-]{4,32}" required></div>
    <div><label style="margin-bottom:14px">비밀번호 *</label><input type="password" name="user_pass" required></div>
    <div><label style="margin-bottom:14px">이메일 *</label><input type="email" name="user_email" value="<?php echo esc_attr($old['user_email']??''); ?>" required></div>
    <div><label style="margin-bottom:14px">이름 *</label><input type="text" name="first_name" value="<?php echo esc_attr($old['first_name']??''); ?>" required></div>

    <div><label style="margin-bottom:14px">회사명 *</label><input type="text" name="bw_company_name" value="<?php echo esc_attr($old['bw_company_name']??''); ?>" required></div>
    <div><label style="margin-bottom:14px">업종 *</label>
      <select name="bw_industry" required>
        <?php $sel = $old['bw_industry']??''; ?>
        <option value="">선택</option>
        <option value="IT/서비스" <?php selected($sel,'IT/서비스'); ?>>IT/서비스</option>
        <option value="커머스" <?php selected($sel,'커머스'); ?>>커머스</option>
        <option value="기타" <?php selected($sel,'기타'); ?>>기타</option>
      </select>
    </div>
    <div><label style="margin-bottom:14px">직원 수 *</label><input type="number" name="bw_employees" value="<?php echo esc_attr($old['bw_employees']??''); ?>" min="1" required></div>
    <div><label style="margin-bottom:14px">홈페이지 URL</label><input type="url" name="user_url" value="<?php echo esc_attr($old['user_url']??''); ?>" placeholder="https://"></div>

    <div class="bwf-col-full">
      <label style="margin-bottom:14px">알게 된 경로 *</label>
      <?php $srcSel = $old['bw_discover']??''; ?>
      <select name="bw_discover" id="bwf-source" required>
        <option value="">선택</option><option value="검색" <?php selected($srcSel,'검색'); ?>>검색</option><option value="SNS" <?php selected($srcSel,'SNS'); ?>>SNS</option><option value="지인추천" <?php selected($srcSel,'지인추천'); ?>>지인추천</option><option value="기타" <?php selected($srcSel,'기타'); ?>>기타</option>
      </select>
      <input type="text" name="source_etc" id="bwf-source-etc" placeholder="기타 경로" class="bwf-col-full <?php echo ($srcSel==='기타'?'':'bwf-hidden'); ?>" style="margin-top:8px" value="<?php echo esc_attr($old['source_etc']??''); ?>">
    </div>

    <div><label style="margin-bottom:14px">휴대폰 번호 *</label>
      <input type="tel" name="bw_phone" id="bwf-phone" inputmode="numeric" placeholder="010-1234-5678" maxlength="13" value="<?php echo esc_attr($old['bw_phone']??''); ?>" required>
    </div>
    <div><label style="margin-bottom:14px">연락 가능한 시간대 *</label><input type="text" name="bw_contact_window" value="<?php echo esc_attr($old['bw_contact_window']??''); ?>" placeholder="예: 평일 13:00~18:00" required></div>

    <div class="bwf-actions bwf-col-full" style="margin-top:18px">
      <button type="submit" name="bwf_register" class="bwf-btn">회원가입</button>
      <span id="bwf-hint" style="font-size:13px;color:#475569"></span>
    </div>

    <script>
    (function(){
      const f=document.getElementById('bwf-signup-rep'),
            src=f.querySelector('#bwf-source'),
            etc=f.querySelector('#bwf-source-etc'),
            tel=f.querySelector('#bwf-phone'),
            hint=document.getElementById('bwf-hint');

      function showEtc(){ if(src.value==='기타'){ etc.classList.remove('bwf-hidden'); } else { etc.classList.add('bwf-hidden'); etc.value=''; } }
      src.addEventListener('change',showEtc); showEtc();

      const dig=s=>String(s||'').replace(/\D/g,'');
      function fmt(raw){ const d=dig(raw).slice(0,11); if(d.length<=3) return d; if(d.length<=7) return d.replace(/^(\d{3})(\d{0,4})$/,'$1-$2'); return d.replace(/^(\d{3})(\d{4})(\d{0,4}).*$/,'$1-$2-$3'); }
      function norm(){ tel.value=fmt(tel.value); try{ tel.setSelectionRange(tel.value.length,tel.value.length);}catch(e){} }
      ['input','keyup','change','paste','blur','focus'].forEach(ev=> tel.addEventListener(ev,norm)); norm();

      f.addEventListener('submit',function(ev){
        norm();
        // 필수항목 검증
        const must=[...f.querySelectorAll('[required]')]; let ok=true; let first=null;
        must.forEach(el=>{
          el.classList.remove('bwf-invalid'); el.setCustomValidity('');
          if(el===tel && !/^010-\d{3,4}-\d{4}$/.test(tel.value)){ el.setCustomValidity('휴대폰 번호는 010-1234-5678 형식'); }
          if(el.name==='bw_discover' && src.value==='기타' && (etc.value||'').trim()===''){ el.setCustomValidity('기타 경로를 입력해 주세요'); }
          if(!el.checkValidity()){ ok=false; if(!first) first=el; el.classList.add('bwf-invalid'); }
        });
        if(!ok){ ev.preventDefault(); hint.textContent='입력이 필요한 항목이 있어요.'; hint.style.color='#ef4444'; first.scrollIntoView({behavior:'smooth',block:'center'}); }
        else   { hint.textContent='제출 중입니다…'; hint.style.color='#475569'; }
      });
    })();
    </script>
  </form>
  <?php
  return ob_get_clean();
});

/* 제출 처리 */
add_action('admin_post_nopriv_bwf_signup_rep','bwf_handle_signup_rep');
function bwf_handle_signup_rep(){
  $old = $_POST; unset($old['action'],$old['bwf_nonce'],$old['user_pass']);
  set_transient('bwf_signup_old',$old,60);

  $nonce = sanitize_text_field($_POST['bwf_nonce'] ?? '');
  if (!wp_verify_nonce($nonce,'bwf_signup_rep')) { set_transient('bwf_signup_err','유효하지 않은 요청입니다.',60); wp_safe_redirect(wp_get_referer()?:home_url('/')); exit; }

  $user_login=sanitize_user($_POST['user_login']??'');
  $user_email=sanitize_email($_POST['user_email']??'');
  $user_pass =$_POST['user_pass']??'';
  $first_name=sanitize_text_field($_POST['first_name']??'');

  if (!$user_login||!$user_email||!$user_pass||!$first_name){ set_transient('bwf_signup_err','필수 항목이 누락되었습니다.',60); wp_safe_redirect(wp_get_referer()?:home_url('/')); exit; }

  $uid = wp_insert_user([
    'user_login'=>$user_login,'user_email'=>$user_email,'user_pass'=>$user_pass,
    'first_name'=>$first_name,'role'=>'bw_owner','user_url'=>esc_url_raw($_POST['user_url']??'')
  ]);

  if (is_wp_error($uid)) {
    set_transient('bwf_signup_err', $uid->get_error_message(), 60);
    wp_safe_redirect(wp_get_referer()?:home_url('/')); exit;
  }

  foreach(['bw_company_name','bw_industry','bw_employees','bw_contact_window','bw_discover','bw_phone'] as $k){
    if(isset($_POST[$k])) update_user_meta($uid,$k,sanitize_text_field($_POST[$k]));
  }
  if (($_POST['bw_discover']??'')==='기타' && !empty($_POST['source_etc'])) {
    update_user_meta($uid,'bw_discover','etc: '.sanitize_text_field($_POST['source_etc']));
  }

  delete_transient('bwf_signup_old');

  wp_set_current_user($uid); wp_set_auth_cookie($uid);
  wp_safe_redirect(home_url('/owner-questions/')); exit;
}


/* ===== 관리자 > 대표 질문지( CPT ) 목록 컬럼/제목 ===== */
add_filter('manage_edit-bwf_owner_answer_columns', function($cols){
  $new = [];
  $new['cb']      = $cols['cb'];
  $new['title']   = '제목';
  $new['author']  = '작성자';
  $new['company'] = '회사명';
  $new['website'] = '웹사이트';
  $new['date']    = '저장 시각';
  return $new;
});
add_action('manage_bwf_owner_answer_posts_custom_column', function($col, $post_id){
  if($col==='company'){
    $author = (int)get_post_field('post_author',$post_id);
    echo esc_html( get_user_meta($author,'bw_company_name',true) ?: '—' );
  } elseif($col==='website'){
    $author = (int)get_post_field('post_author',$post_id);
    $url = get_userdata($author)->user_url;
    echo $url ? '<a href="'.esc_url($url).'" target="_blank" rel="noopener">열기</a>' : '—';
  }
},10,2);

/* 관리자 목록에서 예전 글도 보기 좋은 제목으로 표시 */
add_filter('the_title', function($title, $post_id){
  if (!is_admin()) return $title;
  $p = get_post($post_id);
  if(!$p || $p->post_type!=='bwf_owner_answer') return $title;

  // 이미 새 규칙이면 그대로
  if (strpos($title,'#')!==false && strpos($title,'피드백')!==false) return $title;

  $author  = (int)$p->post_author;
  $company = get_user_meta($author,'bw_company_name',true);
  if($company==='') $company = get_userdata($author)->display_name;

  // 사용자 기준 순번 계산 (오래된 순서)
  $ids = get_posts(['post_type'=>'bwf_owner_answer','author'=>$author,'post_status'=>'any','fields'=>'ids','numberposts'=>-1,'orderby'=>'date','order'=>'ASC']);
  $pos = array_search($post_id, $ids, true);
  $idx = ($pos===false? count($ids): $pos) + 1;

  return sprintf('%s - #%d 피드백', $company, $idx);
},10,2);
`$nl
===== FILE: bw-owner-suite-acf\includes\view-list.php (7622 bytes, 186 lines) =====
`$ext
<?php
/* /includes/view-list.php — 단건 보기 + 마이페이지 목록 */
if (!defined('ABSPATH')) exit;

/* 공통 URL 헬퍼 (중복 선언 방지) */
if (!function_exists('bwf_owner_view_url')) { function bwf_owner_view_url(){ return home_url('/my-question-view/'); } }
if (!function_exists('bwf_owner_edit_url')) { function bwf_owner_edit_url(){ return home_url('/owner-edit/'); } }
if (!function_exists('bwf_owner_list_url')) { function bwf_owner_list_url(){ return home_url('/my-questions/'); } }

/** 단건 보기: [bw_owner_view] / [bwf_owner_view] */
function bwos_render_single_view($atts){
  if (!is_user_logged_in()) return '<div class="bwf-form">로그인이 필요합니다.</div>';

  $id = (int)($atts['id'] ?? ($_GET['id'] ?? 0));
  $p  = get_post($id);
  if(!$p || $p->post_type !== 'bwf_owner_answer') return '<div class="bwf-form">데이터가 없습니다.</div>';
  if((int)$p->post_author !== get_current_user_id() && !current_user_can('read_post', $id)) return '<div class="bwf-form">권한이 없습니다.</div>';

  wp_enqueue_style('bwf-forms');

  // 질문 정의 & 답변
  $cfg = function_exists('bwf_owner_cfg') ? bwf_owner_cfg() : ['title'=>'대표 질문지','qs'=>[]];
  $ans = (array)get_post_meta($id, 'bwf_answers', true);

  // 작성자 메타(요청에 따라 최소 표시만)
  $au   = get_userdata($p->post_author);
  $meta = [
    '회사명'   => get_user_meta($p->post_author,'bw_company_name',true),
    '웹사이트' => $au && $au->user_url ? $au->user_url : '',
    '연락시간' => get_user_meta($p->post_author,'bw_contact_window',true),
    '휴대폰'   => get_user_meta($p->post_author,'bw_phone',true),
  ];

  ob_start(); ?>
  <div class="bwos-wrap">
    <h2 class="bwf-title"><?php echo esc_html($cfg['title']); ?></h2>

    <div class="bwf-card" style="margin-bottom:16px">
      <strong>작성 정보</strong>
      <div style="display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:6px 14px;margin-top:8px">
        <?php foreach($meta as $k=>$v): ?>
          <div>
            <span style="color:#64748b"><?php echo esc_html($k); ?></span> :
            <?php
              if ($k==='웹사이트' && $v) {
                echo '<a href="'.esc_url($v).'" target="_blank" rel="noopener">'.esc_html($v).'</a>';
              } else {
                echo $v ? esc_html($v) : '—';
              }
            ?>
          </div>
        <?php endforeach; ?>
      </div>
    </div>

    <?php foreach(($cfg['qs'] ?? []) as $q):
      $qid = $q['id'] ?? '';
      if(!$qid) continue; ?>
      <div class="bwf-field">
        <label><?php echo esc_html($q['label']); ?></label>
        <?php if(($q['type'] ?? '') === 'group'): ?>
          <?php foreach(($q['sub'] ?? []) as $sub):
            $sid = $sub['id']; $v = trim((string)($ans[$qid][$sid] ?? '')); ?>
            <div class="bwf-sub">
              <div class="bwf-help"><?php echo esc_html($sub['label']); ?></div>
              <div class="bwf-card"><?php echo nl2br(esc_html($v)); ?></div>
            </div>
          <?php endforeach; ?>
        <?php else:
          $v = trim((string)($ans[$qid] ?? '')); ?>
          <div class="bwf-card"><?php echo nl2br(esc_html($v)); ?></div>
        <?php endif; ?>
      </div>
    <?php endforeach; ?>

    <div class="bwf-actions" style="justify-content:center">
      <a class="bwf-btn" href="<?php echo esc_url(add_query_arg(['id'=>$p->ID], bwf_owner_edit_url())); ?>">수정</a>
      <a class="bwf-btn-secondary" href="<?php echo esc_url(bwf_owner_list_url()); ?>">목록</a>
    </div>
  </div>
  <?php
  return ob_get_clean();
}
add_shortcode('bw_owner_view','bwos_render_single_view');
add_shortcode('bwf_owner_view','bwos_render_single_view'); // alias

/** 마이페이지 목록: [bw_owner_list] / [bw_my_questions] */
add_shortcode('bw_owner_list', function($atts){
  if (!is_user_logged_in()) return '<div class="bwf-form">로그인이 필요합니다.</div>';

  $paged = max(1, (int)get_query_var('paged', 0));
  if(!$paged) $paged = max(1, (int)($_GET['pg'] ?? 1));

  $q = new WP_Query([
    'post_type'      => 'bwf_owner_answer',
    'post_status'    => 'private',
    'author'         => get_current_user_id(),
    'posts_per_page' => 8,
    'orderby'        => 'date',
    'order'          => 'DESC',
    'paged'          => $paged,
    'fields'         => 'ids'
  ]);

  wp_enqueue_style('bwf-forms');

  // 사용자 회사명
  $uid     = get_current_user_id();
  $company = trim((string)get_user_meta($uid,'bw_company_name',true));
  if($company==='') $company = wp_get_current_user()->display_name;

  ob_start(); ?>
  <div class="bwos-wrap">
    <h2 class="bwf-title" style="margin-bottom:16px">마이페이지</h2>

    <div class="bwf-actions" style="justify-content:flex-start;margin:0 0 14px">
      <a class="bwf-btn" href="<?php echo esc_url(home_url('/owner-questions/')); ?>">새 피드백 질문하기</a>
    </div>

    <div class="bwos-list">
      <?php
      if ($q->have_posts()):
        foreach ($q->posts as $pid):
          // 제목은 저장된 raw post_title 사용(‘비공개:’ 접두 회피)
          $raw_title = get_post_field('post_title', $pid);

          // 혹시 과거 글(구 규칙)이라면 회사명 - #N 피드백으로 보정
          if (strpos($raw_title,'#') === false || strpos($raw_title,'피드백') === false) {
            // 최신글부터 역순이지만, 사용자는 번호만 구분하면 되므로 글ID 끝 3자리 정도를 보조로 표기할 수도 있음
            // 여기서는 간단히 저장 시각 기준 시퀀스를 표시
            $seq = (int) get_post_meta($pid, '_bw_seq_cache', true);
            if ($seq <= 0) {
              // 없으면 임시 계산: 내 글 전부에서 현재 PID의 역순 인덱스
              $all = new WP_Query([
                'post_type'=>'bwf_owner_answer','post_status'=>'any','author'=>$uid,
                'orderby'=>'date','order'=>'ASC','fields'=>'ids','posts_per_page'=>-1
              ]);
              $seq = 0;
              foreach ($all->posts as $i=>$id) { if ($id == $pid) { $seq = $i+1; break; } }
            }
            $display = sprintf('%s - #%d 피드백', $company, max(1,$seq));
          } else {
            $display = $raw_title;
          }

          $when = get_the_date('Y-m-d H:i', $pid);
          $view = esc_url(add_query_arg(['id'=>$pid], bwf_owner_view_url()));
          $edit = esc_url(add_query_arg(['id'=>$pid], bwf_owner_edit_url()));
      ?>
        <div class="bwos-card">
          <h4><?php echo esc_html($display); ?></h4>
          <div class="meta"><?php echo esc_html($when); ?></div>
          <div class="row">
            <a href="<?php echo $view; ?>">보기</a>
            <a href="<?php echo $edit; ?>">수정</a>
          </div>
        </div>
      <?php
        endforeach;
      else: ?>
        <p>작성한 내역이 없습니다. <a href="<?php echo esc_url(home_url('/owner-questions/')); ?>">새 피드백 질문하기</a>로 첫 저장본을 만들어 보세요.</p>
      <?php endif; ?>
    </div>

    <?php
    $links = paginate_links([
      'total'     => max(1,(int)$q->max_num_pages),
      'current'   => $paged,
      'type'      => 'array',
      'mid_size'  => 2,
      'prev_text' => '이전',
      'next_text' => '다음'
    ]);
    if ($links) {
      echo '<div class="bwos-pg">';
      foreach($links as $l) echo $l.' ';
      echo '</div>';
    }
    wp_reset_postdata();
    ?>
  </div>
  <?php
  return ob_get_clean();
});
add_shortcode('bw_my_questions', fn($a)=>do_shortcode('[bw_owner_list]'));

`$nl

`$nl
===== FILE: pack-code.ps1 (4063 bytes, 113 lines) =====
`$ext
param(
  [string]$Root = ".",
  [string]$Out = "codepack.txt",
  [string]$IncludeExt = ".php,.js,.ts,.css,.scss,.html,.htm,.json,.md,.yml,.yaml,.xml,.sh,.ps1,.ini,.txt,.sql,.twig,.vue",
  # 제외할 디렉터리들 (쉼표로 구분)
  [string]$ExcludeDirs = "node_modules,dist,build,vendor,.git,.github,.idea,.vscode,.next,.cache,growth-checklist\plugin-update-checker",
  # 제외할 파일 패턴들 (쉼표로 구분)
  [string]$ExcludeFiles = "*.min.js,*.min.css,*.map,*.lock,*.zip,*.tar,*.gz,*.png,*.jpg,*.jpeg,*.gif,*.webp,*.svg,*.woff,*.woff2,*.ttf,*.eot,*.pdf",
  # 용량 한도
  [int]$MaxFileBytes = 1000000,    # 파일당 최대 1MB
  [int]$MaxTotalBytes = 20000000,  # 전체 최대 20MB
  # 변경 파일만 모드
  [switch]$ChangedOnly,
  [string]$GitRange = ""
)

$ErrorActionPreference = "Stop"
$Root = (Resolve-Path $Root).Path
$include = $IncludeExt.Split(",") | ForEach-Object { $_.Trim().ToLower() } | Where-Object { $_ -ne "" }
$exDirs  = $ExcludeDirs.Split(",")  | ForEach-Object { $_.Trim() }        | Where-Object { $_ -ne "" }
$exFiles = $ExcludeFiles.Split(",") | ForEach-Object { $_.Trim() }        | Where-Object { $_ -ne "" }

function IsTextExt($path) {
  $ext = [IO.Path]::GetExtension($path).ToLower()
  return $include -contains $ext
}
function IsExcludedDir($path) {
  foreach ($d in $exDirs) {
    if ($path -like "*$d*") { return $true }
  }
  return $false
}
function IsExcludedFile($file) {
  foreach ($p in $exFiles) {
    if ([IO.Path]::GetFileName($file) -like $p) { return $true }
  }
  return $false
}

# 파일 목록 수집
$files = @()
if ($ChangedOnly) {
  $gitArgs = @("diff","--name-only")
  if ($GitRange) { $gitArgs += $GitRange }
  $changed = & git @gitArgs 2>$null
  foreach ($rel in $changed) {
    $p = Join-Path $Root $rel
    if (Test-Path $p -PathType Leaf) { $files += (Resolve-Path $p).Path }
  }
} else {
  $files = Get-ChildItem -Path $Root -Recurse -File | ForEach-Object { $_.FullName }
}

# 필터링
$files = $files | Where-Object {
  -not (IsExcludedDir $_) -and
  -not (IsExcludedFile $_) -and
  (IsTextExt $_)
}

# 출력 빌드
$sb = New-Object System.Text.StringBuilder
$totalBytes = 0
$nl = [Environment]::NewLine

# 상단 메타
try {
  $repoUrl = (git -C $Root config --get remote.origin.url)
  $branch  = (git -C $Root rev-parse --abbrev-ref HEAD)
  $tag     = (git -C $Root describe --tags --abbrev=0) 2>$null
  $commit  = (git -C $Root rev-parse --short HEAD)
  $time    = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
  $null = $sb.AppendLine("===== META =====")
  $null = $sb.AppendLine("Repo: $repoUrl")
  $null = $sb.AppendLine("Branch: $branch  |  Tag: $tag  |  Commit: $commit")
  $null = $sb.AppendLine("Generated: $time")
  $null = $sb.AppendLine("")
} catch {}

foreach ($f in $files) {
  try {
    $fi = Get-Item $f
    $size = $fi.Length
    if ($size -gt $MaxFileBytes) {
      $rel = $f.Substring($Root.Length+1)
      $null = $sb.AppendLine("===== FILE: $rel ($size bytes) SKIPPED: > $MaxFileBytes =====$nl")
      continue
    }
    if (($totalBytes + $size) -gt $MaxTotalBytes) {
      $null = $sb.AppendLine("===== STOP: total size would exceed $MaxTotalBytes bytes. Remaining files omitted. =====$nl")
      break
    }

    $rel = $f.Substring($Root.Length+1)
    $content = (Get-Content -Path $f -Raw -Encoding UTF8)
    $lineCount = ($content -split "`r?`n").Count
    $ext = [IO.Path]::GetExtension($f).TrimStart(".").ToLower()
    if (-not $ext) { $ext = "text" }

    $null = $sb.AppendLine("===== FILE: $rel ($size bytes, $lineCount lines) =====")
    $null = $sb.AppendLine("```$ext")
    $null = $sb.AppendLine($content)
    $null = $sb.AppendLine("```$nl")

    $totalBytes += $size
  } catch {
    $null = $sb.AppendLine("===== FILE: $f ERROR: $($_.Exception.Message) =====$nl")
  }
}

[IO.File]::WriteAllText((Join-Path $Root $Out), $sb.ToString(), [Text.Encoding]::UTF8)
"생성 완료: $(Join-Path $Root $Out)  (총 approx $totalBytes bytes)"

`$nl
===== FILE: berrywalk-feedback-acf\berrywalk-feedback-acf.php (1308 bytes, 33 lines) =====
`$ext
<?php
/**
 * Plugin Name: BW Owner Suite (light)
 * Description: 대표 질문지 + 회원가입(대표 전용) + 마이페이지. ACF 기반 경량 플러그인.
 * Version: 1.0.4
 * Author: Berrywalk
 */
if (!defined('ABSPATH')) exit;

define('BWOS_VER', '1.2.2');
define('BWOS_DIR', plugin_dir_path(__FILE__));
define('BWOS_URL', plugin_dir_url(__FILE__));

// 텔레그램
define('BW_TG_BOT_TOKEN', '8060380419:AAFDlmr9TmX1K5Ocagl6WafN5s2O6oVnvdw');  // BotFather에서 발급
define('BW_TG_CHAT_ID',  '@berrywalk_ownerfeedback');                  // 개인(@me) 또는 채널/그룹 ID

require_once BWOS_DIR.'includes/cpt-admin.php';
require_once BWOS_DIR.'includes/form.php';
require_once BWOS_DIR.'includes/signup.php';
require_once BWOS_DIR.'includes/save.php';
require_once BWOS_DIR.'includes/view-list.php';
require_once BWOS_DIR.'includes/acf-fields.php'; // 관리자 ACF 메타박스(5문항)

add_action('wp_enqueue_scripts', function(){
  $css = BWOS_URL.'assets/owner-form.css';
  $js  = BWOS_URL.'assets/owner-form.js';
  wp_register_style ('bwos-form', $css, [], BWOS_VER);
  wp_register_style ('bwf-forms', $css, [], BWOS_VER); // alias
  wp_register_script('bwos-form', $js,  ['jquery'], BWOS_VER, true);
  wp_register_script('bwf-forms', $js,  ['jquery'], BWOS_VER, true); // alias
});

`$nl
===== FILE: berrywalk-feedback-acf\README.md (1409 bytes, 40 lines) =====
`$ext
# BW Owner Suite (ACF Minimal)

워드프레스 표준 + ACF만 사용하여
- 회원가입 → 프로필 수정
- 대표 질문(CPT) 작성/수정/보기/목록/복제/삭제
- 저장 알림(메일/텔레그램)

을 한 번에 처리하는 경량 플러그인입니다.

## 설치
1) `Advanced Custom Fields`(ACF) 플러그인을 활성화
2) 워드프레스 관리자 → 플러그인 → 새로 추가 → 플러그인 업로드 → 이 ZIP 업로드 후 활성화
3) 활성화 즉시 아래 페이지가 자동 생성됩니다.
   - `/owner-questions/` 작성
   - `/owner-edit/?id=글ID` 수정
   - `/my-question-view/?id=글ID` 보기
   - `/my-questions/` 내 저장본(보기/수정/복제/삭제)
   - `/my-profile/` 마이프로필
   - `/register/` 회원가입

## 텔레그램 알림(선택)
`wp-config.php`에 아래 상수를 추가하면 저장 시 텔레그램 알림이 전송됩니다.

```php
define('BWF_TG_BOT','123456:ABC...');       // 봇 토큰
define('BWF_TG_CHAT','-1001234567890');     // 채팅 ID
```

## 짧은코드(Shortcodes)
- [bw_register]
- [bw_profile_form]
- [bw_owner_form_acf]
- [bw_owner_edit id="123"]  (또는 /owner-edit/?id=123)
- [bwf_owner_view id="123"]
- [bw_my_questions]

## 주의
- 플러그인 동작을 위해 ACF가 필요합니다.
- 데이터는 CPT `bwf_owner_answer`에 저장되며 리비전이 활성화되어 되돌리기가 가능합니다.

`$nl
===== FILE: berrywalk-feedback-acf\assets\owner-form.css (5415 bytes, 109 lines) =====
`$ext
/* /assets/owner-form.css */

/* ====== Base ====== */
:root{
  --bw-font:17.5px;
  --bw-muted:#64748b;
  --bw-border:#e5e7eb;
  --bw-accent:#6366f1;
  --bw-ok:#16a34a;
  --bw-warn:#ef4444;
  --bw-bg:#f8fafc;
}
body{font-size:var(--bw-font);background:var(--bw-bg)}
.bwos-wrap{max-width:920px;margin:40px auto;padding:0 16px}               /* ⬆ 여백 확대 */
.bwf-title{font-size:30px;line-height:1.25;margin:22px 0 16px}
.bwf-help{color:#0f172a;margin:0 0 18px}

/* ====== Sticky progress (카드형, 배경/테두리 추가) ====== */
.bwos-progress{
  position:sticky;top:64px;z-index:1000;margin:0 0 18px;
  background:#ffffff; border:1px solid var(--bw-border); border-radius:14px;
  padding:12px 14px; box-shadow:0 6px 18px rgba(2,6,23,.06);
}
body.admin-bar .bwos-progress{top:96px}
.bwos-progress .bar{height:10px;background:#f2f4f7;border-radius:999px;overflow:hidden}
.bwos-progress .bar>span{display:block;height:100%;width:0%;background:linear-gradient(90deg,#22d3ee,#6366f1);border-radius:999px;transition:width .2s}
.bwos-progress .status{font-size:12px;color:#334155;margin-top:8px}

/* ====== Field ====== */
.bwf-field{margin:28px 0}                                                  /* ⬆ 여백 확대 */
.bwf-field label{display:block;font-weight:700;margin:0 0 14px;font-size:18px}
.bwf-field textarea,
.bwf-field input[type="text"],
.bwf-field input[type="number"],
.bwf-field input[type="email"],
.bwf-field input[type="tel"],
.bwf-field input[type="url"],
.bwf-field select{
  width:100%;box-sizing:border-box;padding:13px 14px;border:1px solid #d1d5db;border-radius:12px;background:#fff;font-size:16.5px;outline:none
}
.bwf-field textarea:focus,
.bwf-field input:focus,
.bwf-field select:focus{border-color:var(--bw-accent);box-shadow:0 0 0 3px rgba(99,102,241,.15)}

.bwos-field.bwos-error textarea,
.bwos-field.bwos-error input,
.bwos-field.bwos-error select{border-color:var(--bw-warn);background:#fff1f2}
.bwf-invalid{border-color:var(--bw-warn) !important;background:#fff1f2 !important}

/* ====== 설명/예시 – 한국형 카드 스타일 ====== */
.bwf-desc, .bwf-examples{
  margin:10px 0 10px;padding:12px 14px;border:1px dashed #dbe1ea;border-radius:12px;background:#fbfdff
}
.bwf-desc::before{
  content:"설명"; display:inline-block; font-size:12px; font-weight:800; color:#0ea5e9;
  background:#e6f6fb; border:1px solid #bde7f4; border-radius:999px; padding:2px 8px; margin-right:8px
}
.bwf-examples::before{
  content:"예시"; display:inline-block; font-size:12px; font-weight:800; color:#6366f1;
  background:#eef0ff; border:1px solid #dfe3ff; border-radius:999px; padding:2px 8px; margin-right:8px
}
.bwf-examples ul,.bwf-examples ol{margin:6px 0 0 18px}

/* ====== Counter ====== */
.bwos-count{
  display:inline-block;margin-top:8px;font-size:12px;font-weight:700;
  color:var(--bw-muted);background:#f3f4f6;border:1px solid #e5e7eb;border-radius:999px;padding:4px 8px
}
.bwos-count.ok{color:#065f46;background:#ecfdf5;border-color:#bbf7d0}
.bwos-count.need{color:#7c2d12;background:#fff7ed;border-color:#fed7aa}

/* ====== Buttons ====== */
.bwf-actions{display:flex;gap:10px;align-items:center;justify-content:center;margin-top:20px}
.bwf-btn{display:inline-block;padding:12px 18px;border-radius:14px;border:none;background:var(--bw-accent);color:#fff;text-decoration:none;font-weight:700}
.bwf-btn-secondary{display:inline-block;padding:12px 18px;border-radius:14px;border:1px solid #cbd5e1;background:#fff;color:#0f172a;text-decoration:none;font-weight:700}


/* ====== Modal (공용) ====== */
.bwos-modal, .bwf-modal{
  position:fixed;inset:0;display:none;align-items:flex-start;justify-content:center;padding-top:18vh;background:rgba(0,0,0,.45);z-index:100000
}
body.admin-bar .bwos-modal, body.admin-bar .bwf-modal{padding-top:calc(18vh + 32px)}
.bwos-modal.is-open, .bwf-modal.is-open{display:flex}
.bwos-modal-inner, .bwf-modal .bwf-modal__card{
  background:#fff;max-width:560px;width:92vw;padding:22px;border-radius:16px;box-shadow:0 22px 44px rgba(2,6,23,.18)
}
.bwos-modal-inner h4, .bwf-modal h3{margin:0 0 10px;font-size:18px}
.bwos-modal-inner p, .bwf-modal p{margin:0 0 12px;color:#334155}
.bwf-modal__list{margin:6px 0 0 18px;font-size:14px;color:#1f2937}

/* ====== List / View ====== */
.bwf-card{border:1px solid var(--bw-border);background:#fff;border-radius:12px;padding:12px 14px}

/* ====== Signup grid ====== */
.bwf-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px 14px}
.bwf-col-full{grid-column:1/-1}
@media (max-width:720px){.bwf-grid{grid-template-columns:1fr}}
.bwf-hidden{display:none}

/* 마이페이지 카드 & 페이지네이션 */
.bwos-list{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:16px}
@media (max-width:920px){.bwos-list{grid-template-columns:1fr}}
.bwos-card{border:1px solid #e5e7eb;border-radius:14px;padding:14px 16px;background:#fff;box-shadow:0 6px 14px rgba(2,6,23,.05)}
.bwos-card h4{margin:0 0 6px;font-size:17px}
.bwos-card .meta{font-size:12px;color:#64748b;margin-bottom:10px}
.bwos-card .row a{display:inline-block;padding:8px 12px;border-radius:10px;background:#f1f5f9;text-decoration:none;color:#0f172a}
.bwos-pg{margin:18px 0 8px;text-align:center}
.bwos-pg .page-numbers{display:inline-block;padding:8px 12px;border:1px solid #e5e7eb;border-radius:10px;margin:0 3px;text-decoration:none;color:#0f172a}
.bwos-pg .current{background:#6366f1;color:#fff;border-color:#6366f1}
`$nl
===== FILE: berrywalk-feedback-acf\assets\owner-form.js (4147 bytes, 94 lines) =====
`$ext
/* /assets/owner-form.js  (카운터 텍스트 – "몇자 남음" 친절 메시지로) */
(function($){
  if(!$ || !$('.bwos-form').length) return;

  const $form = $('.bwos-form').first();
  const $progress = $form.find('.bwos-progress');
  const reqs = []; let submitted=false;

  function updateProgress(){
    const total=reqs.length, done=reqs.filter(r=>r.valid()).length, pct=total?Math.round(done/total*100):0;
    $progress.find('.bar>span').css('width',pct+'%');
    $progress.find('.status').text('작성 '+done+'/'+total+' ('+pct+'%)');
  }

  function wire($wrap){
    const min = parseInt($wrap.data('min')||200,10);
    const $subs = $wrap.find('.bwf-sub textarea');
    const isGroup = $subs.length>0;
    let $cnt = $wrap.find('.bwos-count'); if(!$cnt.length) $cnt=$('<small class="bwos-count"></small>').appendTo($wrap);

    const setError = bad => $wrap.toggleClass('bwos-error', submitted && !!bad);
    const valid = ()=>{
      if(isGroup){ let ok=true; $subs.each(function(){ if(($(this).val()||'').trim()==='') ok=false; }); return ok; }
      return (($wrap.find('textarea,input[type="text"]').first().val()||'').trim().length >= min);
    };

    const update = ()=>{
      if(isGroup){
        let anyEmpty=false; $subs.each(function(){ if(($(this).val()||'').trim()==='') anyEmpty=true; });
        $cnt.text(anyEmpty ? '질문 3개 모두 작성' : '충족').toggleClass('need',anyEmpty).toggleClass('ok',!anyEmpty);
        setError(anyEmpty);
      }else{
        const v=($wrap.find('textarea,input[type="text"]').first().val()||'').trim();
        const diff = min - v.length;
        if(diff>0){ $cnt.text(diff+'자 남음'); $cnt.removeClass('ok').addClass('need'); }
        else      { $cnt.text('충족'); $cnt.removeClass('need').addClass('ok'); }
        setError(v.length < min);
      }
      updateProgress();
    };

    (isGroup ? $subs : $wrap.find('textarea,input[type="text"]').first()).on('input blur', update);
    reqs.push({wrap:$wrap, valid, update, min}); update();
  }

  $form.find('.bwos-required').each(function(){ wire($(this)); });
  updateProgress();

  const $modal=$('<div class="bwos-modal"><div class="bwos-modal-inner"><h4>입력이 필요한 항목이 있어요</h4><p>아래 항목을 확인해 주세요.</p><ul class="bwf-modal__list"></ul><button type="button" class="bwf-btn-secondary ok">확인</button></div></div>').appendTo('body');
  $modal.on('click','.ok',()=> $modal.removeClass('is-open'));

  let locked=false;
  $form.on('submit',function(e){
    submitted=true; let bad=false; const items=[];
    reqs.forEach(r=>{
      if(!r.valid()){
        bad=true; const lab=r.wrap.find('label').first().text().replace(/\*.*$/,'').trim();
        if(r.wrap.find('.bwf-sub').length){ items.push('· '+lab+' — 3개 질문 모두 작성'); }
        else{
          const len=($r=r.wrap.find('textarea,input[type="text"]').first()).val().trim().length;
          const diff=(r.min||200)-len; items.push('· '+lab+' — 최소 글자수 부족 ('+diff+'자 남음)');
        }
        r.update();
      }
    });
    if(bad){
      e.preventDefault();
      const ul=$modal.find('.bwf-modal__list').empty();
      items.forEach(t=> $('<li/>').text(t).appendTo(ul));
      $modal.addClass('is-open');
      const $first=$form.find('.bwos-error').first(); if($first.length) $('html,body').animate({scrollTop:$first.offset().top-120},180);
      return;
    }
    if(locked){ e.preventDefault(); return; }
    locked=true; $form.find('.bwos-submit').prop('disabled',true).text('저장 중…');
    setTimeout(()=>{ locked=false; $form.find('.bwos-submit').prop('disabled',false).text('저장'); }, 6000);
  });
})(jQuery);

/* === Tab 이동: textarea에서 Tab 누르면 다음 필드로 포커스 === */
(function($){
  const $areas = $('.bwos-form textarea:visible');
  $areas.on('keydown', function(e){
    if(e.key === 'Tab' && !e.shiftKey){
      const list = $('.bwos-form textarea:visible');
      const idx = list.index(this);
      if(idx > -1 && idx < list.length - 1){
        e.preventDefault();
        list.eq(idx + 1).focus();
      }
    }
  });
})(jQuery);

`$nl
===== FILE: berrywalk-feedback-acf\includes\acf-fields.php (3509 bytes, 76 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

add_action('acf/init', function(){
  if (!function_exists('acf_add_local_field_group')) return;

  acf_add_local_field_group([
    'key'=>'group_bwos_owner_v5','title'=>'대표 질문지',
    'fields'=>[
      ['key'=>'f_problem','label'=>'1) 지금, 우리 사업의 가장 큰 고민은 무엇인가요?','name'=>'_acf_problem','type'=>'textarea','required'=>1,'rows'=>8,'instructions'=>'최소 200자 권장'],
      ['key'=>'f_value','label'=>'2) 우리 서비스의 핵심 가치는 무엇인가요?','name'=>'_acf_value','type'=>'textarea','required'=>1,'rows'=>6],
      ['key'=>'f_whom','label'=>'3) 누가 이용해야 하나요? 왜 우리인가요?','name'=>'_acf_ideal_customer','type'=>'textarea','required'=>1,'rows'=>6],
      ['key'=>'f_ask1','label'=>'4-1) 고객에게 묻고 싶은 질문 #1','name'=>'_acf_cq1','type'=>'text'],
      ['key'=>'f_ask2','label'=>'4-2) 고객에게 묻고 싶은 질문 #2','name'=>'_acf_cq2','type'=>'text'],
      ['key'=>'f_ask3','label'=>'4-3) 고객에게 묻고 싶은 질문 #3','name'=>'_acf_cq3','type'=>'text'],
      ['key'=>'f_comp','label'=>'5) 경쟁사 대비 차별점','name'=>'_acf_competitors','type'=>'textarea','required'=>1,'rows'=>6],
    ],
    'location'=>[[['param'=>'post_type','operator'=>'==','value'=>'bwf_owner_answer']]],
    'position'=>'normal','style'=>'default','active'=>true,
  ]);
});


/** 200자 필드 서버 검증 */
add_filter('acf/validate_value', function($valid, $value, $field){
  if ($valid !== true) return $valid;
  $min200 = ['problem','core_value','target_customer','differentiation','sales_blockers','current_channels','growth_goal','next_action'];
  if (in_array($field['name'] ?? '', $min200, true)) {
    if (mb_strlen(trim((string)$value)) < 200) return '최소 200자 이상 작성해 주세요.';
  }
  return $valid;
}, 10, 3);
/* ------- ACF <-> bwf_answers 동기화 ------- */
function bwos_acf_meta_keys(){ // ACF 메타키(name) 매핑
  return [
    '_acf_problem'       => ['id'=>'problem'],
    '_acf_value'         => ['id'=>'value'],
    '_acf_ideal_customer'=> ['id'=>'ideal_customer'],
    '_acf_cq1'           => ['id'=>'ask3','sub'=>'q1'],
    '_acf_cq2'           => ['id'=>'ask3','sub'=>'q2'],
    '_acf_cq3'           => ['id'=>'ask3','sub'=>'q3'],
    '_acf_competitors'   => ['id'=>'competitors'],
  ];
}

/* 편집 화면 로드시 ACF 메타 채워넣기(관리자에서 비어 보이던 문제 해결) */
add_action('load-post.php', function(){
  $pid = isset($_GET['post']) ? (int)$_GET['post'] : 0;
  if(!$pid) return;
  $p = get_post($pid);
  if(!$p || $p->post_type!=='bwf_owner_answer') return;

  $ans = (array)get_post_meta($pid,'bwf_answers',true);
  foreach(bwos_acf_meta_keys() as $meta=>$m){
    $val = '';
    if(empty($m['sub'])) $val = (string)($ans[$m['id']] ?? '');
    else                 $val = (string)($ans[$m['id']][$m['sub']] ?? '');
    update_post_meta($pid, $meta, $val);
  }
});

/* 저장 시 ACF 값으로 bwf_answers 재생성(양방향 동기화) */
add_action('save_post_bwf_owner_answer', function($post_id){
  if(defined('DOING_AUTOSAVE') && DOING_AUTOSAVE) return;
  $ans = [];
  foreach(bwos_acf_meta_keys() as $meta=>$m){
    $v = (string)get_post_meta($post_id,$meta,true);
    if(empty($m['sub'])) $ans[$m['id']] = $v;
    else {
      if(empty($ans[$m['id']])) $ans[$m['id']] = [];
      $ans[$m['id']][$m['sub']] = $v;
    }
  }
  if($ans) update_post_meta($post_id,'bwf_answers',$ans);
}, 20);

`$nl
===== FILE: berrywalk-feedback-acf\includes\cpt-admin.php (871 bytes, 21 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

add_action('init', function(){
  register_post_type('bwf_owner_answer', [
    'label'=>'대표 질문지','labels'=>['name'=>'대표 질문지','add_new_item'=>'새 대표 질문 생성','edit_item'=>'대표 질문 편집'],
    'public'=>false,'exclude_from_search'=>true,'publicly_queryable'=>false,'show_ui'=>true,'show_in_menu'=>true,
    'menu_icon'=>'dashicons-editor-help','supports'=>['author','custom-fields'],'map_meta_cap'=>true,
  ]);
});

add_filter('manage_bwf_owner_answer_posts_columns', function($c){
  return ['cb'=>$c['cb'],'title'=>'제목','author'=>'작성자','created'=>'저장 시각'];
});
add_action('manage_bwf_owner_answer_posts_custom_column', function($col,$post_id){
  if($col==='created'){
    $ts = get_post_timestamp($post_id,'date');
    echo esc_html( wp_date('Y-m-d H:i', $ts) );
  }
}, 10, 2);

`$nl
===== FILE: berrywalk-feedback-acf\includes\form.php (7759 bytes, 127 lines) =====
`$ext
<?php
/* /includes/form.php (핵심 변경만) */
if (!defined('ABSPATH')) exit;

/** 공용 URL (중복 선언 방지) */
if (!function_exists('bwf_owner_view_url'))  { function bwf_owner_view_url(){ return home_url('/my-question-view/'); } }
if (!function_exists('bwf_owner_edit_url'))  { function bwf_owner_edit_url(){ return home_url('/owner-edit/'); } }
if (!function_exists('bwf_owner_list_url'))  { function bwf_owner_list_url(){ return home_url('/my-questions/'); } }


function bwf_owner_cfg(){
  return [
    'title'=>'대표님 핵심 질문지',
    'min'=>200,
    'intro'=>'사업의 본질을 파악하고 고객에게 정말 묻고 싶은 질문을 구체화합니다. 각 문항은 최소 <strong>{MIN}</strong>자입니다. <em>(단, <strong>“고객에게 물어보고 싶은 3가지”</strong>는 글자수 제한 없음)</em>',
    'qs'=>[
      [
        'id'=>'problem','label'=>'1. 지금, 우리 사업의 가장 큰 고민은 무엇인가요?','required'=>true,'min'=>200,
        'desc'=>'성장이 정체되었다고 느낀 **구체적 상황**을 한두 문장으로. 숫자/행동 기반이면 좋아요.',
        'ex'=>'<ul><li>“클릭은 많은데 체류 30초 미만 이탈이 많아요.”</li><li>“재구매율이 낮아 신규 유입 의존도가 큽니다.”</li></ul>'
      ],
      [
        'id'=>'value','label'=>'2. 우리 서비스는 고객의 어떤 문제를 해결하나요?','required'=>true,'min'=>200,
        'desc'=>'고객의 **전/후 변화**를 한 문장으로 요약.',
        'ex'=>'<ol><li>“반복 서류작업을 5분 자동화 → 본업 집중”</li><li>“바쁜 직장인도 집밥처럼 건강한 한 끼 확보”</li></ol>'
      ],
      [
        'id'=>'ideal_customer','label'=>'3. 누가 이용해야 하나요? 왜 우리여야 하나요?','required'=>true,'min'=>200,
        'desc'=>'핵심 타깃의 특징 + 우리를 선택할 **결정적 이유**.',
        'ex'=>'<p>“시간/비용이 부족한 20대 대학생 → 15분 홈트 영상으로 꾸준함 확보.”</p>'
      ],
      [
        'id'=>'ask3','type'=>'group','label'=>'4. 고객에게 물어보고 싶은 3가지','required'=>true,
        'desc'=>'실제 경험 기반으로 **구체적인 질문 3개**를 작성.',
        'ex'=>'<p><strong>예)</strong> 첫인상/결심포인트/아쉬운점</p>',
        'sub'=>[
          ['id'=>'q1','label'=>'질문 1','ph'=>'예: 어떻게 알게 되었나요?','required'=>true],
          ['id'=>'q2','label'=>'질문 2','ph'=>'예: 결심 포인트는 무엇이었나요?','required'=>true],
          ['id'=>'q3','label'=>'질문 3','ph'=>'예: 가장 아쉬웠던 점은?','required'=>true],
        ]
      ],
      [
        'id'=>'competitors','label'=>'5. 경쟁사와의 차별점은?','required'=>true,'min'=>200,
        'desc'=>'주요 경쟁사 1~2곳과 비교해 강/약점 정리.',
        'ex'=>'<p>“A는 저렴하지만 CS 느림 / B는 비싸지만 품질 우수 → 우리는 적정가+빠른 CS”</p>'
      ],
    ]
  ];
}

function bwf_owner_view_url(){ return home_url('/my-question-view/'); }
function bwf_owner_edit_url(){ return home_url('/owner-edit/'); }
function bwf_owner_list_url(){ return home_url('/my-questions/'); }

function bwf_render_owner_form($args=[]){
  $cfg=bwf_owner_cfg(); $min=(int)$cfg['min']; $mode=$args['mode']??'create';
  $post=$args['post']??null; $saved=$args['saved']??[]; $errs=$args['errs']??[];
  if($mode==='edit' && $post){ $existing=(array)get_post_meta($post->ID,'bwf_answers',true); $saved=$saved ?: $existing; }
  wp_enqueue_style('bwf-forms'); wp_enqueue_script('bwos-form');

  ob_start(); ?>
  <form id="bwfOwnerForm" class="bwf-form bwos-form" method="post" action="<?php echo esc_url(admin_url('admin-post.php')); ?>" novalidate>
    <input type="hidden" name="action" value="bwf_owner_save">
    <?php wp_nonce_field('bwf_owner_save','bwf_owner_nonce'); ?>
    <input type="hidden" name="post_id" value="<?php echo $post ? (int)$post->ID : 0; ?>">

    <div class="bwos-progress"><div class="bar"><span></span></div><div class="status">작성 0/0 (0%)</div></div>

    <h2 class="bwf-title"><?php echo esc_html($cfg['title']); ?></h2>
    <p class="bwf-help"><?php echo str_replace('{MIN}', $min, $cfg['intro']); ?></p>

    <?php foreach($cfg['qs'] as $q): $type=$q['type']??'textarea'; $id=$q['id']; ?>
      <div class="bwf-field bwos-field bwos-required" data-min="<?php echo (int)($q['min']??$min); ?>">
        <label><?php echo esc_html($q['label']); ?><?php if(!empty($q['required'])): ?><span class="bwf-required">*</span><?php endif; ?></label>

        <?php if(!empty($q['desc'])): ?><div class="bwf-desc"><?php echo wp_kses_post($q['desc']); ?></div><?php endif; ?>
        <?php if(!empty($q['ex'])):   ?><div class="bwf-examples"><?php echo wp_kses_post($q['ex']); ?></div><?php endif; ?>

        <?php if($type==='group'): ?>
          <?php foreach(($q['sub']??[]) as $sub): $sid=$sub['id']; $v=$saved[$id][$sid]??''; ?>
            <div class="bwf-sub">
              <div class="bwf-help" style="margin:6px 0 6px;"><?php echo esc_html($sub['label']); ?></div>
              <textarea name="q[<?php echo esc_attr($id); ?>][<?php echo esc_attr($sid); ?>]" rows="4" placeholder="<?php echo esc_attr($sub['ph']??''); ?>"><?php echo esc_textarea($v); ?></textarea>
            </div>
          <?php endforeach; ?>
        <?php else: $v=$saved[$id]??''; ?>
          <textarea name="q[<?php echo esc_attr($id); ?>]" rows="6"><?php echo esc_textarea($v); ?></textarea>
          <small class="bwos-count">0/<?php echo (int)($q['min']??$min); ?></small>
        <?php endif; ?>
      </div>
    <?php endforeach; ?>

    <div class="bwf-actions">
      <button type="submit" class="bwf-btn bwos-submit"><?php echo $mode==='edit'?'수정 저장':'저장'; ?></button>
      <!-- 마이페이지 버튼 제거 요청 반영 -->
    </div>
  </form>
  <?php return ob_get_clean();
}

add_shortcode('bwf_owner_questions', function(){
  wp_enqueue_style('bwf-forms');

  if (!is_user_logged_in()){
    wp_enqueue_style('bwf-forms');
    $signup = esc_url('https://berrywalk.co.kr/bwf-owner-signup/');
    $login  = esc_url( wp_login_url( home_url('/owner-questions/') ) );
    return '<div class="bwos-wrap"><div class="bwf-need-login"><p>대표님 핵심 질문지를 작성하려면 로그인이 필요합니다.</p><div class="bwf-login-actions"><a class="bwf-btn" href="'.$login.'">로그인하러 가기</a><a class="bwf-btn-secondary" href="'.$signup.'">회원가입하러 가기</a></div></div></div>';
  }
  $uid=get_current_user_id();
  $old=get_transient('bwf_owner_old_'.$uid)?:[]; delete_transient('bwf_owner_old_'.$uid);
  $err=get_transient('bwf_owner_err_'.$uid)?:[]; delete_transient('bwf_owner_err_'.$uid);
  return bwf_render_owner_form(['mode'=>'create','saved'=>$old,'errs'=>$err]);
});
add_shortcode('bw_owner_form', fn()=>do_shortcode('[bwf_owner_questions]'));
add_shortcode('bw_owner_edit', function($atts){
  if (!is_user_logged_in()) return '<div class="bwf-form">로그인이 필요합니다.</div>';
  $id=(int)($atts['id']??($_GET['id']??0));
  $post=get_post($id);
  if(!$post || $post->post_type!=='bwf_owner_answer') return '<div class="bwf-form">데이터가 없습니다.</div>';
  if((int)$post->post_author!==get_current_user_id() && !current_user_can('edit_post',$id)) return '<div class="bwf-form">권한이 없습니다.</div>';
  $uid=get_current_user_id();
  $old=get_transient('bwf_owner_old_'.$uid)?:[]; delete_transient('bwf_owner_old_'.$uid);
  $err=get_transient('bwf_owner_err_'.$uid)?:[]; delete_transient('bwf_owner_err_'.$uid);
  return bwf_render_owner_form(['mode'=>'edit','post'=>$post,'saved'=>$old,'errs'=>$err]);
});

`$nl
===== FILE: berrywalk-feedback-acf\includes\save.php (7163 bytes, 203 lines) =====
`$ext
<?php
/**
 * 대표 질문지 저장 + 텔레그램 알림(디버그 포함)
 */
if (!defined('ABSPATH')) exit;

/* 혹시 남아있을지 모르는 이전 핸들러 제거 */
remove_action('admin_post_bwf_owner_save',     'bwf_owner_handle_save');
remove_action('admin_post_nopriv_bwf_owner_save','bwf_owner_handle_save');

/* 저장 엔드포인트 */
add_action('admin_post_bwf_owner_save',      'bwf_owner_save');
add_action('admin_post_nopriv_bwf_owner_save','bwf_owner_save');

function bwf_owner_save(){
  if (!is_user_logged_in()) { wp_safe_redirect(home_url('/')); exit; }
  check_admin_referer('bwf_owner_save','bwf_owner_nonce');

  $uid = get_current_user_id();

  /** 중복 제출 잠금(8초) */
  $lock_key = 'bwf_owner_lock_'.$uid;
  if (get_transient($lock_key)) { wp_safe_redirect(home_url('/my-questions/')); exit; }
  set_transient($lock_key, 1, 8);

  /** 폼 값 */
  $post_id = (int)($_POST['post_id'] ?? 0);
  $src     = (array)($_POST['q'] ?? []);

  /** 질문 정의/검증 */
  $cfg = function_exists('bwf_owner_cfg') ? bwf_owner_cfg() : ['qs'=>[], 'min'=>200];
  $min = (int)($cfg['min'] ?? 200);
  $ans = []; $err = [];

  foreach ($cfg['qs'] as $q) {
    $id   = $q['id'];
    $type = $q['type'] ?? 'textarea';
    $req  = !empty($q['required']);
    $m    = (int)($q['min'] ?? $min);

    if ($type === 'group') {
      $ans[$id] = [];
      foreach (($q['sub'] ?? []) as $sub) {
        $sid = $sub['id'];
        $v   = trim((string)($src[$id][$sid] ?? ''));
        $ans[$id][$sid] = sanitize_textarea_field($v);
        if (!empty($sub['required']) && $v==='') { $err[$id][$sid] = true; }
      }
    } else {
      $v = trim((string)($src[$id] ?? ''));
      $ans[$id] = sanitize_textarea_field($v);
      if ($req && mb_strlen($v) < $m) { $err[$id] = true; }
    }
  }

  /** 검증 실패 → 폼으로 되돌리기 */
  if (!empty($err)) {
    set_transient('bwf_owner_old_'.$uid, $src, 60);
    set_transient('bwf_owner_err_'.$uid, $err, 60);
    delete_transient($lock_key);
    wp_safe_redirect(wp_get_referer() ?: home_url('/owner-questions/'));
    exit;
  }

  /** 제목 규칙: "회사명 - #N 피드백" (새로 만들 때만 계산) */
  $company = trim((string)get_user_meta($uid,'bw_company_name',true));
  if ($company==='') $company = wp_get_current_user()->display_name;

  $is_new = ($post_id === 0);
  if ($is_new) {
    $count = (int) (new WP_Query([
      'post_type'      => 'bwf_owner_answer',
      'post_status'    => 'any',
      'author'         => $uid,
      'fields'         => 'ids',
      'posts_per_page' => -1
    ]))->found_posts;
    $seq   = $count + 1;
    $title = sprintf('%s - #%d 피드백', $company, $seq);
  } else {
    $title = get_post_field('post_title', $post_id);
  }

  /** 저장/수정 */
  $postarr = [
    'post_type'   => 'bwf_owner_answer',
    'post_status' => 'private',
    'post_title'  => $title,
    'post_author' => $uid,
  ];
  if ($post_id) { $postarr['ID'] = $post_id; $pid = wp_update_post($postarr, true); }
  else          { $pid = wp_insert_post($postarr, true); }

  if (is_wp_error($pid)) { delete_transient($lock_key); wp_die($pid); }

  update_post_meta($pid, 'bwf_answers', $ans);

  // 번호 캐시(목록 보정용)
  if ($is_new && preg_match('~#(\d+)~', $title, $m)) {
    update_post_meta($pid, '_bw_seq_cache', (int)$m[1]);
  }

  /** 텔레그램 알림 */
  bwf_send_telegram_notice($pid, $uid, $is_new);

  delete_transient($lock_key);
  wp_safe_redirect( add_query_arg(['id'=>$pid], home_url('/my-question-view/')) );
  exit;
}


/* ===================== 텔레그램 전송 + 디버그 ===================== */
/**
 * 상수(둘 중 아무 세트나 사용 가능):
 *   define('BWF_TG_BOT',  '123456789:BOT_TOKEN');
 *   define('BWF_TG_CHAT', '@your_channel_or_-100xxxxxxxxxx');
 *  또는
 *   define('BW_TG_BOT_TOKEN', '123456789:BOT_TOKEN');
 *   define('BW_TG_CHAT_ID',   '@your_channel_or_-100xxxxxxxxxx');
 */

function bwf__tg_conf(){
  $bot  = defined('BWF_TG_BOT')       ? BWF_TG_BOT
        : (defined('BW_TG_BOT_TOKEN') ? BW_TG_BOT_TOKEN : '');
  $chat = defined('BWF_TG_CHAT')      ? BWF_TG_CHAT
        : (defined('BW_TG_CHAT_ID')   ? BW_TG_CHAT_ID   : '');
  return [$bot, $chat];
}
function bwf__tg_log($data){
  set_transient('bwf_tg_debug', $data, 120);
  error_log('[BWF_TG] '.print_r($data, true));
}

/** 전송 */
function bwf_send_telegram_notice($post_id, $user_id, $is_new){
  list($BOT, $CHAT_RAW) = bwf__tg_conf();
  if (!$BOT || !$CHAT_RAW) { bwf__tg_log(['stage'=>'skip','reason'=>'missing_bot_or_chat']); return; }

  // chat_id 정규화
  $chat = trim($CHAT_RAW);
  if (preg_match('~t\.me/([A-Za-z0-9_]+)$~i', $chat, $m)) $chat = '@'.$m[1];
  if ($chat !== '' && $chat[0] !== '@' && $chat[0] !== '-' && !preg_match('~^-?\d+$~', $chat)) $chat = '@'.$chat;
  if (preg_match('~bot$~i', $chat)) { bwf__tg_log(['stage'=>'abort','reason'=>'chat_is_bot_username','chat'=>$chat]); return; }

  $u       = get_userdata($user_id);
  $company = get_user_meta($user_id,'bw_company_name',true);
  $phone   = get_user_meta($user_id,'bw_phone',true);
  $title   = $post_id ? get_post_field('post_title', $post_id) : '테스트';
  $url     = $post_id ? add_query_arg(['id'=>$post_id], home_url('/my-question-view/')) : home_url('/');
  $verb    = $is_new ? '새 피드백 작성' : '피드백 수정';

  $lines = [
    "✅ {$verb}",
    "제목: {$title}",
    "대표: {$u->display_name} (@{$u->user_login})",
    "회사: " . ($company ?: '—'),
    "연락처: " . ($phone ?: '—'),
    "보기: {$url}",
  ];
  $text = implode("\n", $lines);

  $endpoint = 'https://api.telegram.org/bot'.$BOT.'/sendMessage';
  $args = [
    'timeout' => 15,
    'headers' => ['Accept'=>'application/json'],
    'body'    => [
      'chat_id'                 => $chat,
      'text'                    => $text,
      'parse_mode'              => 'HTML',
      'disable_web_page_preview'=> true,
    ]
  ];

  $res = wp_remote_post($endpoint, $args);

  if (is_wp_error($res)) {
    bwf__tg_log(['stage'=>'request','ok'=>false,'error'=>$res->get_error_message(),'chat'=>$chat]);
  } else {
    $code = wp_remote_retrieve_response_code($res);
    $body = wp_remote_retrieve_body($res);
    $json = json_decode($body, true);
    bwf__tg_log(['stage'=>'request','ok'=>($code===200 && !empty($json['ok'])),'code'=>$code,'chat'=>$chat,'body'=>$body]);
  }
}

/** 관리자에게 1회성 디버그 알림 */
add_action('admin_notices', function(){
  if (!current_user_can('manage_options')) return;
  $d = get_transient('bwf_tg_debug'); if(!$d) return;
  delete_transient('bwf_tg_debug');
  echo '<div class="notice notice-info"><p><strong>텔레그램 전송 디버그</strong></p><pre style="white-space:pre-wrap">';
  echo esc_html(print_r($d, true));
  echo '</pre></div>';
});

/** 전송 테스트: /wp-admin/?bw_tg_test=1 */
add_action('admin_init', function(){
  if (current_user_can('manage_options') && isset($_GET['bw_tg_test'])) {
    bwf_send_telegram_notice(0, get_current_user_id(), true);
    wp_die('텔레그램 테스트 전송 시도 완료 — 관리자 알림 또는 PHP error_log에서 결과 확인');
  }
});

`$nl
===== FILE: berrywalk-feedback-acf\includes\signup.php (14434 bytes, 263 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

/* 역할 보장 */
add_action('init', function(){
  if (!get_role('bw_owner')) add_role('bw_owner','대표',['read'=>true]);
});

/* --- 관리자 사용자 목록 컬럼 + 프로필 편집 영역 --- */
add_filter('manage_users_columns', function($cols){
  $cols['bw_owner_meta'] = '대표 인적사항';
  return $cols;
});
add_filter('manage_users_custom_column', function($out, $col, $user_id){
  if ($col !== 'bw_owner_meta') return $out;
  $u = get_userdata($user_id);
  $pairs = [
    '회사'     => get_user_meta($user_id,'bw_company_name',true),
    '업종'     => get_user_meta($user_id,'bw_industry',true),
    '직원 수'  => get_user_meta($user_id,'bw_employees',true),
    '휴대폰'   => get_user_meta($user_id,'bw_phone',true),
    '연락시간' => get_user_meta($user_id,'bw_contact_window',true),
    '유입경로' => get_user_meta($user_id,'bw_discover',true),
    '웹사이트' => $u ? $u->user_url : '',
  ];
  $html  = '<div style="line-height:1.5">';
  foreach($pairs as $k=>$v){
    $val = ($v === '' ? '—' : $v);
    $html .= '<div><strong>'.$k.'</strong> '.$val.'</div>';
  }
  $html .= '</div>';
  return $html;
}, 10, 3);

/* 프로필 편집 폼 */
add_action('show_user_profile','bwf_owner_profile_fields');
add_action('edit_user_profile','bwf_owner_profile_fields');
function bwf_owner_profile_fields($user){
  ?>
  <h2>대표 인적사항</h2>
  <table class="form-table" role="presentation">
    <tr><th><label>회사명</label></th><td><input type="text" name="bw_company_name" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_company_name',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>업종</label></th><td><input type="text" name="bw_industry" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_industry',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>직원 수</label></th><td><input type="number" name="bw_employees" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_employees',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>휴대폰</label></th><td><input type="text" name="bw_phone" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_phone',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>연락 가능한 시간대</label></th><td><input type="text" name="bw_contact_window" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_contact_window',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>알게 된 경로</label></th><td><input type="text" name="bw_discover" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_discover',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>웹사이트 URL</label></th><td><input type="url" name="user_url_bwf" value="<?php echo esc_attr(get_userdata($user->ID)->user_url); ?>" class="regular-text" placeholder="https://"></td></tr>
  </table>
  <?php
}
add_action('personal_options_update','bwf_owner_profile_save');
add_action('edit_user_profile_update','bwf_owner_profile_save');
function bwf_owner_profile_save($user_id){
  foreach(['bw_company_name','bw_industry','bw_employees','bw_phone','bw_contact_window','bw_discover'] as $k){
    if(isset($_POST[$k])) update_user_meta($user_id,$k, sanitize_text_field($_POST[$k]));
  }
  if(isset($_POST['user_url_bwf'])){
    wp_update_user(['ID'=>$user_id,'user_url'=>esc_url_raw($_POST['user_url_bwf'])]);
  }
}

/* --- 대표 회원가입 폼 --- */
add_shortcode('bwf_signup_representative', function () {
  wp_enqueue_style('bwf-forms');

  // 에러/이전값 표시
  $err = get_transient('bwf_signup_err'); delete_transient('bwf_signup_err');
  $old = get_transient('bwf_signup_old'); delete_transient('bwf_signup_old');

  if (is_user_logged_in()) {
    return '<div class="bwos-wrap" style="margin-top:40px;margin-bottom:24px">
      <p style="margin:0 0 18px;font-weight:700">로그인되었습니다.</p>
      <div class="bwf-actions" style="margin-top:0">
        <a class="bwf-btn" href="'.esc_url(home_url('/owner-questions/')).'">질문 등록하기</a>
        <a class="bwf-btn-secondary" href="'.esc_url(home_url('/my-questions/')).'">내 질문 목록 보기</a>
      </div>
    </div>';
  }

  ob_start(); ?>
  <form method="post" class="bwf-form bwf-grid" id="bwf-signup-rep" action="<?php echo esc_url(admin_url('admin-post.php')); ?>" novalidate>
    <input type="hidden" name="action" value="bwf_signup_rep">
    <?php wp_nonce_field('bwf_signup_rep','bwf_nonce'); ?>

    <h2 class="bwf-title bwf-col-full" style="margin-top:8px;margin-bottom:10px">대표 회원가입</h2>
    <?php if($err): ?>
      <div class="bwf-card bwf-col-full" style="border-color:#fecaca;background:#fff1f2;color:#7f1d1d;margin-bottom:10px"><?php echo esc_html($err); ?></div>
    <?php endif; ?>
    <p class="bwf-required-note bwf-col-full" style="margin-top:0;margin-bottom:14px">* 표시는 필수 입력</p>

    <div><label style="margin-bottom:14px">아이디 *</label><input type="text" name="user_login" value="<?php echo esc_attr($old['user_login']??''); ?>" pattern="[A-Za-z0-9_\.\-]{4,32}" required></div>
    <div><label style="margin-bottom:14px">비밀번호 *</label><input type="password" name="user_pass" required></div>
    <div><label style="margin-bottom:14px">이메일 *</label><input type="email" name="user_email" value="<?php echo esc_attr($old['user_email']??''); ?>" required></div>
    <div><label style="margin-bottom:14px">이름 *</label><input type="text" name="first_name" value="<?php echo esc_attr($old['first_name']??''); ?>" required></div>

    <div><label style="margin-bottom:14px">회사명 *</label><input type="text" name="bw_company_name" value="<?php echo esc_attr($old['bw_company_name']??''); ?>" required></div>
    <div><label style="margin-bottom:14px">업종 *</label>
      <select name="bw_industry" required>
        <?php $sel = $old['bw_industry']??''; ?>
        <option value="">선택</option>
        <option value="IT/서비스" <?php selected($sel,'IT/서비스'); ?>>IT/서비스</option>
        <option value="커머스" <?php selected($sel,'커머스'); ?>>커머스</option>
        <option value="기타" <?php selected($sel,'기타'); ?>>기타</option>
      </select>
    </div>
    <div><label style="margin-bottom:14px">직원 수 *</label><input type="number" name="bw_employees" value="<?php echo esc_attr($old['bw_employees']??''); ?>" min="1" required></div>
    <div><label style="margin-bottom:14px">홈페이지 URL</label><input type="url" name="user_url" value="<?php echo esc_attr($old['user_url']??''); ?>" placeholder="https://"></div>

    <div class="bwf-col-full">
      <label style="margin-bottom:14px">알게 된 경로 *</label>
      <?php $srcSel = $old['bw_discover']??''; ?>
      <select name="bw_discover" id="bwf-source" required>
        <option value="">선택</option><option value="검색" <?php selected($srcSel,'검색'); ?>>검색</option><option value="SNS" <?php selected($srcSel,'SNS'); ?>>SNS</option><option value="지인추천" <?php selected($srcSel,'지인추천'); ?>>지인추천</option><option value="기타" <?php selected($srcSel,'기타'); ?>>기타</option>
      </select>
      <input type="text" name="source_etc" id="bwf-source-etc" placeholder="기타 경로" class="bwf-col-full <?php echo ($srcSel==='기타'?'':'bwf-hidden'); ?>" style="margin-top:8px" value="<?php echo esc_attr($old['source_etc']??''); ?>">
    </div>

    <div><label style="margin-bottom:14px">휴대폰 번호 *</label>
      <input type="tel" name="bw_phone" id="bwf-phone" inputmode="numeric" placeholder="010-1234-5678" maxlength="13" value="<?php echo esc_attr($old['bw_phone']??''); ?>" required>
    </div>
    <div><label style="margin-bottom:14px">연락 가능한 시간대 *</label><input type="text" name="bw_contact_window" value="<?php echo esc_attr($old['bw_contact_window']??''); ?>" placeholder="예: 평일 13:00~18:00" required></div>

    <div class="bwf-actions bwf-col-full" style="margin-top:18px">
      <button type="submit" name="bwf_register" class="bwf-btn">회원가입</button>
      <span id="bwf-hint" style="font-size:13px;color:#475569"></span>
    </div>

    <script>
    (function(){
      const f=document.getElementById('bwf-signup-rep'),
            src=f.querySelector('#bwf-source'),
            etc=f.querySelector('#bwf-source-etc'),
            tel=f.querySelector('#bwf-phone'),
            hint=document.getElementById('bwf-hint');

      function showEtc(){ if(src.value==='기타'){ etc.classList.remove('bwf-hidden'); } else { etc.classList.add('bwf-hidden'); etc.value=''; } }
      src.addEventListener('change',showEtc); showEtc();

      const dig=s=>String(s||'').replace(/\D/g,'');
      function fmt(raw){ const d=dig(raw).slice(0,11); if(d.length<=3) return d; if(d.length<=7) return d.replace(/^(\d{3})(\d{0,4})$/,'$1-$2'); return d.replace(/^(\d{3})(\d{4})(\d{0,4}).*$/,'$1-$2-$3'); }
      function norm(){ tel.value=fmt(tel.value); try{ tel.setSelectionRange(tel.value.length,tel.value.length);}catch(e){} }
      ['input','keyup','change','paste','blur','focus'].forEach(ev=> tel.addEventListener(ev,norm)); norm();

      f.addEventListener('submit',function(ev){
        norm();
        // 필수항목 검증
        const must=[...f.querySelectorAll('[required]')]; let ok=true; let first=null;
        must.forEach(el=>{
          el.classList.remove('bwf-invalid'); el.setCustomValidity('');
          if(el===tel && !/^010-\d{3,4}-\d{4}$/.test(tel.value)){ el.setCustomValidity('휴대폰 번호는 010-1234-5678 형식'); }
          if(el.name==='bw_discover' && src.value==='기타' && (etc.value||'').trim()===''){ el.setCustomValidity('기타 경로를 입력해 주세요'); }
          if(!el.checkValidity()){ ok=false; if(!first) first=el; el.classList.add('bwf-invalid'); }
        });
        if(!ok){ ev.preventDefault(); hint.textContent='입력이 필요한 항목이 있어요.'; hint.style.color='#ef4444'; first.scrollIntoView({behavior:'smooth',block:'center'}); }
        else   { hint.textContent='제출 중입니다…'; hint.style.color='#475569'; }
      });
    })();
    </script>
  </form>
  <?php
  return ob_get_clean();
});

/* 제출 처리 */
add_action('admin_post_nopriv_bwf_signup_rep','bwf_handle_signup_rep');
function bwf_handle_signup_rep(){
  $old = $_POST; unset($old['action'],$old['bwf_nonce'],$old['user_pass']);
  set_transient('bwf_signup_old',$old,60);

  $nonce = sanitize_text_field($_POST['bwf_nonce'] ?? '');
  if (!wp_verify_nonce($nonce,'bwf_signup_rep')) { set_transient('bwf_signup_err','유효하지 않은 요청입니다.',60); wp_safe_redirect(wp_get_referer()?:home_url('/')); exit; }

  $user_login=sanitize_user($_POST['user_login']??'');
  $user_email=sanitize_email($_POST['user_email']??'');
  $user_pass =$_POST['user_pass']??'';
  $first_name=sanitize_text_field($_POST['first_name']??'');

  if (!$user_login||!$user_email||!$user_pass||!$first_name){ set_transient('bwf_signup_err','필수 항목이 누락되었습니다.',60); wp_safe_redirect(wp_get_referer()?:home_url('/')); exit; }

  $uid = wp_insert_user([
    'user_login'=>$user_login,'user_email'=>$user_email,'user_pass'=>$user_pass,
    'first_name'=>$first_name,'role'=>'bw_owner','user_url'=>esc_url_raw($_POST['user_url']??'')
  ]);

  if (is_wp_error($uid)) {
    set_transient('bwf_signup_err', $uid->get_error_message(), 60);
    wp_safe_redirect(wp_get_referer()?:home_url('/')); exit;
  }

  foreach(['bw_company_name','bw_industry','bw_employees','bw_contact_window','bw_discover','bw_phone'] as $k){
    if(isset($_POST[$k])) update_user_meta($uid,$k,sanitize_text_field($_POST[$k]));
  }
  if (($_POST['bw_discover']??'')==='기타' && !empty($_POST['source_etc'])) {
    update_user_meta($uid,'bw_discover','etc: '.sanitize_text_field($_POST['source_etc']));
  }

  delete_transient('bwf_signup_old');

  wp_set_current_user($uid); wp_set_auth_cookie($uid);
  wp_safe_redirect(home_url('/owner-questions/')); exit;
}


/* ===== 관리자 > 대표 질문지( CPT ) 목록 컬럼/제목 ===== */
add_filter('manage_edit-bwf_owner_answer_columns', function($cols){
  $new = [];
  $new['cb']      = $cols['cb'];
  $new['title']   = '제목';
  $new['author']  = '작성자';
  $new['company'] = '회사명';
  $new['website'] = '웹사이트';
  $new['date']    = '저장 시각';
  return $new;
});
add_action('manage_bwf_owner_answer_posts_custom_column', function($col, $post_id){
  if($col==='company'){
    $author = (int)get_post_field('post_author',$post_id);
    echo esc_html( get_user_meta($author,'bw_company_name',true) ?: '—' );
  } elseif($col==='website'){
    $author = (int)get_post_field('post_author',$post_id);
    $url = get_userdata($author)->user_url;
    echo $url ? '<a href="'.esc_url($url).'" target="_blank" rel="noopener">열기</a>' : '—';
  }
},10,2);

/* 관리자 목록에서 예전 글도 보기 좋은 제목으로 표시 */
add_filter('the_title', function($title, $post_id){
  if (!is_admin()) return $title;
  $p = get_post($post_id);
  if(!$p || $p->post_type!=='bwf_owner_answer') return $title;

  // 이미 새 규칙이면 그대로
  if (strpos($title,'#')!==false && strpos($title,'피드백')!==false) return $title;

  $author  = (int)$p->post_author;
  $company = get_user_meta($author,'bw_company_name',true);
  if($company==='') $company = get_userdata($author)->display_name;

  // 사용자 기준 순번 계산 (오래된 순서)
  $ids = get_posts(['post_type'=>'bwf_owner_answer','author'=>$author,'post_status'=>'any','fields'=>'ids','numberposts'=>-1,'orderby'=>'date','order'=>'ASC']);
  $pos = array_search($post_id, $ids, true);
  $idx = ($pos===false? count($ids): $pos) + 1;

  return sprintf('%s - #%d 피드백', $company, $idx);
},10,2);

// ① 우리 대표 가입 폼으로 제출이면, 그 요청에 한해 '새 사용자 기본역할'을 bw_owner로 임시 변경
add_filter('pre_option_default_role', function($default){
  if (!empty($_POST['bwf_role']) && $_POST['bwf_role'] === 'bw_owner') {
    return 'bw_owner';
  }
  return $default;
});

// ② 어떤 경로로 가입되었든, 우리 폼 마커가 있으면 최종적으로 bw_owner로 강제
add_action('user_register', function($user_id){
  if (!empty($_POST['bwf_role']) && $_POST['bwf_role'] === 'bw_owner') {
    $u = new WP_User($user_id);
    $u->set_role('bw_owner');
  }
}, 10);

`$nl
===== FILE: berrywalk-feedback-acf\includes\view-list.php (7622 bytes, 186 lines) =====
`$ext
<?php
/* /includes/view-list.php — 단건 보기 + 마이페이지 목록 */
if (!defined('ABSPATH')) exit;

/* 공통 URL 헬퍼 (중복 선언 방지) */
if (!function_exists('bwf_owner_view_url')) { function bwf_owner_view_url(){ return home_url('/my-question-view/'); } }
if (!function_exists('bwf_owner_edit_url')) { function bwf_owner_edit_url(){ return home_url('/owner-edit/'); } }
if (!function_exists('bwf_owner_list_url')) { function bwf_owner_list_url(){ return home_url('/my-questions/'); } }

/** 단건 보기: [bw_owner_view] / [bwf_owner_view] */
function bwos_render_single_view($atts){
  if (!is_user_logged_in()) return '<div class="bwf-form">로그인이 필요합니다.</div>';

  $id = (int)($atts['id'] ?? ($_GET['id'] ?? 0));
  $p  = get_post($id);
  if(!$p || $p->post_type !== 'bwf_owner_answer') return '<div class="bwf-form">데이터가 없습니다.</div>';
  if((int)$p->post_author !== get_current_user_id() && !current_user_can('read_post', $id)) return '<div class="bwf-form">권한이 없습니다.</div>';

  wp_enqueue_style('bwf-forms');

  // 질문 정의 & 답변
  $cfg = function_exists('bwf_owner_cfg') ? bwf_owner_cfg() : ['title'=>'대표 질문지','qs'=>[]];
  $ans = (array)get_post_meta($id, 'bwf_answers', true);

  // 작성자 메타(요청에 따라 최소 표시만)
  $au   = get_userdata($p->post_author);
  $meta = [
    '회사명'   => get_user_meta($p->post_author,'bw_company_name',true),
    '웹사이트' => $au && $au->user_url ? $au->user_url : '',
    '연락시간' => get_user_meta($p->post_author,'bw_contact_window',true),
    '휴대폰'   => get_user_meta($p->post_author,'bw_phone',true),
  ];

  ob_start(); ?>
  <div class="bwos-wrap">
    <h2 class="bwf-title"><?php echo esc_html($cfg['title']); ?></h2>

    <div class="bwf-card" style="margin-bottom:16px">
      <strong>작성 정보</strong>
      <div style="display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:6px 14px;margin-top:8px">
        <?php foreach($meta as $k=>$v): ?>
          <div>
            <span style="color:#64748b"><?php echo esc_html($k); ?></span> :
            <?php
              if ($k==='웹사이트' && $v) {
                echo '<a href="'.esc_url($v).'" target="_blank" rel="noopener">'.esc_html($v).'</a>';
              } else {
                echo $v ? esc_html($v) : '—';
              }
            ?>
          </div>
        <?php endforeach; ?>
      </div>
    </div>

    <?php foreach(($cfg['qs'] ?? []) as $q):
      $qid = $q['id'] ?? '';
      if(!$qid) continue; ?>
      <div class="bwf-field">
        <label><?php echo esc_html($q['label']); ?></label>
        <?php if(($q['type'] ?? '') === 'group'): ?>
          <?php foreach(($q['sub'] ?? []) as $sub):
            $sid = $sub['id']; $v = trim((string)($ans[$qid][$sid] ?? '')); ?>
            <div class="bwf-sub">
              <div class="bwf-help"><?php echo esc_html($sub['label']); ?></div>
              <div class="bwf-card"><?php echo nl2br(esc_html($v)); ?></div>
            </div>
          <?php endforeach; ?>
        <?php else:
          $v = trim((string)($ans[$qid] ?? '')); ?>
          <div class="bwf-card"><?php echo nl2br(esc_html($v)); ?></div>
        <?php endif; ?>
      </div>
    <?php endforeach; ?>

    <div class="bwf-actions" style="justify-content:center">
      <a class="bwf-btn" href="<?php echo esc_url(add_query_arg(['id'=>$p->ID], bwf_owner_edit_url())); ?>">수정</a>
      <a class="bwf-btn-secondary" href="<?php echo esc_url(bwf_owner_list_url()); ?>">목록</a>
    </div>
  </div>
  <?php
  return ob_get_clean();
}
add_shortcode('bw_owner_view','bwos_render_single_view');
add_shortcode('bwf_owner_view','bwos_render_single_view'); // alias

/** 마이페이지 목록: [bw_owner_list] / [bw_my_questions] */
add_shortcode('bw_owner_list', function($atts){
  if (!is_user_logged_in()) return '<div class="bwf-form">로그인이 필요합니다.</div>';

  $paged = max(1, (int)get_query_var('paged', 0));
  if(!$paged) $paged = max(1, (int)($_GET['pg'] ?? 1));

  $q = new WP_Query([
    'post_type'      => 'bwf_owner_answer',
    'post_status'    => 'private',
    'author'         => get_current_user_id(),
    'posts_per_page' => 8,
    'orderby'        => 'date',
    'order'          => 'DESC',
    'paged'          => $paged,
    'fields'         => 'ids'
  ]);

  wp_enqueue_style('bwf-forms');

  // 사용자 회사명
  $uid     = get_current_user_id();
  $company = trim((string)get_user_meta($uid,'bw_company_name',true));
  if($company==='') $company = wp_get_current_user()->display_name;

  ob_start(); ?>
  <div class="bwos-wrap">
    <h2 class="bwf-title" style="margin-bottom:16px">마이페이지</h2>

    <div class="bwf-actions" style="justify-content:flex-start;margin:0 0 14px">
      <a class="bwf-btn" href="<?php echo esc_url(home_url('/owner-questions/')); ?>">새 피드백 질문하기</a>
    </div>

    <div class="bwos-list">
      <?php
      if ($q->have_posts()):
        foreach ($q->posts as $pid):
          // 제목은 저장된 raw post_title 사용(‘비공개:’ 접두 회피)
          $raw_title = get_post_field('post_title', $pid);

          // 혹시 과거 글(구 규칙)이라면 회사명 - #N 피드백으로 보정
          if (strpos($raw_title,'#') === false || strpos($raw_title,'피드백') === false) {
            // 최신글부터 역순이지만, 사용자는 번호만 구분하면 되므로 글ID 끝 3자리 정도를 보조로 표기할 수도 있음
            // 여기서는 간단히 저장 시각 기준 시퀀스를 표시
            $seq = (int) get_post_meta($pid, '_bw_seq_cache', true);
            if ($seq <= 0) {
              // 없으면 임시 계산: 내 글 전부에서 현재 PID의 역순 인덱스
              $all = new WP_Query([
                'post_type'=>'bwf_owner_answer','post_status'=>'any','author'=>$uid,
                'orderby'=>'date','order'=>'ASC','fields'=>'ids','posts_per_page'=>-1
              ]);
              $seq = 0;
              foreach ($all->posts as $i=>$id) { if ($id == $pid) { $seq = $i+1; break; } }
            }
            $display = sprintf('%s - #%d 피드백', $company, max(1,$seq));
          } else {
            $display = $raw_title;
          }

          $when = get_the_date('Y-m-d H:i', $pid);
          $view = esc_url(add_query_arg(['id'=>$pid], bwf_owner_view_url()));
          $edit = esc_url(add_query_arg(['id'=>$pid], bwf_owner_edit_url()));
      ?>
        <div class="bwos-card">
          <h4><?php echo esc_html($display); ?></h4>
          <div class="meta"><?php echo esc_html($when); ?></div>
          <div class="row">
            <a href="<?php echo $view; ?>">보기</a>
            <a href="<?php echo $edit; ?>">수정</a>
          </div>
        </div>
      <?php
        endforeach;
      else: ?>
        <p>작성한 내역이 없습니다. <a href="<?php echo esc_url(home_url('/owner-questions/')); ?>">새 피드백 질문하기</a>로 첫 저장본을 만들어 보세요.</p>
      <?php endif; ?>
    </div>

    <?php
    $links = paginate_links([
      'total'     => max(1,(int)$q->max_num_pages),
      'current'   => $paged,
      'type'      => 'array',
      'mid_size'  => 2,
      'prev_text' => '이전',
      'next_text' => '다음'
    ]);
    if ($links) {
      echo '<div class="bwos-pg">';
      foreach($links as $l) echo $l.' ';
      echo '</div>';
    }
    wp_reset_postdata();
    ?>
  </div>
  <?php
  return ob_get_clean();
});
add_shortcode('bw_my_questions', fn($a)=>do_shortcode('[bw_owner_list]'));

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\composer.json (719 bytes, 24 lines) =====
`$ext
{
	"name": "yahnis-elsts/plugin-update-checker",
	"type": "library",
	"description": "A custom update checker for WordPress plugins and themes. Useful if you can't host your plugin in the official WP repository but still want it to support automatic updates.",
	"keywords": ["wordpress", "plugin updates", "automatic updates", "theme updates"],
	"homepage": "https://github.com/YahnisElsts/plugin-update-checker/",
	"license": "MIT",
	"authors": [
		{
			"name": "Yahnis Elsts",
			"email": "whiteshadow@w-shadow.com",
			"homepage": "https://w-shadow.com/",
			"role": "Developer"
		}
	],
	"require": {
		"php": ">=5.6.20",
		"ext-json": "*"
	},
	"autoload": {
		"files": ["load-v5p6.php"]
	}
}

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\license.txt (1063 bytes, 8 lines) =====
`$ext
Copyright (c) 2023 Jānis Elsts

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\load-v5p6.php (1182 bytes, 35 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6;

use YahnisElsts\PluginUpdateChecker\v5\PucFactory as MajorFactory;
use YahnisElsts\PluginUpdateChecker\v5p6\PucFactory as MinorFactory;

require __DIR__ . '/Puc/v5p6/Autoloader.php';
new Autoloader();

require __DIR__ . '/Puc/v5p6/PucFactory.php';
require __DIR__ . '/Puc/v5/PucFactory.php';

//Register classes defined in this version with the factory.
foreach (
	array(
		'Plugin\\UpdateChecker' => Plugin\UpdateChecker::class,
		'Theme\\UpdateChecker'  => Theme\UpdateChecker::class,

		'Vcs\\PluginUpdateChecker' => Vcs\PluginUpdateChecker::class,
		'Vcs\\ThemeUpdateChecker'  => Vcs\ThemeUpdateChecker::class,

		'GitHubApi'    => Vcs\GitHubApi::class,
		'BitBucketApi' => Vcs\BitBucketApi::class,
		'GitLabApi'    => Vcs\GitLabApi::class,
	)
	as $pucGeneralClass => $pucVersionedClass
) {
	MajorFactory::addVersion($pucGeneralClass, $pucVersionedClass, '5.6');
	//Also add it to the minor-version factory in case the major-version factory
	//was already defined by another, older version of the update checker.
	MinorFactory::addVersion($pucGeneralClass, $pucVersionedClass, '5.6');
}


`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\plugin-update-checker.php (227 bytes, 10 lines) =====
`$ext
<?php
/**
 * Plugin Update Checker Library 5.6
 * http://w-shadow.com/
 *
 * Copyright 2025 Janis Elsts
 * Released under the MIT license. See license.txt for details.
 */

require dirname(__FILE__) . '/load-v5p6.php';
`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\README.md (21190 bytes, 373 lines) =====
`$ext
Plugin Update Checker
=====================

This is a custom update checker library for WordPress plugins and themes. It lets you add automatic update notifications and one-click upgrades to your commercial plugins, private themes, and so on. All you need to do is put your plugin/theme details in a JSON file, place the file on your server, and pass the URL to the library. The library periodically checks the URL to see if there's a new version available and displays an update notification to the user if necessary.

From the users' perspective, it works just like with plugins and themes hosted on WordPress.org. The update checker uses the default upgrade UI that is familiar to most WordPress users.

<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->
**Table of Contents**

- [Getting Started](#getting-started)
  - [Self-hosted Plugins and Themes](#self-hosted-plugins-and-themes)
    - [How to Release an Update](#how-to-release-an-update)
    - [Notes](#notes)
  - [GitHub Integration](#github-integration)
    - [How to Release an Update](#how-to-release-an-update-1)
    - [Notes](#notes-1)
  - [BitBucket Integration](#bitbucket-integration)
    - [How to Release an Update](#how-to-release-an-update-2)
  - [GitLab Integration](#gitlab-integration)
    - [How to Release a GitLab Update](#how-to-release-a-gitlab-update)
- [Migrating from 4.x](#migrating-from-4x)
- [License Management](#license-management)
- [Resources](#resources)

<!-- END doctoc generated TOC please keep comment here to allow auto update -->

Getting Started
---------------

*Note:* In each of the below examples, part of the instructions is to create an instance of the update checker class. It's recommended to do this either during the `plugins_loaded` action or outside of any hooks. If you do it only during an `admin_*` action, then updates will not be visible to a wide variety of WordPress management tools; they will only be visible to logged-in users on dashboard pages.

### Self-hosted Plugins and Themes

1. Download [the latest release](https://github.com/YahnisElsts/plugin-update-checker/releases/latest) and copy the `plugin-update-checker` directory to your plugin or theme.
2. Go to the `examples` subdirectory and open the .json file that fits your project type. Replace the placeholder data with your plugin/theme details. 
	- Plugin example:
	
		```json
		{
			"name" : "Plugin Name",
			"version" : "2.0",
			"download_url" : "https://example.com/plugin-name-2.0.zip",
			"sections" : {
				"description" : "Plugin description here. You can use HTML."
			}
		}
		```
		
        This is a minimal example that leaves out optional fields. See [this table](https://docs.google.com/spreadsheets/d/1eOBbW7Go2qEQXReOOCdidMTf_tDYRq4JfegcO1CBPIs/edit?usp=sharing) for a full list of supported fields and their descriptions.
	- Theme example:
	
		```json
		{
			"version": "2.0",
			"details_url": "https://example.com/version-2.0-details.html",
			"download_url": "https://example.com/example-theme-2.0.zip"
		}
		```
		
		This is actually a complete example that shows all theme-related fields. `version` and `download_url` should be self-explanatory. The `details_url` key specifies the page that the user will see if they click the "View version 1.2.3 details" link in an update notification.  
3. Upload the JSON file to a publicly accessible location.
4. Add the following code to the main plugin file or to the `functions.php` file:

	```php
	require 'path/to/plugin-update-checker/plugin-update-checker.php';
	use YahnisElsts\PluginUpdateChecker\v5\PucFactory;
 
	$myUpdateChecker = PucFactory::buildUpdateChecker(
		'https://example.com/path/to/details.json',
		__FILE__, //Full path to the main plugin file or functions.php.
		'unique-plugin-or-theme-slug'
	);
	```
	Note: If you're using the Composer autoloader, you don't need to explicitly `require` the library.

#### How to Release an Update

Change the `version` number in the JSON file and make sure that `download_url` points to the latest version. Update the other fields if necessary. Tip: You can use [wp-update-server](https://github.com/YahnisElsts/wp-update-server) to automate this process.

By default, the library will check the specified URL for changes every 12 hours. You can force it to check immediately by clicking the "Check for updates" link on the "Plugins" page (it's next to the "Visit plugin site" link). Themes don't have that link, but you can also trigger an update check like this:
 
 1. Install [Debug Bar](https://srd.wordpress.org/plugins/debug-bar/).
 2. Click the "Debug" menu in the Admin Bar (a.k.a Toolbar).
 3. Open the "PUC (your-slug)" panel. 
 4. Click the "Check Now" button.  

#### Notes
- The second argument passed to `buildUpdateChecker` must be the absolute path to the main plugin file or any file in the theme directory. If you followed the "getting started" instructions, you can just use the `__FILE__` constant.
- The third argument - i.e. the slug - is optional but recommended. In most cases, the slug should be the same as the name of your plugin directory. For example, if your plugin lives in `/wp-content/plugins/my-plugin`, set the slug to `my-plugin`. If the slug is omitted, the update checker will use the name of the main plugin file as the slug (e.g. `my-cool-plugin.php` &rarr; `my-cool-plugin`). This can lead to conflicts if your plugin has a generic file name like `plugin.php`. 
	
	This doesn't affect themes because PUC uses the theme directory name as the default slug. Still, if you're planning to use the slug in your own code - e.g. to filter updates or override update checker behaviour - it can be a good idea to set it explicitly. 

### GitHub Integration

1. Download [the latest release](https://github.com/YahnisElsts/plugin-update-checker/releases/latest) and copy the `plugin-update-checker` directory to your plugin or theme.
2. Add the following code to the main plugin file or `functions.php`:

	```php
	require 'plugin-update-checker/plugin-update-checker.php';
	use YahnisElsts\PluginUpdateChecker\v5\PucFactory;
 
	$myUpdateChecker = PucFactory::buildUpdateChecker(
		'https://github.com/user-name/repo-name/',
		__FILE__,
		'unique-plugin-or-theme-slug'
	);
	
	//Set the branch that contains the stable release.
	$myUpdateChecker->setBranch('stable-branch-name');

	//Optional: If you're using a private repository, specify the access token like this:
	$myUpdateChecker->setAuthentication('your-token-here');
	```
3. Plugins only: Add a `readme.txt` file formatted according to the [WordPress.org plugin readme standard](https://wordpress.org/plugins/readme.txt) to your repository. The contents of this file will be shown when the user clicks the "View version 1.2.3 details" link.

#### How to Release an Update

This library supports a couple of different ways to release updates on GitHub. Pick the one that best fits your workflow.

- **GitHub releases** 
	
	Create a new release using the "Releases" feature on GitHub. The tag name and release title don't matter. The description is optional, but if you do provide one, it will be displayed when the user clicks the "View version x.y.z details" link on the "Plugins" page. Note that PUC ignores releases marked as "This is a pre-release".
	
	If you want to use release assets, call the `enableReleaseAssets()` method after creating the update checker instance:
	```php
	$myUpdateChecker->getVcsApi()->enableReleaseAssets();
	```
	
- **Tags** 
	
	To release version 1.2.3, create a new Git tag named `v1.2.3` or `1.2.3`. That's it.
	
	PUC doesn't require strict adherence to [SemVer](https://semver.org/). These are all valid tag names: `v1.2.3`, `v1.2-foo`, `1.2.3_rc1-ABC`, `1.2.3.4.5`. However, be warned that it's not smart enough to filter out alpha/beta/RC versions. If that's a problem, you might want to use GitHub releases or branches instead.
	
- **Stable branch** 
	
	Point the update checker at a stable, production-ready branch: 
	 ```php
	 $updateChecker->setBranch('branch-name');
	 ```
	 PUC will periodically check the `Version` header in the main plugin file or `style.css` and display a notification if it's greater than the installed version.
	 
	 Caveat: If you set the branch to `master` (the default), the update checker will look for recent releases and tags first. It'll only use the `master` branch if it doesn't find anything else suitable.

#### Notes

The library will pull update details from the following parts of a release/tag/branch:

- Version number
	- The "Version" plugin header.
	- The latest GitHub release or tag name.
- Changelog
	- The "Changelog" section of `readme.txt`.
	- One of the following files:
		CHANGES.md, CHANGELOG.md, changes.md, changelog.md
	- GitHub release notes.
- Required and tested WordPress versions
	- The "Requires at least" and "Tested up to" fields in `readme.txt`.
	- The following plugin headers:
		`Required WP`, `Tested WP`, `Requires at least`, `Tested up to`
- "Last updated" timestamp
	- The creation timestamp of the latest GitHub release.
	- The latest commit in the selected tag or branch.
- Number of downloads
	- The `download_count` statistic of the latest release.
	- If you're not using GitHub releases, there will be no download stats.
- Other plugin details - author, homepage URL, description
	- The "Description" section of `readme.txt`.
	- Remote plugin headers (i.e. the latest version on GitHub).
	- Local plugin headers (i.e. the currently installed version).
- Ratings, banners, screenshots
	- Not supported.
	
### BitBucket Integration

1. Download [the latest release](https://github.com/YahnisElsts/plugin-update-checker/releases/latest) and copy the `plugin-update-checker` directory to your plugin or theme.
2. Add the following code to the main plugin file or `functions.php`:

	```php
	require 'plugin-update-checker/plugin-update-checker.php';
	use YahnisElsts\PluginUpdateChecker\v5\PucFactory;
 
	$myUpdateChecker = PucFactory::buildUpdateChecker(
		'https://bitbucket.org/user-name/repo-name',
		__FILE__,
		'unique-plugin-or-theme-slug'
	);

	//Optional: If you're using a private repository, create an OAuth consumer
	//and set the authentication credentials like this:
	//Note: For now you need to check "This is a private consumer" when
	//creating the consumer to work around #134:
	// https://github.com/YahnisElsts/plugin-update-checker/issues/134
	$myUpdateChecker->setAuthentication(array(
		'consumer_key' => '...',
		'consumer_secret' => '...',
	));

	//Optional: Set the branch that contains the stable release.
	$myUpdateChecker->setBranch('stable-branch-name');
	```
3. Optional: Add a `readme.txt` file formatted according to the [WordPress.org plugin readme standard](https://wordpress.org/plugins/readme.txt) to your repository. For plugins, the contents of this file will be shown when the user clicks the "View version 1.2.3 details" link.

#### How to Release an Update

BitBucket doesn't have an equivalent to GitHub's releases, so the process is slightly different. You can use any of the following approaches: 

- **`Stable tag` header** 
	
	This is the recommended approach if you're using tags to mark each version. Add a `readme.txt` file formatted according to the [WordPress.org plugin readme standard](https://wordpress.org/plugins/readme.txt) to your repository. Set the "stable tag" header to the tag that represents the latest release. Example:
	```text
	Stable tag: v1.2.3
	```
	The tag doesn't have to start with a "v" or follow any particular format. You can use any name you like as long as it's a valid Git tag.
	
	Tip: If you explicitly set a stable branch, the update checker will look for a `readme.txt` in that branch. Otherwise it will only look at the `master` branch.
	
- **Tags** 
	
	You can skip the "stable tag" bit and just create a new Git tag named `v1.2.3` or `1.2.3`. The update checker will look at the most recent tags and pick the one that looks like the highest version number.
	
	PUC doesn't require strict adherence to [SemVer](https://semver.org/). These are all valid tag names: `v1.2.3`, `v1.2-foo`, `1.2.3_rc1-ABC`, `1.2.3.4.5`. However, be warned that it's not smart enough to filter out alpha/beta/RC versions.
	
- **Stable branch** 
	
	Point the update checker at a stable, production-ready branch: 
	 ```php
	 $updateChecker->setBranch('branch-name');
	 ```
	 PUC will periodically check the `Version` header in the main plugin file or `style.css` and display a notification if it's greater than the installed version. Caveat: If you set the branch to `master`, the update checker will still look for tags first.

### GitLab Integration

1. Download [the latest release](https://github.com/YahnisElsts/plugin-update-checker/releases/latest) and copy the `plugin-update-checker` directory to your plugin or theme.
2. Add the following code to the main plugin file or `functions.php` and define how you want to check for updates from Gitlab (refer to: [Gitlab: How to Release an Update](#how-to-release-a-gitlab-update)):

	```php
	require 'plugin-update-checker/plugin-update-checker.php';
	use YahnisElsts\PluginUpdateChecker\v5\PucFactory;

	$myUpdateChecker = PucFactory::buildUpdateChecker(
		'https://gitlab.com/user-name/repo-name/',
		__FILE__,
		'unique-plugin-or-theme-slug'
	);

	//Optional: If you're using a private repository, specify the access token like this:
	$myUpdateChecker->setAuthentication('your-token-here');
	```

	Alternatively, if you're using a self-hosted GitLab instance, initialize the update checker like this:
	```php
	use YahnisElsts\PluginUpdateChecker\v5p6\Vcs\PluginUpdateChecker;
	use YahnisElsts\PluginUpdateChecker\v5p6\Vcs\GitLabApi;
	
	$myUpdateChecker = new PluginUpdateChecker(
		new GitLabApi('https://myserver.com/user-name/repo-name/'),
		__FILE__,
		'unique-plugin-or-theme-slug'
	);
	//Optional: Add setAuthentication(...) and setBranch(...) as shown above.  
	```
	If you're using a self-hosted GitLab instance and [subgroups or nested groups](https://docs.gitlab.com/ce/user/group/subgroups/index.html), you have to tell the update checker which parts of the URL are subgroups:
	```php
	use YahnisElsts\PluginUpdateChecker\v5p6\Vcs\PluginUpdateChecker;
	use YahnisElsts\PluginUpdateChecker\v5p6\Vcs\GitLabApi;
   
	$myUpdateChecker = new PluginUpdateChecker(
		new GitLabApi(
			'https://myserver.com/group-name/subgroup-level1/subgroup-level2/subgroup-level3/repo-name/', 
			null, 
			'subgroup-level1/subgroup-level2/subgroup-level3'
		),
		__FILE__,
		'unique-plugin-or-theme-slug'
	);
	```

3. Plugins only: Add a `readme.txt` file formatted according to the [WordPress.org plugin readme standard](https://wordpress.org/plugins/readme.txt) to your repository. The contents of this file will be shown when the user clicks the "View version 1.2.3 details" link.

#### How to Release a GitLab Update

A GitLab repository can be checked for updates in 3 different ways.

- **GitLab releases**
	
	Create a new release using the "Releases" feature on GitLab. The tag name should match the version number. You can add a `v` prefix to the tag, like `v1.2.3`. Releases that are marked as ["Upcoming Release"](https://docs.gitlab.com/ee/user/project/releases/index.html#upcoming-releases) will be automatically ignored.
	
	If you want to use custom release assets, call the `enableReleaseAssets()` method after creating the update checker instance:
	```php
	$myUpdateChecker->getVcsApi()->enableReleaseAssets();
	```
	
	By default, PUC will use the first available asset link, regardless of type. You can pass a regular expression to `enableReleaseAssets()` to make it pick the first link where the URL matches the regex. For example:
	```php
	$myUpdateChecker->getVcsApi()->enableReleaseAssets('/\.zip($|[?&#])/i');
	```
	
	**Tip:** You can use a Gitlab CI/CD Pipeline to automatically generate your update on release using a Generic Package. For more information about generic packages, refer to the following links:
		- [Gitlab CI/CD Release Documentation](https://docs.gitlab.com/ee/user/project/releases/#create-release-from-gitlab-ci)
		- [Gitlab Release Assets as Generic Package Documentation](https://gitlab.com/gitlab-org/release-cli/-/tree/master/docs/examples/release-assets-as-generic-package/)
		- [Example .gitlab-ci.yml file using Release Generic Packages for generating a update package from the Sensei-LMS wordpress plugin](https://gist.github.com/timwiel/9dfd3526c768efad4973254085e065ce)

- **Tags**

	To release version 1.2.3, create a new Git tag named `v1.2.3` or `1.2.3`. The update checker will look at recent tags and use the one that looks like the highest version number.
	
	PUC doesn't require strict adherence to [SemVer](https://semver.org/). However, be warned that it's not smart enough to filter out alpha/beta/RC versions. If that's a problem, you might want to use GitLab branches instead.

- **Stable branch**

	Point the update checker at any stable, production-ready branch:
	```php
	$myUpdateChecker->setBranch('stable-branch-name');
	```
	PUC will periodically check the `Version` header in the main plugin file or `style.css` and display a notification if it's greater than the installed version. Caveat: Even if you set the branch to `main` (the default) or `master` (the historical default), the update checker will still look for recent releases and tags first.

Migrating from 4.x
------------------

Older versions of the library didn't use namespaces. Code that was written for those versions will need to be updated to work with the current version. At a minimum, you'll need to change the factory class name. 

Old code:
```php
$myUpdateChecker = Puc_v4_Factory::buildUpdateChecker(
	'https://example.com/info.json',
	__FILE__,
	'my-slug'
);
```

New code:
```php
use YahnisElsts\PluginUpdateChecker\v5\PucFactory;

$myUpdateChecker = PucFactory::buildUpdateChecker(
	'https://example.com/info.json',
	__FILE__,
	'my-slug'
);
```

Other classes have also been renamed, usually by simply removing the `Puc_vXpY_` prefix and converting `Category_Thing` to `Category\Thing`. Here's a table of the most commonly used classes and their new names:

| Old class name                      | New class name                                                 |
|-------------------------------------|----------------------------------------------------------------|
| `Puc_v4_Factory`                    | `YahnisElsts\PluginUpdateChecker\v5\PucFactory`                |
| `Puc_v4p13_Factory`                 | `YahnisElsts\PluginUpdateChecker\v5p6\PucFactory`              |
| `Puc_v4p13_Plugin_UpdateChecker`    | `YahnisElsts\PluginUpdateChecker\v5p6\Plugin\UpdateChecker`    |
| `Puc_v4p13_Theme_UpdateChecker`     | `YahnisElsts\PluginUpdateChecker\v5p6\Theme\UpdateChecker`     |
| `Puc_v4p13_Vcs_PluginUpdateChecker` | `YahnisElsts\PluginUpdateChecker\v5p6\Vcs\PluginUpdateChecker` |
| `Puc_v4p13_Vcs_ThemeUpdateChecker`  | `YahnisElsts\PluginUpdateChecker\v5p6\Vcs\ThemeUpdateChecker`  |
| `Puc_v4p13_Vcs_GitHubApi`           | `YahnisElsts\PluginUpdateChecker\v5p6\Vcs\GitHubApi`           |
| `Puc_v4p13_Vcs_GitLabApi`           | `YahnisElsts\PluginUpdateChecker\v5p6\Vcs\GitLabApi`           |
| `Puc_v4p13_Vcs_BitBucketApi`        | `YahnisElsts\PluginUpdateChecker\v5p6\Vcs\BitBucketApi`        |

License Management
------------------

Currently, the update checker doesn't have any built-in license management features. It only provides some hooks that you can use to, for example, append license keys to update requests (`$updateChecker->addQueryArgFilter()`). If you're looking for ways to manage and verify licenses, please post your feedback in [this issue](https://github.com/YahnisElsts/plugin-update-checker/issues/222).

Resources
---------

- [This blog post](https://w-shadow.com/blog/2010/09/02/automatic-updates-for-any-plugin/) has more information about the update checker API. *Slightly out of date.*
- [Debug Bar](https://wordpress.org/plugins/debug-bar/) - useful for testing and debugging the update checker.
- [Update format reference](https://docs.google.com/spreadsheets/d/1eOBbW7Go2qEQXReOOCdidMTf_tDYRq4JfegcO1CBPIs/edit?usp=sharing) - describes all fields supported by the JSON-based update information format used by the update checker. Only covers plugins. Themes use a similar but more limited format.
- [Securing download links](https://w-shadow.com/blog/2013/03/19/plugin-updates-securing-download-links/) - a general overview.
- [A GUI for entering download credentials](https://open-tools.net/documentation/tutorial-automatic-updates.html#wordpress)
- [Theme Update Checker](https://w-shadow.com/blog/2011/06/02/automatic-updates-for-commercial-themes/) - an older, theme-only variant of this update checker.

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\css\puc-debug-bar.css (1334 bytes, 71 lines) =====
`$ext
.puc-debug-bar-panel-v5 pre {
	margin-top: 0;
}

/* Style the debug data table to match "widefat" table style used by WordPress. */
table.puc-debug-data {
    width: 100%;
    clear: both;
    margin: 0;

    border-spacing: 0;
    background-color: #f9f9f9;

    border-radius: 3px;
    border: 1px solid #dfdfdf;
    border-collapse: separate;
}

table.puc-debug-data * {
    word-wrap: break-word;
}

table.puc-debug-data th {
	width: 11em;
    padding: 7px 7px 8px;
    text-align: left;

    font-family: "Georgia", "Times New Roman", "Bitstream Charter", "Times", serif;
    font-weight: 400;
    font-size: 14px;
    line-height: 1.3em;
    text-shadow: rgba(255, 255, 255, 0.804) 0 1px 0;
}

table.puc-debug-data td, table.puc-debug-data th {
    border-width: 1px 0;
    border-style: solid;

    border-top-color: #fff;
    border-bottom-color: #dfdfdf;

    text-transform: none;
}

table.puc-debug-data td {
    color: #555;
    font-size: 12px;
    padding: 4px 7px 2px;
    vertical-align: top;
}

.puc-ajax-response {
	border: 1px solid #dfdfdf;
	border-radius: 3px;
	padding: 0.5em;
	margin: 5px 0;
	background-color: white;
}

.puc-ajax-nonce {
	display: none;
}

.puc-ajax-response dt {
	margin: 0;
}

.puc-ajax-response dd {
	margin: 0 0 1em;
}

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\js\debug-bar.js (1793 bytes, 54 lines) =====
`$ext
jQuery(function($) {

	function runAjaxAction(button, action) {
		button = $(button);
		var panel = button.closest('.puc-debug-bar-panel-v5');
		var responseBox = button.closest('td').find('.puc-ajax-response');

		responseBox.text('Processing...').show();
		$.post(
			ajaxurl,
			{
				action  : action,
				uid     : panel.data('uid'),
				_wpnonce: panel.data('nonce')
			},
			function(data) {
				//The response contains HTML that should already be escaped in server-side code.
				//phpcs:ignore WordPressVIPMinimum.JS.HTMLExecutingFunctions.html
				responseBox.html(data);
			},
			'html'
		);
	}

	$('.puc-debug-bar-panel-v5 input[name="puc-check-now-button"]').on('click', function() {
		runAjaxAction(this, 'puc_v5_debug_check_now');
		return false;
	});

	$('.puc-debug-bar-panel-v5 input[name="puc-request-info-button"]').on('click', function() {
		runAjaxAction(this, 'puc_v5_debug_request_info');
		return false;
	});


	// Debug Bar uses the panel class name as part of its link and container IDs. This means we can
	// end up with multiple identical IDs if more than one plugin uses the update checker library.
	// Fix it by replacing the class name with the plugin slug.
	var panels = $('#debug-menu-targets').find('.puc-debug-bar-panel-v5');
	panels.each(function() {
		var panel = $(this);
		var uid = panel.data('uid');
		var target = panel.closest('.debug-menu-target');

		//Change the panel wrapper ID.
		target.attr('id', 'debug-menu-target-puc-' + uid);

		//Change the menu link ID as well and point it at the new target ID.
		$('#debug-bar-menu').find('.puc-debug-menu-link-' + uid)
			.closest('.debug-menu-link')
			.attr('id', 'debug-menu-link-puc-' + uid)
			.attr('href', '#' + target.attr('id'));
	});
});
`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5\PucFactory.php (201 bytes, 11 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5;

if ( !class_exists(PucFactory::class, false) ):

	class PucFactory extends \YahnisElsts\PluginUpdateChecker\v5p6\PucFactory {
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Autoloader.php (2774 bytes, 87 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6;

if ( !class_exists(Autoloader::class, false) ):

	class Autoloader {
		const DEFAULT_NS_PREFIX = 'YahnisElsts\\PluginUpdateChecker\\';

		private $prefix;
		private $rootDir;
		private $libraryDir;

		private $staticMap;

		public function __construct() {
			$this->rootDir = dirname(__FILE__) . '/';

			$namespaceWithSlash = __NAMESPACE__ . '\\';
			$this->prefix = $namespaceWithSlash;

			$this->libraryDir = $this->rootDir . '../..';
			if ( !self::isPhar() ) {
				$this->libraryDir = realpath($this->libraryDir);
			}
			$this->libraryDir = $this->libraryDir . '/';

			//Usually, dependencies like Parsedown are in the global namespace,
			//but if someone adds a custom namespace to the entire library, they
			//will be in the same namespace as this class.
			$isCustomNamespace = (
				substr($namespaceWithSlash, 0, strlen(self::DEFAULT_NS_PREFIX)) !== self::DEFAULT_NS_PREFIX
			);
			$libraryPrefix = $isCustomNamespace ? $namespaceWithSlash : '';

			$this->staticMap = array(
				$libraryPrefix . 'PucReadmeParser' => 'vendor/PucReadmeParser.php',
				$libraryPrefix . 'Parsedown'       => 'vendor/Parsedown.php',
			);

			//Add the generic, major-version-only factory class to the static map.
			$versionSeparatorPos = strrpos(__NAMESPACE__, '\\v');
			if ( $versionSeparatorPos !== false ) {
				$versionSegment = substr(__NAMESPACE__, $versionSeparatorPos + 1);
				$pointPos = strpos($versionSegment, 'p');
				if ( ($pointPos !== false) && ($pointPos > 1) ) {
					$majorVersionSegment = substr($versionSegment, 0, $pointPos);
					$majorVersionNs = __NAMESPACE__ . '\\' . $majorVersionSegment;
					$this->staticMap[$majorVersionNs . '\\PucFactory'] =
						'Puc/' . $majorVersionSegment . '/Factory.php';
				}
			}

			spl_autoload_register(array($this, 'autoload'));
		}

		/**
		 * Determine if this file is running as part of a Phar archive.
		 *
		 * @return bool
		 */
		private static function isPhar() {
			//Check if the current file path starts with "phar://".
			static $pharProtocol = 'phar://';
			return (substr(__FILE__, 0, strlen($pharProtocol)) === $pharProtocol);
		}

		public function autoload($className) {
			if ( isset($this->staticMap[$className]) && file_exists($this->libraryDir . $this->staticMap[$className]) ) {
				include($this->libraryDir . $this->staticMap[$className]);
				return;
			}

			if ( strpos($className, $this->prefix) === 0 ) {
				$path = substr($className, strlen($this->prefix));
				$path = str_replace(array('_', '\\'), '/', $path);
				$path = $this->rootDir . $path . '.php';

				if ( file_exists($path) ) {
					include $path;
				}
			}
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\InstalledPackage.php (3042 bytes, 106 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6;

if ( !class_exists(InstalledPackage::class, false) ):

	/**
	 * This class represents a currently installed plugin or theme.
	 *
	 * Not to be confused with the "package" field in WP update API responses that contains
	 * the download URL of a the new version.
	 */
	abstract class InstalledPackage {
		/**
		 * @var UpdateChecker
		 */
		protected $updateChecker;

		public function __construct($updateChecker) {
			$this->updateChecker = $updateChecker;
		}

		/**
		 * Get the currently installed version of the plugin or theme.
		 *
		 * @return string|null Version number.
		 */
		abstract public function getInstalledVersion();

		/**
		 * Get the full path of the plugin or theme directory (without a trailing slash).
		 *
		 * @return string
		 */
		abstract public function getAbsoluteDirectoryPath();

		/**
		 * Check whether a regular file exists in the package's directory.
		 *
		 * @param string $relativeFileName File name relative to the package directory.
		 * @return bool
		 */
		public function fileExists($relativeFileName) {
			return is_file(
				$this->getAbsoluteDirectoryPath()
				. DIRECTORY_SEPARATOR
				. ltrim($relativeFileName, '/\\')
			);
		}

		/* -------------------------------------------------------------------
		 * File header parsing
		 * -------------------------------------------------------------------
		 */

		/**
		 * Parse plugin or theme metadata from the header comment.
		 *
		 * This is basically a simplified version of the get_file_data() function from /wp-includes/functions.php.
		 * It's intended as a utility for subclasses that detect updates by parsing files in a VCS.
		 *
		 * @param string|null $content File contents.
		 * @return string[]
		 */
		public function getFileHeader($content) {
			$content = (string)$content;

			//WordPress only looks at the first 8 KiB of the file, so we do the same.
			$content = substr($content, 0, 8192);
			//Normalize line endings.
			$content = str_replace("\r", "\n", $content);

			$headers = $this->getHeaderNames();
			$results = array();
			foreach ($headers as $field => $name) {
				$success = preg_match('/^[ \t\/*#@]*' . preg_quote($name, '/') . ':(.*)$/mi', $content, $matches);

				if ( ($success === 1) && $matches[1] ) {
					$value = $matches[1];
					if ( function_exists('_cleanup_header_comment') ) {
						$value = _cleanup_header_comment($value);
					}
					$results[$field] = $value;
				} else {
					$results[$field] = '';
				}
			}

			return $results;
		}

		/**
		 * @return array Format: ['HeaderKey' => 'Header Name']
		 */
		abstract protected function getHeaderNames();

		/**
		 * Get the value of a specific plugin or theme header.
		 *
		 * @param string $headerName
		 * @return string Either the value of the header, or an empty string if the header doesn't exist.
		 */
		abstract public function getHeaderValue($headerName);

	}
endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Metadata.php (4401 bytes, 163 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6;

use LogicException;
use stdClass;
use WP_Error;

if ( !class_exists(Metadata::class, false) ):

	/**
	 * A base container for holding information about updates and plugin metadata.
	 *
	 * @author Janis Elsts
	 * @copyright 2016
	 * @access public
	 */
	abstract class Metadata {
		/**
		 * Additional dynamic properties, usually copied from the API response.
		 *
		 * @var array<string,mixed>
		 */
		protected $extraProperties = array();

		/**
		 * Create an instance of this class from a JSON document.
		 *
		 * @abstract
		 * @param string $json
		 * @return self
		 */
		public static function fromJson($json) {
			throw new LogicException('The ' . __METHOD__ . ' method must be implemented by subclasses');
		}

		/**
		 * @param string $json
		 * @param self $target
		 * @return bool
		 */
		protected static function createFromJson($json, $target) {
			/** @var \StdClass $apiResponse */
			$apiResponse = json_decode($json);
			if ( empty($apiResponse) || !is_object($apiResponse) ){
				$errorMessage = "Failed to parse update metadata. Try validating your .json file with https://jsonlint.com/";
				do_action('puc_api_error', new WP_Error('puc-invalid-json', $errorMessage));
				//phpcs:ignore WordPress.PHP.DevelopmentFunctions.error_log_trigger_error -- For plugin developers.
				trigger_error(esc_html($errorMessage), E_USER_NOTICE);
				return false;
			}

			$valid = $target->validateMetadata($apiResponse);
			if ( is_wp_error($valid) ){
				do_action('puc_api_error', $valid);
				//phpcs:ignore WordPress.PHP.DevelopmentFunctions.error_log_trigger_error -- For plugin developers.
				trigger_error(esc_html($valid->get_error_message()), E_USER_NOTICE);
				return false;
			}

			foreach(get_object_vars($apiResponse) as $key => $value){
				$target->$key = $value;
			}

			return true;
		}

		/**
		 * No validation by default! Subclasses should check that the required fields are present.
		 *
		 * @param \StdClass $apiResponse
		 * @return bool|\WP_Error
		 */
		protected function validateMetadata($apiResponse) {
			return true;
		}

		/**
		 * Create a new instance by copying the necessary fields from another object.
		 *
		 * @abstract
		 * @param \StdClass|self $object The source object.
		 * @return self The new copy.
		 */
		public static function fromObject($object) {
			throw new LogicException('The ' . __METHOD__ . ' method must be implemented by subclasses');
		}

		/**
		 * Create an instance of StdClass that can later be converted back to an
		 * update or info container. Useful for serialization and caching, as it
		 * avoids the "incomplete object" problem if the cached value is loaded
		 * before this class.
		 *
		 * @return \StdClass
		 */
		public function toStdClass() {
			$object = new stdClass();
			$this->copyFields($this, $object);
			return $object;
		}

		/**
		 * Transform the metadata into the format used by WordPress core.
		 *
		 * @return object
		 */
		abstract public function toWpFormat();

		/**
		 * Copy known fields from one object to another.
		 *
		 * @param \StdClass|self $from
		 * @param \StdClass|self $to
		 */
		protected function copyFields($from, $to) {
			$fields = $this->getFieldNames();

			if ( property_exists($from, 'slug') && !empty($from->slug) ) {
				//Let plugins add extra fields without having to create subclasses.
				$fields = apply_filters($this->getPrefixedFilter('retain_fields') . '-' . $from->slug, $fields);
			}

			foreach ($fields as $field) {
				if ( property_exists($from, $field) ) {
					$to->$field = $from->$field;
				}
			}
		}

		/**
		 * @return string[]
		 */
		protected function getFieldNames() {
			return array();
		}

		/**
		 * @param string $tag
		 * @return string
		 */
		protected function getPrefixedFilter($tag) {
			return 'puc_' . $tag;
		}

		public function __set($name, $value) {
			$this->extraProperties[$name] = $value;
		}

		public function __get($name) {
			return isset($this->extraProperties[$name]) ? $this->extraProperties[$name] : null;
		}

		public function __isset($name) {
			return isset($this->extraProperties[$name]);
		}

		public function __unset($name) {
			unset($this->extraProperties[$name]);
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\OAuthSignature.php (3167 bytes, 103 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6;

if ( !class_exists(OAuthSignature::class, false) ):

	/**
	 * A basic signature generator for zero-legged OAuth 1.0.
	 */
	class OAuthSignature {
		private $consumerKey = '';
		private $consumerSecret = '';

		public function __construct($consumerKey, $consumerSecret) {
			$this->consumerKey = $consumerKey;
			$this->consumerSecret = $consumerSecret;
		}

		/**
		 * Sign a URL using OAuth 1.0.
		 *
		 * @param string $url The URL to be signed. It may contain query parameters.
		 * @param string $method HTTP method such as "GET", "POST" and so on.
		 * @return string The signed URL.
		 */
		public function sign($url, $method = 'GET') {
			$parameters = array();

			//Parse query parameters.
			$query = wp_parse_url($url, PHP_URL_QUERY);
			if ( !empty($query) ) {
				parse_str($query, $parsedParams);
				if ( is_array($parsedParams) ) {
					$parameters = $parsedParams;
				}
				//Remove the query string from the URL. We'll replace it later.
				$url = substr($url, 0, strpos($url, '?'));
			}

			$parameters = array_merge(
				$parameters,
				array(
					'oauth_consumer_key' => $this->consumerKey,
					'oauth_nonce' => $this->nonce(),
					'oauth_signature_method' => 'HMAC-SHA1',
					'oauth_timestamp' => time(),
					'oauth_version' => '1.0',
				)
			);
			unset($parameters['oauth_signature']);

			//Parameters must be sorted alphabetically before signing.
			ksort($parameters);

			//The most complicated part of the request - generating the signature.
			//The string to sign contains the HTTP method, the URL path, and all of
			//our query parameters. Everything is URL encoded. Then we concatenate
			//them with ampersands into a single string to hash.
			$encodedVerb = urlencode($method);
			$encodedUrl = urlencode($url);
			$encodedParams = urlencode(http_build_query($parameters, '', '&'));

			$stringToSign = $encodedVerb . '&' . $encodedUrl . '&' . $encodedParams;

			//Since we only have one OAuth token (the consumer secret) we only have
			//to use it as our HMAC key. However, we still have to append an & to it
			//as if we were using it with additional tokens.
			$secret = urlencode($this->consumerSecret) . '&';

			//The signature is a hash of the consumer key and the base string. Note
			//that we have to get the raw output from hash_hmac and base64 encode
			//the binary data result.
			$parameters['oauth_signature'] = base64_encode(hash_hmac('sha1', $stringToSign, $secret, true));

			return ($url . '?' . http_build_query($parameters));
		}

		/**
		 * Generate a random nonce.
		 *
		 * @return string
		 */
		private function nonce() {
			$mt = microtime();

			$rand = null;
			if ( is_callable('random_bytes') ) {
				try {
					$rand = random_bytes(16);
				} catch (\Exception $ex) {
					//Fall back to mt_rand (below).
				}
			}
			if ( $rand === null ) {
				//phpcs:ignore WordPress.WP.AlternativeFunctions.rand_mt_rand
				$rand = function_exists('wp_rand') ? wp_rand() : mt_rand();
			}

			return md5($mt . '_' . $rand);
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\PucFactory.php (12121 bytes, 363 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6;

use YahnisElsts\PluginUpdateChecker\v5p6\Plugin;
use YahnisElsts\PluginUpdateChecker\v5p6\Theme;
use YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

if ( !class_exists(PucFactory::class, false) ):

	/**
	 * A factory that builds update checker instances.
	 *
	 * When multiple versions of the same class have been loaded (e.g. PluginUpdateChecker 4.0
	 * and 4.1), this factory will always use the latest available minor version. Register class
	 * versions by calling {@link PucFactory::addVersion()}.
	 *
	 * At the moment it can only build instances of the UpdateChecker class. Other classes are
	 * intended mainly for internal use and refer directly to specific implementations.
	 */
	class PucFactory {
		protected static $classVersions = array();
		protected static $sorted = false;

		protected static $myMajorVersion = '';
		protected static $latestCompatibleVersion = '';

		/**
		 * A wrapper method for buildUpdateChecker() that reads the metadata URL from the plugin or theme header.
		 *
		 * @param string $fullPath Full path to the main plugin file or the theme's style.css.
		 * @param array $args Optional arguments. Keys should match the argument names of the buildUpdateChecker() method.
		 * @return Plugin\UpdateChecker|Theme\UpdateChecker|Vcs\BaseChecker
		 */
		public static function buildFromHeader($fullPath, $args = array()) {
			$fullPath = self::normalizePath($fullPath);

			//Set up defaults.
			$defaults = array(
				'metadataUrl'  => '',
				'slug'         => '',
				'checkPeriod'  => 12,
				'optionName'   => '',
				'muPluginFile' => '',
			);
			$args = array_merge($defaults, array_intersect_key($args, $defaults));
			extract($args, EXTR_SKIP);

			//Check for the service URI
			if ( empty($metadataUrl) ) {
				$metadataUrl = self::getServiceURI($fullPath);
			}

			return self::buildUpdateChecker($metadataUrl, $fullPath, $slug, $checkPeriod, $optionName, $muPluginFile);
		}

		/**
		 * Create a new instance of the update checker.
		 *
		 * This method automatically detects if you're using it for a plugin or a theme and chooses
		 * the appropriate implementation for your update source (JSON file, GitHub, BitBucket, etc).
		 *
		 * @see UpdateChecker::__construct
		 *
		 * @param string $metadataUrl The URL of the metadata file, a GitHub repository, or another supported update source.
		 * @param string $fullPath Full path to the main plugin file or to the theme directory.
		 * @param string $slug Custom slug. Defaults to the name of the main plugin file or the theme directory.
		 * @param int $checkPeriod How often to check for updates (in hours).
		 * @param string $optionName Where to store bookkeeping info about update checks.
		 * @param string $muPluginFile The plugin filename relative to the mu-plugins directory.
		 * @return Plugin\UpdateChecker|Theme\UpdateChecker|Vcs\BaseChecker
		 */
		public static function buildUpdateChecker($metadataUrl, $fullPath, $slug = '', $checkPeriod = 12, $optionName = '', $muPluginFile = '') {
			$fullPath = self::normalizePath($fullPath);
			$id = null;

			//Plugin or theme?
			$themeDirectory = self::getThemeDirectoryName($fullPath);
			if ( self::isPluginFile($fullPath) ) {
				$type = 'Plugin';
				$id = $fullPath;
			} else if ( $themeDirectory !== null ) {
				$type = 'Theme';
				$id = $themeDirectory;
			} else {
				throw new \RuntimeException(sprintf(
					'The update checker cannot determine if "%s" is a plugin or a theme. ' .
					'This is a bug. Please contact the PUC developer.',
					esc_html($fullPath)
				));
			}

			//Which hosting service does the URL point to?
			$service = self::getVcsService($metadataUrl);

			$apiClass = null;
			if ( empty($service) ) {
				//The default is to get update information from a remote JSON file.
				$checkerClass = $type . '\\UpdateChecker';
			} else {
				//You can also use a VCS repository like GitHub.
				$checkerClass = 'Vcs\\' . $type . 'UpdateChecker';
				$apiClass = $service . 'Api';
			}

			$checkerClass = self::getCompatibleClassVersion($checkerClass);
			if ( $checkerClass === null ) {
				//phpcs:ignore WordPress.PHP.DevelopmentFunctions.error_log_trigger_error
				trigger_error(
					esc_html(sprintf(
						'PUC %s does not support updates for %ss %s',
						self::$latestCompatibleVersion,
						strtolower($type),
						$service ? ('hosted on ' . $service) : 'using JSON metadata'
					)),
					E_USER_ERROR
				);
			}

			if ( !isset($apiClass) ) {
				//Plain old update checker.
				return new $checkerClass($metadataUrl, $id, $slug, $checkPeriod, $optionName, $muPluginFile);
			} else {
				//VCS checker + an API client.
				$apiClass = self::getCompatibleClassVersion($apiClass);
				if ( $apiClass === null ) {
					//phpcs:ignore WordPress.PHP.DevelopmentFunctions.error_log_trigger_error
					trigger_error(esc_html(sprintf(
						'PUC %s does not support %s',
						self::$latestCompatibleVersion,
						$service
					)), E_USER_ERROR);
				}

				return new $checkerClass(
					new $apiClass($metadataUrl),
					$id,
					$slug,
					$checkPeriod,
					$optionName,
					$muPluginFile
				);
			}
		}

		/**
		 *
		 * Normalize a filesystem path. Introduced in WP 3.9.
		 * Copying here allows use of the class on earlier versions.
		 * This version adapted from WP 4.8.2 (unchanged since 4.5.6)
		 *
		 * @param string $path Path to normalize.
		 * @return string Normalized path.
		 */
		public static function normalizePath($path) {
			if ( function_exists('wp_normalize_path') ) {
				return wp_normalize_path($path);
			}
			$path = str_replace('\\', '/', $path);
			$path = preg_replace('|(?<=.)/+|', '/', $path);
			if ( substr($path, 1, 1) === ':' ) {
				$path = ucfirst($path);
			}
			return $path;
		}

		/**
		 * Check if the path points to a plugin file.
		 *
		 * @param string $absolutePath Normalized path.
		 * @return bool
		 */
		protected static function isPluginFile($absolutePath) {
			//Is the file inside the "plugins" or "mu-plugins" directory?
			$pluginDir = self::normalizePath(WP_PLUGIN_DIR);
			$muPluginDir = self::normalizePath(WPMU_PLUGIN_DIR);
			if ( (strpos($absolutePath, $pluginDir) === 0) || (strpos($absolutePath, $muPluginDir) === 0) ) {
				return true;
			}

			//Is it a file at all? Caution: is_file() can fail if the parent dir. doesn't have the +x permission set.
			if ( !is_file($absolutePath) ) {
				return false;
			}

			//Does it have a valid plugin header?
			//This is a last-ditch check for plugins symlinked from outside the WP root.
			if ( function_exists('get_file_data') ) {
				$headers = get_file_data($absolutePath, array('Name' => 'Plugin Name'), 'plugin');
				return !empty($headers['Name']);
			}

			return false;
		}

		/**
		 * Get the name of the theme's directory from a full path to a file inside that directory.
		 * E.g. "/abc/public_html/wp-content/themes/foo/whatever.php" => "foo".
		 *
		 * Note that subdirectories are currently not supported. For example,
		 * "/xyz/wp-content/themes/my-theme/includes/whatever.php" => NULL.
		 *
		 * @param string $absolutePath Normalized path.
		 * @return string|null Directory name, or NULL if the path doesn't point to a theme.
		 */
		protected static function getThemeDirectoryName($absolutePath) {
			if ( is_file($absolutePath) ) {
				$absolutePath = dirname($absolutePath);
			}

			if ( file_exists($absolutePath . '/style.css') ) {
				return basename($absolutePath);
			}
			return null;
		}

		/**
		 * Get the service URI from the file header.
		 *
		 * @param string $fullPath
		 * @return string
		 */
		private static function getServiceURI($fullPath) {
			//Look for the URI
			if ( is_readable($fullPath) ) {
				$seek = array(
					'github' => 'GitHub URI',
					'gitlab' => 'GitLab URI',
					'bucket' => 'BitBucket URI',
				);
				$seek = apply_filters('puc_get_source_uri', $seek);
				$data = get_file_data($fullPath, $seek);
				foreach ($data as $key => $uri) {
					if ( $uri ) {
						return $uri;
					}
				}
			}

			//URI was not found so throw an error.
			throw new \RuntimeException(
				sprintf('Unable to locate URI in header of "%s"', esc_html($fullPath))
			);
		}

		/**
		 * Get the name of the hosting service that the URL points to.
		 *
		 * @param string $metadataUrl
		 * @return string|null
		 */
		private static function getVcsService($metadataUrl) {
			$service = null;

			//Which hosting service does the URL point to?
			$host = (string)(wp_parse_url($metadataUrl, PHP_URL_HOST));
			$path = (string)(wp_parse_url($metadataUrl, PHP_URL_PATH));

			//Check if the path looks like "/user-name/repository".
			//For GitLab.com it can also be "/user/group1/group2/.../repository".
			$repoRegex = '@^/?([^/]+?)/([^/#?&]+?)/?$@';
			if ( $host === 'gitlab.com' ) {
				$repoRegex = '@^/?(?:[^/#?&]++/){1,20}(?:[^/#?&]++)/?$@';
			}
			if ( preg_match($repoRegex, $path) ) {
				$knownServices = array(
					'github.com' => 'GitHub',
					'bitbucket.org' => 'BitBucket',
					'gitlab.com' => 'GitLab',
				);
				if ( isset($knownServices[$host]) ) {
					$service = $knownServices[$host];
				}
			}

			return apply_filters('puc_get_vcs_service', $service, $host, $path, $metadataUrl);
		}

		/**
		 * Get the latest version of the specified class that has the same major version number
		 * as this factory class.
		 *
		 * @param string $class Partial class name.
		 * @return string|null Full class name.
		 */
		protected static function getCompatibleClassVersion($class) {
			if ( isset(self::$classVersions[$class][self::$latestCompatibleVersion]) ) {
				return self::$classVersions[$class][self::$latestCompatibleVersion];
			}
			return null;
		}

		/**
		 * Get the specific class name for the latest available version of a class.
		 *
		 * @param string $class
		 * @return null|string
		 */
		public static function getLatestClassVersion($class) {
			if ( !self::$sorted ) {
				self::sortVersions();
			}

			if ( isset(self::$classVersions[$class]) ) {
				return reset(self::$classVersions[$class]);
			} else {
				return null;
			}
		}

		/**
		 * Sort available class versions in descending order (i.e. newest first).
		 */
		protected static function sortVersions() {
			foreach ( self::$classVersions as $class => $versions ) {
				uksort($versions, array(__CLASS__, 'compareVersions'));
				self::$classVersions[$class] = $versions;
			}
			self::$sorted = true;
		}

		protected static function compareVersions($a, $b) {
			return -version_compare($a, $b);
		}

		/**
		 * Register a version of a class.
		 *
		 * @access private This method is only for internal use by the library.
		 *
		 * @param string $generalClass Class name without version numbers, e.g. 'PluginUpdateChecker'.
		 * @param string $versionedClass Actual class name, e.g. 'PluginUpdateChecker_1_2'.
		 * @param string $version Version number, e.g. '1.2'.
		 */
		public static function addVersion($generalClass, $versionedClass, $version) {
			if ( empty(self::$myMajorVersion) ) {
				$lastNamespaceSegment = substr(__NAMESPACE__, strrpos(__NAMESPACE__, '\\') + 1);
				self::$myMajorVersion = substr(ltrim($lastNamespaceSegment, 'v'), 0, 1);
			}

			//Store the greatest version number that matches our major version.
			$components = explode('.', $version);
			if ( $components[0] === self::$myMajorVersion ) {

				if (
					empty(self::$latestCompatibleVersion)
					|| version_compare($version, self::$latestCompatibleVersion, '>')
				) {
					self::$latestCompatibleVersion = $version;
				}

			}

			if ( !isset(self::$classVersions[$generalClass]) ) {
				self::$classVersions[$generalClass] = array();
			}
			self::$classVersions[$generalClass][$version] = $versionedClass;
			self::$sorted = false;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Scheduler.php (11167 bytes, 301 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6;

if ( !class_exists(Scheduler::class, false) ):

	/**
	 * The scheduler decides when and how often to check for updates.
	 * It calls @see UpdateChecker::checkForUpdates() to perform the actual checks.
	 */
	class Scheduler {
		public $checkPeriod = 12; //How often to check for updates (in hours).
		public $throttleRedundantChecks = false; //Check less often if we already know that an update is available.
		public $throttledCheckPeriod = 72;

		protected $hourlyCheckHooks = array('load-update.php');

		/**
		 * @var UpdateChecker
		 */
		protected $updateChecker;

		private $cronHook = null;

		/**
		 * Scheduler constructor.
		 *
		 * @param UpdateChecker $updateChecker
		 * @param int $checkPeriod How often to check for updates (in hours).
		 * @param array $hourlyHooks
		 */
		public function __construct($updateChecker, $checkPeriod, $hourlyHooks = array('load-plugins.php')) {
			$this->updateChecker = $updateChecker;
			$this->checkPeriod = $checkPeriod;

			//Set up the periodic update checks
			$this->cronHook = $this->updateChecker->getUniqueName('cron_check_updates');
			if ( $this->checkPeriod > 0 ){

				//Trigger the check via Cron.
				//Try to use one of the default schedules if possible as it's less likely to conflict
				//with other plugins and their custom schedules.
				$defaultSchedules = array(
					1  => 'hourly',
					12 => 'twicedaily',
					24 => 'daily',
				);
				if ( array_key_exists($this->checkPeriod, $defaultSchedules) ) {
					$scheduleName = $defaultSchedules[$this->checkPeriod];
				} else {
					//Use a custom cron schedule.
					$scheduleName = 'every' . $this->checkPeriod . 'hours';
					//phpcs:ignore WordPress.WP.CronInterval.ChangeDetected -- WPCS fails to parse the callback.
					add_filter('cron_schedules', array($this, '_addCustomSchedule'));
				}

				if ( !wp_next_scheduled($this->cronHook) && !defined('WP_INSTALLING') ) {
					//Randomly offset the schedule to help prevent update server traffic spikes. Without this
					//most checks may happen during times of day when people are most likely to install new plugins.
					$upperLimit = max($this->checkPeriod * 3600 - 15 * 60, 1);
					if ( function_exists('wp_rand') ) {
						$randomOffset = wp_rand(0, $upperLimit);
					} else {
						//This constructor may be called before wp_rand() is available.
						//phpcs:ignore WordPress.WP.AlternativeFunctions.rand_rand
						$randomOffset = rand(0, $upperLimit);
					}
					$firstCheckTime = time() - $randomOffset;
					$firstCheckTime = apply_filters(
						$this->updateChecker->getUniqueName('first_check_time'),
						$firstCheckTime
					);
					wp_schedule_event($firstCheckTime, $scheduleName, $this->cronHook);
				}
				add_action($this->cronHook, array($this, 'maybeCheckForUpdates'));

				//In case Cron is disabled or unreliable, we also manually trigger
				//the periodic checks while the user is browsing the Dashboard.
				add_action( 'admin_init', array($this, 'maybeCheckForUpdates') );

				//Like WordPress itself, we check more often on certain pages.
				/** @see wp_update_plugins */
				add_action('load-update-core.php', array($this, 'maybeCheckForUpdates'));
				//phpcs:ignore Squiz.PHP.CommentedOutCode.Found -- Not actually code, just file names.
				//"load-update.php" and "load-plugins.php" or "load-themes.php".
				$this->hourlyCheckHooks = array_merge($this->hourlyCheckHooks, $hourlyHooks);
				foreach($this->hourlyCheckHooks as $hook) {
					add_action($hook, array($this, 'maybeCheckForUpdates'));
				}
				//This hook fires after a bulk update is complete.
				add_action('upgrader_process_complete', array($this, 'removeHooksIfLibraryGone'), 1, 0);
				add_action('upgrader_process_complete', array($this, 'upgraderProcessComplete'), 11, 2);

			} else {
				//Periodic checks are disabled.
				wp_clear_scheduled_hook($this->cronHook);
			}
		}

		/**
		 * Remove all hooks if this version of PUC has been deleted or overwritten.
		 *
		 * Callback for the "upgrader_process_complete" action.
		 */
		public function removeHooksIfLibraryGone() {
			//Cancel all further actions if the current version of PUC has been deleted or overwritten
			//by a different version during the upgrade. If we try to do anything more in that situation,
			//we could trigger a fatal error by trying to autoload a deleted class.
			clearstatcache();
			if ( !file_exists(__FILE__) ) {
				$this->removeHooks();
				$this->updateChecker->removeHooks();
			}
		}

		/**
		 * Runs upon the WP action upgrader_process_complete.
		 *
		 * We look at the parameters to decide whether to call maybeCheckForUpdates() or not.
		 * We also check if the update checker has been removed by the update.
		 *
		 * @param \WP_Upgrader $upgrader  WP_Upgrader instance
		 * @param array $upgradeInfo extra information about the upgrade
		 */
		public function upgraderProcessComplete(
			/** @noinspection PhpUnusedParameterInspection */
			$upgrader, $upgradeInfo
		) {
			//Sanity check and limitation to relevant types.
			if (
				!is_array($upgradeInfo) || !isset($upgradeInfo['type'], $upgradeInfo['action'])
				|| 'update' !== $upgradeInfo['action'] || !in_array($upgradeInfo['type'], array('plugin', 'theme'))
			) {
				return;
			}

			//Filter out notifications of upgrades that should have no bearing upon whether or not our
			//current info is up-to-date.
			if ( is_a($this->updateChecker, Theme\UpdateChecker::class) ) {
				if ( 'theme' !== $upgradeInfo['type'] || !isset($upgradeInfo['themes']) ) {
					return;
				}

				//Letting too many things going through for checks is not a real problem, so we compare widely.
				if ( !in_array(
					strtolower($this->updateChecker->directoryName),
					array_map('strtolower', $upgradeInfo['themes'])
				) ) {
					return;
				}
			}

			if ( is_a($this->updateChecker, Plugin\UpdateChecker::class) ) {
				if ( 'plugin' !== $upgradeInfo['type'] || !isset($upgradeInfo['plugins']) ) {
					return;
				}

				//Themes pass in directory names in the information array, but plugins use the relative plugin path.
				if ( !in_array(
					strtolower($this->updateChecker->directoryName),
					array_map('dirname', array_map('strtolower', $upgradeInfo['plugins']))
				) ) {
					return;
				}
			}

			$this->maybeCheckForUpdates();
		}

		/**
		 * Check for updates if the configured check interval has already elapsed.
		 * Will use a shorter check interval on certain admin pages like "Dashboard -> Updates" or when doing cron.
		 *
		 * You can override the default behaviour by using the "puc_check_now-$slug" filter.
		 * The filter callback will be passed three parameters:
		 *     - Current decision. TRUE = check updates now, FALSE = don't check now.
		 *     - Last check time as a Unix timestamp.
		 *     - Configured check period in hours.
		 * Return TRUE to check for updates immediately, or FALSE to cancel.
		 *
		 * This method is declared public because it's a hook callback. Calling it directly is not recommended.
		 */
		public function maybeCheckForUpdates() {
			if ( empty($this->checkPeriod) ){
				return;
			}

			$state = $this->updateChecker->getUpdateState();
			$shouldCheck = ($state->timeSinceLastCheck() >= $this->getEffectiveCheckPeriod());

			if ( $shouldCheck ) {
				//Sanity check: Do not proceed if one of the critical classes is missing.
				//That can happen - theoretically and extremely rarely - if maybeCheckForUpdates()
				//is called before the old version of our plugin has been fully deleted, or
				//called from an independent AJAX request during deletion.
				if ( !(
					class_exists(Utils::class)
					&& class_exists(Metadata::class)
					&& class_exists(Plugin\Update::class)
					&& class_exists(Theme\Update::class)
				) ) {
					return;
				}
			}

			//Let plugin authors substitute their own algorithm.
			$shouldCheck = apply_filters(
				$this->updateChecker->getUniqueName('check_now'),
				$shouldCheck,
				$state->getLastCheck(),
				$this->checkPeriod
			);

			if ( $shouldCheck ) {
				$this->updateChecker->checkForUpdates();
			}
		}

		/**
		 * Calculate the actual check period based on the current status and environment.
		 *
		 * @return int Check period in seconds.
		 */
		protected function getEffectiveCheckPeriod() {
			$currentFilter = current_filter();
			if ( in_array($currentFilter, array('load-update-core.php', 'upgrader_process_complete')) ) {
				//Check more often when the user visits "Dashboard -> Updates" or does a bulk update.
				$period = 60;
			} else if ( in_array($currentFilter, $this->hourlyCheckHooks) ) {
				//Also check more often on /wp-admin/update.php and the "Plugins" or "Themes" page.
				$period = 3600;
			} else if ( $this->throttleRedundantChecks && ($this->updateChecker->getUpdate() !== null) ) {
				//Check less frequently if it's already known that an update is available.
				$period = $this->throttledCheckPeriod * 3600;
			} else if ( defined('DOING_CRON') && constant('DOING_CRON') ) {
				//WordPress cron schedules are not exact, so let's do an update check even
				//if slightly less than $checkPeriod hours have elapsed since the last check.
				$cronFuzziness = 20 * 60;
				$period = $this->checkPeriod * 3600 - $cronFuzziness;
			} else {
				$period = $this->checkPeriod * 3600;
			}

			return $period;
		}

		/**
		 * Add our custom schedule to the array of Cron schedules used by WP.
		 *
		 * @param array $schedules
		 * @return array
		 */
		public function _addCustomSchedule($schedules) {
			if ( $this->checkPeriod && ($this->checkPeriod > 0) ){
				$scheduleName = 'every' . $this->checkPeriod . 'hours';
				$schedules[$scheduleName] = array(
					'interval' => $this->checkPeriod * 3600,
					'display' => sprintf('Every %d hours', $this->checkPeriod),
				);
			}
			return $schedules;
		}

		/**
		 * Remove the scheduled cron event that the library uses to check for updates.
		 *
		 * @return void
		 */
		public function removeUpdaterCron() {
			wp_clear_scheduled_hook($this->cronHook);
		}

		/**
		 * Get the name of the update checker's WP-cron hook. Mostly useful for debugging.
		 *
		 * @return string
		 */
		public function getCronHookName() {
			return $this->cronHook;
		}

		/**
		 * Remove most hooks added by the scheduler.
		 */
		public function removeHooks() {
			remove_filter('cron_schedules', array($this, '_addCustomSchedule'));
			remove_action('admin_init', array($this, 'maybeCheckForUpdates'));
			remove_action('load-update-core.php', array($this, 'maybeCheckForUpdates'));

			if ( $this->cronHook !== null ) {
				remove_action($this->cronHook, array($this, 'maybeCheckForUpdates'));
			}
			if ( !empty($this->hourlyCheckHooks) ) {
				foreach ($this->hourlyCheckHooks as $hook) {
					remove_action($hook, array($this, 'maybeCheckForUpdates'));
				}
			}
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\StateStore.php (4972 bytes, 215 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6;

if ( !class_exists(StateStore::class, false) ):

	class StateStore {
		/**
		 * @var int Last update check timestamp.
		 */
		protected $lastCheck = 0;

		/**
		 * @var string Version number.
		 */
		protected $checkedVersion = '';

		/**
		 * @var Update|null Cached update.
		 */
		protected $update = null;

		/**
		 * @var string Site option name.
		 */
		private $optionName = '';

		/**
		 * @var bool Whether we've already tried to load the state from the database.
		 */
		private $isLoaded = false;

		public function __construct($optionName) {
			$this->optionName = $optionName;
		}

		/**
		 * Get time elapsed since the last update check.
		 *
		 * If there are no recorded update checks, this method returns a large arbitrary number
		 * (i.e. time since the Unix epoch).
		 *
		 * @return int Elapsed time in seconds.
		 */
		public function timeSinceLastCheck() {
			$this->lazyLoad();
			return time() - $this->lastCheck;
		}

		/**
		 * @return int
		 */
		public function getLastCheck() {
			$this->lazyLoad();
			return $this->lastCheck;
		}

		/**
		 * Set the time of the last update check to the current timestamp.
		 *
		 * @return $this
		 */
		public function setLastCheckToNow() {
			$this->lazyLoad();
			$this->lastCheck = time();
			return $this;
		}

		/**
		 * @return null|Update
		 */
		public function getUpdate() {
			$this->lazyLoad();
			return $this->update;
		}

		/**
		 * @param Update|null $update
		 * @return $this
		 */
		public function setUpdate($update = null) {
			$this->lazyLoad();
			$this->update = $update;
			return $this;
		}

		/**
		 * @return string
		 */
		public function getCheckedVersion() {
			$this->lazyLoad();
			return $this->checkedVersion;
		}

		/**
		 * @param string $version
		 * @return $this
		 */
		public function setCheckedVersion($version) {
			$this->lazyLoad();
			$this->checkedVersion = strval($version);
			return $this;
		}

		/**
		 * Get translation updates.
		 *
		 * @return array
		 */
		public function getTranslations() {
			$this->lazyLoad();
			if ( isset($this->update, $this->update->translations) ) {
				return $this->update->translations;
			}
			return array();
		}

		/**
		 * Set translation updates.
		 *
		 * @param array $translationUpdates
		 */
		public function setTranslations($translationUpdates) {
			$this->lazyLoad();
			if ( isset($this->update) ) {
				$this->update->translations = $translationUpdates;
				$this->save();
			}
		}

		public function save() {
			$state = new \stdClass();

			$state->lastCheck = $this->lastCheck;
			$state->checkedVersion = $this->checkedVersion;

			if ( isset($this->update)) {
				$state->update = $this->update->toStdClass();

				$updateClass = get_class($this->update);
				$state->updateClass = $updateClass;
				$prefix = $this->getLibPrefix();
				if ( Utils::startsWith($updateClass, $prefix) ) {
					$state->updateBaseClass = substr($updateClass, strlen($prefix));
				}
			}

			update_site_option($this->optionName, $state);
			$this->isLoaded = true;
		}

		/**
		 * @return $this
		 */
		public function lazyLoad() {
			if ( !$this->isLoaded ) {
				$this->load();
			}
			return $this;
		}

		protected function load() {
			$this->isLoaded = true;

			$state = get_site_option($this->optionName, null);

			if (
				!is_object($state)
				//Sanity check: If the Utils class is missing, the plugin is probably in the process
				//of being deleted (e.g. the old version gets deleted during an update).
				|| !class_exists(Utils::class)
			) {
				$this->lastCheck = 0;
				$this->checkedVersion = '';
				$this->update = null;
				return;
			}

			$this->lastCheck = intval(Utils::get($state, 'lastCheck', 0));
			$this->checkedVersion = Utils::get($state, 'checkedVersion', '');
			$this->update = null;

			if ( isset($state->update) ) {
				//This mess is due to the fact that the want the update class from this version
				//of the library, not the version that saved the update.

				$updateClass = null;
				if ( isset($state->updateBaseClass) ) {
					$updateClass = $this->getLibPrefix() . $state->updateBaseClass;
				} else if ( isset($state->updateClass) ) {
					$updateClass = $state->updateClass;
				}

				$factory = array($updateClass, 'fromObject');
				if ( ($updateClass !== null) && is_callable($factory) ) {
					$this->update = call_user_func($factory, $state->update);
				}
			}
		}

		public function delete() {
			delete_site_option($this->optionName);

			$this->lastCheck = 0;
			$this->checkedVersion = '';
			$this->update = null;
		}

		private function getLibPrefix() {
			//This assumes that the current class is at the top of the versioned namespace.
			return __NAMESPACE__ . '\\';
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Update.php (787 bytes, 39 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6;

use stdClass;

if ( !class_exists(Update::class, false) ):

	/**
	 * A simple container class for holding information about an available update.
	 *
	 * @author Janis Elsts
	 * @access public
	 */
	abstract class Update extends Metadata {
		public $slug;
		public $version;
		public $download_url;
		public $translations = array();

		/**
		 * @return string[]
		 */
		protected function getFieldNames() {
			return array('slug', 'version', 'download_url', 'translations');
		}

		public function toWpFormat() {
			$update = new stdClass();

			$update->slug = $this->slug;
			$update->new_version = $this->version;
			$update->package = $this->download_url;

			return $update;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\UpdateChecker.php (37442 bytes, 1142 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6;

use stdClass;
use WP_Error;

if ( !class_exists(UpdateChecker::class, false) ):

	abstract class UpdateChecker {
		protected $filterSuffix = '';
		protected $updateTransient = '';

		/**
		 * @var string This can be "plugin" or "theme".
		 */
		protected $componentType = '';
		/**
		 * @var string Currently the same as $componentType, but this is an implementation detail that
		 *             depends on how WP works internally, and could therefore change.
		 */
		protected $translationType = '';

		/**
		 * Set to TRUE to enable error reporting. Errors are raised using trigger_error()
		 * and should be logged to the standard PHP error log.
		 * @var bool
		 */
		public $debugMode = null;

		/**
		 * @var string Where to store the update info.
		 */
		public $optionName = '';

		/**
		 * @var string The URL of the metadata file.
		 */
		public $metadataUrl = '';

		/**
		 * @var string Plugin or theme directory name.
		 */
		public $directoryName = '';

		/**
		 * @var string The slug that will be used in update checker hooks and remote API requests.
		 * Usually matches the directory name unless the plugin/theme directory has been renamed.
		 */
		public $slug = '';

		/**
		 * @var InstalledPackage
		 */
		protected $package;

		/**
		 * @var Scheduler
		 */
		public $scheduler;

		/**
		 * @var UpgraderStatus
		 */
		protected $upgraderStatus;

		/**
		 * @var StateStore
		 */
		protected $updateState;

		/**
		 * @var array List of API errors triggered during the last checkForUpdates() call.
		 */
		protected $lastRequestApiErrors = array();

		/**
		 * @var string|mixed The default is 0 because parse_url() can return NULL or FALSE.
		 */
		protected $cachedMetadataHost = 0;

		/**
		 * @var DebugBar\Extension|null
		 */
		protected $debugBarExtension = null;

		/**
		 * @var WpCliCheckTrigger|null
		 */
		protected $wpCliCheckTrigger = null;

		public function __construct($metadataUrl, $directoryName, $slug = null, $checkPeriod = 12, $optionName = '') {
			$this->debugMode = (bool)(constant('WP_DEBUG'));
			$this->metadataUrl = $metadataUrl;
			$this->directoryName = $directoryName;
			$this->slug = !empty($slug) ? $slug : $this->directoryName;

			$this->optionName = $optionName;
			if ( empty($this->optionName) ) {
				//BC: Initially the library only supported plugin updates and didn't use type prefixes
				//in the option name. Lets use the same prefix-less name when possible.
				if ( $this->filterSuffix === '' ) {
					$this->optionName = 'external_updates-' . $this->slug;
				} else {
					$this->optionName = $this->getUniqueName('external_updates');
				}
			}

			if ( empty($this->translationType) ) {
				$this->translationType = $this->componentType;
			}

			$this->package = $this->createInstalledPackage();
			$this->scheduler = $this->createScheduler($checkPeriod);
			$this->upgraderStatus = new UpgraderStatus();
			$this->updateState = new StateStore($this->optionName);

			if ( did_action('init') ) {
				$this->loadTextDomain();
			} else {
				add_action('init', array($this, 'loadTextDomain'));
			}

			$this->installHooks();

			if ( ($this->wpCliCheckTrigger === null) && defined('WP_CLI') ) {
				$this->wpCliCheckTrigger = new WpCliCheckTrigger($this->componentType, $this->scheduler);
			}
		}

		/**
		 * @internal
		 */
		public function loadTextDomain() {
			//We're not using load_plugin_textdomain() or its siblings because figuring out where
			//the library is located (plugin, mu-plugin, theme, custom wp-content paths) is messy.
			$domain = 'plugin-update-checker';
			$locale = apply_filters(
				'plugin_locale',
				(is_admin() && function_exists('get_user_locale')) ? get_user_locale() : get_locale(),
				$domain
			);

			$moFile = $domain . '-' . $locale . '.mo';
			$path = realpath(dirname(__FILE__) . '/../../languages');

			if ($path && file_exists($path)) {
				load_textdomain($domain, $path . '/' . $moFile);
			}
		}

		protected function installHooks() {
			//Insert our update info into the update array maintained by WP.
			add_filter('site_transient_' . $this->updateTransient, array($this,'injectUpdate'));

			//Insert translation updates into the update list.
			add_filter('site_transient_' . $this->updateTransient, array($this, 'injectTranslationUpdates'));

			//Clear translation updates when WP clears the update cache.
			//This needs to be done directly because the library doesn't actually remove obsolete plugin updates,
			//it just hides them (see getUpdate()). We can't do that with translations - too much disk I/O.
			add_action(
				'delete_site_transient_' . $this->updateTransient,
				array($this, 'clearCachedTranslationUpdates')
			);

			//Rename the update directory to be the same as the existing directory.
			if ( $this->directoryName !== '.' ) {
				add_filter('upgrader_source_selection', array($this, 'fixDirectoryName'), 10, 3);
			}

			//Allow HTTP requests to the metadata URL even if it's on a local host.
			add_filter('http_request_host_is_external', array($this, 'allowMetadataHost'), 10, 2);

			//Potentially exclude information about this entity from core update check requests to api.wordpress.org.
			//phpcs:ignore WordPressVIPMinimum.Hooks.RestrictedHooks.http_request_args -- Doesn't modify timeouts.
			add_filter('http_request_args', array($this, 'excludeEntityFromWordPressAPI'), 10, 2);

			//DebugBar integration.
			if ( did_action('plugins_loaded') ) {
				$this->maybeInitDebugBar();
			} else {
				add_action('plugins_loaded', array($this, 'maybeInitDebugBar'));
			}
		}

		/**
		 * Remove hooks that were added by this update checker instance.
		 */
		public function removeHooks() {
			remove_filter('site_transient_' . $this->updateTransient, array($this,'injectUpdate'));
			remove_filter('site_transient_' . $this->updateTransient, array($this, 'injectTranslationUpdates'));
			remove_action(
				'delete_site_transient_' . $this->updateTransient,
				array($this, 'clearCachedTranslationUpdates')
			);

			remove_filter('upgrader_source_selection', array($this, 'fixDirectoryName'), 10);
			remove_filter('http_request_host_is_external', array($this, 'allowMetadataHost'), 10);
			remove_filter('http_request_args', array($this, 'excludeEntityFromWordPressAPI'));
			remove_action('plugins_loaded', array($this, 'maybeInitDebugBar'));

			remove_action('init', array($this, 'loadTextDomain'));

			if ( $this->scheduler ) {
				$this->scheduler->removeHooks();
			}

			if ( $this->debugBarExtension ) {
				$this->debugBarExtension->removeHooks();
			}
		}

		/**
		 * Check if the current user has the required permissions to install updates.
		 *
		 * @return bool
		 */
		abstract public function userCanInstallUpdates();

		/**
		 * Explicitly allow HTTP requests to the metadata URL.
		 *
		 * WordPress has a security feature where the HTTP API will reject all requests that are sent to
		 * another site hosted on the same server as the current site (IP match), a local host, or a local
		 * IP, unless the host exactly matches the current site.
		 *
		 * This feature is opt-in (at least in WP 4.4). Apparently some people enable it.
		 *
		 * That can be a problem when you're developing your plugin and you decide to host the update information
		 * on the same server as your test site. Update requests will mysteriously fail.
		 *
		 * We fix that by adding an exception for the metadata host.
		 *
		 * @param bool $allow
		 * @param string $host
		 * @return bool
		 */
		public function allowMetadataHost($allow, $host) {
			if ( $this->cachedMetadataHost === 0 ) {
				$this->cachedMetadataHost = wp_parse_url($this->metadataUrl, PHP_URL_HOST);
			}

			if ( is_string($this->cachedMetadataHost) && (strtolower($host) === strtolower($this->cachedMetadataHost)) ) {
				return true;
			}
			return $allow;
		}

		/**
		 * Create a package instance that represents this plugin or theme.
		 *
		 * @return InstalledPackage
		 */
		abstract protected function createInstalledPackage();

		/**
		 * @return InstalledPackage
		 */
		public function getInstalledPackage() {
			return $this->package;
		}

		/**
		 * Create an instance of the scheduler.
		 *
		 * This is implemented as a method to make it possible for plugins to subclass the update checker
		 * and substitute their own scheduler.
		 *
		 * @param int $checkPeriod
		 * @return Scheduler
		 */
		abstract protected function createScheduler($checkPeriod);

		/**
		 * Remove information about this plugin or theme from the requests that WordPress core sends
		 * to api.wordpress.org when checking for updates.
		 *
		 * @param array $args
		 * @param string $url
		 * @return array
		 */
		public function excludeEntityFromWordPressAPI($args, $url) {
			//Is this an api.wordpress.org update check request?
			$parsedUrl = wp_parse_url($url);
			if ( !isset($parsedUrl['host']) || (strtolower($parsedUrl['host']) !== 'api.wordpress.org') ) {
				return $args;
			}

			$typePluralised = $this->componentType . 's';
			$expectedPathPrefix = '/' . $typePluralised . '/update-check/1.';  //e.g. "/plugins/update-check/1.1/"
			if ( !isset($parsedUrl['path']) || !Utils::startsWith($parsedUrl['path'], $expectedPathPrefix) ) {
				return $args;
			}

			//Plugins and themes can disable this feature by using the filter below.
			if ( !apply_filters(
				$this->getUniqueName('remove_from_default_update_checks'),
				true, $this, $args, $url
			) ) {
				return $args;
			}

			if ( empty($args['body'][$typePluralised]) ) {
				return $args;
			}

			$reportingItems = json_decode($args['body'][$typePluralised], true);
			if ( $reportingItems === null ) {
				return $args;
			}

			//The list of installed items uses different key formats for plugins and themes.
			//Luckily, we can reuse the getUpdateListKey() method here.
			$updateListKey = $this->getUpdateListKey();
			if ( isset($reportingItems[$typePluralised][$updateListKey]) ) {
				unset($reportingItems[$typePluralised][$updateListKey]);
			}

			if ( !empty($reportingItems['active']) ) {
				if ( is_array($reportingItems['active']) ) {
					foreach ($reportingItems['active'] as $index => $relativePath) {
						if ( $relativePath === $updateListKey ) {
							unset($reportingItems['active'][$index]);
						}
					}
					//Re-index the array.
					$reportingItems['active'] = array_values($reportingItems['active']);
				} else if ( $reportingItems['active'] === $updateListKey ) {
					//For themes, the "active" field is a string that contains the theme's directory name.
					//Pretend that the default theme is active so that we don't reveal the actual theme.
					if ( defined('WP_DEFAULT_THEME') ) {
						$reportingItems['active'] = WP_DEFAULT_THEME;
					}

					//Unfortunately, it doesn't seem to be documented if we can safely remove the "active"
					//key. So when we don't know the default theme, we'll just leave it as is.
				}
			}

			$args['body'][$typePluralised] = wp_json_encode($reportingItems);
			return $args;
		}

		/**
		 * Check for updates. The results are stored in the DB option specified in $optionName.
		 *
		 * @return Update|null
		 */
		public function checkForUpdates() {
			$installedVersion = $this->getInstalledVersion();
			//Fail silently if we can't find the plugin/theme or read its header.
			if ( $installedVersion === null ) {
				$this->triggerError(
					sprintf('Skipping update check for %s - installed version unknown.', $this->slug),
					E_USER_WARNING
				);
				return null;
			}

			//Start collecting API errors.
			$this->lastRequestApiErrors = array();
			add_action('puc_api_error', array($this, 'collectApiErrors'), 10, 4);

			$state = $this->updateState;
			$state->setLastCheckToNow()
				->setCheckedVersion($installedVersion)
				->save(); //Save before checking in case something goes wrong

			$state->setUpdate($this->requestUpdate());
			$state->save();

			//Stop collecting API errors.
			remove_action('puc_api_error', array($this, 'collectApiErrors'), 10);

			return $this->getUpdate();
		}

		/**
		 * Load the update checker state from the DB.
		 *
		 * @return StateStore
		 */
		public function getUpdateState() {
			return $this->updateState->lazyLoad();
		}

		/**
		 * Reset update checker state - i.e. last check time, cached update data and so on.
		 *
		 * Call this when your plugin is being uninstalled, or if you want to
		 * clear the update cache.
		 */
		public function resetUpdateState() {
			$this->updateState->delete();
		}

		/**
		 * Get the details of the currently available update, if any.
		 *
		 * If no updates are available, or if the last known update version is below or equal
		 * to the currently installed version, this method will return NULL.
		 *
		 * Uses cached update data. To retrieve update information straight from
		 * the metadata URL, call requestUpdate() instead.
		 *
		 * @return Update|null
		 */
		public function getUpdate() {
			$update = $this->updateState->getUpdate();

			//Is there an update available?
			if ( isset($update) ) {
				//Check if the update is actually newer than the currently installed version.
				$installedVersion = $this->getInstalledVersion();
				if ( ($installedVersion !== null) && version_compare($update->version, $installedVersion, '>') ){
					return $update;
				}
			}
			return null;
		}

		/**
		 * Retrieve the latest update (if any) from the configured API endpoint.
		 *
		 * Subclasses should run the update through filterUpdateResult before returning it.
		 *
		 * @return Update An instance of Update, or NULL when no updates are available.
		 */
		abstract public function requestUpdate();

		/**
		 * Filter the result of a requestUpdate() call.
		 *
		 * @template T of Update
		 * @param T|null $update
		 * @param array|WP_Error|null $httpResult The value returned by wp_remote_get(), if any.
		 * @return T
		 */
		protected function filterUpdateResult($update, $httpResult = null) {
			//Let plugins/themes modify the update.
			$update = apply_filters($this->getUniqueName('request_update_result'), $update, $httpResult);

			$this->fixSupportedWordpressVersion($update);

			if ( isset($update, $update->translations) ) {
				//Keep only those translation updates that apply to this site.
				$update->translations = $this->filterApplicableTranslations($update->translations);
			}

			return $update;
		}

		/**
		 * The "Tested up to" field in the plugin metadata is supposed to be in the form of "major.minor",
		 * while WordPress core's list_plugin_updates() expects the $update->tested field to be an exact
		 * version, e.g. "major.minor.patch", to say it's compatible. In other case it shows
		 * "Compatibility: Unknown".
		 * The function mimics how wordpress.org API crafts the "tested" field out of "Tested up to".
		 *
		 * @param Metadata|null $update
		 */
		protected function fixSupportedWordpressVersion($update = null) {
			if ( !isset($update->tested) || !preg_match('/^\d++\.\d++$/', $update->tested) ) {
				return;
			}

			$actualWpVersions = array();

			$wpVersion = $GLOBALS['wp_version'];

			if ( function_exists('get_core_updates') ) {
				$coreUpdates = get_core_updates();
				if ( is_array($coreUpdates) ) {
					foreach ($coreUpdates as $coreUpdate) {
						if ( isset($coreUpdate->current) ) {
							$actualWpVersions[] = $coreUpdate->current;
						}
					}
				}
			}

			$actualWpVersions[] = $wpVersion;

			$actualWpPatchNumber = null;
			foreach ($actualWpVersions as $version) {
				if ( preg_match('/^(?P<majorMinor>\d++\.\d++)(?:\.(?P<patch>\d++))?/', $version, $versionParts) ) {
					if ( $versionParts['majorMinor'] === $update->tested ) {
						$patch = isset($versionParts['patch']) ? intval($versionParts['patch']) : 0;
						if ( $actualWpPatchNumber === null ) {
							$actualWpPatchNumber = $patch;
						} else {
							$actualWpPatchNumber = max($actualWpPatchNumber, $patch);
						}
					}
				}
			}
			if ( $actualWpPatchNumber === null ) {
				$actualWpPatchNumber = 999;
			}

			if ( $actualWpPatchNumber > 0 ) {
				$update->tested .= '.' . $actualWpPatchNumber;
			}
		}

		/**
		 * Get the currently installed version of the plugin or theme.
		 *
		 * @return string|null Version number.
		 */
		public function getInstalledVersion() {
			return $this->package->getInstalledVersion();
		}

		/**
		 * Get the full path of the plugin or theme directory.
		 *
		 * @return string
		 */
		public function getAbsoluteDirectoryPath() {
			return $this->package->getAbsoluteDirectoryPath();
		}

		/**
		 * Trigger a PHP error, but only when $debugMode is enabled.
		 *
		 * @param string $message
		 * @param int $errorType
		 */
		public function triggerError($message, $errorType) {
			if ( $this->isDebugModeEnabled() ) {
				//phpcs:ignore WordPress.PHP.DevelopmentFunctions.error_log_trigger_error -- Only happens in debug mode.
				trigger_error(esc_html($message), $errorType);
			}
		}

		/**
		 * @return bool
		 */
		protected function isDebugModeEnabled() {
			if ( $this->debugMode === null ) {
				$this->debugMode = (bool)(constant('WP_DEBUG'));
			}
			return $this->debugMode;
		}

		/**
		 * Get the full name of an update checker filter, action or DB entry.
		 *
		 * This method adds the "puc_" prefix and the "-$slug" suffix to the filter name.
		 * For example, "pre_inject_update" becomes "puc_pre_inject_update-plugin-slug".
		 *
		 * @param string $baseTag
		 * @return string
		 */
		public function getUniqueName($baseTag) {
			$name = 'puc_' . $baseTag;
			if ( $this->filterSuffix !== '' ) {
				$name .= '_' . $this->filterSuffix;
			}
			return $name . '-' . $this->slug;
		}

		/**
		 * Store API errors that are generated when checking for updates.
		 *
		 * @internal
		 * @param \WP_Error $error
		 * @param array|null $httpResponse
		 * @param string|null $url
		 * @param string|null $slug
		 */
		public function collectApiErrors($error, $httpResponse = null, $url = null, $slug = null) {
			if ( isset($slug) && ($slug !== $this->slug) ) {
				return;
			}

			$this->lastRequestApiErrors[] = array(
				'error'        => $error,
				'httpResponse' => $httpResponse,
				'url'          => $url,
			);
		}

		/**
		 * @return array
		 */
		public function getLastRequestApiErrors() {
			return $this->lastRequestApiErrors;
		}

		/* -------------------------------------------------------------------
		 * PUC filters and filter utilities
		 * -------------------------------------------------------------------
		 */

		/**
		 * Register a callback for one of the update checker filters.
		 *
		 * Identical to add_filter(), except it automatically adds the "puc_" prefix
		 * and the "-$slug" suffix to the filter name. For example, "request_info_result"
		 * becomes "puc_request_info_result-your_plugin_slug".
		 *
		 * @param string $tag
		 * @param callable $callback
		 * @param int $priority
		 * @param int $acceptedArgs
		 */
		public function addFilter($tag, $callback, $priority = 10, $acceptedArgs = 1) {
			add_filter($this->getUniqueName($tag), $callback, $priority, $acceptedArgs);
		}

		/* -------------------------------------------------------------------
		 * Inject updates
		 * -------------------------------------------------------------------
		 */

		/**
		 * Insert the latest update (if any) into the update list maintained by WP.
		 *
		 * @param \stdClass $updates Update list.
		 * @return \stdClass Modified update list.
		 */
		public function injectUpdate($updates) {
			//Is there an update to insert?
			$update = $this->getUpdate();

			if ( !$this->shouldShowUpdates() ) {
				$update = null;
			}

			if ( !empty($update) ) {
				//Let plugins filter the update info before it's passed on to WordPress.
				$update = apply_filters($this->getUniqueName('pre_inject_update'), $update);
				$updates = $this->addUpdateToList($updates, $update->toWpFormat());
			} else {
				//Clean up any stale update info.
				$updates = $this->removeUpdateFromList($updates);
				//Add a placeholder item to the "no_update" list to enable auto-update support.
				//If we don't do this, the option to enable automatic updates will only show up
				//when an update is available.
				$updates = $this->addNoUpdateItem($updates);
			}

			return $updates;
		}

		/**
		 * @param \stdClass|null $updates
		 * @param \stdClass|array $updateToAdd
		 * @return \stdClass
		 */
		protected function addUpdateToList($updates, $updateToAdd) {
			if ( !is_object($updates) ) {
				$updates = new stdClass();
				$updates->response = array();
			}

			$updates->response[$this->getUpdateListKey()] = $updateToAdd;
			return $updates;
		}

		/**
		 * @param \stdClass|null $updates
		 * @return \stdClass|null
		 */
		protected function removeUpdateFromList($updates) {
			if ( isset($updates, $updates->response) ) {
				unset($updates->response[$this->getUpdateListKey()]);
			}
			return $updates;
		}

		/**
		 * See this post for more information:
		 * @link https://make.wordpress.org/core/2020/07/30/recommended-usage-of-the-updates-api-to-support-the-auto-updates-ui-for-plugins-and-themes-in-wordpress-5-5/
		 *
		 * @param \stdClass|null $updates
		 * @return \stdClass
		 */
		protected function addNoUpdateItem($updates) {
			if ( !is_object($updates) ) {
				$updates = new stdClass();
				$updates->response = array();
				$updates->no_update = array();
			} else if ( !isset($updates->no_update) ) {
				$updates->no_update = array();
			}

			$updates->no_update[$this->getUpdateListKey()] = (object) $this->getNoUpdateItemFields();

			return $updates;
		}

		/**
		 * Subclasses should override this method to add fields that are specific to plugins or themes.
		 * @return array
		 */
		protected function getNoUpdateItemFields() {
			return array(
				'new_version'   => $this->getInstalledVersion(),
				'url'           => '',
				'package'       => '',
				'requires_php'  => '',
			);
		}

		/**
		 * Get the key that will be used when adding updates to the update list that's maintained
		 * by the WordPress core. The list is always an associative array, but the key is different
		 * for plugins and themes.
		 *
		 * @return string
		 */
		abstract protected function getUpdateListKey();

		/**
		 * Should we show available updates?
		 *
		 * Usually the answer is "yes", but there are exceptions. For example, WordPress doesn't
		 * support automatic updates installation for mu-plugins, so PUC usually won't show update
		 * notifications in that case. See the plugin-specific subclass for details.
		 *
		 * Note: This method only applies to updates that are displayed (or not) in the WordPress
		 * admin. It doesn't affect APIs like requestUpdate and getUpdate.
		 *
		 * @return bool
		 */
		protected function shouldShowUpdates() {
			return true;
		}

		/* -------------------------------------------------------------------
		 * JSON-based update API
		 * -------------------------------------------------------------------
		 */

		/**
		 * Retrieve plugin or theme metadata from the JSON document at $this->metadataUrl.
		 *
		 * @param class-string<Update> $metaClass Parse the JSON as an instance of this class. It must have a static fromJson method.
		 * @param string $filterRoot
		 * @param array $queryArgs Additional query arguments.
		 * @return array<Metadata|null, array|WP_Error> A metadata instance and the value returned by wp_remote_get().
		 */
		protected function requestMetadata($metaClass, $filterRoot, $queryArgs = array()) {
			//Query args to append to the URL. Plugins can add their own by using a filter callback (see addQueryArgFilter()).
			$queryArgs = array_merge(
				array(
					'installed_version' => strval($this->getInstalledVersion()),
					'php' => phpversion(),
					'locale' => get_locale(),
				),
				$queryArgs
			);
			$queryArgs = apply_filters($this->getUniqueName($filterRoot . '_query_args'), $queryArgs);

			//Various options for the wp_remote_get() call. Plugins can filter these, too.
			$options = array(
				'timeout' => wp_doing_cron() ? 10 : 3,
				'headers' => array(
					'Accept' => 'application/json',
				),
			);
			$options = apply_filters($this->getUniqueName($filterRoot . '_options'), $options);

			//The metadata file should be at 'http://your-api.com/url/here/$slug/info.json'
			$url = $this->metadataUrl;
			if ( !empty($queryArgs) ){
				$url = add_query_arg($queryArgs, $url);
			}

			$result = wp_remote_get($url, $options);

			$result = apply_filters($this->getUniqueName('request_metadata_http_result'), $result, $url, $options);

			//Try to parse the response
			$status = $this->validateApiResponse($result);
			$metadata = null;
			if ( !is_wp_error($status) ){
				if ( (strpos($metaClass, '\\') === false) ) {
					$metaClass = __NAMESPACE__ . '\\' . $metaClass;
				}
				$metadata = call_user_func(array($metaClass, 'fromJson'), $result['body']);
			} else {
				do_action('puc_api_error', $status, $result, $url, $this->slug);
				$this->triggerError(
					sprintf('The URL %s does not point to a valid metadata file. ', $url)
					. $status->get_error_message(),
					E_USER_WARNING
				);
			}

			return array($metadata, $result);
		}

		/**
		 * Check if $result is a successful update API response.
		 *
		 * @param array|WP_Error $result
		 * @return true|WP_Error
		 */
		protected function validateApiResponse($result) {
			if ( is_wp_error($result) ) { /** @var WP_Error $result */
				return new WP_Error($result->get_error_code(), 'WP HTTP Error: ' . $result->get_error_message());
			}

			if ( !isset($result['response']['code']) ) {
				return new WP_Error(
					'puc_no_response_code',
					'wp_remote_get() returned an unexpected result.'
				);
			}

			if ( $result['response']['code'] !== 200 ) {
				return new WP_Error(
					'puc_unexpected_response_code',
					'HTTP response code is ' . $result['response']['code'] . ' (expected: 200)'
				);
			}

			if ( empty($result['body']) ) {
				return new WP_Error('puc_empty_response', 'The metadata file appears to be empty.');
			}

			return true;
		}

		/* -------------------------------------------------------------------
		 * Language packs / Translation updates
		 * -------------------------------------------------------------------
		 */

		/**
		 * Filter a list of translation updates and return a new list that contains only updates
		 * that apply to the current site.
		 *
		 * @param array $translations
		 * @return array
		 */
		protected function filterApplicableTranslations($translations) {
			$languages = array_flip(array_values(get_available_languages()));
			$installedTranslations = $this->getInstalledTranslations();

			$applicableTranslations = array();
			foreach ($translations as $translation) {
				//Does it match one of the available core languages?
				$isApplicable = array_key_exists($translation->language, $languages);
				//Is it more recent than an already-installed translation?
				if ( isset($installedTranslations[$translation->language]) ) {
					$updateTimestamp = strtotime($translation->updated);
					$installedTimestamp = strtotime($installedTranslations[$translation->language]['PO-Revision-Date']);
					$isApplicable = $updateTimestamp > $installedTimestamp;
				}

				if ( $isApplicable ) {
					$applicableTranslations[] = $translation;
				}
			}

			return $applicableTranslations;
		}

		/**
		 * Get a list of installed translations for this plugin or theme.
		 *
		 * @return array
		 */
		protected function getInstalledTranslations() {
			if ( !function_exists('wp_get_installed_translations') ) {
				return array();
			}
			$installedTranslations = wp_get_installed_translations($this->translationType . 's');
			if ( isset($installedTranslations[$this->directoryName]) ) {
				$installedTranslations = $installedTranslations[$this->directoryName];
			} else {
				$installedTranslations = array();
			}
			return $installedTranslations;
		}

		/**
		 * Insert translation updates into the list maintained by WordPress.
		 *
		 * @param stdClass $updates
		 * @return stdClass
		 */
		public function injectTranslationUpdates($updates) {
			$translationUpdates = $this->getTranslationUpdates();
			if ( empty($translationUpdates) ) {
				return $updates;
			}

			//Being defensive.
			if ( !is_object($updates) ) {
				$updates = new stdClass();
			}
			if ( !isset($updates->translations) ) {
				$updates->translations = array();
			}

			//In case there's a name collision with a plugin or theme hosted on wordpress.org,
			//remove any preexisting updates that match our thing.
			$updates->translations = array_values(array_filter(
				$updates->translations,
				array($this, 'isNotMyTranslation')
			));

			//Add our updates to the list.
			foreach($translationUpdates as $update) {
				$convertedUpdate = array_merge(
					array(
						'type' => $this->translationType,
						'slug' => $this->directoryName,
						'autoupdate' => 0,
						//AFAICT, WordPress doesn't actually use the "version" field for anything.
						//But lets make sure it's there, just in case.
						'version' => isset($update->version) ? $update->version : ('1.' . strtotime($update->updated)),
					),
					(array)$update
				);

				$updates->translations[] = $convertedUpdate;
			}

			return $updates;
		}

		/**
		 * Get a list of available translation updates.
		 *
		 * This method will return an empty array if there are no updates.
		 * Uses cached update data.
		 *
		 * @return array
		 */
		public function getTranslationUpdates() {
			return $this->updateState->getTranslations();
		}

		/**
		 * Remove all cached translation updates.
		 *
		 * @see wp_clean_update_cache
		 */
		public function clearCachedTranslationUpdates() {
			$this->updateState->setTranslations(array());
		}

		/**
		 * Filter callback. Keeps only translations that *don't* match this plugin or theme.
		 *
		 * @param array $translation
		 * @return bool
		 */
		protected function isNotMyTranslation($translation) {
			$isMatch = isset($translation['type'], $translation['slug'])
				&& ($translation['type'] === $this->translationType)
				&& ($translation['slug'] === $this->directoryName);

			return !$isMatch;
		}

		/* -------------------------------------------------------------------
		 * Fix directory name when installing updates
		 * -------------------------------------------------------------------
		 */

		/**
		 * Rename the update directory to match the existing plugin/theme directory.
		 *
		 * When WordPress installs a plugin or theme update, it assumes that the ZIP file will contain
		 * exactly one directory, and that the directory name will be the same as the directory where
		 * the plugin or theme is currently installed.
		 *
		 * GitHub and other repositories provide ZIP downloads, but they often use directory names like
		 * "project-branch" or "project-tag-hash". We need to change the name to the actual plugin folder.
		 *
		 * This is a hook callback. Don't call it from a plugin.
		 *
		 * @access protected
		 *
		 * @param string $source The directory to copy to /wp-content/plugins or /wp-content/themes. Usually a subdirectory of $remoteSource.
		 * @param string $remoteSource WordPress has extracted the update to this directory.
		 * @param \WP_Upgrader $upgrader
		 * @return string|WP_Error
		 */
		public function fixDirectoryName($source, $remoteSource, $upgrader) {
			global $wp_filesystem;
			/** @var \WP_Filesystem_Base $wp_filesystem */

			//Basic sanity checks.
			if ( !isset($source, $remoteSource, $upgrader, $upgrader->skin, $wp_filesystem) ) {
				return $source;
			}

			//If WordPress is upgrading anything other than our plugin/theme, leave the directory name unchanged.
			if ( !$this->isBeingUpgraded($upgrader) ) {
				return $source;
			}

			//Fix the remote source structure if necessary.
			//The update archive should contain a single directory that contains the rest of plugin/theme files.
			//Otherwise, WordPress will try to copy the entire working directory ($source == $remoteSource).
			//We can't rename $remoteSource because that would break WordPress code that cleans up temporary files
			//after update.
			if ( $this->isBadDirectoryStructure($remoteSource) ) {
				//Create a new directory using the plugin slug.
				$newDirectory = trailingslashit($remoteSource) . $this->slug . '/';

				if ( !$wp_filesystem->is_dir($newDirectory) ) {
					$wp_filesystem->mkdir($newDirectory);

					//Move all files to the newly created directory.
					$sourceFiles = $wp_filesystem->dirlist($remoteSource);
					if ( is_array($sourceFiles) ) {
						$sourceFiles = array_keys($sourceFiles);
						$allMoved = true;
						foreach ($sourceFiles as $filename) {
							//Skip our newly created folder.
							if ( $filename === $this->slug ) {
								continue;
							}

							$previousSource = trailingslashit($remoteSource) . $filename;
							$newSource = trailingslashit($newDirectory) . $filename;

							if ( !$wp_filesystem->move($previousSource, $newSource, true) ) {
								$allMoved = false;
								break;
							}
						}

						if ( $allMoved ) {
							//Rename source.
							$source = $newDirectory;
						} else {
							//Delete our newly created folder including all files in it.
							$wp_filesystem->rmdir($newDirectory, true);

							//And return a relevant error.
							return new WP_Error(
								'puc-incorrect-directory-structure',
								sprintf(
									'The directory structure of the update was incorrect. All files should be inside ' .
									'a directory named <span class="code">%s</span>, not at the root of the ZIP archive. Plugin Update Checker tried to fix the directory structure, but failed.',
									esc_html($this->slug)
								)
							);
						}
					}
				}
			}

			//Rename the source to match the existing directory.
			$correctedSource = trailingslashit($remoteSource) . $this->directoryName . '/';
			if ( $source !== $correctedSource ) {
				$upgrader->skin->feedback(sprintf(
					'Renaming %s to %s&#8230;',
					'<span class="code">' . basename($source) . '</span>',
					'<span class="code">' . $this->directoryName . '</span>'
				));

				if ( $wp_filesystem->move($source, $correctedSource, true) ) {
					$upgrader->skin->feedback('Directory successfully renamed.');
					return $correctedSource;
				} else {
					return new WP_Error(
						'puc-rename-failed',
						'Unable to rename the update to match the existing directory.'
					);
				}
			}

			return $source;
		}

		/**
		 * Is there an update being installed right now, for this plugin or theme?
		 *
		 * @param \WP_Upgrader|null $upgrader The upgrader that's performing the current update.
		 * @return bool
		 */
		abstract public function isBeingUpgraded($upgrader = null);

		/**
		 * Check for incorrect update directory structure. An update must contain a single directory,
		 * all other files should be inside that directory.
		 *
		 * @param string $remoteSource Directory path.
		 * @return bool
		 */
		protected function isBadDirectoryStructure($remoteSource) {
			global $wp_filesystem;
			/** @var \WP_Filesystem_Base $wp_filesystem */

			$sourceFiles = $wp_filesystem->dirlist($remoteSource);
			if ( is_array($sourceFiles) ) {
				$sourceFiles = array_keys($sourceFiles);
				$firstFilePath = trailingslashit($remoteSource) . $sourceFiles[0];
				return (count($sourceFiles) > 1) || (!$wp_filesystem->is_dir($firstFilePath));
			}

			//Assume it's fine.
			return false;
		}

		/* -------------------------------------------------------------------
		 * DebugBar integration
		 * -------------------------------------------------------------------
		 */

		/**
		 * Initialize the update checker Debug Bar plugin/add-on thingy.
		 */
		public function maybeInitDebugBar() {
			if (
				class_exists('Debug_Bar', false)
				&& class_exists('Debug_Bar_Panel', false)
				&& file_exists(dirname(__FILE__) . '/DebugBar')
			) {
				$this->debugBarExtension = $this->createDebugBarExtension();
			}
		}

		protected function createDebugBarExtension() {
			return new DebugBar\Extension($this);
		}

		/**
		 * Display additional configuration details in the Debug Bar panel.
		 *
		 * @param DebugBar\Panel $panel
		 */
		public function onDisplayConfiguration($panel) {
			//Do nothing. Subclasses can use this to add additional info to the panel.
		}

	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\UpgraderStatus.php (7248 bytes, 201 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6;

if ( !class_exists(UpgraderStatus::class, false) ):

	/**
	 * A utility class that helps figure out which plugin or theme WordPress is upgrading.
	 *
	 * It may seem strange to have a separate class just for that, but the task is surprisingly complicated.
	 * Core classes like Plugin_Upgrader don't expose the plugin file name during an in-progress update (AFAICT).
	 * This class uses a few workarounds and heuristics to get the file name.
	 */
	class UpgraderStatus {
		private $currentType = null; //This must be either "plugin" or "theme".
		private $currentId = null;   //Plugin basename or theme directory name.

		public function __construct() {
			//Keep track of which plugin/theme WordPress is currently upgrading.
			add_filter('upgrader_pre_install', array($this, 'setUpgradedThing'), 10, 2);
			add_filter('upgrader_package_options', array($this, 'setUpgradedPluginFromOptions'), 10, 1);
			add_filter('upgrader_post_install', array($this, 'clearUpgradedThing'), 10, 1);
			add_action('upgrader_process_complete', array($this, 'clearUpgradedThing'), 10, 1);
		}

		/**
		 * Is there and update being installed RIGHT NOW, for a specific plugin?
		 *
		 * Caution: This method is unreliable. WordPress doesn't make it easy to figure out what it is upgrading,
		 * and upgrader implementations are liable to change without notice.
		 *
		 * @param string $pluginFile The plugin to check.
		 * @param \WP_Upgrader|null $upgrader The upgrader that's performing the current update.
		 * @return bool True if the plugin identified by $pluginFile is being upgraded.
		 */
		public function isPluginBeingUpgraded($pluginFile, $upgrader = null) {
			return $this->isBeingUpgraded('plugin', $pluginFile, $upgrader);
		}

		/**
		 * Is there an update being installed for a specific theme?
		 *
		 * @param string $stylesheet Theme directory name.
		 * @param \WP_Upgrader|null $upgrader The upgrader that's performing the current update.
		 * @return bool
		 */
		public function isThemeBeingUpgraded($stylesheet, $upgrader = null) {
			return $this->isBeingUpgraded('theme', $stylesheet, $upgrader);
		}

		/**
		 * Check if a specific theme or plugin is being upgraded.
		 *
		 * @param string $type
		 * @param string $id
		 * @param \Plugin_Upgrader|\WP_Upgrader|null $upgrader
		 * @return bool
		 */
		protected function isBeingUpgraded($type, $id, $upgrader = null) {
			if ( isset($upgrader) ) {
				list($currentType, $currentId) = $this->getThingBeingUpgradedBy($upgrader);
				if ( $currentType !== null ) {
					$this->currentType = $currentType;
					$this->currentId = $currentId;
				}
			}
			return ($this->currentType === $type) && ($this->currentId === $id);
		}

		/**
		 * Figure out which theme or plugin is being upgraded by a WP_Upgrader instance.
		 *
		 * Returns an array with two items. The first item is the type of the thing that's being
		 * upgraded: "plugin" or "theme". The second item is either the plugin basename or
		 * the theme directory name. If we can't determine what the upgrader is doing, both items
		 * will be NULL.
		 *
		 * Examples:
		 *      ['plugin', 'plugin-dir-name/plugin.php']
		 *      ['theme', 'theme-dir-name']
		 *
		 * @param \Plugin_Upgrader|\WP_Upgrader $upgrader
		 * @return array
		 */
		private function getThingBeingUpgradedBy($upgrader) {
			if ( !isset($upgrader, $upgrader->skin) ) {
				return array(null, null);
			}

			//Figure out which plugin or theme is being upgraded.
			$pluginFile = null;
			$themeDirectoryName = null;

			$skin = $upgrader->skin;
			if ( isset($skin->theme_info) && ($skin->theme_info instanceof \WP_Theme) ) {
				$themeDirectoryName = $skin->theme_info->get_stylesheet();
			} elseif ( $skin instanceof \Plugin_Upgrader_Skin ) {
				if ( isset($skin->plugin) && is_string($skin->plugin) && ($skin->plugin !== '') ) {
					$pluginFile = $skin->plugin;
				}
			} elseif ( $skin instanceof \Theme_Upgrader_Skin ) {
				if ( isset($skin->theme) && is_string($skin->theme) && ($skin->theme !== '') ) {
					$themeDirectoryName = $skin->theme;
				}
			} elseif ( isset($skin->plugin_info) && is_array($skin->plugin_info) ) {
				//This case is tricky because Bulk_Plugin_Upgrader_Skin (etc) doesn't actually store the plugin
				//filename anywhere. Instead, it has the plugin headers in $plugin_info. So the best we can
				//do is compare those headers to the headers of installed plugins.
				$pluginFile = $this->identifyPluginByHeaders($skin->plugin_info);
			}

			if ( $pluginFile !== null ) {
				return array('plugin', $pluginFile);
			} elseif ( $themeDirectoryName !== null ) {
				return array('theme', $themeDirectoryName);
			}
			return array(null, null);
		}

		/**
		 * Identify an installed plugin based on its headers.
		 *
		 * @param array $searchHeaders The plugin file header to look for.
		 * @return string|null Plugin basename ("foo/bar.php"), or NULL if we can't identify the plugin.
		 */
		private function identifyPluginByHeaders($searchHeaders) {
			if ( !function_exists('get_plugins') ){
				require_once( ABSPATH . '/wp-admin/includes/plugin.php' );
			}

			$installedPlugins = get_plugins();
			$matches = array();
			foreach($installedPlugins as $pluginBasename => $headers) {
				$diff1 = array_diff_assoc($headers, $searchHeaders);
				$diff2 = array_diff_assoc($searchHeaders, $headers);
				if ( empty($diff1) && empty($diff2) ) {
					$matches[] = $pluginBasename;
				}
			}

			//It's possible (though very unlikely) that there could be two plugins with identical
			//headers. In that case, we can't unambiguously identify the plugin that's being upgraded.
			if ( count($matches) !== 1 ) {
				return null;
			}

			return reset($matches);
		}

		/**
		 * @access private
		 *
		 * @param mixed $input
		 * @param array $hookExtra
		 * @return mixed Returns $input unaltered.
		 */
		public function setUpgradedThing($input, $hookExtra) {
			if ( !empty($hookExtra['plugin']) && is_string($hookExtra['plugin']) ) {
				$this->currentId = $hookExtra['plugin'];
				$this->currentType = 'plugin';
			} elseif ( !empty($hookExtra['theme']) && is_string($hookExtra['theme']) ) {
				$this->currentId = $hookExtra['theme'];
				$this->currentType = 'theme';
			} else {
				$this->currentType = null;
				$this->currentId = null;
			}
			return $input;
		}

		/**
		 * @access private
		 *
		 * @param array $options
		 * @return array
		 */
		public function setUpgradedPluginFromOptions($options) {
			if ( isset($options['hook_extra']['plugin']) && is_string($options['hook_extra']['plugin']) ) {
				$this->currentType = 'plugin';
				$this->currentId = $options['hook_extra']['plugin'];
			} else {
				$this->currentType = null;
				$this->currentId = null;
			}
			return $options;
		}

		/**
		 * @access private
		 *
		 * @param mixed $input
		 * @return mixed Returns $input unaltered.
		 */
		public function clearUpgradedThing($input = null) {
			$this->currentId = null;
			$this->currentType = null;
			return $input;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Utils.php (1965 bytes, 71 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6;

if ( !class_exists(Utils::class, false) ):

	class Utils {
		/**
		 * Get a value from a nested array or object based on a path.
		 *
		 * @param array|object|null $collection Get an entry from this array.
		 * @param array|string $path A list of array keys in hierarchy order, or a string path like "foo.bar.baz".
		 * @param mixed $default The value to return if the specified path is not found.
		 * @param string $separator Path element separator. Only applies to string paths.
		 * @return mixed
		 */
		public static function get($collection, $path, $default = null, $separator = '.') {
			if ( is_string($path) ) {
				$path = explode($separator, $path);
			}

			//Follow the $path into $input as far as possible.
			$currentValue = $collection;
			foreach ($path as $node) {
				if ( is_array($currentValue) && isset($currentValue[$node]) ) {
					$currentValue = $currentValue[$node];
				} else if ( is_object($currentValue) && isset($currentValue->$node) ) {
					$currentValue = $currentValue->$node;
				} else {
					return $default;
				}
			}

			return $currentValue;
		}

		/**
		 * Get the first array element that is not empty.
		 *
		 * @param array $values
		 * @param mixed|null $default Returns this value if there are no non-empty elements.
		 * @return mixed|null
		 */
		public static function findNotEmpty($values, $default = null) {
			if ( empty($values) ) {
				return $default;
			}

			foreach ($values as $value) {
				if ( !empty($value) ) {
					return $value;
				}
			}

			return $default;
		}

		/**
		 * Check if the input string starts with the specified prefix.
		 *
		 * @param string $input
		 * @param string $prefix
		 * @return bool
		 */
		public static function startsWith($input, $prefix) {
			$length = strlen($prefix);
			return (substr($input, 0, $length) === $prefix);
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\WpCliCheckTrigger.php (2667 bytes, 84 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6;

use WP_CLI;

/**
 * Triggers an update check when relevant WP-CLI commands are executed.
 *
 * When WP-CLI runs certain commands like "wp plugin status" or "wp theme list", it calls
 * wp_update_plugins() and wp_update_themes() to refresh update information. This class hooks into
 * the same commands and triggers an update check when they are executed.
 *
 * Note that wp_update_plugins() and wp_update_themes() do not perform an update check *every* time
 * they are called. They use a context-dependent delay between update checks. Similarly, this class
 * calls Scheduler::maybeCheckForUpdates(), which also dynamically decides whether to actually
 * run a check. If you want to force an update check, call UpdateChecker::checkForUpdates() instead.
 */
class WpCliCheckTrigger {
	/**
	 * @var Scheduler
	 */
	private $scheduler;

	/**
	 * @var string 'plugin' or 'theme'
	 */
	private $componentType;

	/**
	 * @var bool Whether an update check was already triggered during the current request
	 *           or script execution.
	 */
	private $wasCheckTriggered = false;

	public function __construct($componentType, Scheduler $scheduler) {
		if ( !in_array($componentType, ['plugin', 'theme']) ) {
			throw new \InvalidArgumentException('Invalid component type. Must be "plugin" or "theme".');
		}

		$this->componentType = $componentType;
		$this->scheduler = $scheduler;

		if ( !defined('WP_CLI') || !class_exists(WP_CLI::class, false) ) {
			return; //Nothing to do if WP-CLI is not available.
		}

		/*
		 * We can't hook directly into wp_update_plugins(), but we can hook into the WP-CLI
		 * commands that call it. We'll use the "before_invoke:xyz" hook to trigger update checks.
		 */
		foreach ($this->getRelevantCommands() as $command) {
			WP_CLI::add_hook('before_invoke:' . $command, [$this, 'triggerUpdateCheckOnce']);
		}
	}

	private function getRelevantCommands() {
		$result = [];
		foreach (['status', 'list', 'update'] as $subcommand) {
			$result[] = $this->componentType . ' ' . $subcommand;
		}
		return $result;
	}

	/**
	 * Trigger a potential update check once.
	 *
	 * @param mixed $input
	 * @return mixed The input value, unchanged.
	 * @internal This method is public so that it can be used as a WP-CLI hook callback.
	 *           It should not be called directly.
	 *
	 */
	public function triggerUpdateCheckOnce($input = null) {
		if ( $this->wasCheckTriggered ) {
			return $input;
		}

		$this->wasCheckTriggered = true;
		$this->scheduler->maybeCheckForUpdates();

		return $input;
	}
}
`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\DebugBar\Extension.php (6670 bytes, 200 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6\DebugBar;

use YahnisElsts\PluginUpdateChecker\v5p6\PucFactory;
use YahnisElsts\PluginUpdateChecker\v5p6\UpdateChecker;

if ( !class_exists(Extension::class, false) ):

	class Extension {
		const RESPONSE_BODY_LENGTH_LIMIT = 4000;

		/** @var UpdateChecker */
		protected $updateChecker;
		protected $panelClass = Panel::class;

		public function __construct($updateChecker, $panelClass = null) {
			$this->updateChecker = $updateChecker;
			if ( isset($panelClass) ) {
				$this->panelClass = $panelClass;
			}

			if ( (strpos($this->panelClass, '\\') === false) ) {
				$this->panelClass = __NAMESPACE__ . '\\' . $this->panelClass;
			}

			add_filter('debug_bar_panels', array($this, 'addDebugBarPanel'));
			add_action('debug_bar_enqueue_scripts', array($this, 'enqueuePanelDependencies'));

			add_action('wp_ajax_puc_v5_debug_check_now', array($this, 'ajaxCheckNow'));
		}

		/**
		 * Register the PUC Debug Bar panel.
		 *
		 * @param array $panels
		 * @return array
		 */
		public function addDebugBarPanel($panels) {
			if ( $this->updateChecker->userCanInstallUpdates() ) {
				$panels[] = new $this->panelClass($this->updateChecker);
			}
			return $panels;
		}

		/**
		 * Enqueue our Debug Bar scripts and styles.
		 */
		public function enqueuePanelDependencies() {
			wp_enqueue_style(
				'puc-debug-bar-style-v5',
				$this->getLibraryUrl("/css/puc-debug-bar.css"),
				array('debug-bar'),
				'20221008'
			);

			wp_enqueue_script(
				'puc-debug-bar-js-v5',
				$this->getLibraryUrl("/js/debug-bar.js"),
				array('jquery'),
				'20221008'
			);
		}

		/**
		 * Run an update check and output the result. Useful for making sure that
		 * the update checking process works as expected.
		 */
		public function ajaxCheckNow() {
			//phpcs:ignore WordPress.Security.NonceVerification.Missing -- Nonce is checked in preAjaxRequest().
			if ( !isset($_POST['uid']) || ($_POST['uid'] !== $this->updateChecker->getUniqueName('uid')) ) {
				return;
			}
			$this->preAjaxRequest();
			$update = $this->updateChecker->checkForUpdates();
			if ( $update !== null ) {
				echo "An update is available:";
				//phpcs:ignore WordPress.PHP.DevelopmentFunctions.error_log_print_r -- For debugging output.
				echo '<pre>', esc_html(print_r($update, true)), '</pre>';
			} else {
				echo 'No updates found.';
			}

			$errors = $this->updateChecker->getLastRequestApiErrors();
			if ( !empty($errors) ) {
				printf('<p>The update checker encountered %d API error%s.</p>', count($errors), (count($errors) > 1) ? 's' : '');

				foreach (array_values($errors) as $num => $item) {
					$wpError = $item['error'];
					/** @var \WP_Error $wpError */
					printf('<h4>%d) %s</h4>', intval($num + 1), esc_html($wpError->get_error_message()));

					echo '<dl>';
					printf('<dt>Error code:</dt><dd><code>%s</code></dd>', esc_html($wpError->get_error_code()));

					if ( isset($item['url']) ) {
						printf('<dt>Requested URL:</dt><dd><code>%s</code></dd>', esc_html($item['url']));
					}

					if ( isset($item['httpResponse']) ) {
						if ( is_wp_error($item['httpResponse']) ) {
							$httpError = $item['httpResponse'];
							/** @var \WP_Error $httpError */
							printf(
								'<dt>WordPress HTTP API error:</dt><dd>%s (<code>%s</code>)</dd>',
								esc_html($httpError->get_error_message()),
								esc_html($httpError->get_error_code())
							);
						} else {
							//Status code.
							printf(
								'<dt>HTTP status:</dt><dd><code>%d %s</code></dd>',
								esc_html(wp_remote_retrieve_response_code($item['httpResponse'])),
								esc_html(wp_remote_retrieve_response_message($item['httpResponse']))
							);

							//Headers.
							echo '<dt>Response headers:</dt><dd><pre>';
							foreach (wp_remote_retrieve_headers($item['httpResponse']) as $name => $value) {
								printf("%s: %s\n", esc_html($name), esc_html($value));
							}
							echo '</pre></dd>';

							//Body.
							$body = wp_remote_retrieve_body($item['httpResponse']);
							if ( $body === '' ) {
								$body = '(Empty response.)';
							} else if ( strlen($body) > self::RESPONSE_BODY_LENGTH_LIMIT ) {
								$length = strlen($body);
								$body = substr($body, 0, self::RESPONSE_BODY_LENGTH_LIMIT)
									. sprintf("\n(Long string truncated. Total length: %d bytes.)", $length);
							}

							printf('<dt>Response body:</dt><dd><pre>%s</pre></dd>', esc_html($body));
						}
					}
					echo '<dl>';
				}
			}

			exit;
		}

		/**
		 * Check access permissions and enable error display (for debugging).
		 */
		protected function preAjaxRequest() {
			if ( !$this->updateChecker->userCanInstallUpdates() ) {
				die('Access denied');
			}
			check_ajax_referer('puc-ajax');

			//phpcs:ignore WordPress.PHP.DiscouragedPHPFunctions.runtime_configuration_error_reporting -- Part of a debugging feature.
			error_reporting(E_ALL);
			//phpcs:ignore WordPress.PHP.IniSet.display_errors_Blacklisted
			@ini_set('display_errors', 'On');
		}

		/**
		 * Remove hooks that were added by this extension.
		 */
		public function removeHooks() {
			remove_filter('debug_bar_panels', array($this, 'addDebugBarPanel'));
			remove_action('debug_bar_enqueue_scripts', array($this, 'enqueuePanelDependencies'));
			remove_action('wp_ajax_puc_v5_debug_check_now', array($this, 'ajaxCheckNow'));
		}

		/**
		 * @param string $filePath
		 * @return string
		 */
		private function getLibraryUrl($filePath) {
			$absolutePath = realpath(dirname(__FILE__) . '/../../../' . ltrim($filePath, '/'));

			//Where is the library located inside the WordPress directory structure?
			$absolutePath = PucFactory::normalizePath($absolutePath);

			$pluginDir = PucFactory::normalizePath(WP_PLUGIN_DIR);
			$muPluginDir = PucFactory::normalizePath(WPMU_PLUGIN_DIR);
			$themeDir = PucFactory::normalizePath(get_theme_root());

			if ( (strpos($absolutePath, $pluginDir) === 0) || (strpos($absolutePath, $muPluginDir) === 0) ) {
				//It's part of a plugin.
				return plugins_url(basename($absolutePath), $absolutePath);
			} else if ( strpos($absolutePath, $themeDir) === 0 ) {
				//It's part of a theme.
				$relativePath = substr($absolutePath, strlen($themeDir) + 1);
				$template = substr($relativePath, 0, strpos($relativePath, '/'));
				$baseUrl = get_theme_root_uri($template);

				if ( !empty($baseUrl) && $relativePath ) {
					return $baseUrl . '/' . $relativePath;
				}
			}

			return '';
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\DebugBar\Panel.php (6053 bytes, 187 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6\DebugBar;

use YahnisElsts\PluginUpdateChecker\v5p6\UpdateChecker;

if ( !class_exists(Panel::class, false) && class_exists('Debug_Bar_Panel', false) ):

	class Panel extends \Debug_Bar_Panel {
		/** @var UpdateChecker */
		protected $updateChecker;

		private $responseBox = '<div class="puc-ajax-response" style="display: none;"></div>';

		public function __construct($updateChecker) {
			$this->updateChecker = $updateChecker;
			$title = sprintf(
				'<span class="puc-debug-menu-link-%s">PUC (%s)</span>',
				esc_attr($this->updateChecker->getUniqueName('uid')),
				$this->updateChecker->slug
			);
			parent::__construct($title);
		}

		public function render() {
			printf(
				'<div class="puc-debug-bar-panel-v5" id="%1$s" data-slug="%2$s" data-uid="%3$s" data-nonce="%4$s">',
				esc_attr($this->updateChecker->getUniqueName('debug-bar-panel')),
				esc_attr($this->updateChecker->slug),
				esc_attr($this->updateChecker->getUniqueName('uid')),
				esc_attr(wp_create_nonce('puc-ajax'))
			);

			$this->displayConfiguration();
			$this->displayStatus();
			$this->displayCurrentUpdate();

			echo '</div>';
		}

		private function displayConfiguration() {
			echo '<h3>Configuration</h3>';
			echo '<table class="puc-debug-data">';
			$this->displayConfigHeader();
			$this->row('Slug', esc_html($this->updateChecker->slug));
			$this->row('DB option', esc_html($this->updateChecker->optionName));

			$requestInfoButton = $this->getMetadataButton();
			$this->row('Metadata URL', esc_html($this->updateChecker->metadataUrl) . ' ' . $requestInfoButton . $this->responseBox);

			$scheduler = $this->updateChecker->scheduler;
			if ( $scheduler->checkPeriod > 0 ) {
				$this->row('Automatic checks', 'Every ' . $scheduler->checkPeriod . ' hours');
			} else {
				$this->row('Automatic checks', 'Disabled');
			}

			if ( isset($scheduler->throttleRedundantChecks) ) {
				if ( $scheduler->throttleRedundantChecks && ($scheduler->checkPeriod > 0) ) {
					$this->row(
						'Throttling',
						sprintf(
							'Enabled. If an update is already available, check for updates every %1$d hours instead of every %2$d hours.',
							$scheduler->throttledCheckPeriod,
							$scheduler->checkPeriod
						)
					);
				} else {
					$this->row('Throttling', 'Disabled');
				}
			}

			$this->updateChecker->onDisplayConfiguration($this);

			echo '</table>';
		}

		protected function displayConfigHeader() {
			//Do nothing. This should be implemented in subclasses.
		}

		protected function getMetadataButton() {
			return '';
		}

		private function displayStatus() {
			echo '<h3>Status</h3>';
			echo '<table class="puc-debug-data">';
			$state = $this->updateChecker->getUpdateState();
			$checkButtonId = $this->updateChecker->getUniqueName('check-now-button');
			if ( function_exists('get_submit_button')  ) {
				$checkNowButton = get_submit_button(
					'Check Now',
					'secondary',
					'puc-check-now-button',
					false,
					array('id' => $checkButtonId)
				);
			} else {
				//get_submit_button() is not available in the frontend. Make a button directly.
				//It won't look the same without admin styles, but it should still work.
				$checkNowButton = sprintf(
					'<input type="button" id="%1$s" name="puc-check-now-button" value="%2$s" class="button button-secondary" />',
					esc_attr($checkButtonId),
					esc_attr('Check Now')
				);
			}

			if ( $state->getLastCheck() > 0 ) {
				$this->row('Last check', $this->formatTimeWithDelta($state->getLastCheck()) . ' ' . $checkNowButton . $this->responseBox);
			} else {
				$this->row('Last check', 'Never');
			}

			$nextCheck = wp_next_scheduled($this->updateChecker->scheduler->getCronHookName());
			$this->row('Next automatic check', $this->formatTimeWithDelta($nextCheck));

			if ( $state->getCheckedVersion() !== '' ) {
				$this->row('Checked version', esc_html($state->getCheckedVersion()));
				$this->row('Cached update', $state->getUpdate());
			}
			$this->row('Update checker class', esc_html(get_class($this->updateChecker)));
			echo '</table>';
		}

		private function displayCurrentUpdate() {
			$update = $this->updateChecker->getUpdate();
			if ( $update !== null ) {
				echo '<h3>An Update Is Available</h3>';
				echo '<table class="puc-debug-data">';
				$fields = $this->getUpdateFields();
				foreach($fields as $field) {
					if ( property_exists($update, $field) ) {
						$this->row(
							ucwords(str_replace('_', ' ', $field)),
							isset($update->$field) ? esc_html($update->$field) : null
						);
					}
				}
				echo '</table>';
			} else {
				echo '<h3>No updates currently available</h3>';
			}
		}

		protected function getUpdateFields() {
			return array('version', 'download_url', 'slug',);
		}

		private function formatTimeWithDelta($unixTime) {
			if ( empty($unixTime) ) {
				return 'Never';
			}

			$delta = time() - $unixTime;
			$result = human_time_diff(time(), $unixTime);
			if ( $delta < 0 ) {
				$result = 'after ' . $result;
			} else {
				$result = $result . ' ago';
			}
			$result .= ' (' . $this->formatTimestamp($unixTime) . ')';
			return $result;
		}

		private function formatTimestamp($unixTime) {
			return gmdate('Y-m-d H:i:s', $unixTime + (get_option('gmt_offset') * 3600));
		}

		public function row($name, $value) {
			if ( is_object($value) || is_array($value) ) {
				//This is specifically for debugging, so print_r() is fine.
				//phpcs:ignore WordPress.PHP.DevelopmentFunctions.error_log_print_r
				$value = '<pre>' . esc_html(print_r($value, true)) . '</pre>';
			} else if ($value === null) {
				$value = '<code>null</code>';
			}
			printf(
				'<tr><th scope="row">%1$s</th> <td>%2$s</td></tr>',
				esc_html($name),
				//phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped -- Escaped above.
				$value
			);
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\DebugBar\PluginExtension.php (1270 bytes, 41 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\DebugBar;

use YahnisElsts\PluginUpdateChecker\v5p6\Plugin\UpdateChecker;

if ( !class_exists(PluginExtension::class, false) ):

	class PluginExtension extends Extension {
		/** @var UpdateChecker */
		protected $updateChecker;

		public function __construct($updateChecker) {
			parent::__construct($updateChecker, PluginPanel::class);

			add_action('wp_ajax_puc_v5_debug_request_info', array($this, 'ajaxRequestInfo'));
		}

		/**
		 * Request plugin info and output it.
		 */
		public function ajaxRequestInfo() {
			//phpcs:ignore WordPress.Security.NonceVerification.Missing -- Nonce is checked in preAjaxRequest().
			if ( !isset($_POST['uid']) || ($_POST['uid'] !== $this->updateChecker->getUniqueName('uid')) ) {
				return;
			}
			$this->preAjaxRequest();
			$info = $this->updateChecker->requestInfo();
			if ( $info !== null ) {
				echo 'Successfully retrieved plugin info from the metadata URL:';
				//phpcs:ignore WordPress.PHP.DevelopmentFunctions.error_log_print_r -- For debugging output.
				echo '<pre>', esc_html(print_r($info, true)), '</pre>';
			} else {
				echo 'Failed to retrieve plugin info from the metadata URL.';
			}
			exit;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\DebugBar\PluginPanel.php (1248 bytes, 48 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6\DebugBar;

use YahnisElsts\PluginUpdateChecker\v5p6\Plugin\UpdateChecker;

if ( !class_exists(PluginPanel::class, false) ):

	class PluginPanel extends Panel {
		/**
		 * @var UpdateChecker
		 */
		protected $updateChecker;

		protected function displayConfigHeader() {
			$this->row('Plugin file', esc_html($this->updateChecker->pluginFile));
			parent::displayConfigHeader();
		}

		protected function getMetadataButton() {
			$buttonId = $this->updateChecker->getUniqueName('request-info-button');
			if ( function_exists('get_submit_button') ) {
				$requestInfoButton = get_submit_button(
					'Request Info',
					'secondary',
					'puc-request-info-button',
					false,
					array('id' => $buttonId)
				);
			} else {
				$requestInfoButton = sprintf(
					'<input type="button" name="puc-request-info-button" id="%1$s" value="%2$s" class="button button-secondary" />',
					esc_attr($buttonId),
					esc_attr('Request Info')
				);
			}
			return $requestInfoButton;
		}

		protected function getUpdateFields() {
			return array_merge(
				parent::getUpdateFields(),
				array('homepage', 'upgrade_notice', 'tested',)
			);
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\DebugBar\ThemePanel.php (594 bytes, 26 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\DebugBar;

use YahnisElsts\PluginUpdateChecker\v5p6\Theme\UpdateChecker;

if ( !class_exists(ThemePanel::class, false) ):

	class ThemePanel extends Panel {
		/**
		 * @var UpdateChecker
		 */
		protected $updateChecker;

		protected function displayConfigHeader() {
			$this->row('Theme directory', esc_html($this->updateChecker->directoryName));
			parent::displayConfigHeader();
		}

		protected function getUpdateFields() {
			return array_merge(parent::getUpdateFields(), array('details_url'));
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Plugin\Package.php (5735 bytes, 189 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6\Plugin;

use YahnisElsts\PluginUpdateChecker\v5p6\InstalledPackage;
use YahnisElsts\PluginUpdateChecker\v5p6\PucFactory;

if ( !class_exists(Package::class, false) ):

	class Package extends InstalledPackage {
		/**
		 * @var UpdateChecker
		 */
		protected $updateChecker;

		/**
		 * @var string Full path of the main plugin file.
		 */
		protected $pluginAbsolutePath = '';

		/**
		 * @var string Plugin basename.
		 */
		private $pluginFile;

		/**
		 * @var string|null
		 */
		private $cachedInstalledVersion = null;

		public function __construct($pluginAbsolutePath, $updateChecker) {
			$this->pluginAbsolutePath = $pluginAbsolutePath;
			$this->pluginFile = plugin_basename($this->pluginAbsolutePath);

			parent::__construct($updateChecker);

			//Clear the version number cache when something - anything - is upgraded or WP clears the update cache.
			add_filter('upgrader_post_install', array($this, 'clearCachedVersion'));
			add_action('delete_site_transient_update_plugins', array($this, 'clearCachedVersion'));
		}

		public function getInstalledVersion() {
			if ( isset($this->cachedInstalledVersion) ) {
				return $this->cachedInstalledVersion;
			}

			$pluginHeader = $this->getPluginHeader();
			if ( isset($pluginHeader['Version']) ) {
				$this->cachedInstalledVersion = $pluginHeader['Version'];
				return $pluginHeader['Version'];
			} else {
				//This can happen if the filename points to something that is not a plugin.
				$this->updateChecker->triggerError(
					sprintf(
						"Cannot read the Version header for '%s'. The filename is incorrect or is not a plugin.",
						$this->updateChecker->pluginFile
					),
					E_USER_WARNING
				);
				return null;
			}
		}

		/**
		 * Clear the cached plugin version. This method can be set up as a filter (hook) and will
		 * return the filter argument unmodified.
		 *
		 * @param mixed $filterArgument
		 * @return mixed
		 */
		public function clearCachedVersion($filterArgument = null) {
			$this->cachedInstalledVersion = null;
			return $filterArgument;
		}

		public function getAbsoluteDirectoryPath() {
			return dirname($this->pluginAbsolutePath);
		}

		/**
		 * Get the value of a specific plugin or theme header.
		 *
		 * @param string $headerName
		 * @param string $defaultValue
		 * @return string Either the value of the header, or $defaultValue if the header doesn't exist or is empty.
		 */
		public function getHeaderValue($headerName, $defaultValue = '') {
			$headers = $this->getPluginHeader();
			if ( isset($headers[$headerName]) && ($headers[$headerName] !== '') ) {
				return $headers[$headerName];
			}
			return $defaultValue;
		}

		protected function getHeaderNames() {
			return array(
				'Name'              => 'Plugin Name',
				'PluginURI'         => 'Plugin URI',
				'Version'           => 'Version',
				'Description'       => 'Description',
				'Author'            => 'Author',
				'AuthorURI'         => 'Author URI',
				'TextDomain'        => 'Text Domain',
				'DomainPath'        => 'Domain Path',
				'Network'           => 'Network',

				//The newest WordPress version that this plugin requires or has been tested with.
				//We support several different formats for compatibility with other libraries.
				'Tested WP'         => 'Tested WP',
				'Requires WP'       => 'Requires WP',
				'Tested up to'      => 'Tested up to',
				'Requires at least' => 'Requires at least',
			);
		}

		/**
		 * Get the translated plugin title.
		 *
		 * @return string
		 */
		public function getPluginTitle() {
			$title = '';
			$header = $this->getPluginHeader();
			if ( $header && !empty($header['Name']) && isset($header['TextDomain']) ) {
				$title = translate($header['Name'], $header['TextDomain']);
			}
			return $title;
		}

		/**
		 * Get plugin's metadata from its file header.
		 *
		 * @return array
		 */
		public function getPluginHeader() {
			if ( !is_file($this->pluginAbsolutePath) ) {
				//This can happen if the plugin filename is wrong.
				$this->updateChecker->triggerError(
					sprintf(
						"Can't to read the plugin header for '%s'. The file does not exist.",
						$this->updateChecker->pluginFile
					),
					E_USER_WARNING
				);
				return array();
			}

			if ( !function_exists('get_plugin_data') ) {
				require_once(ABSPATH . '/wp-admin/includes/plugin.php');
			}
			return get_plugin_data($this->pluginAbsolutePath, false, false);
		}

		public function removeHooks() {
			remove_filter('upgrader_post_install', array($this, 'clearCachedVersion'));
			remove_action('delete_site_transient_update_plugins', array($this, 'clearCachedVersion'));
		}

		/**
		 * Check if the plugin file is inside the mu-plugins directory.
		 *
		 * @return bool
		 */
		public function isMuPlugin() {
			static $cachedResult = null;

			if ( $cachedResult === null ) {
				if ( !defined('WPMU_PLUGIN_DIR') || !is_string(WPMU_PLUGIN_DIR) ) {
					$cachedResult = false;
					return $cachedResult;
				}

				//Convert both paths to the canonical form before comparison.
				$muPluginDir = realpath(WPMU_PLUGIN_DIR);
				$pluginPath  = realpath($this->pluginAbsolutePath);
				//If realpath() fails, just normalize the syntax instead.
				if (($muPluginDir === false) || ($pluginPath === false)) {
					$muPluginDir = PucFactory::normalizePath(WPMU_PLUGIN_DIR);
					$pluginPath  = PucFactory::normalizePath($this->pluginAbsolutePath);
				}

				$cachedResult = (strpos($pluginPath, $muPluginDir) === 0);
			}

			return $cachedResult;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Plugin\PluginInfo.php (3973 bytes, 137 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6\Plugin;

use YahnisElsts\PluginUpdateChecker\v5p6\Metadata;

if ( !class_exists(PluginInfo::class, false) ):

	/**
	 * A container class for holding and transforming various plugin metadata.
	 *
	 * @author Janis Elsts
	 * @copyright 2016
	 * @access public
	 */
	class PluginInfo extends Metadata {
		//Most fields map directly to the contents of the plugin's info.json file.
		//See the relevant docs for a description of their meaning.
		public $name;
		public $slug;
		public $version;
		public $homepage;
		public $sections = array();
		public $download_url;

		public $banners;
		public $icons = array();
		public $translations = array();

		public $author;
		public $author_homepage;

		public $requires;
		public $tested;
		public $requires_php;
		public $upgrade_notice;

		public $rating;
		public $num_ratings;
		public $downloaded;
		public $active_installs;
		public $last_updated;

		public $id = 0; //The native WP.org API returns numeric plugin IDs, but they're not used for anything.

		public $filename; //Plugin filename relative to the plugins directory.

		/**
		 * Create a new instance of Plugin Info from JSON-encoded plugin info
		 * returned by an external update API.
		 *
		 * @param string $json Valid JSON string representing plugin info.
		 * @return self|null New instance of Plugin Info, or NULL on error.
		 */
		public static function fromJson($json){
			$instance = new self();

			if ( !parent::createFromJson($json, $instance) ) {
				return null;
			}

			//json_decode decodes assoc. arrays as objects. We want them as arrays.
			$instance->sections = (array)$instance->sections;
			$instance->icons = (array)$instance->icons;

			return $instance;
		}

		/**
		 * Very, very basic validation.
		 *
		 * @param \StdClass $apiResponse
		 * @return bool|\WP_Error
		 */
		protected function validateMetadata($apiResponse) {
			if (
				!isset($apiResponse->name, $apiResponse->version)
				|| empty($apiResponse->name)
				|| empty($apiResponse->version)
			) {
				return new \WP_Error(
					'puc-invalid-metadata',
					"The plugin metadata file does not contain the required 'name' and/or 'version' keys."
				);
			}
			return true;
		}


		/**
		 * Transform plugin info into the format used by the native WordPress.org API
		 *
		 * @return object
		 */
		public function toWpFormat(){
			$info = new \stdClass;

			//The custom update API is built so that many fields have the same name and format
			//as those returned by the native WordPress.org API. These can be assigned directly.
			$sameFormat = array(
				'name', 'slug', 'version', 'requires', 'tested', 'rating', 'upgrade_notice',
				'num_ratings', 'downloaded', 'active_installs', 'homepage', 'last_updated',
				'requires_php',
			);
			foreach($sameFormat as $field){
				if ( isset($this->$field) ) {
					$info->$field = $this->$field;
				} else {
					$info->$field = null;
				}
			}

			//Other fields need to be renamed and/or transformed.
			$info->download_link = $this->download_url;
			$info->author = $this->getFormattedAuthor();
			$info->sections = array_merge(array('description' => ''), $this->sections);

			if ( !empty($this->banners) ) {
				//WP expects an array with two keys: "high" and "low". Both are optional.
				//Docs: https://wordpress.org/plugins/about/faq/#banners
				$info->banners = is_object($this->banners) ? get_object_vars($this->banners) : $this->banners;
				$info->banners = array_intersect_key($info->banners, array('high' => true, 'low' => true));
			}

			return $info;
		}

		protected function getFormattedAuthor() {
			if ( !empty($this->author_homepage) ){
				/** @noinspection HtmlUnknownTarget */
				return sprintf('<a href="%s">%s</a>', $this->author_homepage, $this->author);
			}
			return $this->author;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Plugin\Ui.php (10719 bytes, 295 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6\Plugin;

if ( !class_exists(Ui::class, false) ):
	/**
	 * Additional UI elements for plugins.
	 */
	class Ui {
		private $updateChecker;
		private $manualCheckErrorTransient = '';

		/**
		 * @param UpdateChecker $updateChecker
		 */
		public function __construct($updateChecker) {
			$this->updateChecker = $updateChecker;
			$this->manualCheckErrorTransient = $this->updateChecker->getUniqueName('manual_check_errors');

			add_action('admin_init', array($this, 'onAdminInit'));
		}

		public function onAdminInit() {
			if ( $this->updateChecker->userCanInstallUpdates() ) {
				$this->handleManualCheck();

				add_filter('plugin_row_meta', array($this, 'addViewDetailsLink'), 10, 3);
				add_filter('plugin_row_meta', array($this, 'addCheckForUpdatesLink'), 10, 2);
				add_action('all_admin_notices', array($this, 'displayManualCheckResult'));
			}
		}

		/**
		 * Add a "View Details" link to the plugin row in the "Plugins" page. By default,
		 * the new link will appear before the "Visit plugin site" link (if present).
		 *
		 * You can change the link text by using the "puc_view_details_link-$slug" filter.
		 * Returning an empty string from the filter will disable the link.
		 *
		 * You can change the position of the link using the
		 * "puc_view_details_link_position-$slug" filter.
		 * Returning 'before' or 'after' will place the link immediately before/after
		 * the "Visit plugin site" link.
		 * Returning 'append' places the link after any existing links at the time of the hook.
		 * Returning 'replace' replaces the "Visit plugin site" link.
		 * Returning anything else disables the link when there is a "Visit plugin site" link.
		 *
		 * If there is no "Visit plugin site" link 'append' is always used!
		 *
		 * @param array $pluginMeta Array of meta links.
		 * @param string $pluginFile
		 * @param array $pluginData Array of plugin header data.
		 * @return array
		 */
		public function addViewDetailsLink($pluginMeta, $pluginFile, $pluginData = array()) {
			if ( $this->isMyPluginFile($pluginFile) && !isset($pluginData['slug']) ) {
				$linkText = apply_filters($this->updateChecker->getUniqueName('view_details_link'), __('View details'));
				if ( !empty($linkText) ) {
					$viewDetailsLinkPosition = 'append';

					//Find the "Visit plugin site" link (if present).
					$visitPluginSiteLinkIndex = count($pluginMeta) - 1;
					if ( $pluginData['PluginURI'] ) {
						$escapedPluginUri = esc_url($pluginData['PluginURI']);
						foreach ($pluginMeta as $linkIndex => $existingLink) {
							if ( strpos($existingLink, $escapedPluginUri) !== false ) {
								$visitPluginSiteLinkIndex = $linkIndex;
								$viewDetailsLinkPosition = apply_filters(
									$this->updateChecker->getUniqueName('view_details_link_position'),
									'before'
								);
								break;
							}
						}
					}

					$viewDetailsLink = sprintf('<a href="%s" class="thickbox open-plugin-details-modal" aria-label="%s" data-title="%s">%s</a>',
						esc_url(network_admin_url('plugin-install.php?tab=plugin-information&plugin=' . urlencode($this->updateChecker->slug) .
							'&TB_iframe=true&width=600&height=550')),
						esc_attr(sprintf(__('More information about %s'), $pluginData['Name'])),
						esc_attr($pluginData['Name']),
						$linkText
					);
					switch ($viewDetailsLinkPosition) {
						case 'before':
							array_splice($pluginMeta, $visitPluginSiteLinkIndex, 0, $viewDetailsLink);
							break;
						case 'after':
							array_splice($pluginMeta, $visitPluginSiteLinkIndex + 1, 0, $viewDetailsLink);
							break;
						case 'replace':
							$pluginMeta[$visitPluginSiteLinkIndex] = $viewDetailsLink;
							break;
						case 'append':
						default:
							$pluginMeta[] = $viewDetailsLink;
							break;
					}
				}
			}
			return $pluginMeta;
		}

		/**
		 * Add a "Check for updates" link to the plugin row in the "Plugins" page. By default,
		 * the new link will appear after the "Visit plugin site" link if present, otherwise
		 * after the "View plugin details" link.
		 *
		 * You can change the link text by using the "puc_manual_check_link-$slug" filter.
		 * Returning an empty string from the filter will disable the link.
		 *
		 * @param array $pluginMeta Array of meta links.
		 * @param string $pluginFile
		 * @return array
		 */
		public function addCheckForUpdatesLink($pluginMeta, $pluginFile) {
			if ( $this->isMyPluginFile($pluginFile) ) {
				$linkUrl = wp_nonce_url(
					add_query_arg(
						array(
							'puc_check_for_updates' => 1,
							'puc_slug'              => $this->updateChecker->slug,
						),
						self_admin_url('plugins.php')
					),
					'puc_check_for_updates'
				);

				$linkText = apply_filters(
					$this->updateChecker->getUniqueName('manual_check_link'),
					__('Check for updates', 'plugin-update-checker')
				);
				if ( !empty($linkText) ) {
					/** @noinspection HtmlUnknownTarget */
					$pluginMeta[] = sprintf('<a href="%s">%s</a>', esc_attr($linkUrl), $linkText);
				}
			}
			return $pluginMeta;
		}

		protected function isMyPluginFile($pluginFile) {
			return ($pluginFile == $this->updateChecker->pluginFile)
				|| (!empty($this->updateChecker->muPluginFile) && ($pluginFile == $this->updateChecker->muPluginFile));
		}

		/**
		 * Check for updates when the user clicks the "Check for updates" link.
		 *
		 * @see self::addCheckForUpdatesLink()
		 *
		 * @return void
		 */
		public function handleManualCheck() {
			$shouldCheck =
				isset($_GET['puc_check_for_updates'], $_GET['puc_slug'])
				&& $_GET['puc_slug'] == $this->updateChecker->slug
				&& check_admin_referer('puc_check_for_updates');

			if ( $shouldCheck ) {
				$update = $this->updateChecker->checkForUpdates();
				$status = ($update === null) ? 'no_update' : 'update_available';
				$lastRequestApiErrors = $this->updateChecker->getLastRequestApiErrors();

				if ( ($update === null) && !empty($lastRequestApiErrors) ) {
					//Some errors are not critical. For example, if PUC tries to retrieve the readme.txt
					//file from GitHub and gets a 404, that's an API error, but it doesn't prevent updates
					//from working. Maybe the plugin simply doesn't have a readme.
					//Let's only show important errors.
					$foundCriticalErrors = false;
					$questionableErrorCodes = array(
						'puc-github-http-error',
						'puc-gitlab-http-error',
						'puc-bitbucket-http-error',
					);

					foreach ($lastRequestApiErrors as $item) {
						$wpError = $item['error'];
						/** @var \WP_Error $wpError */
						if ( !in_array($wpError->get_error_code(), $questionableErrorCodes) ) {
							$foundCriticalErrors = true;
							break;
						}
					}

					if ( $foundCriticalErrors ) {
						$status = 'error';
						set_site_transient($this->manualCheckErrorTransient, $lastRequestApiErrors, 60);
					}
				}

				wp_safe_redirect(add_query_arg(
					array(
						'puc_update_check_result' => $status,
						'puc_slug'                => $this->updateChecker->slug,
					),
					self_admin_url('plugins.php')
				));
				exit;
			}
		}

		/**
		 * Display the results of a manual update check.
		 *
		 * @see self::handleManualCheck()
		 *
		 * You can change the result message by using the "puc_manual_check_message-$slug" filter.
		 */
		public function displayManualCheckResult() {
			//phpcs:disable WordPress.Security.NonceVerification.Recommended -- Just displaying a message.
			if ( isset($_GET['puc_update_check_result'], $_GET['puc_slug']) && ($_GET['puc_slug'] == $this->updateChecker->slug) ) {
				$status = sanitize_key($_GET['puc_update_check_result']);
				$title = $this->updateChecker->getInstalledPackage()->getPluginTitle();
				$noticeClass = 'updated notice-success';
				$details = '';

				if ( $status == 'no_update' ) {
					$message = sprintf(_x('The %s plugin is up to date.', 'the plugin title', 'plugin-update-checker'), $title);
				} else if ( $status == 'update_available' ) {
					$message = sprintf(_x('A new version of the %s plugin is available.', 'the plugin title', 'plugin-update-checker'), $title);
				} else if ( $status === 'error' ) {
					$message = sprintf(_x('Could not determine if updates are available for %s.', 'the plugin title', 'plugin-update-checker'), $title);
					$noticeClass = 'error notice-error';

					$details = $this->formatManualCheckErrors(get_site_transient($this->manualCheckErrorTransient));
					delete_site_transient($this->manualCheckErrorTransient);
				} else {
					$message = sprintf(__('Unknown update checker status "%s"', 'plugin-update-checker'), $status);
					$noticeClass = 'error notice-error';
				}

				$message = esc_html($message);

				//Plugins can replace the message with their own, including adding HTML.
				$message = apply_filters(
					$this->updateChecker->getUniqueName('manual_check_message'),
					$message,
					$status
				);

				printf(
					'<div class="notice %s is-dismissible"><p>%s</p>%s</div>',
					esc_attr($noticeClass),
					//phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped -- Was escaped above, and plugins can add HTML.
					$message,
					//phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped -- Contains HTML. Content should already be escaped.
					$details
				);
			}
			//phpcs:enable
		}

		/**
		 * Format the list of errors that were thrown during an update check.
		 *
		 * @param array $errors
		 * @return string
		 */
		protected function formatManualCheckErrors($errors) {
			if ( empty($errors) ) {
				return '';
			}
			$output = '';

			$showAsList = count($errors) > 1;
			if ( $showAsList ) {
				$output .= '<ol>';
				$formatString = '<li>%1$s <code>%2$s</code></li>';
			} else {
				$formatString = '<p>%1$s <code>%2$s</code></p>';
			}
			foreach ($errors as $item) {
				$wpError = $item['error'];
				/** @var \WP_Error $wpError */
				$output .= sprintf(
					$formatString,
					esc_html($wpError->get_error_message()),
					esc_html($wpError->get_error_code())
				);
			}
			if ( $showAsList ) {
				$output .= '</ol>';
			}

			return $output;
		}

		public function removeHooks() {
			remove_action('admin_init', array($this, 'onAdminInit'));
			remove_filter('plugin_row_meta', array($this, 'addViewDetailsLink'), 10);
			remove_filter('plugin_row_meta', array($this, 'addCheckForUpdatesLink'), 10);
			remove_action('all_admin_notices', array($this, 'displayManualCheckResult'));
		}
	}
endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Plugin\Update.php (3375 bytes, 117 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6\Plugin;

use YahnisElsts\PluginUpdateChecker\v5p6\Update as BaseUpdate;

if ( !class_exists(Update::class, false) ):

	/**
	 * A simple container class for holding information about an available update.
	 *
	 * @author Janis Elsts
	 * @copyright 2016
	 * @access public
	 */
	class Update extends BaseUpdate {
		public $id = 0;
		public $homepage;
		public $upgrade_notice;
		public $tested;
		public $requires_php = false;
		public $icons = array();
		public $filename; //Plugin filename relative to the plugins directory.

		protected static $extraFields = array(
			'id', 'homepage', 'tested', 'requires_php', 'upgrade_notice', 'icons', 'filename',
		);

		/**
		 * Create a new instance of PluginUpdate from its JSON-encoded representation.
		 *
		 * @param string $json
		 * @return self|null
		 */
		public static function fromJson($json){
			//Since update-related information is simply a subset of the full plugin info,
			//we can parse the update JSON as if it was a plugin info string, then copy over
			//the parts that we care about.
			$pluginInfo = PluginInfo::fromJson($json);
			if ( $pluginInfo !== null ) {
				return self::fromPluginInfo($pluginInfo);
			} else {
				return null;
			}
		}

		/**
		 * Create a new instance of PluginUpdate based on an instance of PluginInfo.
		 * Basically, this just copies a subset of fields from one object to another.
		 *
		 * @param PluginInfo $info
		 * @return static
		 */
		public static function fromPluginInfo($info){
			return static::fromObject($info);
		}

		/**
		 * Create a new instance by copying the necessary fields from another object.
		 *
		 * @param \StdClass|PluginInfo|self $object The source object.
		 * @return self The new copy.
		 */
		public static function fromObject($object) {
			$update = new self();
			$update->copyFields($object, $update);
			return $update;
		}

		/**
		 * @return string[]
		 */
		protected function getFieldNames() {
			return array_merge(parent::getFieldNames(), self::$extraFields);
		}

		/**
		 * Transform the update into the format used by WordPress native plugin API.
		 *
		 * @return object
		 */
		public function toWpFormat() {
			$update = parent::toWpFormat();

			$update->id = $this->id;
			$update->url = $this->homepage;
			$update->tested = $this->tested;
			$update->requires_php = $this->requires_php;
			$update->plugin = $this->filename;

			if ( !empty($this->upgrade_notice) ) {
				$update->upgrade_notice = $this->upgrade_notice;
			}

			if ( !empty($this->icons) && is_array($this->icons) ) {
				//This should be an array with up to 4 keys: 'svg', '1x', '2x' and 'default'.
				//Docs: https://developer.wordpress.org/plugins/wordpress-org/plugin-assets/#plugin-icons
				$icons = array_intersect_key(
					$this->icons,
					array('svg' => true, '1x' => true, '2x' => true, 'default' => true)
				);
				if ( !empty($icons) ) {
					$update->icons = $icons;

					//It appears that the 'default' icon isn't used anywhere in WordPress 4.9,
					//but lets set it just in case a future release needs it.
					if ( !isset($update->icons['default']) ) {
						$update->icons['default'] = current($update->icons);
					}
				}
			}

			return $update;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Plugin\UpdateChecker.php (13780 bytes, 426 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6\Plugin;

use YahnisElsts\PluginUpdateChecker\v5p6\InstalledPackage;
use YahnisElsts\PluginUpdateChecker\v5p6\UpdateChecker as BaseUpdateChecker;
use YahnisElsts\PluginUpdateChecker\v5p6\Scheduler;
use YahnisElsts\PluginUpdateChecker\v5p6\DebugBar;

if ( !class_exists(UpdateChecker::class, false) ):

	/**
	 * A custom plugin update checker.
	 *
	 * @author Janis Elsts
	 * @copyright 2018
	 * @access public
	 */
	class UpdateChecker extends BaseUpdateChecker {
		protected $updateTransient = 'update_plugins';
		protected $componentType = 'plugin';

		public $pluginAbsolutePath = ''; //Full path of the main plugin file.
		public $pluginFile = '';  //Plugin filename relative to the plugins directory. Many WP APIs use this to identify plugins.
		public $muPluginFile = ''; //For MU plugins, the plugin filename relative to the mu-plugins directory.

		/**
		 * @var Package
		 */
		protected $package;

		private $extraUi = null;

		/**
		 * Class constructor.
		 *
		 * @param string $metadataUrl The URL of the plugin's metadata file.
		 * @param string $pluginFile Fully qualified path to the main plugin file.
		 * @param string $slug The plugin's 'slug'. If not specified, the filename part of $pluginFile sans '.php' will be used as the slug.
		 * @param integer $checkPeriod How often to check for updates (in hours). Defaults to checking every 12 hours. Set to 0 to disable automatic update checks.
		 * @param string $optionName Where to store book-keeping info about update checks. Defaults to 'external_updates-$slug'.
		 * @param string $muPluginFile Optional. The plugin filename relative to the mu-plugins directory.
		 */
		public function __construct($metadataUrl, $pluginFile, $slug = '', $checkPeriod = 12, $optionName = '', $muPluginFile = ''){
			$this->pluginAbsolutePath = $pluginFile;
			$this->pluginFile = plugin_basename($this->pluginAbsolutePath);
			$this->muPluginFile = $muPluginFile;

			//If no slug is specified, use the name of the main plugin file as the slug.
			//For example, 'my-cool-plugin/cool-plugin.php' becomes 'cool-plugin'.
			if ( empty($slug) ){
				$slug = basename($this->pluginFile, '.php');
			}

			//Plugin slugs must be unique.
			$slugCheckFilter = 'puc_is_slug_in_use-' . $slug;
			$slugUsedBy = apply_filters($slugCheckFilter, false);
			if ( $slugUsedBy ) {
				$this->triggerError(sprintf(
					'Plugin slug "%s" is already in use by %s. Slugs must be unique.',
					$slug,
					$slugUsedBy
				), E_USER_ERROR);
			}
			add_filter($slugCheckFilter, array($this, 'getAbsolutePath'));

			parent::__construct($metadataUrl, dirname($this->pluginFile), $slug, $checkPeriod, $optionName);

			//Backwards compatibility: If the plugin is a mu-plugin but no $muPluginFile is specified, assume
			//it's the same as $pluginFile given that it's not in a subdirectory (WP only looks in the base dir).
			if ( (strpbrk($this->pluginFile, '/\\') === false) && $this->isUnknownMuPlugin() ) {
				$this->muPluginFile = $this->pluginFile;
			}

			//To prevent a crash during plugin uninstallation, remove updater hooks when the user removes the plugin.
			//Details: https://github.com/YahnisElsts/plugin-update-checker/issues/138#issuecomment-335590964
			add_action('uninstall_' . $this->pluginFile, array($this, 'removeHooks'));

			$this->extraUi = new Ui($this);
		}

		/**
		 * Create an instance of the scheduler.
		 *
		 * @param int $checkPeriod
		 * @return Scheduler
		 */
		protected function createScheduler($checkPeriod) {
			$scheduler = new Scheduler($this, $checkPeriod, array('load-plugins.php'));
			register_deactivation_hook($this->pluginFile, array($scheduler, 'removeUpdaterCron'));
			return $scheduler;
		}

		/**
		 * Install the hooks required to run periodic update checks and inject update info
		 * into WP data structures.
		 *
		 * @return void
		 */
		protected function installHooks(){
			//Override requests for plugin information
			add_filter('plugins_api', array($this, 'injectInfo'), 20, 3);

			parent::installHooks();
		}

		/**
		 * Remove update checker hooks.
		 *
		 * The intent is to prevent a fatal error that can happen if the plugin has an uninstall
		 * hook. During uninstallation, WP includes the main plugin file (which creates a PUC instance),
		 * the uninstall hook runs, WP deletes the plugin files and then updates some transients.
		 * If PUC hooks are still around at this time, they could throw an error while trying to
		 * autoload classes from files that no longer exist.
		 *
		 * The "site_transient_{$transient}" filter is the main problem here, but let's also remove
		 * most other PUC hooks to be safe.
		 *
		 * @internal
		 */
		public function removeHooks() {
			parent::removeHooks();
			$this->extraUi->removeHooks();
			$this->package->removeHooks();

			remove_filter('plugins_api', array($this, 'injectInfo'), 20);
		}

		/**
		 * Retrieve plugin info from the configured API endpoint.
		 *
		 * @uses wp_remote_get()
		 *
		 * @param array $queryArgs Additional query arguments to append to the request. Optional.
		 * @return PluginInfo
		 */
		public function requestInfo($queryArgs = array()) {
			list($pluginInfo, $result) = $this->requestMetadata(
				PluginInfo::class,
				'request_info',
				$queryArgs
			);

			if ( $pluginInfo !== null ) {
				/** @var PluginInfo $pluginInfo */
				$pluginInfo->filename = $this->pluginFile;
				$pluginInfo->slug = $this->slug;
			}

			$pluginInfo = apply_filters($this->getUniqueName('request_info_result'), $pluginInfo, $result);
			return $pluginInfo;
		}

		/**
		 * Retrieve the latest update (if any) from the configured API endpoint.
		 *
		 * @uses UpdateChecker::requestInfo()
		 *
		 * @return Update|null An instance of Plugin Update, or NULL when no updates are available.
		 */
		public function requestUpdate() {
			//For the sake of simplicity, this function just calls requestInfo()
			//and transforms the result accordingly.
			$pluginInfo = $this->requestInfo(array('checking_for_updates' => '1'));
			if ( $pluginInfo === null ){
				return null;
			}
			$update = Update::fromPluginInfo($pluginInfo);

			$update = $this->filterUpdateResult($update);

			return $update;
		}

		/**
		 * Intercept plugins_api() calls that request information about our plugin and
		 * use the configured API endpoint to satisfy them.
		 *
		 * @see plugins_api()
		 *
		 * @param mixed $result
		 * @param string $action
		 * @param array|object $args
		 * @return mixed
		 */
		public function injectInfo($result, $action = null, $args = null){
			$relevant = ($action == 'plugin_information') && isset($args->slug) && (
					($args->slug == $this->slug) || ($args->slug == dirname($this->pluginFile))
				);
			if ( !$relevant ) {
				return $result;
			}

			$pluginInfo = $this->requestInfo();
			$this->fixSupportedWordpressVersion($pluginInfo);

			$pluginInfo = apply_filters($this->getUniqueName('pre_inject_info'), $pluginInfo);
			if ( $pluginInfo ) {
				return $pluginInfo->toWpFormat();
			}

			return $result;
		}

		protected function shouldShowUpdates() {
			//No update notifications for mu-plugins unless explicitly enabled. The MU plugin file
			//is usually different from the main plugin file so the update wouldn't show up properly anyway.
			return !$this->isUnknownMuPlugin();
		}

		/**
		 * @param \stdClass|null $updates
		 * @param \stdClass $updateToAdd
		 * @return \stdClass
		 */
		protected function addUpdateToList($updates, $updateToAdd) {
			if ( $this->package->isMuPlugin() ) {
				//WP does not support automatic update installation for mu-plugins, but we can
				//still display a notice.
				$updateToAdd->package = null;
			}
			return parent::addUpdateToList($updates, $updateToAdd);
		}

		/**
		 * @param \stdClass|null $updates
		 * @return \stdClass|null
		 */
		protected function removeUpdateFromList($updates) {
			$updates = parent::removeUpdateFromList($updates);
			if ( !empty($this->muPluginFile) && isset($updates, $updates->response) ) {
				unset($updates->response[$this->muPluginFile]);
			}
			return $updates;
		}

		/**
		 * For plugins, the update array is indexed by the plugin filename relative to the "plugins"
		 * directory. Example: "plugin-name/plugin.php".
		 *
		 * @return string
		 */
		protected function getUpdateListKey() {
			if ( $this->package->isMuPlugin() ) {
				return $this->muPluginFile;
			}
			return $this->pluginFile;
		}

		protected function getNoUpdateItemFields() {
			return array_merge(
				parent::getNoUpdateItemFields(),
				array(
					'id'            => $this->pluginFile,
					'slug'          => $this->slug,
					'plugin'        => $this->pluginFile,
					'icons'         => array(),
					'banners'       => array(),
					'banners_rtl'   => array(),
					'tested'        => '',
					'compatibility' => new \stdClass(),
				)
			);
		}

		/**
		 * Alias for isBeingUpgraded().
		 *
		 * @deprecated
		 * @param \WP_Upgrader|null $upgrader The upgrader that's performing the current update.
		 * @return bool
		 */
		public function isPluginBeingUpgraded($upgrader = null) {
			return $this->isBeingUpgraded($upgrader);
		}

		/**
		 * Is there an update being installed for this plugin, right now?
		 *
		 * @param \WP_Upgrader|null $upgrader
		 * @return bool
		 */
		public function isBeingUpgraded($upgrader = null) {
			return $this->upgraderStatus->isPluginBeingUpgraded($this->pluginFile, $upgrader);
		}

		/**
		 * Get the details of the currently available update, if any.
		 *
		 * If no updates are available, or if the last known update version is below or equal
		 * to the currently installed version, this method will return NULL.
		 *
		 * Uses cached update data. To retrieve update information straight from
		 * the metadata URL, call requestUpdate() instead.
		 *
		 * @return Update|null
		 */
		public function getUpdate() {
			$update = parent::getUpdate();
			if ( isset($update) ) {
				/** @var Update $update */
				$update->filename = $this->pluginFile;
			}
			return $update;
		}

		/**
		 * Get the translated plugin title.
		 *
		 * @deprecated
		 * @return string
		 */
		public function getPluginTitle() {
			return $this->package->getPluginTitle();
		}

		/**
		 * Check if the current user has the required permissions to install updates.
		 *
		 * @return bool
		 */
		public function userCanInstallUpdates() {
			return current_user_can('update_plugins');
		}

		/**
		 * Check if the plugin file is inside the mu-plugins directory.
		 *
		 * @deprecated
		 * @return bool
		 */
		protected function isMuPlugin() {
			return $this->package->isMuPlugin();
		}

		/**
		 * MU plugins are partially supported, but only when we know which file in mu-plugins
		 * corresponds to this plugin.
		 *
		 * @return bool
		 */
		protected function isUnknownMuPlugin() {
			return empty($this->muPluginFile) && $this->package->isMuPlugin();
		}

		/**
		 * Get absolute path to the main plugin file.
		 *
		 * @return string
		 */
		public function getAbsolutePath() {
			return $this->pluginAbsolutePath;
		}

		/**
		 * Register a callback for filtering query arguments.
		 *
		 * The callback function should take one argument - an associative array of query arguments.
		 * It should return a modified array of query arguments.
		 *
		 * @uses add_filter() This method is a convenience wrapper for add_filter().
		 *
		 * @param callable $callback
		 * @return void
		 */
		public function addQueryArgFilter($callback){
			$this->addFilter('request_info_query_args', $callback);
		}

		/**
		 * Register a callback for filtering arguments passed to wp_remote_get().
		 *
		 * The callback function should take one argument - an associative array of arguments -
		 * and return a modified array or arguments. See the WP documentation on wp_remote_get()
		 * for details on what arguments are available and how they work.
		 *
		 * @uses add_filter() This method is a convenience wrapper for add_filter().
		 *
		 * @param callable $callback
		 * @return void
		 */
		public function addHttpRequestArgFilter($callback) {
			$this->addFilter('request_info_options', $callback);
		}

		/**
		 * Register a callback for filtering the plugin info retrieved from the external API.
		 *
		 * The callback function should take two arguments. If the plugin info was retrieved
		 * successfully, the first argument passed will be an instance of  PluginInfo. Otherwise,
		 * it will be NULL. The second argument will be the corresponding return value of
		 * wp_remote_get (see WP docs for details).
		 *
		 * The callback function should return a new or modified instance of PluginInfo or NULL.
		 *
		 * @uses add_filter() This method is a convenience wrapper for add_filter().
		 *
		 * @param callable $callback
		 * @return void
		 */
		public function addResultFilter($callback) {
			$this->addFilter('request_info_result', $callback, 10, 2);
		}

		protected function createDebugBarExtension() {
			return new DebugBar\PluginExtension($this);
		}

		/**
		 * Create a package instance that represents this plugin or theme.
		 *
		 * @return InstalledPackage
		 */
		protected function createInstalledPackage() {
			return new Package($this->pluginAbsolutePath, $this);
		}

		/**
		 * @return Package
		 */
		public function getInstalledPackage() {
			return $this->package;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Theme\Package.php (1898 bytes, 70 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6\Theme;

use YahnisElsts\PluginUpdateChecker\v5p6\InstalledPackage;

if ( !class_exists(Package::class, false) ):

	class Package extends InstalledPackage {
		/**
		 * @var string Theme directory name.
		 */
		protected $stylesheet;

		/**
		 * @var \WP_Theme Theme object.
		 */
		protected $theme;

		public function __construct($stylesheet, $updateChecker) {
			$this->stylesheet = $stylesheet;
			$this->theme = wp_get_theme($this->stylesheet);

			parent::__construct($updateChecker);
		}

		public function getInstalledVersion() {
			return $this->theme->get('Version');
		}

		public function getAbsoluteDirectoryPath() {
			if ( method_exists($this->theme, 'get_stylesheet_directory') ) {
				return $this->theme->get_stylesheet_directory(); //Available since WP 3.4.
			}
			return get_theme_root($this->stylesheet) . '/' . $this->stylesheet;
		}

		/**
		 * Get the value of a specific plugin or theme header.
		 *
		 * @param string $headerName
		 * @param string $defaultValue
		 * @return string Either the value of the header, or $defaultValue if the header doesn't exist or is empty.
		 */
		public function getHeaderValue($headerName, $defaultValue = '') {
			$value = $this->theme->get($headerName);
			if ( ($headerName === false) || ($headerName === '') ) {
				return $defaultValue;
			}
			return $value;
		}

		protected function getHeaderNames() {
			return array(
				'Name'        => 'Theme Name',
				'ThemeURI'    => 'Theme URI',
				'Description' => 'Description',
				'Author'      => 'Author',
				'AuthorURI'   => 'Author URI',
				'Version'     => 'Version',
				'Template'    => 'Template',
				'Status'      => 'Status',
				'Tags'        => 'Tags',
				'TextDomain'  => 'Text Domain',
				'DomainPath'  => 'Domain Path',
			);
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Theme\Update.php (2299 bytes, 89 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\Theme;

use YahnisElsts\PluginUpdateChecker\v5p6\Update as BaseUpdate;

if ( !class_exists(Update::class, false) ):

	class Update extends BaseUpdate {
		public $details_url = '';

		protected static $extraFields = array('details_url');

		/**
		 * Transform the metadata into the format used by WordPress core.
		 * Note the inconsistency: WP stores plugin updates as objects and theme updates as arrays.
		 *
		 * @return array
		 */
		public function toWpFormat() {
			$update = array(
				'theme' => $this->slug,
				'new_version' => $this->version,
				'url' => $this->details_url,
			);

			if ( !empty($this->download_url) ) {
				$update['package'] = $this->download_url;
			}

			return $update;
		}

		/**
		 * Create a new instance of Theme_Update from its JSON-encoded representation.
		 *
		 * @param string $json Valid JSON string representing a theme information object.
		 * @return self New instance of ThemeUpdate, or NULL on error.
		 */
		public static function fromJson($json) {
			$instance = new self();
			if ( !parent::createFromJson($json, $instance) ) {
				return null;
			}
			return $instance;
		}

		/**
		 * Create a new instance by copying the necessary fields from another object.
		 *
		 * @param \StdClass|self $object The source object.
		 * @return self The new copy.
		 */
		public static function fromObject($object) {
			$update = new self();
			$update->copyFields($object, $update);
			return $update;
		}

		/**
		 * Basic validation.
		 *
		 * @param \StdClass $apiResponse
		 * @return bool|\WP_Error
		 */
		protected function validateMetadata($apiResponse) {
			$required = array('version', 'details_url');
			foreach($required as $key) {
				if ( !isset($apiResponse->$key) || empty($apiResponse->$key) ) {
					return new \WP_Error(
						'tuc-invalid-metadata',
						sprintf('The theme metadata is missing the required "%s" key.', $key)
					);
				}
			}
			return true;
		}

		protected function getFieldNames() {
			return array_merge(parent::getFieldNames(), self::$extraFields);
		}

		protected function getPrefixedFilter($tag) {
			return parent::getPrefixedFilter($tag) . '_theme';
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Theme\UpdateChecker.php (4837 bytes, 160 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\Theme;

use YahnisElsts\PluginUpdateChecker\v5p6\UpdateChecker as BaseUpdateChecker;
use YahnisElsts\PluginUpdateChecker\v5p6\InstalledPackage;
use YahnisElsts\PluginUpdateChecker\v5p6\Scheduler;
use YahnisElsts\PluginUpdateChecker\v5p6\DebugBar;

if ( !class_exists(UpdateChecker::class, false) ):

	class UpdateChecker extends BaseUpdateChecker {
		protected $filterSuffix = 'theme';
		protected $updateTransient = 'update_themes';
		protected $componentType = 'theme';

		/**
		 * @var string Theme directory name.
		 */
		protected $stylesheet;

		public function __construct($metadataUrl, $stylesheet = null, $customSlug = null, $checkPeriod = 12, $optionName = '') {
			if ( $stylesheet === null ) {
				$stylesheet = get_stylesheet();
			}
			$this->stylesheet = $stylesheet;

			parent::__construct(
				$metadataUrl,
				$stylesheet,
				$customSlug ? $customSlug : $stylesheet,
				$checkPeriod,
				$optionName
			);
		}

		/**
		 * For themes, the update array is indexed by theme directory name.
		 *
		 * @return string
		 */
		protected function getUpdateListKey() {
			return $this->directoryName;
		}

		/**
		 * Retrieve the latest update (if any) from the configured API endpoint.
		 *
		 * @return Update|null An instance of Update, or NULL when no updates are available.
		 */
		public function requestUpdate() {
			list($themeUpdate, $result) = $this->requestMetadata(Update::class, 'request_update');

			if ( $themeUpdate !== null ) {
				/** @var Update $themeUpdate */
				$themeUpdate->slug = $this->slug;
			}

			$themeUpdate = $this->filterUpdateResult($themeUpdate, $result);
			return $themeUpdate;
		}

		protected function getNoUpdateItemFields() {
			return array_merge(
				parent::getNoUpdateItemFields(),
				array(
					'theme'        => $this->directoryName,
					'requires'     => '',
				)
			);
		}

		public function userCanInstallUpdates() {
			return current_user_can('update_themes');
		}

		/**
		 * Create an instance of the scheduler.
		 *
		 * @param int $checkPeriod
		 * @return Scheduler
		 */
		protected function createScheduler($checkPeriod) {
			return new Scheduler($this, $checkPeriod, array('load-themes.php'));
		}

		/**
		 * Is there an update being installed right now for this theme?
		 *
		 * @param \WP_Upgrader|null $upgrader The upgrader that's performing the current update.
		 * @return bool
		 */
		public function isBeingUpgraded($upgrader = null) {
			return $this->upgraderStatus->isThemeBeingUpgraded($this->stylesheet, $upgrader);
		}

		protected function createDebugBarExtension() {
			return new DebugBar\Extension($this, DebugBar\ThemePanel::class);
		}

		/**
		 * Register a callback for filtering query arguments.
		 *
		 * The callback function should take one argument - an associative array of query arguments.
		 * It should return a modified array of query arguments.
		 *
		 * @param callable $callback
		 * @return void
		 */
		public function addQueryArgFilter($callback){
			$this->addFilter('request_update_query_args', $callback);
		}

		/**
		 * Register a callback for filtering arguments passed to wp_remote_get().
		 *
		 * The callback function should take one argument - an associative array of arguments -
		 * and return a modified array or arguments. See the WP documentation on wp_remote_get()
		 * for details on what arguments are available and how they work.
		 *
		 * @uses add_filter() This method is a convenience wrapper for add_filter().
		 *
		 * @param callable $callback
		 * @return void
		 */
		public function addHttpRequestArgFilter($callback) {
			$this->addFilter('request_update_options', $callback);
		}

		/**
		 * Register a callback for filtering theme updates retrieved from the external API.
		 *
		 * The callback function should take two arguments. If the theme update was retrieved
		 * successfully, the first argument passed will be an instance of Theme_Update. Otherwise,
		 * it will be NULL. The second argument will be the corresponding return value of
		 * wp_remote_get (see WP docs for details).
		 *
		 * The callback function should return a new or modified instance of Theme_Update or NULL.
		 *
		 * @uses add_filter() This method is a convenience wrapper for add_filter().
		 *
		 * @param callable $callback
		 * @return void
		 */
		public function addResultFilter($callback) {
			$this->addFilter('request_update_result', $callback, 10, 2);
		}

		/**
		 * Create a package instance that represents this plugin or theme.
		 *
		 * @return InstalledPackage
		 */
		protected function createInstalledPackage() {
			return new Package($this->stylesheet, $this);
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Vcs\Api.php (10264 bytes, 380 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

use Parsedown;
use PucReadmeParser;

if ( !class_exists(Api::class, false) ):

	abstract class Api {
		const STRATEGY_LATEST_RELEASE = 'latest_release';
		const STRATEGY_LATEST_TAG = 'latest_tag';
		const STRATEGY_STABLE_TAG = 'stable_tag';
		const STRATEGY_BRANCH = 'branch';

		/**
		 * Consider all releases regardless of their version number or prerelease/upcoming
		 * release status.
		 */
		const RELEASE_FILTER_ALL = 3;

		/**
		 * Exclude releases that have the "prerelease" or "upcoming release" flag.
		 *
		 * This does *not* look for prerelease keywords like "beta" in the version number.
		 * It only uses the data provided by the API. For example, on GitHub, you can
		 * manually mark a release as a prerelease.
		 */
		const RELEASE_FILTER_SKIP_PRERELEASE = 1;

		/**
		 * If there are no release assets or none of them match the configured filter,
		 * fall back to the automatically generated source code archive.
		 */
		const PREFER_RELEASE_ASSETS = 1;
		/**
		 * Skip releases that don't have any matching release assets.
		 */
		const REQUIRE_RELEASE_ASSETS = 2;

		protected $tagNameProperty = 'name';
		protected $slug = '';

		/**
		 * @var string
		 */
		protected $repositoryUrl = '';

		/**
		 * @var mixed Authentication details for private repositories. Format depends on service.
		 */
		protected $credentials = null;

		/**
		 * @var string The filter tag that's used to filter options passed to wp_remote_get.
		 * For example, "puc_request_info_options-slug" or "puc_request_update_options_theme-slug".
		 */
		protected $httpFilterName = '';

		/**
		 * @var string The filter applied to the list of update detection strategies that
		 * are used to find the latest version.
		 */
		protected $strategyFilterName = '';

		/**
		 * @var string|null
		 */
		protected $localDirectory = null;

		/**
		 * Api constructor.
		 *
		 * @param string $repositoryUrl
		 * @param array|string|null $credentials
		 */
		public function __construct($repositoryUrl, $credentials = null) {
			$this->repositoryUrl = $repositoryUrl;
			$this->setAuthentication($credentials);
		}

		/**
		 * @return string
		 */
		public function getRepositoryUrl() {
			return $this->repositoryUrl;
		}

		/**
		 * Figure out which reference (i.e. tag or branch) contains the latest version.
		 *
		 * @param string $configBranch Start looking in this branch.
		 * @return null|Reference
		 */
		public function chooseReference($configBranch) {
			$strategies = $this->getUpdateDetectionStrategies($configBranch);

			if ( !empty($this->strategyFilterName) ) {
				$strategies = apply_filters(
					$this->strategyFilterName,
					$strategies,
					$this->slug
				);
			}

			foreach ($strategies as $strategy) {
				$reference = call_user_func($strategy);
				if ( !empty($reference) ) {
					return $reference;
				}
			}
			return null;
		}

		/**
		 * Get an ordered list of strategies that can be used to find the latest version.
		 *
		 * The update checker will try each strategy in order until one of them
		 * returns a valid reference.
		 *
		 * @param string $configBranch
		 * @return array<callable> Array of callables that return Vcs_Reference objects.
		 */
		abstract protected function getUpdateDetectionStrategies($configBranch);

		/**
		 * Get the readme.txt file from the remote repository and parse it
		 * according to the plugin readme standard.
		 *
		 * @param string $ref Tag or branch name.
		 * @return array Parsed readme.
		 */
		public function getRemoteReadme($ref = 'master') {
			$fileContents = $this->getRemoteFile($this->getLocalReadmeName(), $ref);
			if ( empty($fileContents) ) {
				return array();
			}

			$parser = new PucReadmeParser();
			return $parser->parse_readme_contents($fileContents);
		}

		/**
		 * Get the case-sensitive name of the local readme.txt file.
		 *
		 * In most cases it should just be called "readme.txt", but some plugins call it "README.txt",
		 * "README.TXT", or even "Readme.txt". Most VCS are case-sensitive so we need to know the correct
		 * capitalization.
		 *
		 * Defaults to "readme.txt" (all lowercase).
		 *
		 * @return string
		 */
		public function getLocalReadmeName() {
			static $fileName = null;
			if ( $fileName !== null ) {
				return $fileName;
			}

			$fileName = 'readme.txt';
			if ( isset($this->localDirectory) ) {
				$files = scandir($this->localDirectory);
				if ( !empty($files) ) {
					foreach ($files as $possibleFileName) {
						if ( strcasecmp($possibleFileName, 'readme.txt') === 0 ) {
							$fileName = $possibleFileName;
							break;
						}
					}
				}
			}
			return $fileName;
		}

		/**
		 * Get a branch.
		 *
		 * @param string $branchName
		 * @return Reference|null
		 */
		abstract public function getBranch($branchName);

		/**
		 * Get a specific tag.
		 *
		 * @param string $tagName
		 * @return Reference|null
		 */
		abstract public function getTag($tagName);

		/**
		 * Get the tag that looks like the highest version number.
		 * (Implementations should skip pre-release versions if possible.)
		 *
		 * @return Reference|null
		 */
		abstract public function getLatestTag();

		/**
		 * Check if a tag name string looks like a version number.
		 *
		 * @param string $name
		 * @return bool
		 */
		protected function looksLikeVersion($name) {
			//Tag names may be prefixed with "v", e.g. "v1.2.3".
			$name = ltrim($name, 'v');

			//The version string must start with a number.
			if ( !is_numeric(substr($name, 0, 1)) ) {
				return false;
			}

			//The goal is to accept any SemVer-compatible or "PHP-standardized" version number.
			return (preg_match('@^(\d{1,5}?)(\.\d{1,10}?){0,4}?($|[abrdp+_\-]|\s)@i', $name) === 1);
		}

		/**
		 * Check if a tag appears to be named like a version number.
		 *
		 * @param \stdClass $tag
		 * @return bool
		 */
		protected function isVersionTag($tag) {
			$property = $this->tagNameProperty;
			return isset($tag->$property) && $this->looksLikeVersion($tag->$property);
		}

		/**
		 * Sort a list of tags as if they were version numbers.
		 * Tags that don't look like version number will be removed.
		 *
		 * @param \stdClass[] $tags Array of tag objects.
		 * @return \stdClass[] Filtered array of tags sorted in descending order.
		 */
		protected function sortTagsByVersion($tags) {
			//Keep only those tags that look like version numbers.
			$versionTags = array_filter($tags, array($this, 'isVersionTag'));
			//Sort them in descending order.
			usort($versionTags, array($this, 'compareTagNames'));

			return $versionTags;
		}

		/**
		 * Compare two tags as if they were version number.
		 *
		 * @param \stdClass $tag1 Tag object.
		 * @param \stdClass $tag2 Another tag object.
		 * @return int
		 */
		protected function compareTagNames($tag1, $tag2) {
			$property = $this->tagNameProperty;
			if ( !isset($tag1->$property) ) {
				return 1;
			}
			if ( !isset($tag2->$property) ) {
				return -1;
			}
			return -version_compare(ltrim($tag1->$property, 'v'), ltrim($tag2->$property, 'v'));
		}

		/**
		 * Get the contents of a file from a specific branch or tag.
		 *
		 * @param string $path File name.
		 * @param string $ref
		 * @return null|string Either the contents of the file, or null if the file doesn't exist or there's an error.
		 */
		abstract public function getRemoteFile($path, $ref = 'master');

		/**
		 * Get the timestamp of the latest commit that changed the specified branch or tag.
		 *
		 * @param string $ref Reference name (e.g. branch or tag).
		 * @return string|null
		 */
		abstract public function getLatestCommitTime($ref);

		/**
		 * Get the contents of the changelog file from the repository.
		 *
		 * @param string $ref
		 * @param string $localDirectory Full path to the local plugin or theme directory.
		 * @return null|string The HTML contents of the changelog.
		 */
		public function getRemoteChangelog($ref, $localDirectory) {
			$filename = $this->findChangelogName($localDirectory);
			if ( empty($filename) ) {
				return null;
			}

			$changelog = $this->getRemoteFile($filename, $ref);
			if ( $changelog === null ) {
				return null;
			}

			return Parsedown::instance()->text($changelog);
		}

		/**
		 * Guess the name of the changelog file.
		 *
		 * @param string $directory
		 * @return string|null
		 */
		protected function findChangelogName($directory = null) {
			if ( !isset($directory) ) {
				$directory = $this->localDirectory;
			}
			if ( empty($directory) || !is_dir($directory) || ($directory === '.') ) {
				return null;
			}

			$possibleNames = array('CHANGES.md', 'CHANGELOG.md', 'changes.md', 'changelog.md');
			$files = scandir($directory);
			$foundNames = array_intersect($possibleNames, $files);

			if ( !empty($foundNames) ) {
				return reset($foundNames);
			}
			return null;
		}

		/**
		 * Set authentication credentials.
		 *
		 * @param $credentials
		 */
		public function setAuthentication($credentials) {
			$this->credentials = $credentials;
		}

		public function isAuthenticationEnabled() {
			return !empty($this->credentials);
		}

		/**
		 * @param string $url
		 * @return string
		 */
		public function signDownloadUrl($url) {
			return $url;
		}

		/**
		 * @param string $filterName
		 */
		public function setHttpFilterName($filterName) {
			$this->httpFilterName = $filterName;
		}

		/**
		 * @param string $filterName
		 */
		public function setStrategyFilterName($filterName) {
			$this->strategyFilterName = $filterName;
		}

		/**
		 * @param string $directory
		 */
		public function setLocalDirectory($directory) {
			if ( empty($directory) || !is_dir($directory) || ($directory === '.') ) {
				$this->localDirectory = null;
			} else {
				$this->localDirectory = $directory;
			}
		}

		/**
		 * @param string $slug
		 */
		public function setSlug($slug) {
			$this->slug = $slug;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Vcs\BaseChecker.php (576 bytes, 30 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

if ( !interface_exists(BaseChecker::class, false) ):

	interface BaseChecker {
		/**
		 * Set the repository branch to use for updates. Defaults to 'master'.
		 *
		 * @param string $branch
		 * @return $this
		 */
		public function setBranch($branch);

		/**
		 * Set authentication credentials.
		 *
		 * @param array|string $credentials
		 * @return $this
		 */
		public function setAuthentication($credentials);

		/**
		 * @return Api
		 */
		public function getVcsApi();
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Vcs\BitBucketApi.php (7626 bytes, 273 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

use YahnisElsts\PluginUpdateChecker\v5p6\OAuthSignature;
use YahnisElsts\PluginUpdateChecker\v5p6\Utils;

if ( !class_exists(BitBucketApi::class, false) ):

	class BitBucketApi extends Api {
		/**
		 * @var OAuthSignature
		 */
		private $oauth = null;

		/**
		 * @var string
		 */
		private $username;

		/**
		 * @var string
		 */
		private $repository;

		public function __construct($repositoryUrl, $credentials = array()) {
			$path = wp_parse_url($repositoryUrl, PHP_URL_PATH);
			if ( preg_match('@^/?(?P<username>[^/]+?)/(?P<repository>[^/#?&]+?)/?$@', $path, $matches) ) {
				$this->username = $matches['username'];
				$this->repository = $matches['repository'];
			} else {
				throw new \InvalidArgumentException('Invalid BitBucket repository URL: "' . $repositoryUrl . '"');
			}

			parent::__construct($repositoryUrl, $credentials);
		}

		protected function getUpdateDetectionStrategies($configBranch) {
			$strategies = array(
				self::STRATEGY_STABLE_TAG => function () use ($configBranch) {
					return $this->getStableTag($configBranch);
				},
			);

			if ( ($configBranch === 'master' || $configBranch === 'main') ) {
				$strategies[self::STRATEGY_LATEST_TAG] = array($this, 'getLatestTag');
			}

			$strategies[self::STRATEGY_BRANCH] = function () use ($configBranch) {
				return $this->getBranch($configBranch);
			};
			return $strategies;
		}

		public function getBranch($branchName) {
			$branch = $this->api('/refs/branches/' . $branchName);
			if ( is_wp_error($branch) || empty($branch) ) {
				return null;
			}

			//The "/src/{stuff}/{path}" endpoint doesn't seem to handle branch names that contain slashes.
			//If we don't encode the slash, we get a 404. If we encode it as "%2F", we get a 401.
			//To avoid issues, if the branch name is not URL-safe, let's use the commit hash instead.
			$ref = $branch->name;
			if ((urlencode($ref) !== $ref) && isset($branch->target->hash)) {
				$ref = $branch->target->hash;
			}

			return new Reference(array(
				'name' => $ref,
				'updated' => $branch->target->date,
				'downloadUrl' => $this->getDownloadUrl($branch->name),
			));
		}

		/**
		 * Get a specific tag.
		 *
		 * @param string $tagName
		 * @return Reference|null
		 */
		public function getTag($tagName) {
			$tag = $this->api('/refs/tags/' . $tagName);
			if ( is_wp_error($tag) || empty($tag) ) {
				return null;
			}

			return new Reference(array(
				'name' => $tag->name,
				'version' => ltrim($tag->name, 'v'),
				'updated' => $tag->target->date,
				'downloadUrl' => $this->getDownloadUrl($tag->name),
			));
		}

		/**
		 * Get the tag that looks like the highest version number.
		 *
		 * @return Reference|null
		 */
		public function getLatestTag() {
			$tags = $this->api('/refs/tags?sort=-target.date');
			if ( !isset($tags, $tags->values) || !is_array($tags->values) ) {
				return null;
			}

			//Filter and sort the list of tags.
			$versionTags = $this->sortTagsByVersion($tags->values);

			//Return the first result.
			if ( !empty($versionTags) ) {
				$tag = $versionTags[0];
				return new Reference(array(
					'name' => $tag->name,
					'version' => ltrim($tag->name, 'v'),
					'updated' => $tag->target->date,
					'downloadUrl' => $this->getDownloadUrl($tag->name),
				));
			}
			return null;
		}

		/**
		 * Get the tag/ref specified by the "Stable tag" header in the readme.txt of a given branch.
		 *
		 * @param string $branch
		 * @return null|Reference
		 */
		protected function getStableTag($branch) {
			$remoteReadme = $this->getRemoteReadme($branch);
			if ( !empty($remoteReadme['stable_tag']) ) {
				$tag = $remoteReadme['stable_tag'];

				//You can explicitly opt out of using tags by setting "Stable tag" to
				//"trunk" or the name of the current branch.
				if ( ($tag === $branch) || ($tag === 'trunk') ) {
					return $this->getBranch($branch);
				}

				return $this->getTag($tag);
			}

			return null;
		}

		/**
		 * @param string $ref
		 * @return string
		 */
		protected function getDownloadUrl($ref) {
			return sprintf(
				'https://bitbucket.org/%s/%s/get/%s.zip',
				$this->username,
				$this->repository,
				$ref
			);
		}

		/**
		 * Get the contents of a file from a specific branch or tag.
		 *
		 * @param string $path File name.
		 * @param string $ref
		 * @return null|string Either the contents of the file, or null if the file doesn't exist or there's an error.
		 */
		public function getRemoteFile($path, $ref = 'master') {
			$response = $this->api('src/' . $ref . '/' . ltrim($path));
			if ( is_wp_error($response) || !is_string($response) ) {
				return null;
			}
			return $response;
		}

		/**
		 * Get the timestamp of the latest commit that changed the specified branch or tag.
		 *
		 * @param string $ref Reference name (e.g. branch or tag).
		 * @return string|null
		 */
		public function getLatestCommitTime($ref) {
			$response = $this->api('commits/' . $ref);
			if ( isset($response->values, $response->values[0], $response->values[0]->date) ) {
				return $response->values[0]->date;
			}
			return null;
		}

		/**
		 * Perform a BitBucket API 2.0 request.
		 *
		 * @param string $url
		 * @param string $version
		 * @return mixed|\WP_Error
		 */
		public function api($url, $version = '2.0') {
			$url = ltrim($url, '/');
			$isSrcResource = Utils::startsWith($url, 'src/');

			$url = implode('/', array(
				'https://api.bitbucket.org',
				$version,
				'repositories',
				$this->username,
				$this->repository,
				$url
			));
			$baseUrl = $url;

			if ( $this->oauth ) {
				$url = $this->oauth->sign($url,'GET');
			}

			$options = array('timeout' => wp_doing_cron() ? 10 : 3);
			if ( !empty($this->httpFilterName) ) {
				$options = apply_filters($this->httpFilterName, $options);
			}
			$response = wp_remote_get($url, $options);
			if ( is_wp_error($response) ) {
				do_action('puc_api_error', $response, null, $url, $this->slug);
				return $response;
			}

			$code = wp_remote_retrieve_response_code($response);
			$body = wp_remote_retrieve_body($response);
			if ( $code === 200 ) {
				if ( $isSrcResource ) {
					//Most responses are JSON-encoded, but src resources just
					//return raw file contents.
					$document = $body;
				} else {
					$document = json_decode($body);
				}
				return $document;
			}

			$error = new \WP_Error(
				'puc-bitbucket-http-error',
				sprintf('BitBucket API error. Base URL: "%s",  HTTP status code: %d.', $baseUrl, $code)
			);
			do_action('puc_api_error', $error, $response, $url, $this->slug);

			return $error;
		}

		/**
		 * @param array $credentials
		 */
		public function setAuthentication($credentials) {
			parent::setAuthentication($credentials);

			if ( !empty($credentials) && !empty($credentials['consumer_key']) ) {
				$this->oauth = new OAuthSignature(
					$credentials['consumer_key'],
					$credentials['consumer_secret']
				);
			} else {
				$this->oauth = null;
			}
		}

		public function signDownloadUrl($url) {
			//Add authentication data to download URLs. Since OAuth signatures incorporate
			//timestamps, we have to do this immediately before inserting the update. Otherwise,
			//authentication could fail due to a stale timestamp.
			if ( $this->oauth ) {
				$url = $this->oauth->sign($url);
			}
			return $url;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Vcs\GitHubApi.php (14207 bytes, 468 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

use Parsedown;

if ( !class_exists(GitHubApi::class, false) ):

	class GitHubApi extends Api {
		use ReleaseAssetSupport;
		use ReleaseFilteringFeature;

		/**
		 * @var string GitHub username.
		 */
		protected $userName;
		/**
		 * @var string GitHub repository name.
		 */
		protected $repositoryName;

		/**
		 * @var string Either a fully qualified repository URL, or just "user/repo-name".
		 */
		protected $repositoryUrl;

		/**
		 * @var string GitHub authentication token. Optional.
		 */
		protected $accessToken;

		/**
		 * @var bool
		 */
		private $downloadFilterAdded = false;

		public function __construct($repositoryUrl, $accessToken = null) {
			$path = wp_parse_url($repositoryUrl, PHP_URL_PATH);
			if ( preg_match('@^/?(?P<username>[^/]+?)/(?P<repository>[^/#?&]+?)/?$@', $path, $matches) ) {
				$this->userName = $matches['username'];
				$this->repositoryName = $matches['repository'];
			} else {
				throw new \InvalidArgumentException('Invalid GitHub repository URL: "' . $repositoryUrl . '"');
			}

			parent::__construct($repositoryUrl, $accessToken);
		}

		/**
		 * Get the latest release from GitHub.
		 *
		 * @return Reference|null
		 */
		public function getLatestRelease() {
			//The "latest release" endpoint returns one release and always skips pre-releases,
			//so we can only use it if that's compatible with the current filter settings.
			if (
				$this->shouldSkipPreReleases()
				&& (
					($this->releaseFilterMaxReleases === 1) || !$this->hasCustomReleaseFilter()
				)
			) {
				//Just get the latest release.
				$release = $this->api('/repos/:user/:repo/releases/latest');
				if ( is_wp_error($release) || !is_object($release) || !isset($release->tag_name) ) {
					return null;
				}
				$foundReleases = array($release);
			} else {
				//Get a list of the most recent releases.
				$foundReleases = $this->api(
					'/repos/:user/:repo/releases',
					array('per_page' => $this->releaseFilterMaxReleases)
				);
				if ( is_wp_error($foundReleases) || !is_array($foundReleases) ) {
					return null;
				}
			}

			foreach ($foundReleases as $release) {
				//Always skip drafts.
				if ( isset($release->draft) && !empty($release->draft) ) {
					continue;
				}

				//Skip pre-releases unless specifically included.
				if (
					$this->shouldSkipPreReleases()
					&& isset($release->prerelease)
					&& !empty($release->prerelease)
				) {
					continue;
				}

				$versionNumber = ltrim($release->tag_name, 'v'); //Remove the "v" prefix from "v1.2.3".

				//Custom release filtering.
				if ( !$this->matchesCustomReleaseFilter($versionNumber, $release) ) {
					continue;
				}

				$reference = new Reference(array(
					'name'        => $release->tag_name,
					'version'     => $versionNumber,
					'downloadUrl' => $release->zipball_url,
					'updated'     => $release->created_at,
					'apiResponse' => $release,
				));

				if ( isset($release->assets[0]) ) {
					$reference->downloadCount = $release->assets[0]->download_count;
				}

				if ( $this->releaseAssetsEnabled ) {
					//Use the first release asset that matches the specified regular expression.
					if ( isset($release->assets, $release->assets[0]) ) {
						$matchingAssets = array_values(array_filter($release->assets, array($this, 'matchesAssetFilter')));
					} else {
						$matchingAssets = array();
					}

					if ( !empty($matchingAssets) ) {
						if ( $this->isAuthenticationEnabled() ) {
							/**
							 * Keep in mind that we'll need to add an "Accept" header to download this asset.
							 *
							 * @see setUpdateDownloadHeaders()
							 */
							$reference->downloadUrl = $matchingAssets[0]->url;
						} else {
							//It seems that browser_download_url only works for public repositories.
							//Using an access_token doesn't help. Maybe OAuth would work?
							$reference->downloadUrl = $matchingAssets[0]->browser_download_url;
						}

						$reference->downloadCount = $matchingAssets[0]->download_count;
					} else if ( $this->releaseAssetPreference === Api::REQUIRE_RELEASE_ASSETS ) {
						//None of the assets match the filter, and we're not allowed
						//to fall back to the auto-generated source ZIP.
						return null;
					}
				}

				if ( !empty($release->body) ) {
					$reference->changelog = Parsedown::instance()->text($release->body);
				}

				return $reference;
			}

			return null;
		}

		/**
		 * Get the tag that looks like the highest version number.
		 *
		 * @return Reference|null
		 */
		public function getLatestTag() {
			$tags = $this->api('/repos/:user/:repo/tags');

			if ( is_wp_error($tags) || !is_array($tags) ) {
				return null;
			}

			$versionTags = $this->sortTagsByVersion($tags);
			if ( empty($versionTags) ) {
				return null;
			}

			$tag = $versionTags[0];
			return new Reference(array(
				'name'        => $tag->name,
				'version'     => ltrim($tag->name, 'v'),
				'downloadUrl' => $tag->zipball_url,
				'apiResponse' => $tag,
			));
		}

		/**
		 * Get a branch by name.
		 *
		 * @param string $branchName
		 * @return null|Reference
		 */
		public function getBranch($branchName) {
			$branch = $this->api('/repos/:user/:repo/branches/' . $branchName);
			if ( is_wp_error($branch) || empty($branch) ) {
				return null;
			}

			$reference = new Reference(array(
				'name'        => $branch->name,
				'downloadUrl' => $this->buildArchiveDownloadUrl($branch->name),
				'apiResponse' => $branch,
			));

			if ( isset($branch->commit, $branch->commit->commit, $branch->commit->commit->author->date) ) {
				$reference->updated = $branch->commit->commit->author->date;
			}

			return $reference;
		}

		/**
		 * Get the latest commit that changed the specified file.
		 *
		 * @param string $filename
		 * @param string $ref Reference name (e.g. branch or tag).
		 * @return \StdClass|null
		 */
		public function getLatestCommit($filename, $ref = 'master') {
			$commits = $this->api(
				'/repos/:user/:repo/commits',
				array(
					'path' => $filename,
					'sha'  => $ref,
				)
			);
			if ( !is_wp_error($commits) && isset($commits[0]) ) {
				return $commits[0];
			}
			return null;
		}

		/**
		 * Get the timestamp of the latest commit that changed the specified branch or tag.
		 *
		 * @param string $ref Reference name (e.g. branch or tag).
		 * @return string|null
		 */
		public function getLatestCommitTime($ref) {
			$commits = $this->api('/repos/:user/:repo/commits', array('sha' => $ref));
			if ( !is_wp_error($commits) && isset($commits[0]) ) {
				return $commits[0]->commit->author->date;
			}
			return null;
		}

		/**
		 * Perform a GitHub API request.
		 *
		 * @param string $url
		 * @param array $queryParams
		 * @return mixed|\WP_Error
		 */
		protected function api($url, $queryParams = array()) {
			$baseUrl = $url;
			$url = $this->buildApiUrl($url, $queryParams);

			$options = array('timeout' => wp_doing_cron() ? 10 : 3);
			if ( $this->isAuthenticationEnabled() ) {
				$options['headers'] = array('Authorization' => $this->getAuthorizationHeader());
			}

			if ( !empty($this->httpFilterName) ) {
				$options = apply_filters($this->httpFilterName, $options);
			}
			$response = wp_remote_get($url, $options);
			if ( is_wp_error($response) ) {
				do_action('puc_api_error', $response, null, $url, $this->slug);
				return $response;
			}

			$code = wp_remote_retrieve_response_code($response);
			$body = wp_remote_retrieve_body($response);
			if ( $code === 200 ) {
				$document = json_decode($body);
				return $document;
			}

			$error = new \WP_Error(
				'puc-github-http-error',
				sprintf('GitHub API error. Base URL: "%s",  HTTP status code: %d.', $baseUrl, $code)
			);
			do_action('puc_api_error', $error, $response, $url, $this->slug);

			return $error;
		}

		/**
		 * Build a fully qualified URL for an API request.
		 *
		 * @param string $url
		 * @param array $queryParams
		 * @return string
		 */
		protected function buildApiUrl($url, $queryParams) {
			$variables = array(
				'user' => $this->userName,
				'repo' => $this->repositoryName,
			);
			foreach ($variables as $name => $value) {
				$url = str_replace('/:' . $name, '/' . urlencode($value), $url);
			}
			$url = 'https://api.github.com' . $url;

			if ( !empty($queryParams) ) {
				$url = add_query_arg($queryParams, $url);
			}

			return $url;
		}

		/**
		 * Get the contents of a file from a specific branch or tag.
		 *
		 * @param string $path File name.
		 * @param string $ref
		 * @return null|string Either the contents of the file, or null if the file doesn't exist or there's an error.
		 */
		public function getRemoteFile($path, $ref = 'master') {
			$apiUrl = '/repos/:user/:repo/contents/' . $path;
			$response = $this->api($apiUrl, array('ref' => $ref));

			if ( is_wp_error($response) || !isset($response->content) || ($response->encoding !== 'base64') ) {
				return null;
			}
			return base64_decode($response->content);
		}

		/**
		 * Generate a URL to download a ZIP archive of the specified branch/tag/etc.
		 *
		 * @param string $ref
		 * @return string
		 */
		public function buildArchiveDownloadUrl($ref = 'master') {
			$url = sprintf(
				'https://api.github.com/repos/%1$s/%2$s/zipball/%3$s',
				urlencode($this->userName),
				urlencode($this->repositoryName),
				urlencode($ref)
			);
			return $url;
		}

		/**
		 * Get a specific tag.
		 *
		 * @param string $tagName
		 * @return void
		 */
		public function getTag($tagName) {
			//The current GitHub update checker doesn't use getTag, so I didn't bother to implement it.
			throw new \LogicException('The ' . __METHOD__ . ' method is not implemented and should not be used.');
		}

		public function setAuthentication($credentials) {
			parent::setAuthentication($credentials);
			$this->accessToken = is_string($credentials) ? $credentials : null;

			//Optimization: Instead of filtering all HTTP requests, let's do it only when
			//WordPress is about to download an update.
			add_filter('upgrader_pre_download', array($this, 'addHttpRequestFilter'), 10, 1); //WP 3.7+
		}

		protected function getUpdateDetectionStrategies($configBranch) {
			$strategies = array();

			if ( $configBranch === 'master' || $configBranch === 'main') {
				//Use the latest release.
				$strategies[self::STRATEGY_LATEST_RELEASE] = array($this, 'getLatestRelease');
				//Failing that, use the tag with the highest version number.
				$strategies[self::STRATEGY_LATEST_TAG] = array($this, 'getLatestTag');
			}

			//Alternatively, just use the branch itself.
			$strategies[self::STRATEGY_BRANCH] = function () use ($configBranch) {
				return $this->getBranch($configBranch);
			};

			return $strategies;
		}

		/**
		 * Get the unchanging part of a release asset URL. Used to identify download attempts.
		 *
		 * @return string
		 */
		protected function getAssetApiBaseUrl() {
			return sprintf(
				'//api.github.com/repos/%1$s/%2$s/releases/assets/',
				$this->userName,
				$this->repositoryName
			);
		}

		protected function getFilterableAssetName($releaseAsset) {
			if ( isset($releaseAsset->name) ) {
				return $releaseAsset->name;
			}
			return null;
		}

		/**
		 * @param bool $result
		 * @return bool
		 * @internal
		 */
		public function addHttpRequestFilter($result) {
			if ( !$this->downloadFilterAdded && $this->isAuthenticationEnabled() ) {
				//phpcs:ignore WordPressVIPMinimum.Hooks.RestrictedHooks.http_request_args -- The callback doesn't change the timeout.
				add_filter('http_request_args', array($this, 'setUpdateDownloadHeaders'), 10, 2);
				add_action('requests-requests.before_redirect', array($this, 'removeAuthHeaderFromRedirects'), 10, 4);
				$this->downloadFilterAdded = true;
			}
			return $result;
		}

		/**
		 * Set the HTTP headers that are necessary to download updates from private repositories.
		 *
		 * See GitHub docs:
		 *
		 * @link https://developer.github.com/v3/repos/releases/#get-a-single-release-asset
		 * @link https://developer.github.com/v3/auth/#basic-authentication
		 *
		 * @internal
		 * @param array $requestArgs
		 * @param string $url
		 * @return array
		 */
		public function setUpdateDownloadHeaders($requestArgs, $url = '') {
			//Is WordPress trying to download one of our release assets?
			if ( $this->releaseAssetsEnabled && (strpos($url, $this->getAssetApiBaseUrl()) !== false) ) {
				$requestArgs['headers']['Accept'] = 'application/octet-stream';
			}
			//Use Basic authentication, but only if the download is from our repository.
			$repoApiBaseUrl = $this->buildApiUrl('/repos/:user/:repo/', array());
			if ( $this->isAuthenticationEnabled() && (strpos($url, $repoApiBaseUrl)) === 0 ) {
				$requestArgs['headers']['Authorization'] = $this->getAuthorizationHeader();
			}
			return $requestArgs;
		}

		/**
		 * When following a redirect, the Requests library will automatically forward
		 * the authorization header to other hosts. We don't want that because it breaks
		 * AWS downloads and can leak authorization information.
		 *
		 * @param string $location
		 * @param array $headers
		 * @internal
		 */
		public function removeAuthHeaderFromRedirects(&$location, &$headers) {
			$repoApiBaseUrl = $this->buildApiUrl('/repos/:user/:repo/', array());
			if ( strpos($location, $repoApiBaseUrl) === 0 ) {
				return; //This request is going to GitHub, so it's fine.
			}
			//Remove the header.
			if ( isset($headers['Authorization']) ) {
				unset($headers['Authorization']);
			}
		}

		/**
		 * Generate the value of the "Authorization" header.
		 *
		 * @return string
		 */
		protected function getAuthorizationHeader() {
			return 'Basic ' . base64_encode($this->userName . ':' . $this->accessToken);
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Vcs\GitLabApi.php (12135 bytes, 415 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

if ( !class_exists(GitLabApi::class, false) ):

	class GitLabApi extends Api {
		use ReleaseAssetSupport;
		use ReleaseFilteringFeature;

		/**
		 * @var string GitLab username.
		 */
		protected $userName;

		/**
		 * @var string GitLab server host.
		 */
		protected $repositoryHost;

		/**
		 * @var string Protocol used by this GitLab server: "http" or "https".
		 */
		protected $repositoryProtocol = 'https';

		/**
		 * @var string GitLab repository name.
		 */
		protected $repositoryName;

		/**
		 * @var string GitLab authentication token. Optional.
		 */
		protected $accessToken;

		/**
		 * @deprecated
		 * @var bool No longer used.
		 */
		protected $releasePackageEnabled = false;

		public function __construct($repositoryUrl, $accessToken = null, $subgroup = null) {
			//Parse the repository host to support custom hosts.
			$port = wp_parse_url($repositoryUrl, PHP_URL_PORT);
			if ( !empty($port) ) {
				$port = ':' . $port;
			}
			$this->repositoryHost = wp_parse_url($repositoryUrl, PHP_URL_HOST) . $port;

			if ( $this->repositoryHost !== 'gitlab.com' ) {
				$this->repositoryProtocol = wp_parse_url($repositoryUrl, PHP_URL_SCHEME);
			}

			//Find the repository information
			$path = wp_parse_url($repositoryUrl, PHP_URL_PATH);
			if ( preg_match('@^/?(?P<username>[^/]+?)/(?P<repository>[^/#?&]+?)/?$@', $path, $matches) ) {
				$this->userName = $matches['username'];
				$this->repositoryName = $matches['repository'];
			} elseif ( ($this->repositoryHost === 'gitlab.com') ) {
				//This is probably a repository in a subgroup, e.g. "/organization/category/repo".
				$parts = explode('/', trim($path, '/'));
				if ( count($parts) < 3 ) {
					throw new \InvalidArgumentException('Invalid GitLab.com repository URL: "' . $repositoryUrl . '"');
				}
				$lastPart = array_pop($parts);
				$this->userName = implode('/', $parts);
				$this->repositoryName = $lastPart;
			} else {
				//There could be subgroups in the URL:  gitlab.domain.com/group/subgroup/subgroup2/repository
				if ( $subgroup !== null ) {
					$path = str_replace(trailingslashit($subgroup), '', $path);
				}

				//This is not a traditional url, it could be gitlab is in a deeper subdirectory.
				//Get the path segments.
				$segments = explode('/', untrailingslashit(ltrim($path, '/')));

				//We need at least /user-name/repository-name/
				if ( count($segments) < 2 ) {
					throw new \InvalidArgumentException('Invalid GitLab repository URL: "' . $repositoryUrl . '"');
				}

				//Get the username and repository name.
				$usernameRepo = array_splice($segments, -2, 2);
				$this->userName = $usernameRepo[0];
				$this->repositoryName = $usernameRepo[1];

				//Append the remaining segments to the host if there are segments left.
				if ( count($segments) > 0 ) {
					$this->repositoryHost = trailingslashit($this->repositoryHost) . implode('/', $segments);
				}

				//Add subgroups to username.
				if ( $subgroup !== null ) {
					$this->userName = $usernameRepo[0] . '/' . untrailingslashit($subgroup);
				}
			}

			parent::__construct($repositoryUrl, $accessToken);
		}

		/**
		 * Get the latest release from GitLab.
		 *
		 * @return Reference|null
		 */
		public function getLatestRelease() {
			$releases = $this->api('/:id/releases', array('per_page' => $this->releaseFilterMaxReleases));
			if ( is_wp_error($releases) || empty($releases) || !is_array($releases) ) {
				return null;
			}

			foreach ($releases as $release) {
				if (
					//Skip invalid/unsupported releases.
					!is_object($release)
					|| !isset($release->tag_name)
					//Skip upcoming releases.
					|| (
						!empty($release->upcoming_release)
						&& $this->shouldSkipPreReleases()
					)
				) {
					continue;
				}

				$versionNumber = ltrim($release->tag_name, 'v'); //Remove the "v" prefix from "v1.2.3".

				//Apply custom filters.
				if ( !$this->matchesCustomReleaseFilter($versionNumber, $release) ) {
					continue;
				}

				$downloadUrl = $this->findReleaseDownloadUrl($release);
				if ( empty($downloadUrl) ) {
					//The latest release doesn't have valid download URL.
					return null;
				}

				if ( !empty($this->accessToken) ) {
					$downloadUrl = add_query_arg('private_token', $this->accessToken, $downloadUrl);
				}

				return new Reference(array(
					'name'        => $release->tag_name,
					'version'     => $versionNumber,
					'downloadUrl' => $downloadUrl,
					'updated'     => $release->released_at,
					'apiResponse' => $release,
				));
			}

			return null;
		}

		/**
		 * @param object $release
		 * @return string|null
		 */
		protected function findReleaseDownloadUrl($release) {
			if ( $this->releaseAssetsEnabled ) {
				if ( isset($release->assets, $release->assets->links) ) {
					//Use the first asset link where the URL matches the filter.
					foreach ($release->assets->links as $link) {
						if ( $this->matchesAssetFilter($link) ) {
							return $link->url;
						}
					}
				}

				if ( $this->releaseAssetPreference === Api::REQUIRE_RELEASE_ASSETS ) {
					//Falling back to source archives is not allowed, so give up.
					return null;
				}
			}

			//Use the first source code archive that's in ZIP format.
			foreach ($release->assets->sources as $source) {
				if ( isset($source->format) && ($source->format === 'zip') ) {
					return $source->url;
				}
			}

			return null;
		}

		/**
		 * Get the tag that looks like the highest version number.
		 *
		 * @return Reference|null
		 */
		public function getLatestTag() {
			$tags = $this->api('/:id/repository/tags');
			if ( is_wp_error($tags) || empty($tags) || !is_array($tags) ) {
				return null;
			}

			$versionTags = $this->sortTagsByVersion($tags);
			if ( empty($versionTags) ) {
				return null;
			}

			$tag = $versionTags[0];
			return new Reference(array(
				'name'        => $tag->name,
				'version'     => ltrim($tag->name, 'v'),
				'downloadUrl' => $this->buildArchiveDownloadUrl($tag->name),
				'apiResponse' => $tag,
			));
		}

		/**
		 * Get a branch by name.
		 *
		 * @param string $branchName
		 * @return null|Reference
		 */
		public function getBranch($branchName) {
			$branch = $this->api('/:id/repository/branches/' . $branchName);
			if ( is_wp_error($branch) || empty($branch) ) {
				return null;
			}

			$reference = new Reference(array(
				'name'        => $branch->name,
				'downloadUrl' => $this->buildArchiveDownloadUrl($branch->name),
				'apiResponse' => $branch,
			));

			if ( isset($branch->commit, $branch->commit->committed_date) ) {
				$reference->updated = $branch->commit->committed_date;
			}

			return $reference;
		}

		/**
		 * Get the timestamp of the latest commit that changed the specified branch or tag.
		 *
		 * @param string $ref Reference name (e.g. branch or tag).
		 * @return string|null
		 */
		public function getLatestCommitTime($ref) {
			$commits = $this->api('/:id/repository/commits/', array('ref_name' => $ref));
			if ( is_wp_error($commits) || !is_array($commits) || !isset($commits[0]) ) {
				return null;
			}

			return $commits[0]->committed_date;
		}

		/**
		 * Perform a GitLab API request.
		 *
		 * @param string $url
		 * @param array $queryParams
		 * @return mixed|\WP_Error
		 */
		protected function api($url, $queryParams = array()) {
			$baseUrl = $url;
			$url = $this->buildApiUrl($url, $queryParams);

			$options = array('timeout' => wp_doing_cron() ? 10 : 3);
			if ( !empty($this->httpFilterName) ) {
				$options = apply_filters($this->httpFilterName, $options);
			}

			$response = wp_remote_get($url, $options);
			if ( is_wp_error($response) ) {
				do_action('puc_api_error', $response, null, $url, $this->slug);
				return $response;
			}

			$code = wp_remote_retrieve_response_code($response);
			$body = wp_remote_retrieve_body($response);
			if ( $code === 200 ) {
				return json_decode($body);
			}

			$error = new \WP_Error(
				'puc-gitlab-http-error',
				sprintf('GitLab API error. URL: "%s",  HTTP status code: %d.', $baseUrl, $code)
			);
			do_action('puc_api_error', $error, $response, $url, $this->slug);

			return $error;
		}

		/**
		 * Build a fully qualified URL for an API request.
		 *
		 * @param string $url
		 * @param array $queryParams
		 * @return string
		 */
		protected function buildApiUrl($url, $queryParams) {
			$variables = array(
				'user' => $this->userName,
				'repo' => $this->repositoryName,
				'id'   => $this->userName . '/' . $this->repositoryName,
			);

			foreach ($variables as $name => $value) {
				$url = str_replace("/:{$name}", '/' . urlencode($value), $url);
			}

			$url = substr($url, 1);
			$url = sprintf('%1$s://%2$s/api/v4/projects/%3$s', $this->repositoryProtocol, $this->repositoryHost, $url);

			if ( !empty($this->accessToken) ) {
				$queryParams['private_token'] = $this->accessToken;
			}

			if ( !empty($queryParams) ) {
				$url = add_query_arg($queryParams, $url);
			}

			return $url;
		}

		/**
		 * Get the contents of a file from a specific branch or tag.
		 *
		 * @param string $path File name.
		 * @param string $ref
		 * @return null|string Either the contents of the file, or null if the file doesn't exist or there's an error.
		 */
		public function getRemoteFile($path, $ref = 'master') {
			$response = $this->api('/:id/repository/files/' . $path, array('ref' => $ref));
			if ( is_wp_error($response) || !isset($response->content) || $response->encoding !== 'base64' ) {
				return null;
			}

			return base64_decode($response->content);
		}

		/**
		 * Generate a URL to download a ZIP archive of the specified branch/tag/etc.
		 *
		 * @param string $ref
		 * @return string
		 */
		public function buildArchiveDownloadUrl($ref = 'master') {
			$url = sprintf(
				'%1$s://%2$s/api/v4/projects/%3$s/repository/archive.zip',
				$this->repositoryProtocol,
				$this->repositoryHost,
				urlencode($this->userName . '/' . $this->repositoryName)
			);
			$url = add_query_arg('sha', urlencode($ref), $url);

			if ( !empty($this->accessToken) ) {
				$url = add_query_arg('private_token', $this->accessToken, $url);
			}

			return $url;
		}

		/**
		 * Get a specific tag.
		 *
		 * @param string $tagName
		 * @return void
		 */
		public function getTag($tagName) {
			throw new \LogicException('The ' . __METHOD__ . ' method is not implemented and should not be used.');
		}

		protected function getUpdateDetectionStrategies($configBranch) {
			$strategies = array();

			if ( ($configBranch === 'main') || ($configBranch === 'master') ) {
				$strategies[self::STRATEGY_LATEST_RELEASE] = array($this, 'getLatestRelease');
				$strategies[self::STRATEGY_LATEST_TAG] = array($this, 'getLatestTag');
			}

			$strategies[self::STRATEGY_BRANCH] = function () use ($configBranch) {
				return $this->getBranch($configBranch);
			};

			return $strategies;
		}

		public function setAuthentication($credentials) {
			parent::setAuthentication($credentials);
			$this->accessToken = is_string($credentials) ? $credentials : null;
		}

		/**
		 * Use release assets that link to GitLab generic packages (e.g. .zip files)
		 * instead of automatically generated source archives.
		 *
		 * This is included for backwards compatibility with older versions of PUC.
		 *
		 * @return void
		 * @deprecated   Use enableReleaseAssets() instead.
		 * @noinspection PhpUnused -- Public API
		 */
		public function enableReleasePackages() {
			$this->enableReleaseAssets(
			/** @lang RegExp */ '/\.zip($|[?&#])/i',
				Api::REQUIRE_RELEASE_ASSETS
			);
		}

		protected function getFilterableAssetName($releaseAsset) {
			if ( isset($releaseAsset->url) ) {
				return $releaseAsset->url;
			}
			return null;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Vcs\PluginUpdateChecker.php (9381 bytes, 276 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

use YahnisElsts\PluginUpdateChecker\v5p6\Plugin;

if ( !class_exists(PluginUpdateChecker::class, false) ):

	class PluginUpdateChecker extends Plugin\UpdateChecker implements BaseChecker {
		use VcsCheckerMethods;

		/**
		 * PluginUpdateChecker constructor.
		 *
		 * @param Api $api
		 * @param string $pluginFile
		 * @param string $slug
		 * @param int $checkPeriod
		 * @param string $optionName
		 * @param string $muPluginFile
		 */
		public function __construct($api, $pluginFile, $slug = '', $checkPeriod = 12, $optionName = '', $muPluginFile = '') {
			$this->api = $api;

			parent::__construct($api->getRepositoryUrl(), $pluginFile, $slug, $checkPeriod, $optionName, $muPluginFile);

			$this->api->setHttpFilterName($this->getUniqueName('request_info_options'));
			$this->api->setStrategyFilterName($this->getUniqueName('vcs_update_detection_strategies'));
			$this->api->setSlug($this->slug);
		}

		public function requestInfo($unusedParameter = null) {
			//We have to make several remote API requests to gather all the necessary info
			//which can take a while on slow networks.
			if ( function_exists('set_time_limit') ) {
				@set_time_limit(60);
			}

			$api = $this->api;
			$api->setLocalDirectory($this->package->getAbsoluteDirectoryPath());

			$info = new Plugin\PluginInfo();
			$info->filename = $this->pluginFile;
			$info->slug = $this->slug;

			$this->setInfoFromHeader($this->package->getPluginHeader(), $info);
			$this->setIconsFromLocalAssets($info);
			$this->setBannersFromLocalAssets($info);

			//Pick a branch or tag.
			$updateSource = $api->chooseReference($this->branch);
			if ( $updateSource ) {
				$ref = $updateSource->name;
				$info->version = $updateSource->version;
				$info->last_updated = $updateSource->updated;
				$info->download_url = $updateSource->downloadUrl;

				if ( !empty($updateSource->changelog) ) {
					$info->sections['changelog'] = $updateSource->changelog;
				}
				if ( isset($updateSource->downloadCount) ) {
					$info->downloaded = $updateSource->downloadCount;
				}
			} else {
				//There's probably a network problem or an authentication error.
				do_action(
					'puc_api_error',
					new \WP_Error(
						'puc-no-update-source',
						'Could not retrieve version information from the repository. '
						. 'This usually means that the update checker either can\'t connect '
						. 'to the repository or it\'s configured incorrectly.'
					),
					null, null, $this->slug
				);
				return null;
			}

			//Get headers from the main plugin file in this branch/tag. Its "Version" header and other metadata
			//are what the WordPress install will actually see after upgrading, so they take precedence over releases/tags.
			$mainPluginFile = basename($this->pluginFile);
			$remotePlugin = $api->getRemoteFile($mainPluginFile, $ref);
			if ( !empty($remotePlugin) ) {
				$remoteHeader = $this->package->getFileHeader($remotePlugin);
				$this->setInfoFromHeader($remoteHeader, $info);
			}

			//Sanity check: Reject updates that don't have a version number.
			//This can happen when we're using a branch, and we either fail to retrieve the main plugin
			//file or the file doesn't have a "Version" header.
			if ( empty($info->version) ) {
				do_action(
					'puc_api_error',
					new \WP_Error(
						'puc-no-plugin-version',
						'Could not find the version number in the repository.'
					),
					null, null, $this->slug
				);
				return null;
			}

			//Try parsing readme.txt. If it's formatted according to WordPress.org standards, it will contain
			//a lot of useful information like the required/tested WP version, changelog, and so on.
			if ( $this->readmeTxtExistsLocally() ) {
				$this->setInfoFromRemoteReadme($ref, $info);
			}

			//The changelog might be in a separate file.
			if ( empty($info->sections['changelog']) ) {
				$info->sections['changelog'] = $api->getRemoteChangelog($ref, $this->package->getAbsoluteDirectoryPath());
				if ( empty($info->sections['changelog']) ) {
					$info->sections['changelog'] = __('There is no changelog available.', 'plugin-update-checker');
				}
			}

			if ( empty($info->last_updated) ) {
				//Fetch the latest commit that changed the tag or branch and use it as the "last_updated" date.
				$latestCommitTime = $api->getLatestCommitTime($ref);
				if ( $latestCommitTime !== null ) {
					$info->last_updated = $latestCommitTime;
				}
			}

			$info = apply_filters($this->getUniqueName('request_info_result'), $info, null);
			return $info;
		}

		/**
		 * Check if the currently installed version has a readme.txt file.
		 *
		 * @return bool
		 */
		protected function readmeTxtExistsLocally() {
			return $this->package->fileExists($this->api->getLocalReadmeName());
		}

		/**
		 * Copy plugin metadata from a file header to a Plugin Info object.
		 *
		 * @param array $fileHeader
		 * @param Plugin\PluginInfo $pluginInfo
		 */
		protected function setInfoFromHeader($fileHeader, $pluginInfo) {
			$headerToPropertyMap = array(
				'Version' => 'version',
				'Name' => 'name',
				'PluginURI' => 'homepage',
				'Author' => 'author',
				'AuthorName' => 'author',
				'AuthorURI' => 'author_homepage',

				'Requires WP' => 'requires',
				'Tested WP' => 'tested',
				'Requires at least' => 'requires',
				'Tested up to' => 'tested',

				'Requires PHP' => 'requires_php',
			);
			foreach ($headerToPropertyMap as $headerName => $property) {
				if ( isset($fileHeader[$headerName]) && !empty($fileHeader[$headerName]) ) {
					$pluginInfo->$property = $fileHeader[$headerName];
				}
			}

			if ( !empty($fileHeader['Description']) ) {
				$pluginInfo->sections['description'] = $fileHeader['Description'];
			}
		}

		/**
		 * Copy plugin metadata from the remote readme.txt file.
		 *
		 * @param string $ref GitHub tag or branch where to look for the readme.
		 * @param Plugin\PluginInfo $pluginInfo
		 */
		protected function setInfoFromRemoteReadme($ref, $pluginInfo) {
			$readme = $this->api->getRemoteReadme($ref);
			if ( empty($readme) ) {
				return;
			}

			if ( isset($readme['sections']) ) {
				$pluginInfo->sections = array_merge($pluginInfo->sections, $readme['sections']);
			}
			if ( !empty($readme['tested_up_to']) ) {
				$pluginInfo->tested = $readme['tested_up_to'];
			}
			if ( !empty($readme['requires_at_least']) ) {
				$pluginInfo->requires = $readme['requires_at_least'];
			}
			if ( !empty($readme['requires_php']) ) {
				$pluginInfo->requires_php = $readme['requires_php'];
			}

			if ( isset($readme['upgrade_notice'], $readme['upgrade_notice'][$pluginInfo->version]) ) {
				$pluginInfo->upgrade_notice = $readme['upgrade_notice'][$pluginInfo->version];
			}
		}

		/**
		 * Add icons from the currently installed version to a Plugin Info object.
		 *
		 * The icons should be in a subdirectory named "assets". Supported image formats
		 * and file names are described here:
		 * @link https://developer.wordpress.org/plugins/wordpress-org/plugin-assets/#plugin-icons
		 *
		 * @param Plugin\PluginInfo $pluginInfo
		 */
		protected function setIconsFromLocalAssets($pluginInfo) {
			$icons = $this->getLocalAssetUrls(array(
				'icon.svg'         => 'svg',
				'icon-256x256.png' => '2x',
				'icon-256x256.jpg' => '2x',
				'icon-128x128.png' => '1x',
				'icon-128x128.jpg' => '1x',
			));

			if ( !empty($icons) ) {
				//The "default" key seems to be used only as last-resort fallback in WP core (5.8/5.9),
				//but we'll set it anyway in case some code somewhere needs it.
				reset($icons);
				$firstKey = key($icons);
				$icons['default'] = $icons[$firstKey];

				$pluginInfo->icons = $icons;
			}
		}

		/**
		 * Add banners from the currently installed version to a Plugin Info object.
		 *
		 * The banners should be in a subdirectory named "assets". Supported image formats
		 * and file names are described here:
		 * @link https://developer.wordpress.org/plugins/wordpress-org/plugin-assets/#plugin-headers
		 *
		 * @param Plugin\PluginInfo $pluginInfo
		 */
		protected function setBannersFromLocalAssets($pluginInfo) {
			$banners = $this->getLocalAssetUrls(array(
				'banner-772x250.png' => 'high',
				'banner-772x250.jpg' => 'high',
				'banner-1544x500.png' => 'low',
				'banner-1544x500.jpg' => 'low',
			));

			if ( !empty($banners) ) {
				$pluginInfo->banners = $banners;
			}
		}

		/**
		 * @param array<string, string> $filesToKeys
		 * @return array<string, string>
		 */
		protected function getLocalAssetUrls($filesToKeys) {
			$assetDirectory = $this->package->getAbsoluteDirectoryPath() . DIRECTORY_SEPARATOR . 'assets';
			if ( !is_dir($assetDirectory) ) {
				return array();
			}
			$assetBaseUrl = trailingslashit(plugins_url('', $assetDirectory . '/imaginary.file'));

			$foundAssets = array();
			foreach ($filesToKeys as $fileName => $key) {
				$fullBannerPath = $assetDirectory . DIRECTORY_SEPARATOR . $fileName;
				if ( !isset($icons[$key]) && is_file($fullBannerPath) ) {
					$foundAssets[$key] = $assetBaseUrl . $fileName;
				}
			}

			return $foundAssets;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Vcs\Reference.php (1173 bytes, 52 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

if ( !class_exists(Reference::class, false) ):

	/**
	 * This class represents a VCS branch or tag. It's intended as a read only, short-lived container
	 * that only exists to provide a limited degree of type checking.
	 *
	 * @property string $name
	 * @property string|null version
	 * @property string $downloadUrl
	 * @property string $updated
	 *
	 * @property string|null $changelog
	 * @property int|null $downloadCount
	 */
	class Reference {
		private $properties = array();

		public function __construct($properties = array()) {
			$this->properties = $properties;
		}

		/**
		 * @param string $name
		 * @return mixed|null
		 */
		public function __get($name) {
			return array_key_exists($name, $this->properties) ? $this->properties[$name] : null;
		}

		/**
		 * @param string $name
		 * @param mixed $value
		 */
		public function __set($name, $value) {
			$this->properties[$name] = $value;
		}

		/**
		 * @param string $name
		 * @return bool
		 */
		public function __isset($name) {
			return isset($this->properties[$name]);
		}

	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Vcs\ReleaseAssetSupport.php (2465 bytes, 83 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

if ( !trait_exists(ReleaseAssetSupport::class, false) ) :

	trait ReleaseAssetSupport {
		/**
		 * @var bool Whether to download release assets instead of the auto-generated
		 *           source code archives.
		 */
		protected $releaseAssetsEnabled = false;

		/**
		 * @var string|null Regular expression that's used to filter release assets
		 *                  by file name or URL. Optional.
		 */
		protected $assetFilterRegex = null;

		/**
		 * How to handle releases that don't have any matching release assets.
		 *
		 * @var int
		 */
		protected $releaseAssetPreference = Api::PREFER_RELEASE_ASSETS;

		/**
		 * Enable updating via release assets.
		 *
		 * If the latest release contains no usable assets, the update checker
		 * will fall back to using the automatically generated ZIP archive.
		 *
		 * @param string|null $nameRegex Optional. Use only those assets where
		 *                               the file name or URL matches this regex.
		 * @param int $preference Optional. How to handle releases that don't have
		 *                        any matching release assets.
		 */
		public function enableReleaseAssets($nameRegex = null, $preference = Api::PREFER_RELEASE_ASSETS) {
			$this->releaseAssetsEnabled = true;
			$this->assetFilterRegex = $nameRegex;
			$this->releaseAssetPreference = $preference;
		}

		/**
		 * Disable release assets.
		 *
		 * @return void
		 * @noinspection PhpUnused -- Public API
		 */
		public function disableReleaseAssets() {
			$this->releaseAssetsEnabled = false;
			$this->assetFilterRegex = null;
		}

		/**
		 * Does the specified asset match the name regex?
		 *
		 * @param mixed $releaseAsset Data type and structure depend on the host/API.
		 * @return bool
		 */
		protected function matchesAssetFilter($releaseAsset) {
			if ( $this->assetFilterRegex === null ) {
				//The default is to accept all assets.
				return true;
			}

			$name = $this->getFilterableAssetName($releaseAsset);
			if ( !is_string($name) ) {
				return false;
			}
			return (bool)preg_match($this->assetFilterRegex, $releaseAsset->name);
		}

		/**
		 * Get the part of asset data that will be checked against the filter regex.
		 *
		 * @param mixed $releaseAsset
		 * @return string|null
		 */
		abstract protected function getFilterableAssetName($releaseAsset);
	}

endif;
`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Vcs\ReleaseFilteringFeature.php (3287 bytes, 108 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

if ( !trait_exists(ReleaseFilteringFeature::class, false) ) :

	trait ReleaseFilteringFeature {
		/**
		 * @var callable|null
		 */
		protected $releaseFilterCallback = null;
		/**
		 * @var int
		 */
		protected $releaseFilterMaxReleases = 1;
		/**
		 * @var string One of the Api::RELEASE_FILTER_* constants.
		 */
		protected $releaseFilterByType = Api::RELEASE_FILTER_SKIP_PRERELEASE;

		/**
		 * Set a custom release filter.
		 *
		 * Setting a new filter will override the old filter, if any.
		 *
		 * @param callable $callback A callback that accepts a version number and a release
		 *                           object, and returns a boolean.
		 * @param int $releaseTypes  One of the Api::RELEASE_FILTER_* constants.
		 * @param int $maxReleases   Optional. The maximum number of recent releases to examine
		 *                           when trying to find a release that matches the filter. 1 to 100.
		 * @return $this
		 */
		public function setReleaseFilter(
			$callback,
			$releaseTypes = Api::RELEASE_FILTER_SKIP_PRERELEASE,
			$maxReleases = 20
		) {
			if ( $maxReleases > 100 ) {
				throw new \InvalidArgumentException(sprintf(
					'The max number of releases is too high (%d). It must be 100 or less.',
					$maxReleases
				));
			} else if ( $maxReleases < 1 ) {
				throw new \InvalidArgumentException(sprintf(
					'The max number of releases is too low (%d). It must be at least 1.',
					$maxReleases
				));
			}

			$this->releaseFilterCallback = $callback;
			$this->releaseFilterByType = $releaseTypes;
			$this->releaseFilterMaxReleases = $maxReleases;
			return $this;
		}

		/**
		 * Filter releases by their version number.
		 *
		 * @param string $regex A regular expression. The release version number must match this regex.
		 * @param int $releaseTypes
		 * @param int $maxReleasesToExamine
		 * @return $this
		 * @noinspection PhpUnused -- Public API
		 */
		public function setReleaseVersionFilter(
			$regex,
			$releaseTypes = Api::RELEASE_FILTER_SKIP_PRERELEASE,
			$maxReleasesToExamine = 20
		) {
			return $this->setReleaseFilter(
				function ($versionNumber) use ($regex) {
					return (preg_match($regex, $versionNumber) === 1);
				},
				$releaseTypes,
				$maxReleasesToExamine
			);
		}

		/**
		 * @param string $versionNumber The detected release version number.
		 * @param object $releaseObject Varies depending on the host/API.
		 * @return bool
		 */
		protected function matchesCustomReleaseFilter($versionNumber, $releaseObject) {
			if ( !is_callable($this->releaseFilterCallback) ) {
				return true; //No custom filter.
			}
			return call_user_func($this->releaseFilterCallback, $versionNumber, $releaseObject);
		}

		/**
		 * @return bool
		 */
		protected function shouldSkipPreReleases() {
			//Maybe this could be a bitfield in the future, if we need to support
			//more release types.
			return ($this->releaseFilterByType !== Api::RELEASE_FILTER_ALL);
		}

		/**
		 * @return bool
		 */
		protected function hasCustomReleaseFilter() {
			return isset($this->releaseFilterCallback) && is_callable($this->releaseFilterCallback);
		}
	}

endif;
`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Vcs\ThemeUpdateChecker.php (2786 bytes, 84 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

use YahnisElsts\PluginUpdateChecker\v5p6\Theme;
use YahnisElsts\PluginUpdateChecker\v5p6\Utils;

if ( !class_exists(ThemeUpdateChecker::class, false) ):

	class ThemeUpdateChecker extends Theme\UpdateChecker implements BaseChecker {
		use VcsCheckerMethods;

		/**
		 * ThemeUpdateChecker constructor.
		 *
		 * @param Api $api
		 * @param null $stylesheet
		 * @param null $customSlug
		 * @param int $checkPeriod
		 * @param string $optionName
		 */
		public function __construct($api, $stylesheet = null, $customSlug = null, $checkPeriod = 12, $optionName = '') {
			$this->api = $api;

			parent::__construct($api->getRepositoryUrl(), $stylesheet, $customSlug, $checkPeriod, $optionName);

			$this->api->setHttpFilterName($this->getUniqueName('request_update_options'));
			$this->api->setStrategyFilterName($this->getUniqueName('vcs_update_detection_strategies'));
			$this->api->setSlug($this->slug);
		}

		public function requestUpdate() {
			$api = $this->api;
			$api->setLocalDirectory($this->package->getAbsoluteDirectoryPath());

			$update = new Theme\Update();
			$update->slug = $this->slug;

			//Figure out which reference (tag or branch) we'll use to get the latest version of the theme.
			$updateSource = $api->chooseReference($this->branch);
			if ( $updateSource ) {
				$ref = $updateSource->name;
				$update->download_url = $updateSource->downloadUrl;
			} else {
				do_action(
					'puc_api_error',
					new \WP_Error(
						'puc-no-update-source',
						'Could not retrieve version information from the repository. '
						. 'This usually means that the update checker either can\'t connect '
						. 'to the repository or it\'s configured incorrectly.'
					),
					null, null, $this->slug
				);
				$ref = $this->branch;
			}

			//Get headers from the main stylesheet in this branch/tag. Its "Version" header and other metadata
			//are what the WordPress install will actually see after upgrading, so they take precedence over releases/tags.
			$remoteHeader = $this->package->getFileHeader($api->getRemoteFile('style.css', $ref));
			$update->version = Utils::findNotEmpty(array(
				$remoteHeader['Version'],
				Utils::get($updateSource, 'version'),
			));

			//The details URL defaults to the Theme URI header or the repository URL.
			$update->details_url = Utils::findNotEmpty(array(
				$remoteHeader['ThemeURI'],
				$this->package->getHeaderValue('ThemeURI'),
				$this->metadataUrl,
			));

			if ( empty($update->version) ) {
				//It looks like we didn't find a valid update after all.
				$update = null;
			}

			$update = $this->filterUpdateResult($update);
			return $update;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Vcs\VcsCheckerMethods.php (1344 bytes, 59 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

if ( !trait_exists(VcsCheckerMethods::class, false) ) :

	trait VcsCheckerMethods {
		/**
		 * @var string The branch where to look for updates. Defaults to "master".
		 */
		protected $branch = 'master';

		/**
		 * @var Api Repository API client.
		 */
		protected $api = null;

		public function setBranch($branch) {
			$this->branch = $branch;
			return $this;
		}

		/**
		 * Set authentication credentials.
		 *
		 * @param array|string $credentials
		 * @return $this
		 */
		public function setAuthentication($credentials) {
			$this->api->setAuthentication($credentials);
			return $this;
		}

		/**
		 * @return Api
		 */
		public function getVcsApi() {
			return $this->api;
		}

		public function getUpdate() {
			$update = parent::getUpdate();

			if ( isset($update) && !empty($update->download_url) ) {
				$update->download_url = $this->api->signDownloadUrl($update->download_url);
			}

			return $update;
		}

		public function onDisplayConfiguration($panel) {
			parent::onDisplayConfiguration($panel);
			$panel->row('Branch', $this->branch);
			$panel->row('Authentication enabled', $this->api->isAuthenticationEnabled() ? 'Yes' : 'No');
			$panel->row('API client', get_class($this->api));
		}
	}

endif;
`$nl

`$nl
===== FILE: pack-code.ps1 (4063 bytes, 113 lines) =====
`$ext
param(
  [string]$Root = ".",
  [string]$Out = "codepack.txt",
  [string]$IncludeExt = ".php,.js,.ts,.css,.scss,.html,.htm,.json,.md,.yml,.yaml,.xml,.sh,.ps1,.ini,.txt,.sql,.twig,.vue",
  # 제외할 디렉터리들 (쉼표로 구분)
  [string]$ExcludeDirs = "node_modules,dist,build,vendor,.git,.github,.idea,.vscode,.next,.cache,growth-checklist\plugin-update-checker",
  # 제외할 파일 패턴들 (쉼표로 구분)
  [string]$ExcludeFiles = "*.min.js,*.min.css,*.map,*.lock,*.zip,*.tar,*.gz,*.png,*.jpg,*.jpeg,*.gif,*.webp,*.svg,*.woff,*.woff2,*.ttf,*.eot,*.pdf",
  # 용량 한도
  [int]$MaxFileBytes = 1000000,    # 파일당 최대 1MB
  [int]$MaxTotalBytes = 20000000,  # 전체 최대 20MB
  # 변경 파일만 모드
  [switch]$ChangedOnly,
  [string]$GitRange = ""
)

$ErrorActionPreference = "Stop"
$Root = (Resolve-Path $Root).Path
$include = $IncludeExt.Split(",") | ForEach-Object { $_.Trim().ToLower() } | Where-Object { $_ -ne "" }
$exDirs  = $ExcludeDirs.Split(",")  | ForEach-Object { $_.Trim() }        | Where-Object { $_ -ne "" }
$exFiles = $ExcludeFiles.Split(",") | ForEach-Object { $_.Trim() }        | Where-Object { $_ -ne "" }

function IsTextExt($path) {
  $ext = [IO.Path]::GetExtension($path).ToLower()
  return $include -contains $ext
}
function IsExcludedDir($path) {
  foreach ($d in $exDirs) {
    if ($path -like "*$d*") { return $true }
  }
  return $false
}
function IsExcludedFile($file) {
  foreach ($p in $exFiles) {
    if ([IO.Path]::GetFileName($file) -like $p) { return $true }
  }
  return $false
}

# 파일 목록 수집
$files = @()
if ($ChangedOnly) {
  $gitArgs = @("diff","--name-only")
  if ($GitRange) { $gitArgs += $GitRange }
  $changed = & git @gitArgs 2>$null
  foreach ($rel in $changed) {
    $p = Join-Path $Root $rel
    if (Test-Path $p -PathType Leaf) { $files += (Resolve-Path $p).Path }
  }
} else {
  $files = Get-ChildItem -Path $Root -Recurse -File | ForEach-Object { $_.FullName }
}

# 필터링
$files = $files | Where-Object {
  -not (IsExcludedDir $_) -and
  -not (IsExcludedFile $_) -and
  (IsTextExt $_)
}

# 출력 빌드
$sb = New-Object System.Text.StringBuilder
$totalBytes = 0
$nl = [Environment]::NewLine

# 상단 메타
try {
  $repoUrl = (git -C $Root config --get remote.origin.url)
  $branch  = (git -C $Root rev-parse --abbrev-ref HEAD)
  $tag     = (git -C $Root describe --tags --abbrev=0) 2>$null
  $commit  = (git -C $Root rev-parse --short HEAD)
  $time    = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
  $null = $sb.AppendLine("===== META =====")
  $null = $sb.AppendLine("Repo: $repoUrl")
  $null = $sb.AppendLine("Branch: $branch  |  Tag: $tag  |  Commit: $commit")
  $null = $sb.AppendLine("Generated: $time")
  $null = $sb.AppendLine("")
} catch {}

foreach ($f in $files) {
  try {
    $fi = Get-Item $f
    $size = $fi.Length
    if ($size -gt $MaxFileBytes) {
      $rel = $f.Substring($Root.Length+1)
      $null = $sb.AppendLine("===== FILE: $rel ($size bytes) SKIPPED: > $MaxFileBytes =====$nl")
      continue
    }
    if (($totalBytes + $size) -gt $MaxTotalBytes) {
      $null = $sb.AppendLine("===== STOP: total size would exceed $MaxTotalBytes bytes. Remaining files omitted. =====$nl")
      break
    }

    $rel = $f.Substring($Root.Length+1)
    $content = (Get-Content -Path $f -Raw -Encoding UTF8)
    $lineCount = ($content -split "`r?`n").Count
    $ext = [IO.Path]::GetExtension($f).TrimStart(".").ToLower()
    if (-not $ext) { $ext = "text" }

    $null = $sb.AppendLine("===== FILE: $rel ($size bytes, $lineCount lines) =====")
    $null = $sb.AppendLine("```$ext")
    $null = $sb.AppendLine($content)
    $null = $sb.AppendLine("```$nl")

    $totalBytes += $size
  } catch {
    $null = $sb.AppendLine("===== FILE: $f ERROR: $($_.Exception.Message) =====$nl")
  }
}

[IO.File]::WriteAllText((Join-Path $Root $Out), $sb.ToString(), [Text.Encoding]::UTF8)
"생성 완료: $(Join-Path $Root $Out)  (총 approx $totalBytes bytes)"

`$nl
===== FILE: berrywalk-feedback-acf\berrywalk-feedback-acf.php (2000 bytes, 50 lines) =====
`$ext
<?php
/**
 * Plugin Name: BW Owner Suite (light)
 * Description: 대표 질문지 + 회원가입(대표 전용) + 마이페이지. ACF 기반 경량 플러그인.
 * Version: 1.4.5
 * Author: Berrywalk
 */
if (!defined('ABSPATH')) exit;

define('BWOS_VER', '1.4.5');
define('BWOS_DIR', plugin_dir_path(__FILE__));
define('BWOS_URL', plugin_dir_url(__FILE__));

// GitHub 업데이트 확인 (admin에서만 동작)
if ( is_admin() ) {
  require_once BWOS_DIR.'lib/plugin-update-checker/plugin-update-checker.php';
  $bwos_uc = Puc_v4_Factory::buildUpdateChecker(
    'https://github.com/newcode4/berrywalk_Feedback', // 깃허브 저장소
    __FILE__,                                         // 이 플러그인 메인 파일
    'bw-owner-suite-acf'                              // 플러그인 슬러그(폴더명)
  );
  $bwos_uc->setBranch('main'); // 기본 브랜치가 main일 때
  // 릴리스 Asset(zip) 사용 시:
  $api = $bwos_uc->getVcsApi();
  if (method_exists($api, 'enableReleaseAssets')) {
    $api->enableReleaseAssets();
  }
}


// 텔레그램
define('BW_TG_BOT_TOKEN', '8060380419:AAFDlmr9TmX1K5Ocagl6WafN5s2O6oVnvdw');  // BotFather에서 발급
define('BW_TG_CHAT_ID',  '@berrywalk_ownerfeedback');                  // 개인(@me) 또는 채널/그룹 ID

require_once BWOS_DIR.'includes/cpt-admin.php';
require_once BWOS_DIR.'includes/form.php';
require_once BWOS_DIR.'includes/signup.php';
require_once BWOS_DIR.'includes/save.php';
require_once BWOS_DIR.'includes/view-list.php';
require_once BWOS_DIR.'includes/acf-fields.php'; // 관리자 ACF 메타박스(5문항)

add_action('wp_enqueue_scripts', function(){
  $css = BWOS_URL.'assets/owner-form.css';
  $js  = BWOS_URL.'assets/owner-form.js';
  wp_register_style ('bwos-form', $css, [], BWOS_VER);
  wp_register_style ('bwf-forms', $css, [], BWOS_VER); // alias
  wp_register_script('bwos-form', $js,  ['jquery'], BWOS_VER, true);
  wp_register_script('bwf-forms', $js,  ['jquery'], BWOS_VER, true); // alias
});

`$nl
===== FILE: berrywalk-feedback-acf\README.md (1409 bytes, 40 lines) =====
`$ext
# BW Owner Suite (ACF Minimal)

워드프레스 표준 + ACF만 사용하여
- 회원가입 → 프로필 수정
- 대표 질문(CPT) 작성/수정/보기/목록/복제/삭제
- 저장 알림(메일/텔레그램)

을 한 번에 처리하는 경량 플러그인입니다.

## 설치
1) `Advanced Custom Fields`(ACF) 플러그인을 활성화
2) 워드프레스 관리자 → 플러그인 → 새로 추가 → 플러그인 업로드 → 이 ZIP 업로드 후 활성화
3) 활성화 즉시 아래 페이지가 자동 생성됩니다.
   - `/owner-questions/` 작성
   - `/owner-edit/?id=글ID` 수정
   - `/my-question-view/?id=글ID` 보기
   - `/my-questions/` 내 저장본(보기/수정/복제/삭제)
   - `/my-profile/` 마이프로필
   - `/register/` 회원가입

## 텔레그램 알림(선택)
`wp-config.php`에 아래 상수를 추가하면 저장 시 텔레그램 알림이 전송됩니다.

```php
define('BWF_TG_BOT','123456:ABC...');       // 봇 토큰
define('BWF_TG_CHAT','-1001234567890');     // 채팅 ID
```

## 짧은코드(Shortcodes)
- [bw_register]
- [bw_profile_form]
- [bw_owner_form_acf]
- [bw_owner_edit id="123"]  (또는 /owner-edit/?id=123)
- [bwf_owner_view id="123"]
- [bw_my_questions]

## 주의
- 플러그인 동작을 위해 ACF가 필요합니다.
- 데이터는 CPT `bwf_owner_answer`에 저장되며 리비전이 활성화되어 되돌리기가 가능합니다.

`$nl
===== FILE: berrywalk-feedback-acf\assets\owner-form.css (5415 bytes, 109 lines) =====
`$ext
/* /assets/owner-form.css */

/* ====== Base ====== */
:root{
  --bw-font:17.5px;
  --bw-muted:#64748b;
  --bw-border:#e5e7eb;
  --bw-accent:#6366f1;
  --bw-ok:#16a34a;
  --bw-warn:#ef4444;
  --bw-bg:#f8fafc;
}
body{font-size:var(--bw-font);background:var(--bw-bg)}
.bwos-wrap{max-width:920px;margin:40px auto;padding:0 16px}               /* ⬆ 여백 확대 */
.bwf-title{font-size:30px;line-height:1.25;margin:22px 0 16px}
.bwf-help{color:#0f172a;margin:0 0 18px}

/* ====== Sticky progress (카드형, 배경/테두리 추가) ====== */
.bwos-progress{
  position:sticky;top:64px;z-index:1000;margin:0 0 18px;
  background:#ffffff; border:1px solid var(--bw-border); border-radius:14px;
  padding:12px 14px; box-shadow:0 6px 18px rgba(2,6,23,.06);
}
body.admin-bar .bwos-progress{top:96px}
.bwos-progress .bar{height:10px;background:#f2f4f7;border-radius:999px;overflow:hidden}
.bwos-progress .bar>span{display:block;height:100%;width:0%;background:linear-gradient(90deg,#22d3ee,#6366f1);border-radius:999px;transition:width .2s}
.bwos-progress .status{font-size:12px;color:#334155;margin-top:8px}

/* ====== Field ====== */
.bwf-field{margin:28px 0}                                                  /* ⬆ 여백 확대 */
.bwf-field label{display:block;font-weight:700;margin:0 0 14px;font-size:18px}
.bwf-field textarea,
.bwf-field input[type="text"],
.bwf-field input[type="number"],
.bwf-field input[type="email"],
.bwf-field input[type="tel"],
.bwf-field input[type="url"],
.bwf-field select{
  width:100%;box-sizing:border-box;padding:13px 14px;border:1px solid #d1d5db;border-radius:12px;background:#fff;font-size:16.5px;outline:none
}
.bwf-field textarea:focus,
.bwf-field input:focus,
.bwf-field select:focus{border-color:var(--bw-accent);box-shadow:0 0 0 3px rgba(99,102,241,.15)}

.bwos-field.bwos-error textarea,
.bwos-field.bwos-error input,
.bwos-field.bwos-error select{border-color:var(--bw-warn);background:#fff1f2}
.bwf-invalid{border-color:var(--bw-warn) !important;background:#fff1f2 !important}

/* ====== 설명/예시 – 한국형 카드 스타일 ====== */
.bwf-desc, .bwf-examples{
  margin:10px 0 10px;padding:12px 14px;border:1px dashed #dbe1ea;border-radius:12px;background:#fbfdff
}
.bwf-desc::before{
  content:"설명"; display:inline-block; font-size:12px; font-weight:800; color:#0ea5e9;
  background:#e6f6fb; border:1px solid #bde7f4; border-radius:999px; padding:2px 8px; margin-right:8px
}
.bwf-examples::before{
  content:"예시"; display:inline-block; font-size:12px; font-weight:800; color:#6366f1;
  background:#eef0ff; border:1px solid #dfe3ff; border-radius:999px; padding:2px 8px; margin-right:8px
}
.bwf-examples ul,.bwf-examples ol{margin:6px 0 0 18px}

/* ====== Counter ====== */
.bwos-count{
  display:inline-block;margin-top:8px;font-size:12px;font-weight:700;
  color:var(--bw-muted);background:#f3f4f6;border:1px solid #e5e7eb;border-radius:999px;padding:4px 8px
}
.bwos-count.ok{color:#065f46;background:#ecfdf5;border-color:#bbf7d0}
.bwos-count.need{color:#7c2d12;background:#fff7ed;border-color:#fed7aa}

/* ====== Buttons ====== */
.bwf-actions{display:flex;gap:10px;align-items:center;justify-content:center;margin-top:20px}
.bwf-btn{display:inline-block;padding:12px 18px;border-radius:14px;border:none;background:var(--bw-accent);color:#fff;text-decoration:none;font-weight:700}
.bwf-btn-secondary{display:inline-block;padding:12px 18px;border-radius:14px;border:1px solid #cbd5e1;background:#fff;color:#0f172a;text-decoration:none;font-weight:700}


/* ====== Modal (공용) ====== */
.bwos-modal, .bwf-modal{
  position:fixed;inset:0;display:none;align-items:flex-start;justify-content:center;padding-top:18vh;background:rgba(0,0,0,.45);z-index:100000
}
body.admin-bar .bwos-modal, body.admin-bar .bwf-modal{padding-top:calc(18vh + 32px)}
.bwos-modal.is-open, .bwf-modal.is-open{display:flex}
.bwos-modal-inner, .bwf-modal .bwf-modal__card{
  background:#fff;max-width:560px;width:92vw;padding:22px;border-radius:16px;box-shadow:0 22px 44px rgba(2,6,23,.18)
}
.bwos-modal-inner h4, .bwf-modal h3{margin:0 0 10px;font-size:18px}
.bwos-modal-inner p, .bwf-modal p{margin:0 0 12px;color:#334155}
.bwf-modal__list{margin:6px 0 0 18px;font-size:14px;color:#1f2937}

/* ====== List / View ====== */
.bwf-card{border:1px solid var(--bw-border);background:#fff;border-radius:12px;padding:12px 14px}

/* ====== Signup grid ====== */
.bwf-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px 14px}
.bwf-col-full{grid-column:1/-1}
@media (max-width:720px){.bwf-grid{grid-template-columns:1fr}}
.bwf-hidden{display:none}

/* 마이페이지 카드 & 페이지네이션 */
.bwos-list{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:16px}
@media (max-width:920px){.bwos-list{grid-template-columns:1fr}}
.bwos-card{border:1px solid #e5e7eb;border-radius:14px;padding:14px 16px;background:#fff;box-shadow:0 6px 14px rgba(2,6,23,.05)}
.bwos-card h4{margin:0 0 6px;font-size:17px}
.bwos-card .meta{font-size:12px;color:#64748b;margin-bottom:10px}
.bwos-card .row a{display:inline-block;padding:8px 12px;border-radius:10px;background:#f1f5f9;text-decoration:none;color:#0f172a}
.bwos-pg{margin:18px 0 8px;text-align:center}
.bwos-pg .page-numbers{display:inline-block;padding:8px 12px;border:1px solid #e5e7eb;border-radius:10px;margin:0 3px;text-decoration:none;color:#0f172a}
.bwos-pg .current{background:#6366f1;color:#fff;border-color:#6366f1}
`$nl
===== FILE: berrywalk-feedback-acf\assets\owner-form.js (4147 bytes, 94 lines) =====
`$ext
/* /assets/owner-form.js  (카운터 텍스트 – "몇자 남음" 친절 메시지로) */
(function($){
  if(!$ || !$('.bwos-form').length) return;

  const $form = $('.bwos-form').first();
  const $progress = $form.find('.bwos-progress');
  const reqs = []; let submitted=false;

  function updateProgress(){
    const total=reqs.length, done=reqs.filter(r=>r.valid()).length, pct=total?Math.round(done/total*100):0;
    $progress.find('.bar>span').css('width',pct+'%');
    $progress.find('.status').text('작성 '+done+'/'+total+' ('+pct+'%)');
  }

  function wire($wrap){
    const min = parseInt($wrap.data('min')||200,10);
    const $subs = $wrap.find('.bwf-sub textarea');
    const isGroup = $subs.length>0;
    let $cnt = $wrap.find('.bwos-count'); if(!$cnt.length) $cnt=$('<small class="bwos-count"></small>').appendTo($wrap);

    const setError = bad => $wrap.toggleClass('bwos-error', submitted && !!bad);
    const valid = ()=>{
      if(isGroup){ let ok=true; $subs.each(function(){ if(($(this).val()||'').trim()==='') ok=false; }); return ok; }
      return (($wrap.find('textarea,input[type="text"]').first().val()||'').trim().length >= min);
    };

    const update = ()=>{
      if(isGroup){
        let anyEmpty=false; $subs.each(function(){ if(($(this).val()||'').trim()==='') anyEmpty=true; });
        $cnt.text(anyEmpty ? '질문 3개 모두 작성' : '충족').toggleClass('need',anyEmpty).toggleClass('ok',!anyEmpty);
        setError(anyEmpty);
      }else{
        const v=($wrap.find('textarea,input[type="text"]').first().val()||'').trim();
        const diff = min - v.length;
        if(diff>0){ $cnt.text(diff+'자 남음'); $cnt.removeClass('ok').addClass('need'); }
        else      { $cnt.text('충족'); $cnt.removeClass('need').addClass('ok'); }
        setError(v.length < min);
      }
      updateProgress();
    };

    (isGroup ? $subs : $wrap.find('textarea,input[type="text"]').first()).on('input blur', update);
    reqs.push({wrap:$wrap, valid, update, min}); update();
  }

  $form.find('.bwos-required').each(function(){ wire($(this)); });
  updateProgress();

  const $modal=$('<div class="bwos-modal"><div class="bwos-modal-inner"><h4>입력이 필요한 항목이 있어요</h4><p>아래 항목을 확인해 주세요.</p><ul class="bwf-modal__list"></ul><button type="button" class="bwf-btn-secondary ok">확인</button></div></div>').appendTo('body');
  $modal.on('click','.ok',()=> $modal.removeClass('is-open'));

  let locked=false;
  $form.on('submit',function(e){
    submitted=true; let bad=false; const items=[];
    reqs.forEach(r=>{
      if(!r.valid()){
        bad=true; const lab=r.wrap.find('label').first().text().replace(/\*.*$/,'').trim();
        if(r.wrap.find('.bwf-sub').length){ items.push('· '+lab+' — 3개 질문 모두 작성'); }
        else{
          const len=($r=r.wrap.find('textarea,input[type="text"]').first()).val().trim().length;
          const diff=(r.min||200)-len; items.push('· '+lab+' — 최소 글자수 부족 ('+diff+'자 남음)');
        }
        r.update();
      }
    });
    if(bad){
      e.preventDefault();
      const ul=$modal.find('.bwf-modal__list').empty();
      items.forEach(t=> $('<li/>').text(t).appendTo(ul));
      $modal.addClass('is-open');
      const $first=$form.find('.bwos-error').first(); if($first.length) $('html,body').animate({scrollTop:$first.offset().top-120},180);
      return;
    }
    if(locked){ e.preventDefault(); return; }
    locked=true; $form.find('.bwos-submit').prop('disabled',true).text('저장 중…');
    setTimeout(()=>{ locked=false; $form.find('.bwos-submit').prop('disabled',false).text('저장'); }, 6000);
  });
})(jQuery);

/* === Tab 이동: textarea에서 Tab 누르면 다음 필드로 포커스 === */
(function($){
  const $areas = $('.bwos-form textarea:visible');
  $areas.on('keydown', function(e){
    if(e.key === 'Tab' && !e.shiftKey){
      const list = $('.bwos-form textarea:visible');
      const idx = list.index(this);
      if(idx > -1 && idx < list.length - 1){
        e.preventDefault();
        list.eq(idx + 1).focus();
      }
    }
  });
})(jQuery);

`$nl
===== FILE: berrywalk-feedback-acf\includes\acf-fields.php (3509 bytes, 76 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

add_action('acf/init', function(){
  if (!function_exists('acf_add_local_field_group')) return;

  acf_add_local_field_group([
    'key'=>'group_bwos_owner_v5','title'=>'대표 질문지',
    'fields'=>[
      ['key'=>'f_problem','label'=>'1) 지금, 우리 사업의 가장 큰 고민은 무엇인가요?','name'=>'_acf_problem','type'=>'textarea','required'=>1,'rows'=>8,'instructions'=>'최소 200자 권장'],
      ['key'=>'f_value','label'=>'2) 우리 서비스의 핵심 가치는 무엇인가요?','name'=>'_acf_value','type'=>'textarea','required'=>1,'rows'=>6],
      ['key'=>'f_whom','label'=>'3) 누가 이용해야 하나요? 왜 우리인가요?','name'=>'_acf_ideal_customer','type'=>'textarea','required'=>1,'rows'=>6],
      ['key'=>'f_ask1','label'=>'4-1) 고객에게 묻고 싶은 질문 #1','name'=>'_acf_cq1','type'=>'text'],
      ['key'=>'f_ask2','label'=>'4-2) 고객에게 묻고 싶은 질문 #2','name'=>'_acf_cq2','type'=>'text'],
      ['key'=>'f_ask3','label'=>'4-3) 고객에게 묻고 싶은 질문 #3','name'=>'_acf_cq3','type'=>'text'],
      ['key'=>'f_comp','label'=>'5) 경쟁사 대비 차별점','name'=>'_acf_competitors','type'=>'textarea','required'=>1,'rows'=>6],
    ],
    'location'=>[[['param'=>'post_type','operator'=>'==','value'=>'bwf_owner_answer']]],
    'position'=>'normal','style'=>'default','active'=>true,
  ]);
});


/** 200자 필드 서버 검증 */
add_filter('acf/validate_value', function($valid, $value, $field){
  if ($valid !== true) return $valid;
  $min200 = ['problem','core_value','target_customer','differentiation','sales_blockers','current_channels','growth_goal','next_action'];
  if (in_array($field['name'] ?? '', $min200, true)) {
    if (mb_strlen(trim((string)$value)) < 200) return '최소 200자 이상 작성해 주세요.';
  }
  return $valid;
}, 10, 3);
/* ------- ACF <-> bwf_answers 동기화 ------- */
function bwos_acf_meta_keys(){ // ACF 메타키(name) 매핑
  return [
    '_acf_problem'       => ['id'=>'problem'],
    '_acf_value'         => ['id'=>'value'],
    '_acf_ideal_customer'=> ['id'=>'ideal_customer'],
    '_acf_cq1'           => ['id'=>'ask3','sub'=>'q1'],
    '_acf_cq2'           => ['id'=>'ask3','sub'=>'q2'],
    '_acf_cq3'           => ['id'=>'ask3','sub'=>'q3'],
    '_acf_competitors'   => ['id'=>'competitors'],
  ];
}

/* 편집 화면 로드시 ACF 메타 채워넣기(관리자에서 비어 보이던 문제 해결) */
add_action('load-post.php', function(){
  $pid = isset($_GET['post']) ? (int)$_GET['post'] : 0;
  if(!$pid) return;
  $p = get_post($pid);
  if(!$p || $p->post_type!=='bwf_owner_answer') return;

  $ans = (array)get_post_meta($pid,'bwf_answers',true);
  foreach(bwos_acf_meta_keys() as $meta=>$m){
    $val = '';
    if(empty($m['sub'])) $val = (string)($ans[$m['id']] ?? '');
    else                 $val = (string)($ans[$m['id']][$m['sub']] ?? '');
    update_post_meta($pid, $meta, $val);
  }
});

/* 저장 시 ACF 값으로 bwf_answers 재생성(양방향 동기화) */
add_action('save_post_bwf_owner_answer', function($post_id){
  if(defined('DOING_AUTOSAVE') && DOING_AUTOSAVE) return;
  $ans = [];
  foreach(bwos_acf_meta_keys() as $meta=>$m){
    $v = (string)get_post_meta($post_id,$meta,true);
    if(empty($m['sub'])) $ans[$m['id']] = $v;
    else {
      if(empty($ans[$m['id']])) $ans[$m['id']] = [];
      $ans[$m['id']][$m['sub']] = $v;
    }
  }
  if($ans) update_post_meta($post_id,'bwf_answers',$ans);
}, 20);

`$nl
===== FILE: berrywalk-feedback-acf\includes\cpt-admin.php (871 bytes, 21 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

add_action('init', function(){
  register_post_type('bwf_owner_answer', [
    'label'=>'대표 질문지','labels'=>['name'=>'대표 질문지','add_new_item'=>'새 대표 질문 생성','edit_item'=>'대표 질문 편집'],
    'public'=>false,'exclude_from_search'=>true,'publicly_queryable'=>false,'show_ui'=>true,'show_in_menu'=>true,
    'menu_icon'=>'dashicons-editor-help','supports'=>['author','custom-fields'],'map_meta_cap'=>true,
  ]);
});

add_filter('manage_bwf_owner_answer_posts_columns', function($c){
  return ['cb'=>$c['cb'],'title'=>'제목','author'=>'작성자','created'=>'저장 시각'];
});
add_action('manage_bwf_owner_answer_posts_custom_column', function($col,$post_id){
  if($col==='created'){
    $ts = get_post_timestamp($post_id,'date');
    echo esc_html( wp_date('Y-m-d H:i', $ts) );
  }
}, 10, 2);

`$nl
===== FILE: berrywalk-feedback-acf\includes\form.php (7759 bytes, 127 lines) =====
`$ext
<?php
/* /includes/form.php (핵심 변경만) */
if (!defined('ABSPATH')) exit;

/** 공용 URL (중복 선언 방지) */
if (!function_exists('bwf_owner_view_url'))  { function bwf_owner_view_url(){ return home_url('/my-question-view/'); } }
if (!function_exists('bwf_owner_edit_url'))  { function bwf_owner_edit_url(){ return home_url('/owner-edit/'); } }
if (!function_exists('bwf_owner_list_url'))  { function bwf_owner_list_url(){ return home_url('/my-questions/'); } }


function bwf_owner_cfg(){
  return [
    'title'=>'대표님 핵심 질문지',
    'min'=>200,
    'intro'=>'사업의 본질을 파악하고 고객에게 정말 묻고 싶은 질문을 구체화합니다. 각 문항은 최소 <strong>{MIN}</strong>자입니다. <em>(단, <strong>“고객에게 물어보고 싶은 3가지”</strong>는 글자수 제한 없음)</em>',
    'qs'=>[
      [
        'id'=>'problem','label'=>'1. 지금, 우리 사업의 가장 큰 고민은 무엇인가요?','required'=>true,'min'=>200,
        'desc'=>'성장이 정체되었다고 느낀 **구체적 상황**을 한두 문장으로. 숫자/행동 기반이면 좋아요.',
        'ex'=>'<ul><li>“클릭은 많은데 체류 30초 미만 이탈이 많아요.”</li><li>“재구매율이 낮아 신규 유입 의존도가 큽니다.”</li></ul>'
      ],
      [
        'id'=>'value','label'=>'2. 우리 서비스는 고객의 어떤 문제를 해결하나요?','required'=>true,'min'=>200,
        'desc'=>'고객의 **전/후 변화**를 한 문장으로 요약.',
        'ex'=>'<ol><li>“반복 서류작업을 5분 자동화 → 본업 집중”</li><li>“바쁜 직장인도 집밥처럼 건강한 한 끼 확보”</li></ol>'
      ],
      [
        'id'=>'ideal_customer','label'=>'3. 누가 이용해야 하나요? 왜 우리여야 하나요?','required'=>true,'min'=>200,
        'desc'=>'핵심 타깃의 특징 + 우리를 선택할 **결정적 이유**.',
        'ex'=>'<p>“시간/비용이 부족한 20대 대학생 → 15분 홈트 영상으로 꾸준함 확보.”</p>'
      ],
      [
        'id'=>'ask3','type'=>'group','label'=>'4. 고객에게 물어보고 싶은 3가지','required'=>true,
        'desc'=>'실제 경험 기반으로 **구체적인 질문 3개**를 작성.',
        'ex'=>'<p><strong>예)</strong> 첫인상/결심포인트/아쉬운점</p>',
        'sub'=>[
          ['id'=>'q1','label'=>'질문 1','ph'=>'예: 어떻게 알게 되었나요?','required'=>true],
          ['id'=>'q2','label'=>'질문 2','ph'=>'예: 결심 포인트는 무엇이었나요?','required'=>true],
          ['id'=>'q3','label'=>'질문 3','ph'=>'예: 가장 아쉬웠던 점은?','required'=>true],
        ]
      ],
      [
        'id'=>'competitors','label'=>'5. 경쟁사와의 차별점은?','required'=>true,'min'=>200,
        'desc'=>'주요 경쟁사 1~2곳과 비교해 강/약점 정리.',
        'ex'=>'<p>“A는 저렴하지만 CS 느림 / B는 비싸지만 품질 우수 → 우리는 적정가+빠른 CS”</p>'
      ],
    ]
  ];
}

function bwf_owner_view_url(){ return home_url('/my-question-view/'); }
function bwf_owner_edit_url(){ return home_url('/owner-edit/'); }
function bwf_owner_list_url(){ return home_url('/my-questions/'); }

function bwf_render_owner_form($args=[]){
  $cfg=bwf_owner_cfg(); $min=(int)$cfg['min']; $mode=$args['mode']??'create';
  $post=$args['post']??null; $saved=$args['saved']??[]; $errs=$args['errs']??[];
  if($mode==='edit' && $post){ $existing=(array)get_post_meta($post->ID,'bwf_answers',true); $saved=$saved ?: $existing; }
  wp_enqueue_style('bwf-forms'); wp_enqueue_script('bwos-form');

  ob_start(); ?>
  <form id="bwfOwnerForm" class="bwf-form bwos-form" method="post" action="<?php echo esc_url(admin_url('admin-post.php')); ?>" novalidate>
    <input type="hidden" name="action" value="bwf_owner_save">
    <?php wp_nonce_field('bwf_owner_save','bwf_owner_nonce'); ?>
    <input type="hidden" name="post_id" value="<?php echo $post ? (int)$post->ID : 0; ?>">

    <div class="bwos-progress"><div class="bar"><span></span></div><div class="status">작성 0/0 (0%)</div></div>

    <h2 class="bwf-title"><?php echo esc_html($cfg['title']); ?></h2>
    <p class="bwf-help"><?php echo str_replace('{MIN}', $min, $cfg['intro']); ?></p>

    <?php foreach($cfg['qs'] as $q): $type=$q['type']??'textarea'; $id=$q['id']; ?>
      <div class="bwf-field bwos-field bwos-required" data-min="<?php echo (int)($q['min']??$min); ?>">
        <label><?php echo esc_html($q['label']); ?><?php if(!empty($q['required'])): ?><span class="bwf-required">*</span><?php endif; ?></label>

        <?php if(!empty($q['desc'])): ?><div class="bwf-desc"><?php echo wp_kses_post($q['desc']); ?></div><?php endif; ?>
        <?php if(!empty($q['ex'])):   ?><div class="bwf-examples"><?php echo wp_kses_post($q['ex']); ?></div><?php endif; ?>

        <?php if($type==='group'): ?>
          <?php foreach(($q['sub']??[]) as $sub): $sid=$sub['id']; $v=$saved[$id][$sid]??''; ?>
            <div class="bwf-sub">
              <div class="bwf-help" style="margin:6px 0 6px;"><?php echo esc_html($sub['label']); ?></div>
              <textarea name="q[<?php echo esc_attr($id); ?>][<?php echo esc_attr($sid); ?>]" rows="4" placeholder="<?php echo esc_attr($sub['ph']??''); ?>"><?php echo esc_textarea($v); ?></textarea>
            </div>
          <?php endforeach; ?>
        <?php else: $v=$saved[$id]??''; ?>
          <textarea name="q[<?php echo esc_attr($id); ?>]" rows="6"><?php echo esc_textarea($v); ?></textarea>
          <small class="bwos-count">0/<?php echo (int)($q['min']??$min); ?></small>
        <?php endif; ?>
      </div>
    <?php endforeach; ?>

    <div class="bwf-actions">
      <button type="submit" class="bwf-btn bwos-submit"><?php echo $mode==='edit'?'수정 저장':'저장'; ?></button>
      <!-- 마이페이지 버튼 제거 요청 반영 -->
    </div>
  </form>
  <?php return ob_get_clean();
}

add_shortcode('bwf_owner_questions', function(){
  wp_enqueue_style('bwf-forms');

  if (!is_user_logged_in()){
    wp_enqueue_style('bwf-forms');
    $signup = esc_url('https://berrywalk.co.kr/bwf-owner-signup/');
    $login  = esc_url( wp_login_url( home_url('/owner-questions/') ) );
    return '<div class="bwos-wrap"><div class="bwf-need-login"><p>대표님 핵심 질문지를 작성하려면 로그인이 필요합니다.</p><div class="bwf-login-actions"><a class="bwf-btn" href="'.$login.'">로그인하러 가기</a><a class="bwf-btn-secondary" href="'.$signup.'">회원가입하러 가기</a></div></div></div>';
  }
  $uid=get_current_user_id();
  $old=get_transient('bwf_owner_old_'.$uid)?:[]; delete_transient('bwf_owner_old_'.$uid);
  $err=get_transient('bwf_owner_err_'.$uid)?:[]; delete_transient('bwf_owner_err_'.$uid);
  return bwf_render_owner_form(['mode'=>'create','saved'=>$old,'errs'=>$err]);
});
add_shortcode('bw_owner_form', fn()=>do_shortcode('[bwf_owner_questions]'));
add_shortcode('bw_owner_edit', function($atts){
  if (!is_user_logged_in()) return '<div class="bwf-form">로그인이 필요합니다.</div>';
  $id=(int)($atts['id']??($_GET['id']??0));
  $post=get_post($id);
  if(!$post || $post->post_type!=='bwf_owner_answer') return '<div class="bwf-form">데이터가 없습니다.</div>';
  if((int)$post->post_author!==get_current_user_id() && !current_user_can('edit_post',$id)) return '<div class="bwf-form">권한이 없습니다.</div>';
  $uid=get_current_user_id();
  $old=get_transient('bwf_owner_old_'.$uid)?:[]; delete_transient('bwf_owner_old_'.$uid);
  $err=get_transient('bwf_owner_err_'.$uid)?:[]; delete_transient('bwf_owner_err_'.$uid);
  return bwf_render_owner_form(['mode'=>'edit','post'=>$post,'saved'=>$old,'errs'=>$err]);
});

`$nl
===== FILE: berrywalk-feedback-acf\includes\save.php (7163 bytes, 203 lines) =====
`$ext
<?php
/**
 * 대표 질문지 저장 + 텔레그램 알림(디버그 포함)
 */
if (!defined('ABSPATH')) exit;

/* 혹시 남아있을지 모르는 이전 핸들러 제거 */
remove_action('admin_post_bwf_owner_save',     'bwf_owner_handle_save');
remove_action('admin_post_nopriv_bwf_owner_save','bwf_owner_handle_save');

/* 저장 엔드포인트 */
add_action('admin_post_bwf_owner_save',      'bwf_owner_save');
add_action('admin_post_nopriv_bwf_owner_save','bwf_owner_save');

function bwf_owner_save(){
  if (!is_user_logged_in()) { wp_safe_redirect(home_url('/')); exit; }
  check_admin_referer('bwf_owner_save','bwf_owner_nonce');

  $uid = get_current_user_id();

  /** 중복 제출 잠금(8초) */
  $lock_key = 'bwf_owner_lock_'.$uid;
  if (get_transient($lock_key)) { wp_safe_redirect(home_url('/my-questions/')); exit; }
  set_transient($lock_key, 1, 8);

  /** 폼 값 */
  $post_id = (int)($_POST['post_id'] ?? 0);
  $src     = (array)($_POST['q'] ?? []);

  /** 질문 정의/검증 */
  $cfg = function_exists('bwf_owner_cfg') ? bwf_owner_cfg() : ['qs'=>[], 'min'=>200];
  $min = (int)($cfg['min'] ?? 200);
  $ans = []; $err = [];

  foreach ($cfg['qs'] as $q) {
    $id   = $q['id'];
    $type = $q['type'] ?? 'textarea';
    $req  = !empty($q['required']);
    $m    = (int)($q['min'] ?? $min);

    if ($type === 'group') {
      $ans[$id] = [];
      foreach (($q['sub'] ?? []) as $sub) {
        $sid = $sub['id'];
        $v   = trim((string)($src[$id][$sid] ?? ''));
        $ans[$id][$sid] = sanitize_textarea_field($v);
        if (!empty($sub['required']) && $v==='') { $err[$id][$sid] = true; }
      }
    } else {
      $v = trim((string)($src[$id] ?? ''));
      $ans[$id] = sanitize_textarea_field($v);
      if ($req && mb_strlen($v) < $m) { $err[$id] = true; }
    }
  }

  /** 검증 실패 → 폼으로 되돌리기 */
  if (!empty($err)) {
    set_transient('bwf_owner_old_'.$uid, $src, 60);
    set_transient('bwf_owner_err_'.$uid, $err, 60);
    delete_transient($lock_key);
    wp_safe_redirect(wp_get_referer() ?: home_url('/owner-questions/'));
    exit;
  }

  /** 제목 규칙: "회사명 - #N 피드백" (새로 만들 때만 계산) */
  $company = trim((string)get_user_meta($uid,'bw_company_name',true));
  if ($company==='') $company = wp_get_current_user()->display_name;

  $is_new = ($post_id === 0);
  if ($is_new) {
    $count = (int) (new WP_Query([
      'post_type'      => 'bwf_owner_answer',
      'post_status'    => 'any',
      'author'         => $uid,
      'fields'         => 'ids',
      'posts_per_page' => -1
    ]))->found_posts;
    $seq   = $count + 1;
    $title = sprintf('%s - #%d 피드백', $company, $seq);
  } else {
    $title = get_post_field('post_title', $post_id);
  }

  /** 저장/수정 */
  $postarr = [
    'post_type'   => 'bwf_owner_answer',
    'post_status' => 'private',
    'post_title'  => $title,
    'post_author' => $uid,
  ];
  if ($post_id) { $postarr['ID'] = $post_id; $pid = wp_update_post($postarr, true); }
  else          { $pid = wp_insert_post($postarr, true); }

  if (is_wp_error($pid)) { delete_transient($lock_key); wp_die($pid); }

  update_post_meta($pid, 'bwf_answers', $ans);

  // 번호 캐시(목록 보정용)
  if ($is_new && preg_match('~#(\d+)~', $title, $m)) {
    update_post_meta($pid, '_bw_seq_cache', (int)$m[1]);
  }

  /** 텔레그램 알림 */
  bwf_send_telegram_notice($pid, $uid, $is_new);

  delete_transient($lock_key);
  wp_safe_redirect( add_query_arg(['id'=>$pid], home_url('/my-question-view/')) );
  exit;
}


/* ===================== 텔레그램 전송 + 디버그 ===================== */
/**
 * 상수(둘 중 아무 세트나 사용 가능):
 *   define('BWF_TG_BOT',  '123456789:BOT_TOKEN');
 *   define('BWF_TG_CHAT', '@your_channel_or_-100xxxxxxxxxx');
 *  또는
 *   define('BW_TG_BOT_TOKEN', '123456789:BOT_TOKEN');
 *   define('BW_TG_CHAT_ID',   '@your_channel_or_-100xxxxxxxxxx');
 */

function bwf__tg_conf(){
  $bot  = defined('BWF_TG_BOT')       ? BWF_TG_BOT
        : (defined('BW_TG_BOT_TOKEN') ? BW_TG_BOT_TOKEN : '');
  $chat = defined('BWF_TG_CHAT')      ? BWF_TG_CHAT
        : (defined('BW_TG_CHAT_ID')   ? BW_TG_CHAT_ID   : '');
  return [$bot, $chat];
}
function bwf__tg_log($data){
  set_transient('bwf_tg_debug', $data, 120);
  error_log('[BWF_TG] '.print_r($data, true));
}

/** 전송 */
function bwf_send_telegram_notice($post_id, $user_id, $is_new){
  list($BOT, $CHAT_RAW) = bwf__tg_conf();
  if (!$BOT || !$CHAT_RAW) { bwf__tg_log(['stage'=>'skip','reason'=>'missing_bot_or_chat']); return; }

  // chat_id 정규화
  $chat = trim($CHAT_RAW);
  if (preg_match('~t\.me/([A-Za-z0-9_]+)$~i', $chat, $m)) $chat = '@'.$m[1];
  if ($chat !== '' && $chat[0] !== '@' && $chat[0] !== '-' && !preg_match('~^-?\d+$~', $chat)) $chat = '@'.$chat;
  if (preg_match('~bot$~i', $chat)) { bwf__tg_log(['stage'=>'abort','reason'=>'chat_is_bot_username','chat'=>$chat]); return; }

  $u       = get_userdata($user_id);
  $company = get_user_meta($user_id,'bw_company_name',true);
  $phone   = get_user_meta($user_id,'bw_phone',true);
  $title   = $post_id ? get_post_field('post_title', $post_id) : '테스트';
  $url     = $post_id ? add_query_arg(['id'=>$post_id], home_url('/my-question-view/')) : home_url('/');
  $verb    = $is_new ? '새 피드백 작성' : '피드백 수정';

  $lines = [
    "✅ {$verb}",
    "제목: {$title}",
    "대표: {$u->display_name} (@{$u->user_login})",
    "회사: " . ($company ?: '—'),
    "연락처: " . ($phone ?: '—'),
    "보기: {$url}",
  ];
  $text = implode("\n", $lines);

  $endpoint = 'https://api.telegram.org/bot'.$BOT.'/sendMessage';
  $args = [
    'timeout' => 15,
    'headers' => ['Accept'=>'application/json'],
    'body'    => [
      'chat_id'                 => $chat,
      'text'                    => $text,
      'parse_mode'              => 'HTML',
      'disable_web_page_preview'=> true,
    ]
  ];

  $res = wp_remote_post($endpoint, $args);

  if (is_wp_error($res)) {
    bwf__tg_log(['stage'=>'request','ok'=>false,'error'=>$res->get_error_message(),'chat'=>$chat]);
  } else {
    $code = wp_remote_retrieve_response_code($res);
    $body = wp_remote_retrieve_body($res);
    $json = json_decode($body, true);
    bwf__tg_log(['stage'=>'request','ok'=>($code===200 && !empty($json['ok'])),'code'=>$code,'chat'=>$chat,'body'=>$body]);
  }
}

/** 관리자에게 1회성 디버그 알림 */
add_action('admin_notices', function(){
  if (!current_user_can('manage_options')) return;
  $d = get_transient('bwf_tg_debug'); if(!$d) return;
  delete_transient('bwf_tg_debug');
  echo '<div class="notice notice-info"><p><strong>텔레그램 전송 디버그</strong></p><pre style="white-space:pre-wrap">';
  echo esc_html(print_r($d, true));
  echo '</pre></div>';
});

/** 전송 테스트: /wp-admin/?bw_tg_test=1 */
add_action('admin_init', function(){
  if (current_user_can('manage_options') && isset($_GET['bw_tg_test'])) {
    bwf_send_telegram_notice(0, get_current_user_id(), true);
    wp_die('텔레그램 테스트 전송 시도 완료 — 관리자 알림 또는 PHP error_log에서 결과 확인');
  }
});

`$nl
===== FILE: berrywalk-feedback-acf\includes\signup.php (14434 bytes, 263 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

/* 역할 보장 */
add_action('init', function(){
  if (!get_role('bw_owner')) add_role('bw_owner','대표',['read'=>true]);
});

/* --- 관리자 사용자 목록 컬럼 + 프로필 편집 영역 --- */
add_filter('manage_users_columns', function($cols){
  $cols['bw_owner_meta'] = '대표 인적사항';
  return $cols;
});
add_filter('manage_users_custom_column', function($out, $col, $user_id){
  if ($col !== 'bw_owner_meta') return $out;
  $u = get_userdata($user_id);
  $pairs = [
    '회사'     => get_user_meta($user_id,'bw_company_name',true),
    '업종'     => get_user_meta($user_id,'bw_industry',true),
    '직원 수'  => get_user_meta($user_id,'bw_employees',true),
    '휴대폰'   => get_user_meta($user_id,'bw_phone',true),
    '연락시간' => get_user_meta($user_id,'bw_contact_window',true),
    '유입경로' => get_user_meta($user_id,'bw_discover',true),
    '웹사이트' => $u ? $u->user_url : '',
  ];
  $html  = '<div style="line-height:1.5">';
  foreach($pairs as $k=>$v){
    $val = ($v === '' ? '—' : $v);
    $html .= '<div><strong>'.$k.'</strong> '.$val.'</div>';
  }
  $html .= '</div>';
  return $html;
}, 10, 3);

/* 프로필 편집 폼 */
add_action('show_user_profile','bwf_owner_profile_fields');
add_action('edit_user_profile','bwf_owner_profile_fields');
function bwf_owner_profile_fields($user){
  ?>
  <h2>대표 인적사항</h2>
  <table class="form-table" role="presentation">
    <tr><th><label>회사명</label></th><td><input type="text" name="bw_company_name" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_company_name',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>업종</label></th><td><input type="text" name="bw_industry" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_industry',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>직원 수</label></th><td><input type="number" name="bw_employees" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_employees',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>휴대폰</label></th><td><input type="text" name="bw_phone" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_phone',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>연락 가능한 시간대</label></th><td><input type="text" name="bw_contact_window" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_contact_window',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>알게 된 경로</label></th><td><input type="text" name="bw_discover" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_discover',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>웹사이트 URL</label></th><td><input type="url" name="user_url_bwf" value="<?php echo esc_attr(get_userdata($user->ID)->user_url); ?>" class="regular-text" placeholder="https://"></td></tr>
  </table>
  <?php
}
add_action('personal_options_update','bwf_owner_profile_save');
add_action('edit_user_profile_update','bwf_owner_profile_save');
function bwf_owner_profile_save($user_id){
  foreach(['bw_company_name','bw_industry','bw_employees','bw_phone','bw_contact_window','bw_discover'] as $k){
    if(isset($_POST[$k])) update_user_meta($user_id,$k, sanitize_text_field($_POST[$k]));
  }
  if(isset($_POST['user_url_bwf'])){
    wp_update_user(['ID'=>$user_id,'user_url'=>esc_url_raw($_POST['user_url_bwf'])]);
  }
}

/* --- 대표 회원가입 폼 --- */
add_shortcode('bwf_signup_representative', function () {
  wp_enqueue_style('bwf-forms');

  // 에러/이전값 표시
  $err = get_transient('bwf_signup_err'); delete_transient('bwf_signup_err');
  $old = get_transient('bwf_signup_old'); delete_transient('bwf_signup_old');

  if (is_user_logged_in()) {
    return '<div class="bwos-wrap" style="margin-top:40px;margin-bottom:24px">
      <p style="margin:0 0 18px;font-weight:700">로그인되었습니다.</p>
      <div class="bwf-actions" style="margin-top:0">
        <a class="bwf-btn" href="'.esc_url(home_url('/owner-questions/')).'">질문 등록하기</a>
        <a class="bwf-btn-secondary" href="'.esc_url(home_url('/my-questions/')).'">내 질문 목록 보기</a>
      </div>
    </div>';
  }

  ob_start(); ?>
  <form method="post" class="bwf-form bwf-grid" id="bwf-signup-rep" action="<?php echo esc_url(admin_url('admin-post.php')); ?>" novalidate>
    <input type="hidden" name="action" value="bwf_signup_rep">
    <?php wp_nonce_field('bwf_signup_rep','bwf_nonce'); ?>

    <h2 class="bwf-title bwf-col-full" style="margin-top:8px;margin-bottom:10px">대표 회원가입</h2>
    <?php if($err): ?>
      <div class="bwf-card bwf-col-full" style="border-color:#fecaca;background:#fff1f2;color:#7f1d1d;margin-bottom:10px"><?php echo esc_html($err); ?></div>
    <?php endif; ?>
    <p class="bwf-required-note bwf-col-full" style="margin-top:0;margin-bottom:14px">* 표시는 필수 입력</p>

    <div><label style="margin-bottom:14px">아이디 *</label><input type="text" name="user_login" value="<?php echo esc_attr($old['user_login']??''); ?>" pattern="[A-Za-z0-9_\.\-]{4,32}" required></div>
    <div><label style="margin-bottom:14px">비밀번호 *</label><input type="password" name="user_pass" required></div>
    <div><label style="margin-bottom:14px">이메일 *</label><input type="email" name="user_email" value="<?php echo esc_attr($old['user_email']??''); ?>" required></div>
    <div><label style="margin-bottom:14px">이름 *</label><input type="text" name="first_name" value="<?php echo esc_attr($old['first_name']??''); ?>" required></div>

    <div><label style="margin-bottom:14px">회사명 *</label><input type="text" name="bw_company_name" value="<?php echo esc_attr($old['bw_company_name']??''); ?>" required></div>
    <div><label style="margin-bottom:14px">업종 *</label>
      <select name="bw_industry" required>
        <?php $sel = $old['bw_industry']??''; ?>
        <option value="">선택</option>
        <option value="IT/서비스" <?php selected($sel,'IT/서비스'); ?>>IT/서비스</option>
        <option value="커머스" <?php selected($sel,'커머스'); ?>>커머스</option>
        <option value="기타" <?php selected($sel,'기타'); ?>>기타</option>
      </select>
    </div>
    <div><label style="margin-bottom:14px">직원 수 *</label><input type="number" name="bw_employees" value="<?php echo esc_attr($old['bw_employees']??''); ?>" min="1" required></div>
    <div><label style="margin-bottom:14px">홈페이지 URL</label><input type="url" name="user_url" value="<?php echo esc_attr($old['user_url']??''); ?>" placeholder="https://"></div>

    <div class="bwf-col-full">
      <label style="margin-bottom:14px">알게 된 경로 *</label>
      <?php $srcSel = $old['bw_discover']??''; ?>
      <select name="bw_discover" id="bwf-source" required>
        <option value="">선택</option><option value="검색" <?php selected($srcSel,'검색'); ?>>검색</option><option value="SNS" <?php selected($srcSel,'SNS'); ?>>SNS</option><option value="지인추천" <?php selected($srcSel,'지인추천'); ?>>지인추천</option><option value="기타" <?php selected($srcSel,'기타'); ?>>기타</option>
      </select>
      <input type="text" name="source_etc" id="bwf-source-etc" placeholder="기타 경로" class="bwf-col-full <?php echo ($srcSel==='기타'?'':'bwf-hidden'); ?>" style="margin-top:8px" value="<?php echo esc_attr($old['source_etc']??''); ?>">
    </div>

    <div><label style="margin-bottom:14px">휴대폰 번호 *</label>
      <input type="tel" name="bw_phone" id="bwf-phone" inputmode="numeric" placeholder="010-1234-5678" maxlength="13" value="<?php echo esc_attr($old['bw_phone']??''); ?>" required>
    </div>
    <div><label style="margin-bottom:14px">연락 가능한 시간대 *</label><input type="text" name="bw_contact_window" value="<?php echo esc_attr($old['bw_contact_window']??''); ?>" placeholder="예: 평일 13:00~18:00" required></div>

    <div class="bwf-actions bwf-col-full" style="margin-top:18px">
      <button type="submit" name="bwf_register" class="bwf-btn">회원가입</button>
      <span id="bwf-hint" style="font-size:13px;color:#475569"></span>
    </div>

    <script>
    (function(){
      const f=document.getElementById('bwf-signup-rep'),
            src=f.querySelector('#bwf-source'),
            etc=f.querySelector('#bwf-source-etc'),
            tel=f.querySelector('#bwf-phone'),
            hint=document.getElementById('bwf-hint');

      function showEtc(){ if(src.value==='기타'){ etc.classList.remove('bwf-hidden'); } else { etc.classList.add('bwf-hidden'); etc.value=''; } }
      src.addEventListener('change',showEtc); showEtc();

      const dig=s=>String(s||'').replace(/\D/g,'');
      function fmt(raw){ const d=dig(raw).slice(0,11); if(d.length<=3) return d; if(d.length<=7) return d.replace(/^(\d{3})(\d{0,4})$/,'$1-$2'); return d.replace(/^(\d{3})(\d{4})(\d{0,4}).*$/,'$1-$2-$3'); }
      function norm(){ tel.value=fmt(tel.value); try{ tel.setSelectionRange(tel.value.length,tel.value.length);}catch(e){} }
      ['input','keyup','change','paste','blur','focus'].forEach(ev=> tel.addEventListener(ev,norm)); norm();

      f.addEventListener('submit',function(ev){
        norm();
        // 필수항목 검증
        const must=[...f.querySelectorAll('[required]')]; let ok=true; let first=null;
        must.forEach(el=>{
          el.classList.remove('bwf-invalid'); el.setCustomValidity('');
          if(el===tel && !/^010-\d{3,4}-\d{4}$/.test(tel.value)){ el.setCustomValidity('휴대폰 번호는 010-1234-5678 형식'); }
          if(el.name==='bw_discover' && src.value==='기타' && (etc.value||'').trim()===''){ el.setCustomValidity('기타 경로를 입력해 주세요'); }
          if(!el.checkValidity()){ ok=false; if(!first) first=el; el.classList.add('bwf-invalid'); }
        });
        if(!ok){ ev.preventDefault(); hint.textContent='입력이 필요한 항목이 있어요.'; hint.style.color='#ef4444'; first.scrollIntoView({behavior:'smooth',block:'center'}); }
        else   { hint.textContent='제출 중입니다…'; hint.style.color='#475569'; }
      });
    })();
    </script>
  </form>
  <?php
  return ob_get_clean();
});

/* 제출 처리 */
add_action('admin_post_nopriv_bwf_signup_rep','bwf_handle_signup_rep');
function bwf_handle_signup_rep(){
  $old = $_POST; unset($old['action'],$old['bwf_nonce'],$old['user_pass']);
  set_transient('bwf_signup_old',$old,60);

  $nonce = sanitize_text_field($_POST['bwf_nonce'] ?? '');
  if (!wp_verify_nonce($nonce,'bwf_signup_rep')) { set_transient('bwf_signup_err','유효하지 않은 요청입니다.',60); wp_safe_redirect(wp_get_referer()?:home_url('/')); exit; }

  $user_login=sanitize_user($_POST['user_login']??'');
  $user_email=sanitize_email($_POST['user_email']??'');
  $user_pass =$_POST['user_pass']??'';
  $first_name=sanitize_text_field($_POST['first_name']??'');

  if (!$user_login||!$user_email||!$user_pass||!$first_name){ set_transient('bwf_signup_err','필수 항목이 누락되었습니다.',60); wp_safe_redirect(wp_get_referer()?:home_url('/')); exit; }

  $uid = wp_insert_user([
    'user_login'=>$user_login,'user_email'=>$user_email,'user_pass'=>$user_pass,
    'first_name'=>$first_name,'role'=>'bw_owner','user_url'=>esc_url_raw($_POST['user_url']??'')
  ]);

  if (is_wp_error($uid)) {
    set_transient('bwf_signup_err', $uid->get_error_message(), 60);
    wp_safe_redirect(wp_get_referer()?:home_url('/')); exit;
  }

  foreach(['bw_company_name','bw_industry','bw_employees','bw_contact_window','bw_discover','bw_phone'] as $k){
    if(isset($_POST[$k])) update_user_meta($uid,$k,sanitize_text_field($_POST[$k]));
  }
  if (($_POST['bw_discover']??'')==='기타' && !empty($_POST['source_etc'])) {
    update_user_meta($uid,'bw_discover','etc: '.sanitize_text_field($_POST['source_etc']));
  }

  delete_transient('bwf_signup_old');

  wp_set_current_user($uid); wp_set_auth_cookie($uid);
  wp_safe_redirect(home_url('/owner-questions/')); exit;
}


/* ===== 관리자 > 대표 질문지( CPT ) 목록 컬럼/제목 ===== */
add_filter('manage_edit-bwf_owner_answer_columns', function($cols){
  $new = [];
  $new['cb']      = $cols['cb'];
  $new['title']   = '제목';
  $new['author']  = '작성자';
  $new['company'] = '회사명';
  $new['website'] = '웹사이트';
  $new['date']    = '저장 시각';
  return $new;
});
add_action('manage_bwf_owner_answer_posts_custom_column', function($col, $post_id){
  if($col==='company'){
    $author = (int)get_post_field('post_author',$post_id);
    echo esc_html( get_user_meta($author,'bw_company_name',true) ?: '—' );
  } elseif($col==='website'){
    $author = (int)get_post_field('post_author',$post_id);
    $url = get_userdata($author)->user_url;
    echo $url ? '<a href="'.esc_url($url).'" target="_blank" rel="noopener">열기</a>' : '—';
  }
},10,2);

/* 관리자 목록에서 예전 글도 보기 좋은 제목으로 표시 */
add_filter('the_title', function($title, $post_id){
  if (!is_admin()) return $title;
  $p = get_post($post_id);
  if(!$p || $p->post_type!=='bwf_owner_answer') return $title;

  // 이미 새 규칙이면 그대로
  if (strpos($title,'#')!==false && strpos($title,'피드백')!==false) return $title;

  $author  = (int)$p->post_author;
  $company = get_user_meta($author,'bw_company_name',true);
  if($company==='') $company = get_userdata($author)->display_name;

  // 사용자 기준 순번 계산 (오래된 순서)
  $ids = get_posts(['post_type'=>'bwf_owner_answer','author'=>$author,'post_status'=>'any','fields'=>'ids','numberposts'=>-1,'orderby'=>'date','order'=>'ASC']);
  $pos = array_search($post_id, $ids, true);
  $idx = ($pos===false? count($ids): $pos) + 1;

  return sprintf('%s - #%d 피드백', $company, $idx);
},10,2);

// ① 우리 대표 가입 폼으로 제출이면, 그 요청에 한해 '새 사용자 기본역할'을 bw_owner로 임시 변경
add_filter('pre_option_default_role', function($default){
  if (!empty($_POST['bwf_role']) && $_POST['bwf_role'] === 'bw_owner') {
    return 'bw_owner';
  }
  return $default;
});

// ② 어떤 경로로 가입되었든, 우리 폼 마커가 있으면 최종적으로 bw_owner로 강제
add_action('user_register', function($user_id){
  if (!empty($_POST['bwf_role']) && $_POST['bwf_role'] === 'bw_owner') {
    $u = new WP_User($user_id);
    $u->set_role('bw_owner');
  }
}, 10);

`$nl
===== FILE: berrywalk-feedback-acf\includes\view-list.php (7622 bytes, 186 lines) =====
`$ext
<?php
/* /includes/view-list.php — 단건 보기 + 마이페이지 목록 */
if (!defined('ABSPATH')) exit;

/* 공통 URL 헬퍼 (중복 선언 방지) */
if (!function_exists('bwf_owner_view_url')) { function bwf_owner_view_url(){ return home_url('/my-question-view/'); } }
if (!function_exists('bwf_owner_edit_url')) { function bwf_owner_edit_url(){ return home_url('/owner-edit/'); } }
if (!function_exists('bwf_owner_list_url')) { function bwf_owner_list_url(){ return home_url('/my-questions/'); } }

/** 단건 보기: [bw_owner_view] / [bwf_owner_view] */
function bwos_render_single_view($atts){
  if (!is_user_logged_in()) return '<div class="bwf-form">로그인이 필요합니다.</div>';

  $id = (int)($atts['id'] ?? ($_GET['id'] ?? 0));
  $p  = get_post($id);
  if(!$p || $p->post_type !== 'bwf_owner_answer') return '<div class="bwf-form">데이터가 없습니다.</div>';
  if((int)$p->post_author !== get_current_user_id() && !current_user_can('read_post', $id)) return '<div class="bwf-form">권한이 없습니다.</div>';

  wp_enqueue_style('bwf-forms');

  // 질문 정의 & 답변
  $cfg = function_exists('bwf_owner_cfg') ? bwf_owner_cfg() : ['title'=>'대표 질문지','qs'=>[]];
  $ans = (array)get_post_meta($id, 'bwf_answers', true);

  // 작성자 메타(요청에 따라 최소 표시만)
  $au   = get_userdata($p->post_author);
  $meta = [
    '회사명'   => get_user_meta($p->post_author,'bw_company_name',true),
    '웹사이트' => $au && $au->user_url ? $au->user_url : '',
    '연락시간' => get_user_meta($p->post_author,'bw_contact_window',true),
    '휴대폰'   => get_user_meta($p->post_author,'bw_phone',true),
  ];

  ob_start(); ?>
  <div class="bwos-wrap">
    <h2 class="bwf-title"><?php echo esc_html($cfg['title']); ?></h2>

    <div class="bwf-card" style="margin-bottom:16px">
      <strong>작성 정보</strong>
      <div style="display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:6px 14px;margin-top:8px">
        <?php foreach($meta as $k=>$v): ?>
          <div>
            <span style="color:#64748b"><?php echo esc_html($k); ?></span> :
            <?php
              if ($k==='웹사이트' && $v) {
                echo '<a href="'.esc_url($v).'" target="_blank" rel="noopener">'.esc_html($v).'</a>';
              } else {
                echo $v ? esc_html($v) : '—';
              }
            ?>
          </div>
        <?php endforeach; ?>
      </div>
    </div>

    <?php foreach(($cfg['qs'] ?? []) as $q):
      $qid = $q['id'] ?? '';
      if(!$qid) continue; ?>
      <div class="bwf-field">
        <label><?php echo esc_html($q['label']); ?></label>
        <?php if(($q['type'] ?? '') === 'group'): ?>
          <?php foreach(($q['sub'] ?? []) as $sub):
            $sid = $sub['id']; $v = trim((string)($ans[$qid][$sid] ?? '')); ?>
            <div class="bwf-sub">
              <div class="bwf-help"><?php echo esc_html($sub['label']); ?></div>
              <div class="bwf-card"><?php echo nl2br(esc_html($v)); ?></div>
            </div>
          <?php endforeach; ?>
        <?php else:
          $v = trim((string)($ans[$qid] ?? '')); ?>
          <div class="bwf-card"><?php echo nl2br(esc_html($v)); ?></div>
        <?php endif; ?>
      </div>
    <?php endforeach; ?>

    <div class="bwf-actions" style="justify-content:center">
      <a class="bwf-btn" href="<?php echo esc_url(add_query_arg(['id'=>$p->ID], bwf_owner_edit_url())); ?>">수정</a>
      <a class="bwf-btn-secondary" href="<?php echo esc_url(bwf_owner_list_url()); ?>">목록</a>
    </div>
  </div>
  <?php
  return ob_get_clean();
}
add_shortcode('bw_owner_view','bwos_render_single_view');
add_shortcode('bwf_owner_view','bwos_render_single_view'); // alias

/** 마이페이지 목록: [bw_owner_list] / [bw_my_questions] */
add_shortcode('bw_owner_list', function($atts){
  if (!is_user_logged_in()) return '<div class="bwf-form">로그인이 필요합니다.</div>';

  $paged = max(1, (int)get_query_var('paged', 0));
  if(!$paged) $paged = max(1, (int)($_GET['pg'] ?? 1));

  $q = new WP_Query([
    'post_type'      => 'bwf_owner_answer',
    'post_status'    => 'private',
    'author'         => get_current_user_id(),
    'posts_per_page' => 8,
    'orderby'        => 'date',
    'order'          => 'DESC',
    'paged'          => $paged,
    'fields'         => 'ids'
  ]);

  wp_enqueue_style('bwf-forms');

  // 사용자 회사명
  $uid     = get_current_user_id();
  $company = trim((string)get_user_meta($uid,'bw_company_name',true));
  if($company==='') $company = wp_get_current_user()->display_name;

  ob_start(); ?>
  <div class="bwos-wrap">
    <h2 class="bwf-title" style="margin-bottom:16px">마이페이지</h2>

    <div class="bwf-actions" style="justify-content:flex-start;margin:0 0 14px">
      <a class="bwf-btn" href="<?php echo esc_url(home_url('/owner-questions/')); ?>">새 피드백 질문하기</a>
    </div>

    <div class="bwos-list">
      <?php
      if ($q->have_posts()):
        foreach ($q->posts as $pid):
          // 제목은 저장된 raw post_title 사용(‘비공개:’ 접두 회피)
          $raw_title = get_post_field('post_title', $pid);

          // 혹시 과거 글(구 규칙)이라면 회사명 - #N 피드백으로 보정
          if (strpos($raw_title,'#') === false || strpos($raw_title,'피드백') === false) {
            // 최신글부터 역순이지만, 사용자는 번호만 구분하면 되므로 글ID 끝 3자리 정도를 보조로 표기할 수도 있음
            // 여기서는 간단히 저장 시각 기준 시퀀스를 표시
            $seq = (int) get_post_meta($pid, '_bw_seq_cache', true);
            if ($seq <= 0) {
              // 없으면 임시 계산: 내 글 전부에서 현재 PID의 역순 인덱스
              $all = new WP_Query([
                'post_type'=>'bwf_owner_answer','post_status'=>'any','author'=>$uid,
                'orderby'=>'date','order'=>'ASC','fields'=>'ids','posts_per_page'=>-1
              ]);
              $seq = 0;
              foreach ($all->posts as $i=>$id) { if ($id == $pid) { $seq = $i+1; break; } }
            }
            $display = sprintf('%s - #%d 피드백', $company, max(1,$seq));
          } else {
            $display = $raw_title;
          }

          $when = get_the_date('Y-m-d H:i', $pid);
          $view = esc_url(add_query_arg(['id'=>$pid], bwf_owner_view_url()));
          $edit = esc_url(add_query_arg(['id'=>$pid], bwf_owner_edit_url()));
      ?>
        <div class="bwos-card">
          <h4><?php echo esc_html($display); ?></h4>
          <div class="meta"><?php echo esc_html($when); ?></div>
          <div class="row">
            <a href="<?php echo $view; ?>">보기</a>
            <a href="<?php echo $edit; ?>">수정</a>
          </div>
        </div>
      <?php
        endforeach;
      else: ?>
        <p>작성한 내역이 없습니다. <a href="<?php echo esc_url(home_url('/owner-questions/')); ?>">새 피드백 질문하기</a>로 첫 저장본을 만들어 보세요.</p>
      <?php endif; ?>
    </div>

    <?php
    $links = paginate_links([
      'total'     => max(1,(int)$q->max_num_pages),
      'current'   => $paged,
      'type'      => 'array',
      'mid_size'  => 2,
      'prev_text' => '이전',
      'next_text' => '다음'
    ]);
    if ($links) {
      echo '<div class="bwos-pg">';
      foreach($links as $l) echo $l.' ';
      echo '</div>';
    }
    wp_reset_postdata();
    ?>
  </div>
  <?php
  return ob_get_clean();
});
add_shortcode('bw_my_questions', fn($a)=>do_shortcode('[bw_owner_list]'));

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\composer.json (719 bytes, 24 lines) =====
`$ext
{
	"name": "yahnis-elsts/plugin-update-checker",
	"type": "library",
	"description": "A custom update checker for WordPress plugins and themes. Useful if you can't host your plugin in the official WP repository but still want it to support automatic updates.",
	"keywords": ["wordpress", "plugin updates", "automatic updates", "theme updates"],
	"homepage": "https://github.com/YahnisElsts/plugin-update-checker/",
	"license": "MIT",
	"authors": [
		{
			"name": "Yahnis Elsts",
			"email": "whiteshadow@w-shadow.com",
			"homepage": "https://w-shadow.com/",
			"role": "Developer"
		}
	],
	"require": {
		"php": ">=5.6.20",
		"ext-json": "*"
	},
	"autoload": {
		"files": ["load-v5p6.php"]
	}
}

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\license.txt (1063 bytes, 8 lines) =====
`$ext
Copyright (c) 2023 Jānis Elsts

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\load-v5p6.php (1182 bytes, 35 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6;

use YahnisElsts\PluginUpdateChecker\v5\PucFactory as MajorFactory;
use YahnisElsts\PluginUpdateChecker\v5p6\PucFactory as MinorFactory;

require __DIR__ . '/Puc/v5p6/Autoloader.php';
new Autoloader();

require __DIR__ . '/Puc/v5p6/PucFactory.php';
require __DIR__ . '/Puc/v5/PucFactory.php';

//Register classes defined in this version with the factory.
foreach (
	array(
		'Plugin\\UpdateChecker' => Plugin\UpdateChecker::class,
		'Theme\\UpdateChecker'  => Theme\UpdateChecker::class,

		'Vcs\\PluginUpdateChecker' => Vcs\PluginUpdateChecker::class,
		'Vcs\\ThemeUpdateChecker'  => Vcs\ThemeUpdateChecker::class,

		'GitHubApi'    => Vcs\GitHubApi::class,
		'BitBucketApi' => Vcs\BitBucketApi::class,
		'GitLabApi'    => Vcs\GitLabApi::class,
	)
	as $pucGeneralClass => $pucVersionedClass
) {
	MajorFactory::addVersion($pucGeneralClass, $pucVersionedClass, '5.6');
	//Also add it to the minor-version factory in case the major-version factory
	//was already defined by another, older version of the update checker.
	MinorFactory::addVersion($pucGeneralClass, $pucVersionedClass, '5.6');
}


`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\plugin-update-checker.php (227 bytes, 10 lines) =====
`$ext
<?php
/**
 * Plugin Update Checker Library 5.6
 * http://w-shadow.com/
 *
 * Copyright 2025 Janis Elsts
 * Released under the MIT license. See license.txt for details.
 */

require dirname(__FILE__) . '/load-v5p6.php';
`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\README.md (21190 bytes, 373 lines) =====
`$ext
Plugin Update Checker
=====================

This is a custom update checker library for WordPress plugins and themes. It lets you add automatic update notifications and one-click upgrades to your commercial plugins, private themes, and so on. All you need to do is put your plugin/theme details in a JSON file, place the file on your server, and pass the URL to the library. The library periodically checks the URL to see if there's a new version available and displays an update notification to the user if necessary.

From the users' perspective, it works just like with plugins and themes hosted on WordPress.org. The update checker uses the default upgrade UI that is familiar to most WordPress users.

<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->
**Table of Contents**

- [Getting Started](#getting-started)
  - [Self-hosted Plugins and Themes](#self-hosted-plugins-and-themes)
    - [How to Release an Update](#how-to-release-an-update)
    - [Notes](#notes)
  - [GitHub Integration](#github-integration)
    - [How to Release an Update](#how-to-release-an-update-1)
    - [Notes](#notes-1)
  - [BitBucket Integration](#bitbucket-integration)
    - [How to Release an Update](#how-to-release-an-update-2)
  - [GitLab Integration](#gitlab-integration)
    - [How to Release a GitLab Update](#how-to-release-a-gitlab-update)
- [Migrating from 4.x](#migrating-from-4x)
- [License Management](#license-management)
- [Resources](#resources)

<!-- END doctoc generated TOC please keep comment here to allow auto update -->

Getting Started
---------------

*Note:* In each of the below examples, part of the instructions is to create an instance of the update checker class. It's recommended to do this either during the `plugins_loaded` action or outside of any hooks. If you do it only during an `admin_*` action, then updates will not be visible to a wide variety of WordPress management tools; they will only be visible to logged-in users on dashboard pages.

### Self-hosted Plugins and Themes

1. Download [the latest release](https://github.com/YahnisElsts/plugin-update-checker/releases/latest) and copy the `plugin-update-checker` directory to your plugin or theme.
2. Go to the `examples` subdirectory and open the .json file that fits your project type. Replace the placeholder data with your plugin/theme details. 
	- Plugin example:
	
		```json
		{
			"name" : "Plugin Name",
			"version" : "2.0",
			"download_url" : "https://example.com/plugin-name-2.0.zip",
			"sections" : {
				"description" : "Plugin description here. You can use HTML."
			}
		}
		```
		
        This is a minimal example that leaves out optional fields. See [this table](https://docs.google.com/spreadsheets/d/1eOBbW7Go2qEQXReOOCdidMTf_tDYRq4JfegcO1CBPIs/edit?usp=sharing) for a full list of supported fields and their descriptions.
	- Theme example:
	
		```json
		{
			"version": "2.0",
			"details_url": "https://example.com/version-2.0-details.html",
			"download_url": "https://example.com/example-theme-2.0.zip"
		}
		```
		
		This is actually a complete example that shows all theme-related fields. `version` and `download_url` should be self-explanatory. The `details_url` key specifies the page that the user will see if they click the "View version 1.2.3 details" link in an update notification.  
3. Upload the JSON file to a publicly accessible location.
4. Add the following code to the main plugin file or to the `functions.php` file:

	```php
	require 'path/to/plugin-update-checker/plugin-update-checker.php';
	use YahnisElsts\PluginUpdateChecker\v5\PucFactory;
 
	$myUpdateChecker = PucFactory::buildUpdateChecker(
		'https://example.com/path/to/details.json',
		__FILE__, //Full path to the main plugin file or functions.php.
		'unique-plugin-or-theme-slug'
	);
	```
	Note: If you're using the Composer autoloader, you don't need to explicitly `require` the library.

#### How to Release an Update

Change the `version` number in the JSON file and make sure that `download_url` points to the latest version. Update the other fields if necessary. Tip: You can use [wp-update-server](https://github.com/YahnisElsts/wp-update-server) to automate this process.

By default, the library will check the specified URL for changes every 12 hours. You can force it to check immediately by clicking the "Check for updates" link on the "Plugins" page (it's next to the "Visit plugin site" link). Themes don't have that link, but you can also trigger an update check like this:
 
 1. Install [Debug Bar](https://srd.wordpress.org/plugins/debug-bar/).
 2. Click the "Debug" menu in the Admin Bar (a.k.a Toolbar).
 3. Open the "PUC (your-slug)" panel. 
 4. Click the "Check Now" button.  

#### Notes
- The second argument passed to `buildUpdateChecker` must be the absolute path to the main plugin file or any file in the theme directory. If you followed the "getting started" instructions, you can just use the `__FILE__` constant.
- The third argument - i.e. the slug - is optional but recommended. In most cases, the slug should be the same as the name of your plugin directory. For example, if your plugin lives in `/wp-content/plugins/my-plugin`, set the slug to `my-plugin`. If the slug is omitted, the update checker will use the name of the main plugin file as the slug (e.g. `my-cool-plugin.php` &rarr; `my-cool-plugin`). This can lead to conflicts if your plugin has a generic file name like `plugin.php`. 
	
	This doesn't affect themes because PUC uses the theme directory name as the default slug. Still, if you're planning to use the slug in your own code - e.g. to filter updates or override update checker behaviour - it can be a good idea to set it explicitly. 

### GitHub Integration

1. Download [the latest release](https://github.com/YahnisElsts/plugin-update-checker/releases/latest) and copy the `plugin-update-checker` directory to your plugin or theme.
2. Add the following code to the main plugin file or `functions.php`:

	```php
	require 'plugin-update-checker/plugin-update-checker.php';
	use YahnisElsts\PluginUpdateChecker\v5\PucFactory;
 
	$myUpdateChecker = PucFactory::buildUpdateChecker(
		'https://github.com/user-name/repo-name/',
		__FILE__,
		'unique-plugin-or-theme-slug'
	);
	
	//Set the branch that contains the stable release.
	$myUpdateChecker->setBranch('stable-branch-name');

	//Optional: If you're using a private repository, specify the access token like this:
	$myUpdateChecker->setAuthentication('your-token-here');
	```
3. Plugins only: Add a `readme.txt` file formatted according to the [WordPress.org plugin readme standard](https://wordpress.org/plugins/readme.txt) to your repository. The contents of this file will be shown when the user clicks the "View version 1.2.3 details" link.

#### How to Release an Update

This library supports a couple of different ways to release updates on GitHub. Pick the one that best fits your workflow.

- **GitHub releases** 
	
	Create a new release using the "Releases" feature on GitHub. The tag name and release title don't matter. The description is optional, but if you do provide one, it will be displayed when the user clicks the "View version x.y.z details" link on the "Plugins" page. Note that PUC ignores releases marked as "This is a pre-release".
	
	If you want to use release assets, call the `enableReleaseAssets()` method after creating the update checker instance:
	```php
	$myUpdateChecker->getVcsApi()->enableReleaseAssets();
	```
	
- **Tags** 
	
	To release version 1.2.3, create a new Git tag named `v1.2.3` or `1.2.3`. That's it.
	
	PUC doesn't require strict adherence to [SemVer](https://semver.org/). These are all valid tag names: `v1.2.3`, `v1.2-foo`, `1.2.3_rc1-ABC`, `1.2.3.4.5`. However, be warned that it's not smart enough to filter out alpha/beta/RC versions. If that's a problem, you might want to use GitHub releases or branches instead.
	
- **Stable branch** 
	
	Point the update checker at a stable, production-ready branch: 
	 ```php
	 $updateChecker->setBranch('branch-name');
	 ```
	 PUC will periodically check the `Version` header in the main plugin file or `style.css` and display a notification if it's greater than the installed version.
	 
	 Caveat: If you set the branch to `master` (the default), the update checker will look for recent releases and tags first. It'll only use the `master` branch if it doesn't find anything else suitable.

#### Notes

The library will pull update details from the following parts of a release/tag/branch:

- Version number
	- The "Version" plugin header.
	- The latest GitHub release or tag name.
- Changelog
	- The "Changelog" section of `readme.txt`.
	- One of the following files:
		CHANGES.md, CHANGELOG.md, changes.md, changelog.md
	- GitHub release notes.
- Required and tested WordPress versions
	- The "Requires at least" and "Tested up to" fields in `readme.txt`.
	- The following plugin headers:
		`Required WP`, `Tested WP`, `Requires at least`, `Tested up to`
- "Last updated" timestamp
	- The creation timestamp of the latest GitHub release.
	- The latest commit in the selected tag or branch.
- Number of downloads
	- The `download_count` statistic of the latest release.
	- If you're not using GitHub releases, there will be no download stats.
- Other plugin details - author, homepage URL, description
	- The "Description" section of `readme.txt`.
	- Remote plugin headers (i.e. the latest version on GitHub).
	- Local plugin headers (i.e. the currently installed version).
- Ratings, banners, screenshots
	- Not supported.
	
### BitBucket Integration

1. Download [the latest release](https://github.com/YahnisElsts/plugin-update-checker/releases/latest) and copy the `plugin-update-checker` directory to your plugin or theme.
2. Add the following code to the main plugin file or `functions.php`:

	```php
	require 'plugin-update-checker/plugin-update-checker.php';
	use YahnisElsts\PluginUpdateChecker\v5\PucFactory;
 
	$myUpdateChecker = PucFactory::buildUpdateChecker(
		'https://bitbucket.org/user-name/repo-name',
		__FILE__,
		'unique-plugin-or-theme-slug'
	);

	//Optional: If you're using a private repository, create an OAuth consumer
	//and set the authentication credentials like this:
	//Note: For now you need to check "This is a private consumer" when
	//creating the consumer to work around #134:
	// https://github.com/YahnisElsts/plugin-update-checker/issues/134
	$myUpdateChecker->setAuthentication(array(
		'consumer_key' => '...',
		'consumer_secret' => '...',
	));

	//Optional: Set the branch that contains the stable release.
	$myUpdateChecker->setBranch('stable-branch-name');
	```
3. Optional: Add a `readme.txt` file formatted according to the [WordPress.org plugin readme standard](https://wordpress.org/plugins/readme.txt) to your repository. For plugins, the contents of this file will be shown when the user clicks the "View version 1.2.3 details" link.

#### How to Release an Update

BitBucket doesn't have an equivalent to GitHub's releases, so the process is slightly different. You can use any of the following approaches: 

- **`Stable tag` header** 
	
	This is the recommended approach if you're using tags to mark each version. Add a `readme.txt` file formatted according to the [WordPress.org plugin readme standard](https://wordpress.org/plugins/readme.txt) to your repository. Set the "stable tag" header to the tag that represents the latest release. Example:
	```text
	Stable tag: v1.2.3
	```
	The tag doesn't have to start with a "v" or follow any particular format. You can use any name you like as long as it's a valid Git tag.
	
	Tip: If you explicitly set a stable branch, the update checker will look for a `readme.txt` in that branch. Otherwise it will only look at the `master` branch.
	
- **Tags** 
	
	You can skip the "stable tag" bit and just create a new Git tag named `v1.2.3` or `1.2.3`. The update checker will look at the most recent tags and pick the one that looks like the highest version number.
	
	PUC doesn't require strict adherence to [SemVer](https://semver.org/). These are all valid tag names: `v1.2.3`, `v1.2-foo`, `1.2.3_rc1-ABC`, `1.2.3.4.5`. However, be warned that it's not smart enough to filter out alpha/beta/RC versions.
	
- **Stable branch** 
	
	Point the update checker at a stable, production-ready branch: 
	 ```php
	 $updateChecker->setBranch('branch-name');
	 ```
	 PUC will periodically check the `Version` header in the main plugin file or `style.css` and display a notification if it's greater than the installed version. Caveat: If you set the branch to `master`, the update checker will still look for tags first.

### GitLab Integration

1. Download [the latest release](https://github.com/YahnisElsts/plugin-update-checker/releases/latest) and copy the `plugin-update-checker` directory to your plugin or theme.
2. Add the following code to the main plugin file or `functions.php` and define how you want to check for updates from Gitlab (refer to: [Gitlab: How to Release an Update](#how-to-release-a-gitlab-update)):

	```php
	require 'plugin-update-checker/plugin-update-checker.php';
	use YahnisElsts\PluginUpdateChecker\v5\PucFactory;

	$myUpdateChecker = PucFactory::buildUpdateChecker(
		'https://gitlab.com/user-name/repo-name/',
		__FILE__,
		'unique-plugin-or-theme-slug'
	);

	//Optional: If you're using a private repository, specify the access token like this:
	$myUpdateChecker->setAuthentication('your-token-here');
	```

	Alternatively, if you're using a self-hosted GitLab instance, initialize the update checker like this:
	```php
	use YahnisElsts\PluginUpdateChecker\v5p6\Vcs\PluginUpdateChecker;
	use YahnisElsts\PluginUpdateChecker\v5p6\Vcs\GitLabApi;
	
	$myUpdateChecker = new PluginUpdateChecker(
		new GitLabApi('https://myserver.com/user-name/repo-name/'),
		__FILE__,
		'unique-plugin-or-theme-slug'
	);
	//Optional: Add setAuthentication(...) and setBranch(...) as shown above.  
	```
	If you're using a self-hosted GitLab instance and [subgroups or nested groups](https://docs.gitlab.com/ce/user/group/subgroups/index.html), you have to tell the update checker which parts of the URL are subgroups:
	```php
	use YahnisElsts\PluginUpdateChecker\v5p6\Vcs\PluginUpdateChecker;
	use YahnisElsts\PluginUpdateChecker\v5p6\Vcs\GitLabApi;
   
	$myUpdateChecker = new PluginUpdateChecker(
		new GitLabApi(
			'https://myserver.com/group-name/subgroup-level1/subgroup-level2/subgroup-level3/repo-name/', 
			null, 
			'subgroup-level1/subgroup-level2/subgroup-level3'
		),
		__FILE__,
		'unique-plugin-or-theme-slug'
	);
	```

3. Plugins only: Add a `readme.txt` file formatted according to the [WordPress.org plugin readme standard](https://wordpress.org/plugins/readme.txt) to your repository. The contents of this file will be shown when the user clicks the "View version 1.2.3 details" link.

#### How to Release a GitLab Update

A GitLab repository can be checked for updates in 3 different ways.

- **GitLab releases**
	
	Create a new release using the "Releases" feature on GitLab. The tag name should match the version number. You can add a `v` prefix to the tag, like `v1.2.3`. Releases that are marked as ["Upcoming Release"](https://docs.gitlab.com/ee/user/project/releases/index.html#upcoming-releases) will be automatically ignored.
	
	If you want to use custom release assets, call the `enableReleaseAssets()` method after creating the update checker instance:
	```php
	$myUpdateChecker->getVcsApi()->enableReleaseAssets();
	```
	
	By default, PUC will use the first available asset link, regardless of type. You can pass a regular expression to `enableReleaseAssets()` to make it pick the first link where the URL matches the regex. For example:
	```php
	$myUpdateChecker->getVcsApi()->enableReleaseAssets('/\.zip($|[?&#])/i');
	```
	
	**Tip:** You can use a Gitlab CI/CD Pipeline to automatically generate your update on release using a Generic Package. For more information about generic packages, refer to the following links:
		- [Gitlab CI/CD Release Documentation](https://docs.gitlab.com/ee/user/project/releases/#create-release-from-gitlab-ci)
		- [Gitlab Release Assets as Generic Package Documentation](https://gitlab.com/gitlab-org/release-cli/-/tree/master/docs/examples/release-assets-as-generic-package/)
		- [Example .gitlab-ci.yml file using Release Generic Packages for generating a update package from the Sensei-LMS wordpress plugin](https://gist.github.com/timwiel/9dfd3526c768efad4973254085e065ce)

- **Tags**

	To release version 1.2.3, create a new Git tag named `v1.2.3` or `1.2.3`. The update checker will look at recent tags and use the one that looks like the highest version number.
	
	PUC doesn't require strict adherence to [SemVer](https://semver.org/). However, be warned that it's not smart enough to filter out alpha/beta/RC versions. If that's a problem, you might want to use GitLab branches instead.

- **Stable branch**

	Point the update checker at any stable, production-ready branch:
	```php
	$myUpdateChecker->setBranch('stable-branch-name');
	```
	PUC will periodically check the `Version` header in the main plugin file or `style.css` and display a notification if it's greater than the installed version. Caveat: Even if you set the branch to `main` (the default) or `master` (the historical default), the update checker will still look for recent releases and tags first.

Migrating from 4.x
------------------

Older versions of the library didn't use namespaces. Code that was written for those versions will need to be updated to work with the current version. At a minimum, you'll need to change the factory class name. 

Old code:
```php
$myUpdateChecker = Puc_v4_Factory::buildUpdateChecker(
	'https://example.com/info.json',
	__FILE__,
	'my-slug'
);
```

New code:
```php
use YahnisElsts\PluginUpdateChecker\v5\PucFactory;

$myUpdateChecker = PucFactory::buildUpdateChecker(
	'https://example.com/info.json',
	__FILE__,
	'my-slug'
);
```

Other classes have also been renamed, usually by simply removing the `Puc_vXpY_` prefix and converting `Category_Thing` to `Category\Thing`. Here's a table of the most commonly used classes and their new names:

| Old class name                      | New class name                                                 |
|-------------------------------------|----------------------------------------------------------------|
| `Puc_v4_Factory`                    | `YahnisElsts\PluginUpdateChecker\v5\PucFactory`                |
| `Puc_v4p13_Factory`                 | `YahnisElsts\PluginUpdateChecker\v5p6\PucFactory`              |
| `Puc_v4p13_Plugin_UpdateChecker`    | `YahnisElsts\PluginUpdateChecker\v5p6\Plugin\UpdateChecker`    |
| `Puc_v4p13_Theme_UpdateChecker`     | `YahnisElsts\PluginUpdateChecker\v5p6\Theme\UpdateChecker`     |
| `Puc_v4p13_Vcs_PluginUpdateChecker` | `YahnisElsts\PluginUpdateChecker\v5p6\Vcs\PluginUpdateChecker` |
| `Puc_v4p13_Vcs_ThemeUpdateChecker`  | `YahnisElsts\PluginUpdateChecker\v5p6\Vcs\ThemeUpdateChecker`  |
| `Puc_v4p13_Vcs_GitHubApi`           | `YahnisElsts\PluginUpdateChecker\v5p6\Vcs\GitHubApi`           |
| `Puc_v4p13_Vcs_GitLabApi`           | `YahnisElsts\PluginUpdateChecker\v5p6\Vcs\GitLabApi`           |
| `Puc_v4p13_Vcs_BitBucketApi`        | `YahnisElsts\PluginUpdateChecker\v5p6\Vcs\BitBucketApi`        |

License Management
------------------

Currently, the update checker doesn't have any built-in license management features. It only provides some hooks that you can use to, for example, append license keys to update requests (`$updateChecker->addQueryArgFilter()`). If you're looking for ways to manage and verify licenses, please post your feedback in [this issue](https://github.com/YahnisElsts/plugin-update-checker/issues/222).

Resources
---------

- [This blog post](https://w-shadow.com/blog/2010/09/02/automatic-updates-for-any-plugin/) has more information about the update checker API. *Slightly out of date.*
- [Debug Bar](https://wordpress.org/plugins/debug-bar/) - useful for testing and debugging the update checker.
- [Update format reference](https://docs.google.com/spreadsheets/d/1eOBbW7Go2qEQXReOOCdidMTf_tDYRq4JfegcO1CBPIs/edit?usp=sharing) - describes all fields supported by the JSON-based update information format used by the update checker. Only covers plugins. Themes use a similar but more limited format.
- [Securing download links](https://w-shadow.com/blog/2013/03/19/plugin-updates-securing-download-links/) - a general overview.
- [A GUI for entering download credentials](https://open-tools.net/documentation/tutorial-automatic-updates.html#wordpress)
- [Theme Update Checker](https://w-shadow.com/blog/2011/06/02/automatic-updates-for-commercial-themes/) - an older, theme-only variant of this update checker.

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\css\puc-debug-bar.css (1334 bytes, 71 lines) =====
`$ext
.puc-debug-bar-panel-v5 pre {
	margin-top: 0;
}

/* Style the debug data table to match "widefat" table style used by WordPress. */
table.puc-debug-data {
    width: 100%;
    clear: both;
    margin: 0;

    border-spacing: 0;
    background-color: #f9f9f9;

    border-radius: 3px;
    border: 1px solid #dfdfdf;
    border-collapse: separate;
}

table.puc-debug-data * {
    word-wrap: break-word;
}

table.puc-debug-data th {
	width: 11em;
    padding: 7px 7px 8px;
    text-align: left;

    font-family: "Georgia", "Times New Roman", "Bitstream Charter", "Times", serif;
    font-weight: 400;
    font-size: 14px;
    line-height: 1.3em;
    text-shadow: rgba(255, 255, 255, 0.804) 0 1px 0;
}

table.puc-debug-data td, table.puc-debug-data th {
    border-width: 1px 0;
    border-style: solid;

    border-top-color: #fff;
    border-bottom-color: #dfdfdf;

    text-transform: none;
}

table.puc-debug-data td {
    color: #555;
    font-size: 12px;
    padding: 4px 7px 2px;
    vertical-align: top;
}

.puc-ajax-response {
	border: 1px solid #dfdfdf;
	border-radius: 3px;
	padding: 0.5em;
	margin: 5px 0;
	background-color: white;
}

.puc-ajax-nonce {
	display: none;
}

.puc-ajax-response dt {
	margin: 0;
}

.puc-ajax-response dd {
	margin: 0 0 1em;
}

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\js\debug-bar.js (1793 bytes, 54 lines) =====
`$ext
jQuery(function($) {

	function runAjaxAction(button, action) {
		button = $(button);
		var panel = button.closest('.puc-debug-bar-panel-v5');
		var responseBox = button.closest('td').find('.puc-ajax-response');

		responseBox.text('Processing...').show();
		$.post(
			ajaxurl,
			{
				action  : action,
				uid     : panel.data('uid'),
				_wpnonce: panel.data('nonce')
			},
			function(data) {
				//The response contains HTML that should already be escaped in server-side code.
				//phpcs:ignore WordPressVIPMinimum.JS.HTMLExecutingFunctions.html
				responseBox.html(data);
			},
			'html'
		);
	}

	$('.puc-debug-bar-panel-v5 input[name="puc-check-now-button"]').on('click', function() {
		runAjaxAction(this, 'puc_v5_debug_check_now');
		return false;
	});

	$('.puc-debug-bar-panel-v5 input[name="puc-request-info-button"]').on('click', function() {
		runAjaxAction(this, 'puc_v5_debug_request_info');
		return false;
	});


	// Debug Bar uses the panel class name as part of its link and container IDs. This means we can
	// end up with multiple identical IDs if more than one plugin uses the update checker library.
	// Fix it by replacing the class name with the plugin slug.
	var panels = $('#debug-menu-targets').find('.puc-debug-bar-panel-v5');
	panels.each(function() {
		var panel = $(this);
		var uid = panel.data('uid');
		var target = panel.closest('.debug-menu-target');

		//Change the panel wrapper ID.
		target.attr('id', 'debug-menu-target-puc-' + uid);

		//Change the menu link ID as well and point it at the new target ID.
		$('#debug-bar-menu').find('.puc-debug-menu-link-' + uid)
			.closest('.debug-menu-link')
			.attr('id', 'debug-menu-link-puc-' + uid)
			.attr('href', '#' + target.attr('id'));
	});
});
`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5\PucFactory.php (201 bytes, 11 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5;

if ( !class_exists(PucFactory::class, false) ):

	class PucFactory extends \YahnisElsts\PluginUpdateChecker\v5p6\PucFactory {
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Autoloader.php (2774 bytes, 87 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6;

if ( !class_exists(Autoloader::class, false) ):

	class Autoloader {
		const DEFAULT_NS_PREFIX = 'YahnisElsts\\PluginUpdateChecker\\';

		private $prefix;
		private $rootDir;
		private $libraryDir;

		private $staticMap;

		public function __construct() {
			$this->rootDir = dirname(__FILE__) . '/';

			$namespaceWithSlash = __NAMESPACE__ . '\\';
			$this->prefix = $namespaceWithSlash;

			$this->libraryDir = $this->rootDir . '../..';
			if ( !self::isPhar() ) {
				$this->libraryDir = realpath($this->libraryDir);
			}
			$this->libraryDir = $this->libraryDir . '/';

			//Usually, dependencies like Parsedown are in the global namespace,
			//but if someone adds a custom namespace to the entire library, they
			//will be in the same namespace as this class.
			$isCustomNamespace = (
				substr($namespaceWithSlash, 0, strlen(self::DEFAULT_NS_PREFIX)) !== self::DEFAULT_NS_PREFIX
			);
			$libraryPrefix = $isCustomNamespace ? $namespaceWithSlash : '';

			$this->staticMap = array(
				$libraryPrefix . 'PucReadmeParser' => 'vendor/PucReadmeParser.php',
				$libraryPrefix . 'Parsedown'       => 'vendor/Parsedown.php',
			);

			//Add the generic, major-version-only factory class to the static map.
			$versionSeparatorPos = strrpos(__NAMESPACE__, '\\v');
			if ( $versionSeparatorPos !== false ) {
				$versionSegment = substr(__NAMESPACE__, $versionSeparatorPos + 1);
				$pointPos = strpos($versionSegment, 'p');
				if ( ($pointPos !== false) && ($pointPos > 1) ) {
					$majorVersionSegment = substr($versionSegment, 0, $pointPos);
					$majorVersionNs = __NAMESPACE__ . '\\' . $majorVersionSegment;
					$this->staticMap[$majorVersionNs . '\\PucFactory'] =
						'Puc/' . $majorVersionSegment . '/Factory.php';
				}
			}

			spl_autoload_register(array($this, 'autoload'));
		}

		/**
		 * Determine if this file is running as part of a Phar archive.
		 *
		 * @return bool
		 */
		private static function isPhar() {
			//Check if the current file path starts with "phar://".
			static $pharProtocol = 'phar://';
			return (substr(__FILE__, 0, strlen($pharProtocol)) === $pharProtocol);
		}

		public function autoload($className) {
			if ( isset($this->staticMap[$className]) && file_exists($this->libraryDir . $this->staticMap[$className]) ) {
				include($this->libraryDir . $this->staticMap[$className]);
				return;
			}

			if ( strpos($className, $this->prefix) === 0 ) {
				$path = substr($className, strlen($this->prefix));
				$path = str_replace(array('_', '\\'), '/', $path);
				$path = $this->rootDir . $path . '.php';

				if ( file_exists($path) ) {
					include $path;
				}
			}
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\InstalledPackage.php (3042 bytes, 106 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6;

if ( !class_exists(InstalledPackage::class, false) ):

	/**
	 * This class represents a currently installed plugin or theme.
	 *
	 * Not to be confused with the "package" field in WP update API responses that contains
	 * the download URL of a the new version.
	 */
	abstract class InstalledPackage {
		/**
		 * @var UpdateChecker
		 */
		protected $updateChecker;

		public function __construct($updateChecker) {
			$this->updateChecker = $updateChecker;
		}

		/**
		 * Get the currently installed version of the plugin or theme.
		 *
		 * @return string|null Version number.
		 */
		abstract public function getInstalledVersion();

		/**
		 * Get the full path of the plugin or theme directory (without a trailing slash).
		 *
		 * @return string
		 */
		abstract public function getAbsoluteDirectoryPath();

		/**
		 * Check whether a regular file exists in the package's directory.
		 *
		 * @param string $relativeFileName File name relative to the package directory.
		 * @return bool
		 */
		public function fileExists($relativeFileName) {
			return is_file(
				$this->getAbsoluteDirectoryPath()
				. DIRECTORY_SEPARATOR
				. ltrim($relativeFileName, '/\\')
			);
		}

		/* -------------------------------------------------------------------
		 * File header parsing
		 * -------------------------------------------------------------------
		 */

		/**
		 * Parse plugin or theme metadata from the header comment.
		 *
		 * This is basically a simplified version of the get_file_data() function from /wp-includes/functions.php.
		 * It's intended as a utility for subclasses that detect updates by parsing files in a VCS.
		 *
		 * @param string|null $content File contents.
		 * @return string[]
		 */
		public function getFileHeader($content) {
			$content = (string)$content;

			//WordPress only looks at the first 8 KiB of the file, so we do the same.
			$content = substr($content, 0, 8192);
			//Normalize line endings.
			$content = str_replace("\r", "\n", $content);

			$headers = $this->getHeaderNames();
			$results = array();
			foreach ($headers as $field => $name) {
				$success = preg_match('/^[ \t\/*#@]*' . preg_quote($name, '/') . ':(.*)$/mi', $content, $matches);

				if ( ($success === 1) && $matches[1] ) {
					$value = $matches[1];
					if ( function_exists('_cleanup_header_comment') ) {
						$value = _cleanup_header_comment($value);
					}
					$results[$field] = $value;
				} else {
					$results[$field] = '';
				}
			}

			return $results;
		}

		/**
		 * @return array Format: ['HeaderKey' => 'Header Name']
		 */
		abstract protected function getHeaderNames();

		/**
		 * Get the value of a specific plugin or theme header.
		 *
		 * @param string $headerName
		 * @return string Either the value of the header, or an empty string if the header doesn't exist.
		 */
		abstract public function getHeaderValue($headerName);

	}
endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Metadata.php (4401 bytes, 163 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6;

use LogicException;
use stdClass;
use WP_Error;

if ( !class_exists(Metadata::class, false) ):

	/**
	 * A base container for holding information about updates and plugin metadata.
	 *
	 * @author Janis Elsts
	 * @copyright 2016
	 * @access public
	 */
	abstract class Metadata {
		/**
		 * Additional dynamic properties, usually copied from the API response.
		 *
		 * @var array<string,mixed>
		 */
		protected $extraProperties = array();

		/**
		 * Create an instance of this class from a JSON document.
		 *
		 * @abstract
		 * @param string $json
		 * @return self
		 */
		public static function fromJson($json) {
			throw new LogicException('The ' . __METHOD__ . ' method must be implemented by subclasses');
		}

		/**
		 * @param string $json
		 * @param self $target
		 * @return bool
		 */
		protected static function createFromJson($json, $target) {
			/** @var \StdClass $apiResponse */
			$apiResponse = json_decode($json);
			if ( empty($apiResponse) || !is_object($apiResponse) ){
				$errorMessage = "Failed to parse update metadata. Try validating your .json file with https://jsonlint.com/";
				do_action('puc_api_error', new WP_Error('puc-invalid-json', $errorMessage));
				//phpcs:ignore WordPress.PHP.DevelopmentFunctions.error_log_trigger_error -- For plugin developers.
				trigger_error(esc_html($errorMessage), E_USER_NOTICE);
				return false;
			}

			$valid = $target->validateMetadata($apiResponse);
			if ( is_wp_error($valid) ){
				do_action('puc_api_error', $valid);
				//phpcs:ignore WordPress.PHP.DevelopmentFunctions.error_log_trigger_error -- For plugin developers.
				trigger_error(esc_html($valid->get_error_message()), E_USER_NOTICE);
				return false;
			}

			foreach(get_object_vars($apiResponse) as $key => $value){
				$target->$key = $value;
			}

			return true;
		}

		/**
		 * No validation by default! Subclasses should check that the required fields are present.
		 *
		 * @param \StdClass $apiResponse
		 * @return bool|\WP_Error
		 */
		protected function validateMetadata($apiResponse) {
			return true;
		}

		/**
		 * Create a new instance by copying the necessary fields from another object.
		 *
		 * @abstract
		 * @param \StdClass|self $object The source object.
		 * @return self The new copy.
		 */
		public static function fromObject($object) {
			throw new LogicException('The ' . __METHOD__ . ' method must be implemented by subclasses');
		}

		/**
		 * Create an instance of StdClass that can later be converted back to an
		 * update or info container. Useful for serialization and caching, as it
		 * avoids the "incomplete object" problem if the cached value is loaded
		 * before this class.
		 *
		 * @return \StdClass
		 */
		public function toStdClass() {
			$object = new stdClass();
			$this->copyFields($this, $object);
			return $object;
		}

		/**
		 * Transform the metadata into the format used by WordPress core.
		 *
		 * @return object
		 */
		abstract public function toWpFormat();

		/**
		 * Copy known fields from one object to another.
		 *
		 * @param \StdClass|self $from
		 * @param \StdClass|self $to
		 */
		protected function copyFields($from, $to) {
			$fields = $this->getFieldNames();

			if ( property_exists($from, 'slug') && !empty($from->slug) ) {
				//Let plugins add extra fields without having to create subclasses.
				$fields = apply_filters($this->getPrefixedFilter('retain_fields') . '-' . $from->slug, $fields);
			}

			foreach ($fields as $field) {
				if ( property_exists($from, $field) ) {
					$to->$field = $from->$field;
				}
			}
		}

		/**
		 * @return string[]
		 */
		protected function getFieldNames() {
			return array();
		}

		/**
		 * @param string $tag
		 * @return string
		 */
		protected function getPrefixedFilter($tag) {
			return 'puc_' . $tag;
		}

		public function __set($name, $value) {
			$this->extraProperties[$name] = $value;
		}

		public function __get($name) {
			return isset($this->extraProperties[$name]) ? $this->extraProperties[$name] : null;
		}

		public function __isset($name) {
			return isset($this->extraProperties[$name]);
		}

		public function __unset($name) {
			unset($this->extraProperties[$name]);
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\OAuthSignature.php (3167 bytes, 103 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6;

if ( !class_exists(OAuthSignature::class, false) ):

	/**
	 * A basic signature generator for zero-legged OAuth 1.0.
	 */
	class OAuthSignature {
		private $consumerKey = '';
		private $consumerSecret = '';

		public function __construct($consumerKey, $consumerSecret) {
			$this->consumerKey = $consumerKey;
			$this->consumerSecret = $consumerSecret;
		}

		/**
		 * Sign a URL using OAuth 1.0.
		 *
		 * @param string $url The URL to be signed. It may contain query parameters.
		 * @param string $method HTTP method such as "GET", "POST" and so on.
		 * @return string The signed URL.
		 */
		public function sign($url, $method = 'GET') {
			$parameters = array();

			//Parse query parameters.
			$query = wp_parse_url($url, PHP_URL_QUERY);
			if ( !empty($query) ) {
				parse_str($query, $parsedParams);
				if ( is_array($parsedParams) ) {
					$parameters = $parsedParams;
				}
				//Remove the query string from the URL. We'll replace it later.
				$url = substr($url, 0, strpos($url, '?'));
			}

			$parameters = array_merge(
				$parameters,
				array(
					'oauth_consumer_key' => $this->consumerKey,
					'oauth_nonce' => $this->nonce(),
					'oauth_signature_method' => 'HMAC-SHA1',
					'oauth_timestamp' => time(),
					'oauth_version' => '1.0',
				)
			);
			unset($parameters['oauth_signature']);

			//Parameters must be sorted alphabetically before signing.
			ksort($parameters);

			//The most complicated part of the request - generating the signature.
			//The string to sign contains the HTTP method, the URL path, and all of
			//our query parameters. Everything is URL encoded. Then we concatenate
			//them with ampersands into a single string to hash.
			$encodedVerb = urlencode($method);
			$encodedUrl = urlencode($url);
			$encodedParams = urlencode(http_build_query($parameters, '', '&'));

			$stringToSign = $encodedVerb . '&' . $encodedUrl . '&' . $encodedParams;

			//Since we only have one OAuth token (the consumer secret) we only have
			//to use it as our HMAC key. However, we still have to append an & to it
			//as if we were using it with additional tokens.
			$secret = urlencode($this->consumerSecret) . '&';

			//The signature is a hash of the consumer key and the base string. Note
			//that we have to get the raw output from hash_hmac and base64 encode
			//the binary data result.
			$parameters['oauth_signature'] = base64_encode(hash_hmac('sha1', $stringToSign, $secret, true));

			return ($url . '?' . http_build_query($parameters));
		}

		/**
		 * Generate a random nonce.
		 *
		 * @return string
		 */
		private function nonce() {
			$mt = microtime();

			$rand = null;
			if ( is_callable('random_bytes') ) {
				try {
					$rand = random_bytes(16);
				} catch (\Exception $ex) {
					//Fall back to mt_rand (below).
				}
			}
			if ( $rand === null ) {
				//phpcs:ignore WordPress.WP.AlternativeFunctions.rand_mt_rand
				$rand = function_exists('wp_rand') ? wp_rand() : mt_rand();
			}

			return md5($mt . '_' . $rand);
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\PucFactory.php (12121 bytes, 363 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6;

use YahnisElsts\PluginUpdateChecker\v5p6\Plugin;
use YahnisElsts\PluginUpdateChecker\v5p6\Theme;
use YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

if ( !class_exists(PucFactory::class, false) ):

	/**
	 * A factory that builds update checker instances.
	 *
	 * When multiple versions of the same class have been loaded (e.g. PluginUpdateChecker 4.0
	 * and 4.1), this factory will always use the latest available minor version. Register class
	 * versions by calling {@link PucFactory::addVersion()}.
	 *
	 * At the moment it can only build instances of the UpdateChecker class. Other classes are
	 * intended mainly for internal use and refer directly to specific implementations.
	 */
	class PucFactory {
		protected static $classVersions = array();
		protected static $sorted = false;

		protected static $myMajorVersion = '';
		protected static $latestCompatibleVersion = '';

		/**
		 * A wrapper method for buildUpdateChecker() that reads the metadata URL from the plugin or theme header.
		 *
		 * @param string $fullPath Full path to the main plugin file or the theme's style.css.
		 * @param array $args Optional arguments. Keys should match the argument names of the buildUpdateChecker() method.
		 * @return Plugin\UpdateChecker|Theme\UpdateChecker|Vcs\BaseChecker
		 */
		public static function buildFromHeader($fullPath, $args = array()) {
			$fullPath = self::normalizePath($fullPath);

			//Set up defaults.
			$defaults = array(
				'metadataUrl'  => '',
				'slug'         => '',
				'checkPeriod'  => 12,
				'optionName'   => '',
				'muPluginFile' => '',
			);
			$args = array_merge($defaults, array_intersect_key($args, $defaults));
			extract($args, EXTR_SKIP);

			//Check for the service URI
			if ( empty($metadataUrl) ) {
				$metadataUrl = self::getServiceURI($fullPath);
			}

			return self::buildUpdateChecker($metadataUrl, $fullPath, $slug, $checkPeriod, $optionName, $muPluginFile);
		}

		/**
		 * Create a new instance of the update checker.
		 *
		 * This method automatically detects if you're using it for a plugin or a theme and chooses
		 * the appropriate implementation for your update source (JSON file, GitHub, BitBucket, etc).
		 *
		 * @see UpdateChecker::__construct
		 *
		 * @param string $metadataUrl The URL of the metadata file, a GitHub repository, or another supported update source.
		 * @param string $fullPath Full path to the main plugin file or to the theme directory.
		 * @param string $slug Custom slug. Defaults to the name of the main plugin file or the theme directory.
		 * @param int $checkPeriod How often to check for updates (in hours).
		 * @param string $optionName Where to store bookkeeping info about update checks.
		 * @param string $muPluginFile The plugin filename relative to the mu-plugins directory.
		 * @return Plugin\UpdateChecker|Theme\UpdateChecker|Vcs\BaseChecker
		 */
		public static function buildUpdateChecker($metadataUrl, $fullPath, $slug = '', $checkPeriod = 12, $optionName = '', $muPluginFile = '') {
			$fullPath = self::normalizePath($fullPath);
			$id = null;

			//Plugin or theme?
			$themeDirectory = self::getThemeDirectoryName($fullPath);
			if ( self::isPluginFile($fullPath) ) {
				$type = 'Plugin';
				$id = $fullPath;
			} else if ( $themeDirectory !== null ) {
				$type = 'Theme';
				$id = $themeDirectory;
			} else {
				throw new \RuntimeException(sprintf(
					'The update checker cannot determine if "%s" is a plugin or a theme. ' .
					'This is a bug. Please contact the PUC developer.',
					esc_html($fullPath)
				));
			}

			//Which hosting service does the URL point to?
			$service = self::getVcsService($metadataUrl);

			$apiClass = null;
			if ( empty($service) ) {
				//The default is to get update information from a remote JSON file.
				$checkerClass = $type . '\\UpdateChecker';
			} else {
				//You can also use a VCS repository like GitHub.
				$checkerClass = 'Vcs\\' . $type . 'UpdateChecker';
				$apiClass = $service . 'Api';
			}

			$checkerClass = self::getCompatibleClassVersion($checkerClass);
			if ( $checkerClass === null ) {
				//phpcs:ignore WordPress.PHP.DevelopmentFunctions.error_log_trigger_error
				trigger_error(
					esc_html(sprintf(
						'PUC %s does not support updates for %ss %s',
						self::$latestCompatibleVersion,
						strtolower($type),
						$service ? ('hosted on ' . $service) : 'using JSON metadata'
					)),
					E_USER_ERROR
				);
			}

			if ( !isset($apiClass) ) {
				//Plain old update checker.
				return new $checkerClass($metadataUrl, $id, $slug, $checkPeriod, $optionName, $muPluginFile);
			} else {
				//VCS checker + an API client.
				$apiClass = self::getCompatibleClassVersion($apiClass);
				if ( $apiClass === null ) {
					//phpcs:ignore WordPress.PHP.DevelopmentFunctions.error_log_trigger_error
					trigger_error(esc_html(sprintf(
						'PUC %s does not support %s',
						self::$latestCompatibleVersion,
						$service
					)), E_USER_ERROR);
				}

				return new $checkerClass(
					new $apiClass($metadataUrl),
					$id,
					$slug,
					$checkPeriod,
					$optionName,
					$muPluginFile
				);
			}
		}

		/**
		 *
		 * Normalize a filesystem path. Introduced in WP 3.9.
		 * Copying here allows use of the class on earlier versions.
		 * This version adapted from WP 4.8.2 (unchanged since 4.5.6)
		 *
		 * @param string $path Path to normalize.
		 * @return string Normalized path.
		 */
		public static function normalizePath($path) {
			if ( function_exists('wp_normalize_path') ) {
				return wp_normalize_path($path);
			}
			$path = str_replace('\\', '/', $path);
			$path = preg_replace('|(?<=.)/+|', '/', $path);
			if ( substr($path, 1, 1) === ':' ) {
				$path = ucfirst($path);
			}
			return $path;
		}

		/**
		 * Check if the path points to a plugin file.
		 *
		 * @param string $absolutePath Normalized path.
		 * @return bool
		 */
		protected static function isPluginFile($absolutePath) {
			//Is the file inside the "plugins" or "mu-plugins" directory?
			$pluginDir = self::normalizePath(WP_PLUGIN_DIR);
			$muPluginDir = self::normalizePath(WPMU_PLUGIN_DIR);
			if ( (strpos($absolutePath, $pluginDir) === 0) || (strpos($absolutePath, $muPluginDir) === 0) ) {
				return true;
			}

			//Is it a file at all? Caution: is_file() can fail if the parent dir. doesn't have the +x permission set.
			if ( !is_file($absolutePath) ) {
				return false;
			}

			//Does it have a valid plugin header?
			//This is a last-ditch check for plugins symlinked from outside the WP root.
			if ( function_exists('get_file_data') ) {
				$headers = get_file_data($absolutePath, array('Name' => 'Plugin Name'), 'plugin');
				return !empty($headers['Name']);
			}

			return false;
		}

		/**
		 * Get the name of the theme's directory from a full path to a file inside that directory.
		 * E.g. "/abc/public_html/wp-content/themes/foo/whatever.php" => "foo".
		 *
		 * Note that subdirectories are currently not supported. For example,
		 * "/xyz/wp-content/themes/my-theme/includes/whatever.php" => NULL.
		 *
		 * @param string $absolutePath Normalized path.
		 * @return string|null Directory name, or NULL if the path doesn't point to a theme.
		 */
		protected static function getThemeDirectoryName($absolutePath) {
			if ( is_file($absolutePath) ) {
				$absolutePath = dirname($absolutePath);
			}

			if ( file_exists($absolutePath . '/style.css') ) {
				return basename($absolutePath);
			}
			return null;
		}

		/**
		 * Get the service URI from the file header.
		 *
		 * @param string $fullPath
		 * @return string
		 */
		private static function getServiceURI($fullPath) {
			//Look for the URI
			if ( is_readable($fullPath) ) {
				$seek = array(
					'github' => 'GitHub URI',
					'gitlab' => 'GitLab URI',
					'bucket' => 'BitBucket URI',
				);
				$seek = apply_filters('puc_get_source_uri', $seek);
				$data = get_file_data($fullPath, $seek);
				foreach ($data as $key => $uri) {
					if ( $uri ) {
						return $uri;
					}
				}
			}

			//URI was not found so throw an error.
			throw new \RuntimeException(
				sprintf('Unable to locate URI in header of "%s"', esc_html($fullPath))
			);
		}

		/**
		 * Get the name of the hosting service that the URL points to.
		 *
		 * @param string $metadataUrl
		 * @return string|null
		 */
		private static function getVcsService($metadataUrl) {
			$service = null;

			//Which hosting service does the URL point to?
			$host = (string)(wp_parse_url($metadataUrl, PHP_URL_HOST));
			$path = (string)(wp_parse_url($metadataUrl, PHP_URL_PATH));

			//Check if the path looks like "/user-name/repository".
			//For GitLab.com it can also be "/user/group1/group2/.../repository".
			$repoRegex = '@^/?([^/]+?)/([^/#?&]+?)/?$@';
			if ( $host === 'gitlab.com' ) {
				$repoRegex = '@^/?(?:[^/#?&]++/){1,20}(?:[^/#?&]++)/?$@';
			}
			if ( preg_match($repoRegex, $path) ) {
				$knownServices = array(
					'github.com' => 'GitHub',
					'bitbucket.org' => 'BitBucket',
					'gitlab.com' => 'GitLab',
				);
				if ( isset($knownServices[$host]) ) {
					$service = $knownServices[$host];
				}
			}

			return apply_filters('puc_get_vcs_service', $service, $host, $path, $metadataUrl);
		}

		/**
		 * Get the latest version of the specified class that has the same major version number
		 * as this factory class.
		 *
		 * @param string $class Partial class name.
		 * @return string|null Full class name.
		 */
		protected static function getCompatibleClassVersion($class) {
			if ( isset(self::$classVersions[$class][self::$latestCompatibleVersion]) ) {
				return self::$classVersions[$class][self::$latestCompatibleVersion];
			}
			return null;
		}

		/**
		 * Get the specific class name for the latest available version of a class.
		 *
		 * @param string $class
		 * @return null|string
		 */
		public static function getLatestClassVersion($class) {
			if ( !self::$sorted ) {
				self::sortVersions();
			}

			if ( isset(self::$classVersions[$class]) ) {
				return reset(self::$classVersions[$class]);
			} else {
				return null;
			}
		}

		/**
		 * Sort available class versions in descending order (i.e. newest first).
		 */
		protected static function sortVersions() {
			foreach ( self::$classVersions as $class => $versions ) {
				uksort($versions, array(__CLASS__, 'compareVersions'));
				self::$classVersions[$class] = $versions;
			}
			self::$sorted = true;
		}

		protected static function compareVersions($a, $b) {
			return -version_compare($a, $b);
		}

		/**
		 * Register a version of a class.
		 *
		 * @access private This method is only for internal use by the library.
		 *
		 * @param string $generalClass Class name without version numbers, e.g. 'PluginUpdateChecker'.
		 * @param string $versionedClass Actual class name, e.g. 'PluginUpdateChecker_1_2'.
		 * @param string $version Version number, e.g. '1.2'.
		 */
		public static function addVersion($generalClass, $versionedClass, $version) {
			if ( empty(self::$myMajorVersion) ) {
				$lastNamespaceSegment = substr(__NAMESPACE__, strrpos(__NAMESPACE__, '\\') + 1);
				self::$myMajorVersion = substr(ltrim($lastNamespaceSegment, 'v'), 0, 1);
			}

			//Store the greatest version number that matches our major version.
			$components = explode('.', $version);
			if ( $components[0] === self::$myMajorVersion ) {

				if (
					empty(self::$latestCompatibleVersion)
					|| version_compare($version, self::$latestCompatibleVersion, '>')
				) {
					self::$latestCompatibleVersion = $version;
				}

			}

			if ( !isset(self::$classVersions[$generalClass]) ) {
				self::$classVersions[$generalClass] = array();
			}
			self::$classVersions[$generalClass][$version] = $versionedClass;
			self::$sorted = false;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Scheduler.php (11167 bytes, 301 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6;

if ( !class_exists(Scheduler::class, false) ):

	/**
	 * The scheduler decides when and how often to check for updates.
	 * It calls @see UpdateChecker::checkForUpdates() to perform the actual checks.
	 */
	class Scheduler {
		public $checkPeriod = 12; //How often to check for updates (in hours).
		public $throttleRedundantChecks = false; //Check less often if we already know that an update is available.
		public $throttledCheckPeriod = 72;

		protected $hourlyCheckHooks = array('load-update.php');

		/**
		 * @var UpdateChecker
		 */
		protected $updateChecker;

		private $cronHook = null;

		/**
		 * Scheduler constructor.
		 *
		 * @param UpdateChecker $updateChecker
		 * @param int $checkPeriod How often to check for updates (in hours).
		 * @param array $hourlyHooks
		 */
		public function __construct($updateChecker, $checkPeriod, $hourlyHooks = array('load-plugins.php')) {
			$this->updateChecker = $updateChecker;
			$this->checkPeriod = $checkPeriod;

			//Set up the periodic update checks
			$this->cronHook = $this->updateChecker->getUniqueName('cron_check_updates');
			if ( $this->checkPeriod > 0 ){

				//Trigger the check via Cron.
				//Try to use one of the default schedules if possible as it's less likely to conflict
				//with other plugins and their custom schedules.
				$defaultSchedules = array(
					1  => 'hourly',
					12 => 'twicedaily',
					24 => 'daily',
				);
				if ( array_key_exists($this->checkPeriod, $defaultSchedules) ) {
					$scheduleName = $defaultSchedules[$this->checkPeriod];
				} else {
					//Use a custom cron schedule.
					$scheduleName = 'every' . $this->checkPeriod . 'hours';
					//phpcs:ignore WordPress.WP.CronInterval.ChangeDetected -- WPCS fails to parse the callback.
					add_filter('cron_schedules', array($this, '_addCustomSchedule'));
				}

				if ( !wp_next_scheduled($this->cronHook) && !defined('WP_INSTALLING') ) {
					//Randomly offset the schedule to help prevent update server traffic spikes. Without this
					//most checks may happen during times of day when people are most likely to install new plugins.
					$upperLimit = max($this->checkPeriod * 3600 - 15 * 60, 1);
					if ( function_exists('wp_rand') ) {
						$randomOffset = wp_rand(0, $upperLimit);
					} else {
						//This constructor may be called before wp_rand() is available.
						//phpcs:ignore WordPress.WP.AlternativeFunctions.rand_rand
						$randomOffset = rand(0, $upperLimit);
					}
					$firstCheckTime = time() - $randomOffset;
					$firstCheckTime = apply_filters(
						$this->updateChecker->getUniqueName('first_check_time'),
						$firstCheckTime
					);
					wp_schedule_event($firstCheckTime, $scheduleName, $this->cronHook);
				}
				add_action($this->cronHook, array($this, 'maybeCheckForUpdates'));

				//In case Cron is disabled or unreliable, we also manually trigger
				//the periodic checks while the user is browsing the Dashboard.
				add_action( 'admin_init', array($this, 'maybeCheckForUpdates') );

				//Like WordPress itself, we check more often on certain pages.
				/** @see wp_update_plugins */
				add_action('load-update-core.php', array($this, 'maybeCheckForUpdates'));
				//phpcs:ignore Squiz.PHP.CommentedOutCode.Found -- Not actually code, just file names.
				//"load-update.php" and "load-plugins.php" or "load-themes.php".
				$this->hourlyCheckHooks = array_merge($this->hourlyCheckHooks, $hourlyHooks);
				foreach($this->hourlyCheckHooks as $hook) {
					add_action($hook, array($this, 'maybeCheckForUpdates'));
				}
				//This hook fires after a bulk update is complete.
				add_action('upgrader_process_complete', array($this, 'removeHooksIfLibraryGone'), 1, 0);
				add_action('upgrader_process_complete', array($this, 'upgraderProcessComplete'), 11, 2);

			} else {
				//Periodic checks are disabled.
				wp_clear_scheduled_hook($this->cronHook);
			}
		}

		/**
		 * Remove all hooks if this version of PUC has been deleted or overwritten.
		 *
		 * Callback for the "upgrader_process_complete" action.
		 */
		public function removeHooksIfLibraryGone() {
			//Cancel all further actions if the current version of PUC has been deleted or overwritten
			//by a different version during the upgrade. If we try to do anything more in that situation,
			//we could trigger a fatal error by trying to autoload a deleted class.
			clearstatcache();
			if ( !file_exists(__FILE__) ) {
				$this->removeHooks();
				$this->updateChecker->removeHooks();
			}
		}

		/**
		 * Runs upon the WP action upgrader_process_complete.
		 *
		 * We look at the parameters to decide whether to call maybeCheckForUpdates() or not.
		 * We also check if the update checker has been removed by the update.
		 *
		 * @param \WP_Upgrader $upgrader  WP_Upgrader instance
		 * @param array $upgradeInfo extra information about the upgrade
		 */
		public function upgraderProcessComplete(
			/** @noinspection PhpUnusedParameterInspection */
			$upgrader, $upgradeInfo
		) {
			//Sanity check and limitation to relevant types.
			if (
				!is_array($upgradeInfo) || !isset($upgradeInfo['type'], $upgradeInfo['action'])
				|| 'update' !== $upgradeInfo['action'] || !in_array($upgradeInfo['type'], array('plugin', 'theme'))
			) {
				return;
			}

			//Filter out notifications of upgrades that should have no bearing upon whether or not our
			//current info is up-to-date.
			if ( is_a($this->updateChecker, Theme\UpdateChecker::class) ) {
				if ( 'theme' !== $upgradeInfo['type'] || !isset($upgradeInfo['themes']) ) {
					return;
				}

				//Letting too many things going through for checks is not a real problem, so we compare widely.
				if ( !in_array(
					strtolower($this->updateChecker->directoryName),
					array_map('strtolower', $upgradeInfo['themes'])
				) ) {
					return;
				}
			}

			if ( is_a($this->updateChecker, Plugin\UpdateChecker::class) ) {
				if ( 'plugin' !== $upgradeInfo['type'] || !isset($upgradeInfo['plugins']) ) {
					return;
				}

				//Themes pass in directory names in the information array, but plugins use the relative plugin path.
				if ( !in_array(
					strtolower($this->updateChecker->directoryName),
					array_map('dirname', array_map('strtolower', $upgradeInfo['plugins']))
				) ) {
					return;
				}
			}

			$this->maybeCheckForUpdates();
		}

		/**
		 * Check for updates if the configured check interval has already elapsed.
		 * Will use a shorter check interval on certain admin pages like "Dashboard -> Updates" or when doing cron.
		 *
		 * You can override the default behaviour by using the "puc_check_now-$slug" filter.
		 * The filter callback will be passed three parameters:
		 *     - Current decision. TRUE = check updates now, FALSE = don't check now.
		 *     - Last check time as a Unix timestamp.
		 *     - Configured check period in hours.
		 * Return TRUE to check for updates immediately, or FALSE to cancel.
		 *
		 * This method is declared public because it's a hook callback. Calling it directly is not recommended.
		 */
		public function maybeCheckForUpdates() {
			if ( empty($this->checkPeriod) ){
				return;
			}

			$state = $this->updateChecker->getUpdateState();
			$shouldCheck = ($state->timeSinceLastCheck() >= $this->getEffectiveCheckPeriod());

			if ( $shouldCheck ) {
				//Sanity check: Do not proceed if one of the critical classes is missing.
				//That can happen - theoretically and extremely rarely - if maybeCheckForUpdates()
				//is called before the old version of our plugin has been fully deleted, or
				//called from an independent AJAX request during deletion.
				if ( !(
					class_exists(Utils::class)
					&& class_exists(Metadata::class)
					&& class_exists(Plugin\Update::class)
					&& class_exists(Theme\Update::class)
				) ) {
					return;
				}
			}

			//Let plugin authors substitute their own algorithm.
			$shouldCheck = apply_filters(
				$this->updateChecker->getUniqueName('check_now'),
				$shouldCheck,
				$state->getLastCheck(),
				$this->checkPeriod
			);

			if ( $shouldCheck ) {
				$this->updateChecker->checkForUpdates();
			}
		}

		/**
		 * Calculate the actual check period based on the current status and environment.
		 *
		 * @return int Check period in seconds.
		 */
		protected function getEffectiveCheckPeriod() {
			$currentFilter = current_filter();
			if ( in_array($currentFilter, array('load-update-core.php', 'upgrader_process_complete')) ) {
				//Check more often when the user visits "Dashboard -> Updates" or does a bulk update.
				$period = 60;
			} else if ( in_array($currentFilter, $this->hourlyCheckHooks) ) {
				//Also check more often on /wp-admin/update.php and the "Plugins" or "Themes" page.
				$period = 3600;
			} else if ( $this->throttleRedundantChecks && ($this->updateChecker->getUpdate() !== null) ) {
				//Check less frequently if it's already known that an update is available.
				$period = $this->throttledCheckPeriod * 3600;
			} else if ( defined('DOING_CRON') && constant('DOING_CRON') ) {
				//WordPress cron schedules are not exact, so let's do an update check even
				//if slightly less than $checkPeriod hours have elapsed since the last check.
				$cronFuzziness = 20 * 60;
				$period = $this->checkPeriod * 3600 - $cronFuzziness;
			} else {
				$period = $this->checkPeriod * 3600;
			}

			return $period;
		}

		/**
		 * Add our custom schedule to the array of Cron schedules used by WP.
		 *
		 * @param array $schedules
		 * @return array
		 */
		public function _addCustomSchedule($schedules) {
			if ( $this->checkPeriod && ($this->checkPeriod > 0) ){
				$scheduleName = 'every' . $this->checkPeriod . 'hours';
				$schedules[$scheduleName] = array(
					'interval' => $this->checkPeriod * 3600,
					'display' => sprintf('Every %d hours', $this->checkPeriod),
				);
			}
			return $schedules;
		}

		/**
		 * Remove the scheduled cron event that the library uses to check for updates.
		 *
		 * @return void
		 */
		public function removeUpdaterCron() {
			wp_clear_scheduled_hook($this->cronHook);
		}

		/**
		 * Get the name of the update checker's WP-cron hook. Mostly useful for debugging.
		 *
		 * @return string
		 */
		public function getCronHookName() {
			return $this->cronHook;
		}

		/**
		 * Remove most hooks added by the scheduler.
		 */
		public function removeHooks() {
			remove_filter('cron_schedules', array($this, '_addCustomSchedule'));
			remove_action('admin_init', array($this, 'maybeCheckForUpdates'));
			remove_action('load-update-core.php', array($this, 'maybeCheckForUpdates'));

			if ( $this->cronHook !== null ) {
				remove_action($this->cronHook, array($this, 'maybeCheckForUpdates'));
			}
			if ( !empty($this->hourlyCheckHooks) ) {
				foreach ($this->hourlyCheckHooks as $hook) {
					remove_action($hook, array($this, 'maybeCheckForUpdates'));
				}
			}
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\StateStore.php (4972 bytes, 215 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6;

if ( !class_exists(StateStore::class, false) ):

	class StateStore {
		/**
		 * @var int Last update check timestamp.
		 */
		protected $lastCheck = 0;

		/**
		 * @var string Version number.
		 */
		protected $checkedVersion = '';

		/**
		 * @var Update|null Cached update.
		 */
		protected $update = null;

		/**
		 * @var string Site option name.
		 */
		private $optionName = '';

		/**
		 * @var bool Whether we've already tried to load the state from the database.
		 */
		private $isLoaded = false;

		public function __construct($optionName) {
			$this->optionName = $optionName;
		}

		/**
		 * Get time elapsed since the last update check.
		 *
		 * If there are no recorded update checks, this method returns a large arbitrary number
		 * (i.e. time since the Unix epoch).
		 *
		 * @return int Elapsed time in seconds.
		 */
		public function timeSinceLastCheck() {
			$this->lazyLoad();
			return time() - $this->lastCheck;
		}

		/**
		 * @return int
		 */
		public function getLastCheck() {
			$this->lazyLoad();
			return $this->lastCheck;
		}

		/**
		 * Set the time of the last update check to the current timestamp.
		 *
		 * @return $this
		 */
		public function setLastCheckToNow() {
			$this->lazyLoad();
			$this->lastCheck = time();
			return $this;
		}

		/**
		 * @return null|Update
		 */
		public function getUpdate() {
			$this->lazyLoad();
			return $this->update;
		}

		/**
		 * @param Update|null $update
		 * @return $this
		 */
		public function setUpdate($update = null) {
			$this->lazyLoad();
			$this->update = $update;
			return $this;
		}

		/**
		 * @return string
		 */
		public function getCheckedVersion() {
			$this->lazyLoad();
			return $this->checkedVersion;
		}

		/**
		 * @param string $version
		 * @return $this
		 */
		public function setCheckedVersion($version) {
			$this->lazyLoad();
			$this->checkedVersion = strval($version);
			return $this;
		}

		/**
		 * Get translation updates.
		 *
		 * @return array
		 */
		public function getTranslations() {
			$this->lazyLoad();
			if ( isset($this->update, $this->update->translations) ) {
				return $this->update->translations;
			}
			return array();
		}

		/**
		 * Set translation updates.
		 *
		 * @param array $translationUpdates
		 */
		public function setTranslations($translationUpdates) {
			$this->lazyLoad();
			if ( isset($this->update) ) {
				$this->update->translations = $translationUpdates;
				$this->save();
			}
		}

		public function save() {
			$state = new \stdClass();

			$state->lastCheck = $this->lastCheck;
			$state->checkedVersion = $this->checkedVersion;

			if ( isset($this->update)) {
				$state->update = $this->update->toStdClass();

				$updateClass = get_class($this->update);
				$state->updateClass = $updateClass;
				$prefix = $this->getLibPrefix();
				if ( Utils::startsWith($updateClass, $prefix) ) {
					$state->updateBaseClass = substr($updateClass, strlen($prefix));
				}
			}

			update_site_option($this->optionName, $state);
			$this->isLoaded = true;
		}

		/**
		 * @return $this
		 */
		public function lazyLoad() {
			if ( !$this->isLoaded ) {
				$this->load();
			}
			return $this;
		}

		protected function load() {
			$this->isLoaded = true;

			$state = get_site_option($this->optionName, null);

			if (
				!is_object($state)
				//Sanity check: If the Utils class is missing, the plugin is probably in the process
				//of being deleted (e.g. the old version gets deleted during an update).
				|| !class_exists(Utils::class)
			) {
				$this->lastCheck = 0;
				$this->checkedVersion = '';
				$this->update = null;
				return;
			}

			$this->lastCheck = intval(Utils::get($state, 'lastCheck', 0));
			$this->checkedVersion = Utils::get($state, 'checkedVersion', '');
			$this->update = null;

			if ( isset($state->update) ) {
				//This mess is due to the fact that the want the update class from this version
				//of the library, not the version that saved the update.

				$updateClass = null;
				if ( isset($state->updateBaseClass) ) {
					$updateClass = $this->getLibPrefix() . $state->updateBaseClass;
				} else if ( isset($state->updateClass) ) {
					$updateClass = $state->updateClass;
				}

				$factory = array($updateClass, 'fromObject');
				if ( ($updateClass !== null) && is_callable($factory) ) {
					$this->update = call_user_func($factory, $state->update);
				}
			}
		}

		public function delete() {
			delete_site_option($this->optionName);

			$this->lastCheck = 0;
			$this->checkedVersion = '';
			$this->update = null;
		}

		private function getLibPrefix() {
			//This assumes that the current class is at the top of the versioned namespace.
			return __NAMESPACE__ . '\\';
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Update.php (787 bytes, 39 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6;

use stdClass;

if ( !class_exists(Update::class, false) ):

	/**
	 * A simple container class for holding information about an available update.
	 *
	 * @author Janis Elsts
	 * @access public
	 */
	abstract class Update extends Metadata {
		public $slug;
		public $version;
		public $download_url;
		public $translations = array();

		/**
		 * @return string[]
		 */
		protected function getFieldNames() {
			return array('slug', 'version', 'download_url', 'translations');
		}

		public function toWpFormat() {
			$update = new stdClass();

			$update->slug = $this->slug;
			$update->new_version = $this->version;
			$update->package = $this->download_url;

			return $update;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\UpdateChecker.php (37442 bytes, 1142 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6;

use stdClass;
use WP_Error;

if ( !class_exists(UpdateChecker::class, false) ):

	abstract class UpdateChecker {
		protected $filterSuffix = '';
		protected $updateTransient = '';

		/**
		 * @var string This can be "plugin" or "theme".
		 */
		protected $componentType = '';
		/**
		 * @var string Currently the same as $componentType, but this is an implementation detail that
		 *             depends on how WP works internally, and could therefore change.
		 */
		protected $translationType = '';

		/**
		 * Set to TRUE to enable error reporting. Errors are raised using trigger_error()
		 * and should be logged to the standard PHP error log.
		 * @var bool
		 */
		public $debugMode = null;

		/**
		 * @var string Where to store the update info.
		 */
		public $optionName = '';

		/**
		 * @var string The URL of the metadata file.
		 */
		public $metadataUrl = '';

		/**
		 * @var string Plugin or theme directory name.
		 */
		public $directoryName = '';

		/**
		 * @var string The slug that will be used in update checker hooks and remote API requests.
		 * Usually matches the directory name unless the plugin/theme directory has been renamed.
		 */
		public $slug = '';

		/**
		 * @var InstalledPackage
		 */
		protected $package;

		/**
		 * @var Scheduler
		 */
		public $scheduler;

		/**
		 * @var UpgraderStatus
		 */
		protected $upgraderStatus;

		/**
		 * @var StateStore
		 */
		protected $updateState;

		/**
		 * @var array List of API errors triggered during the last checkForUpdates() call.
		 */
		protected $lastRequestApiErrors = array();

		/**
		 * @var string|mixed The default is 0 because parse_url() can return NULL or FALSE.
		 */
		protected $cachedMetadataHost = 0;

		/**
		 * @var DebugBar\Extension|null
		 */
		protected $debugBarExtension = null;

		/**
		 * @var WpCliCheckTrigger|null
		 */
		protected $wpCliCheckTrigger = null;

		public function __construct($metadataUrl, $directoryName, $slug = null, $checkPeriod = 12, $optionName = '') {
			$this->debugMode = (bool)(constant('WP_DEBUG'));
			$this->metadataUrl = $metadataUrl;
			$this->directoryName = $directoryName;
			$this->slug = !empty($slug) ? $slug : $this->directoryName;

			$this->optionName = $optionName;
			if ( empty($this->optionName) ) {
				//BC: Initially the library only supported plugin updates and didn't use type prefixes
				//in the option name. Lets use the same prefix-less name when possible.
				if ( $this->filterSuffix === '' ) {
					$this->optionName = 'external_updates-' . $this->slug;
				} else {
					$this->optionName = $this->getUniqueName('external_updates');
				}
			}

			if ( empty($this->translationType) ) {
				$this->translationType = $this->componentType;
			}

			$this->package = $this->createInstalledPackage();
			$this->scheduler = $this->createScheduler($checkPeriod);
			$this->upgraderStatus = new UpgraderStatus();
			$this->updateState = new StateStore($this->optionName);

			if ( did_action('init') ) {
				$this->loadTextDomain();
			} else {
				add_action('init', array($this, 'loadTextDomain'));
			}

			$this->installHooks();

			if ( ($this->wpCliCheckTrigger === null) && defined('WP_CLI') ) {
				$this->wpCliCheckTrigger = new WpCliCheckTrigger($this->componentType, $this->scheduler);
			}
		}

		/**
		 * @internal
		 */
		public function loadTextDomain() {
			//We're not using load_plugin_textdomain() or its siblings because figuring out where
			//the library is located (plugin, mu-plugin, theme, custom wp-content paths) is messy.
			$domain = 'plugin-update-checker';
			$locale = apply_filters(
				'plugin_locale',
				(is_admin() && function_exists('get_user_locale')) ? get_user_locale() : get_locale(),
				$domain
			);

			$moFile = $domain . '-' . $locale . '.mo';
			$path = realpath(dirname(__FILE__) . '/../../languages');

			if ($path && file_exists($path)) {
				load_textdomain($domain, $path . '/' . $moFile);
			}
		}

		protected function installHooks() {
			//Insert our update info into the update array maintained by WP.
			add_filter('site_transient_' . $this->updateTransient, array($this,'injectUpdate'));

			//Insert translation updates into the update list.
			add_filter('site_transient_' . $this->updateTransient, array($this, 'injectTranslationUpdates'));

			//Clear translation updates when WP clears the update cache.
			//This needs to be done directly because the library doesn't actually remove obsolete plugin updates,
			//it just hides them (see getUpdate()). We can't do that with translations - too much disk I/O.
			add_action(
				'delete_site_transient_' . $this->updateTransient,
				array($this, 'clearCachedTranslationUpdates')
			);

			//Rename the update directory to be the same as the existing directory.
			if ( $this->directoryName !== '.' ) {
				add_filter('upgrader_source_selection', array($this, 'fixDirectoryName'), 10, 3);
			}

			//Allow HTTP requests to the metadata URL even if it's on a local host.
			add_filter('http_request_host_is_external', array($this, 'allowMetadataHost'), 10, 2);

			//Potentially exclude information about this entity from core update check requests to api.wordpress.org.
			//phpcs:ignore WordPressVIPMinimum.Hooks.RestrictedHooks.http_request_args -- Doesn't modify timeouts.
			add_filter('http_request_args', array($this, 'excludeEntityFromWordPressAPI'), 10, 2);

			//DebugBar integration.
			if ( did_action('plugins_loaded') ) {
				$this->maybeInitDebugBar();
			} else {
				add_action('plugins_loaded', array($this, 'maybeInitDebugBar'));
			}
		}

		/**
		 * Remove hooks that were added by this update checker instance.
		 */
		public function removeHooks() {
			remove_filter('site_transient_' . $this->updateTransient, array($this,'injectUpdate'));
			remove_filter('site_transient_' . $this->updateTransient, array($this, 'injectTranslationUpdates'));
			remove_action(
				'delete_site_transient_' . $this->updateTransient,
				array($this, 'clearCachedTranslationUpdates')
			);

			remove_filter('upgrader_source_selection', array($this, 'fixDirectoryName'), 10);
			remove_filter('http_request_host_is_external', array($this, 'allowMetadataHost'), 10);
			remove_filter('http_request_args', array($this, 'excludeEntityFromWordPressAPI'));
			remove_action('plugins_loaded', array($this, 'maybeInitDebugBar'));

			remove_action('init', array($this, 'loadTextDomain'));

			if ( $this->scheduler ) {
				$this->scheduler->removeHooks();
			}

			if ( $this->debugBarExtension ) {
				$this->debugBarExtension->removeHooks();
			}
		}

		/**
		 * Check if the current user has the required permissions to install updates.
		 *
		 * @return bool
		 */
		abstract public function userCanInstallUpdates();

		/**
		 * Explicitly allow HTTP requests to the metadata URL.
		 *
		 * WordPress has a security feature where the HTTP API will reject all requests that are sent to
		 * another site hosted on the same server as the current site (IP match), a local host, or a local
		 * IP, unless the host exactly matches the current site.
		 *
		 * This feature is opt-in (at least in WP 4.4). Apparently some people enable it.
		 *
		 * That can be a problem when you're developing your plugin and you decide to host the update information
		 * on the same server as your test site. Update requests will mysteriously fail.
		 *
		 * We fix that by adding an exception for the metadata host.
		 *
		 * @param bool $allow
		 * @param string $host
		 * @return bool
		 */
		public function allowMetadataHost($allow, $host) {
			if ( $this->cachedMetadataHost === 0 ) {
				$this->cachedMetadataHost = wp_parse_url($this->metadataUrl, PHP_URL_HOST);
			}

			if ( is_string($this->cachedMetadataHost) && (strtolower($host) === strtolower($this->cachedMetadataHost)) ) {
				return true;
			}
			return $allow;
		}

		/**
		 * Create a package instance that represents this plugin or theme.
		 *
		 * @return InstalledPackage
		 */
		abstract protected function createInstalledPackage();

		/**
		 * @return InstalledPackage
		 */
		public function getInstalledPackage() {
			return $this->package;
		}

		/**
		 * Create an instance of the scheduler.
		 *
		 * This is implemented as a method to make it possible for plugins to subclass the update checker
		 * and substitute their own scheduler.
		 *
		 * @param int $checkPeriod
		 * @return Scheduler
		 */
		abstract protected function createScheduler($checkPeriod);

		/**
		 * Remove information about this plugin or theme from the requests that WordPress core sends
		 * to api.wordpress.org when checking for updates.
		 *
		 * @param array $args
		 * @param string $url
		 * @return array
		 */
		public function excludeEntityFromWordPressAPI($args, $url) {
			//Is this an api.wordpress.org update check request?
			$parsedUrl = wp_parse_url($url);
			if ( !isset($parsedUrl['host']) || (strtolower($parsedUrl['host']) !== 'api.wordpress.org') ) {
				return $args;
			}

			$typePluralised = $this->componentType . 's';
			$expectedPathPrefix = '/' . $typePluralised . '/update-check/1.';  //e.g. "/plugins/update-check/1.1/"
			if ( !isset($parsedUrl['path']) || !Utils::startsWith($parsedUrl['path'], $expectedPathPrefix) ) {
				return $args;
			}

			//Plugins and themes can disable this feature by using the filter below.
			if ( !apply_filters(
				$this->getUniqueName('remove_from_default_update_checks'),
				true, $this, $args, $url
			) ) {
				return $args;
			}

			if ( empty($args['body'][$typePluralised]) ) {
				return $args;
			}

			$reportingItems = json_decode($args['body'][$typePluralised], true);
			if ( $reportingItems === null ) {
				return $args;
			}

			//The list of installed items uses different key formats for plugins and themes.
			//Luckily, we can reuse the getUpdateListKey() method here.
			$updateListKey = $this->getUpdateListKey();
			if ( isset($reportingItems[$typePluralised][$updateListKey]) ) {
				unset($reportingItems[$typePluralised][$updateListKey]);
			}

			if ( !empty($reportingItems['active']) ) {
				if ( is_array($reportingItems['active']) ) {
					foreach ($reportingItems['active'] as $index => $relativePath) {
						if ( $relativePath === $updateListKey ) {
							unset($reportingItems['active'][$index]);
						}
					}
					//Re-index the array.
					$reportingItems['active'] = array_values($reportingItems['active']);
				} else if ( $reportingItems['active'] === $updateListKey ) {
					//For themes, the "active" field is a string that contains the theme's directory name.
					//Pretend that the default theme is active so that we don't reveal the actual theme.
					if ( defined('WP_DEFAULT_THEME') ) {
						$reportingItems['active'] = WP_DEFAULT_THEME;
					}

					//Unfortunately, it doesn't seem to be documented if we can safely remove the "active"
					//key. So when we don't know the default theme, we'll just leave it as is.
				}
			}

			$args['body'][$typePluralised] = wp_json_encode($reportingItems);
			return $args;
		}

		/**
		 * Check for updates. The results are stored in the DB option specified in $optionName.
		 *
		 * @return Update|null
		 */
		public function checkForUpdates() {
			$installedVersion = $this->getInstalledVersion();
			//Fail silently if we can't find the plugin/theme or read its header.
			if ( $installedVersion === null ) {
				$this->triggerError(
					sprintf('Skipping update check for %s - installed version unknown.', $this->slug),
					E_USER_WARNING
				);
				return null;
			}

			//Start collecting API errors.
			$this->lastRequestApiErrors = array();
			add_action('puc_api_error', array($this, 'collectApiErrors'), 10, 4);

			$state = $this->updateState;
			$state->setLastCheckToNow()
				->setCheckedVersion($installedVersion)
				->save(); //Save before checking in case something goes wrong

			$state->setUpdate($this->requestUpdate());
			$state->save();

			//Stop collecting API errors.
			remove_action('puc_api_error', array($this, 'collectApiErrors'), 10);

			return $this->getUpdate();
		}

		/**
		 * Load the update checker state from the DB.
		 *
		 * @return StateStore
		 */
		public function getUpdateState() {
			return $this->updateState->lazyLoad();
		}

		/**
		 * Reset update checker state - i.e. last check time, cached update data and so on.
		 *
		 * Call this when your plugin is being uninstalled, or if you want to
		 * clear the update cache.
		 */
		public function resetUpdateState() {
			$this->updateState->delete();
		}

		/**
		 * Get the details of the currently available update, if any.
		 *
		 * If no updates are available, or if the last known update version is below or equal
		 * to the currently installed version, this method will return NULL.
		 *
		 * Uses cached update data. To retrieve update information straight from
		 * the metadata URL, call requestUpdate() instead.
		 *
		 * @return Update|null
		 */
		public function getUpdate() {
			$update = $this->updateState->getUpdate();

			//Is there an update available?
			if ( isset($update) ) {
				//Check if the update is actually newer than the currently installed version.
				$installedVersion = $this->getInstalledVersion();
				if ( ($installedVersion !== null) && version_compare($update->version, $installedVersion, '>') ){
					return $update;
				}
			}
			return null;
		}

		/**
		 * Retrieve the latest update (if any) from the configured API endpoint.
		 *
		 * Subclasses should run the update through filterUpdateResult before returning it.
		 *
		 * @return Update An instance of Update, or NULL when no updates are available.
		 */
		abstract public function requestUpdate();

		/**
		 * Filter the result of a requestUpdate() call.
		 *
		 * @template T of Update
		 * @param T|null $update
		 * @param array|WP_Error|null $httpResult The value returned by wp_remote_get(), if any.
		 * @return T
		 */
		protected function filterUpdateResult($update, $httpResult = null) {
			//Let plugins/themes modify the update.
			$update = apply_filters($this->getUniqueName('request_update_result'), $update, $httpResult);

			$this->fixSupportedWordpressVersion($update);

			if ( isset($update, $update->translations) ) {
				//Keep only those translation updates that apply to this site.
				$update->translations = $this->filterApplicableTranslations($update->translations);
			}

			return $update;
		}

		/**
		 * The "Tested up to" field in the plugin metadata is supposed to be in the form of "major.minor",
		 * while WordPress core's list_plugin_updates() expects the $update->tested field to be an exact
		 * version, e.g. "major.minor.patch", to say it's compatible. In other case it shows
		 * "Compatibility: Unknown".
		 * The function mimics how wordpress.org API crafts the "tested" field out of "Tested up to".
		 *
		 * @param Metadata|null $update
		 */
		protected function fixSupportedWordpressVersion($update = null) {
			if ( !isset($update->tested) || !preg_match('/^\d++\.\d++$/', $update->tested) ) {
				return;
			}

			$actualWpVersions = array();

			$wpVersion = $GLOBALS['wp_version'];

			if ( function_exists('get_core_updates') ) {
				$coreUpdates = get_core_updates();
				if ( is_array($coreUpdates) ) {
					foreach ($coreUpdates as $coreUpdate) {
						if ( isset($coreUpdate->current) ) {
							$actualWpVersions[] = $coreUpdate->current;
						}
					}
				}
			}

			$actualWpVersions[] = $wpVersion;

			$actualWpPatchNumber = null;
			foreach ($actualWpVersions as $version) {
				if ( preg_match('/^(?P<majorMinor>\d++\.\d++)(?:\.(?P<patch>\d++))?/', $version, $versionParts) ) {
					if ( $versionParts['majorMinor'] === $update->tested ) {
						$patch = isset($versionParts['patch']) ? intval($versionParts['patch']) : 0;
						if ( $actualWpPatchNumber === null ) {
							$actualWpPatchNumber = $patch;
						} else {
							$actualWpPatchNumber = max($actualWpPatchNumber, $patch);
						}
					}
				}
			}
			if ( $actualWpPatchNumber === null ) {
				$actualWpPatchNumber = 999;
			}

			if ( $actualWpPatchNumber > 0 ) {
				$update->tested .= '.' . $actualWpPatchNumber;
			}
		}

		/**
		 * Get the currently installed version of the plugin or theme.
		 *
		 * @return string|null Version number.
		 */
		public function getInstalledVersion() {
			return $this->package->getInstalledVersion();
		}

		/**
		 * Get the full path of the plugin or theme directory.
		 *
		 * @return string
		 */
		public function getAbsoluteDirectoryPath() {
			return $this->package->getAbsoluteDirectoryPath();
		}

		/**
		 * Trigger a PHP error, but only when $debugMode is enabled.
		 *
		 * @param string $message
		 * @param int $errorType
		 */
		public function triggerError($message, $errorType) {
			if ( $this->isDebugModeEnabled() ) {
				//phpcs:ignore WordPress.PHP.DevelopmentFunctions.error_log_trigger_error -- Only happens in debug mode.
				trigger_error(esc_html($message), $errorType);
			}
		}

		/**
		 * @return bool
		 */
		protected function isDebugModeEnabled() {
			if ( $this->debugMode === null ) {
				$this->debugMode = (bool)(constant('WP_DEBUG'));
			}
			return $this->debugMode;
		}

		/**
		 * Get the full name of an update checker filter, action or DB entry.
		 *
		 * This method adds the "puc_" prefix and the "-$slug" suffix to the filter name.
		 * For example, "pre_inject_update" becomes "puc_pre_inject_update-plugin-slug".
		 *
		 * @param string $baseTag
		 * @return string
		 */
		public function getUniqueName($baseTag) {
			$name = 'puc_' . $baseTag;
			if ( $this->filterSuffix !== '' ) {
				$name .= '_' . $this->filterSuffix;
			}
			return $name . '-' . $this->slug;
		}

		/**
		 * Store API errors that are generated when checking for updates.
		 *
		 * @internal
		 * @param \WP_Error $error
		 * @param array|null $httpResponse
		 * @param string|null $url
		 * @param string|null $slug
		 */
		public function collectApiErrors($error, $httpResponse = null, $url = null, $slug = null) {
			if ( isset($slug) && ($slug !== $this->slug) ) {
				return;
			}

			$this->lastRequestApiErrors[] = array(
				'error'        => $error,
				'httpResponse' => $httpResponse,
				'url'          => $url,
			);
		}

		/**
		 * @return array
		 */
		public function getLastRequestApiErrors() {
			return $this->lastRequestApiErrors;
		}

		/* -------------------------------------------------------------------
		 * PUC filters and filter utilities
		 * -------------------------------------------------------------------
		 */

		/**
		 * Register a callback for one of the update checker filters.
		 *
		 * Identical to add_filter(), except it automatically adds the "puc_" prefix
		 * and the "-$slug" suffix to the filter name. For example, "request_info_result"
		 * becomes "puc_request_info_result-your_plugin_slug".
		 *
		 * @param string $tag
		 * @param callable $callback
		 * @param int $priority
		 * @param int $acceptedArgs
		 */
		public function addFilter($tag, $callback, $priority = 10, $acceptedArgs = 1) {
			add_filter($this->getUniqueName($tag), $callback, $priority, $acceptedArgs);
		}

		/* -------------------------------------------------------------------
		 * Inject updates
		 * -------------------------------------------------------------------
		 */

		/**
		 * Insert the latest update (if any) into the update list maintained by WP.
		 *
		 * @param \stdClass $updates Update list.
		 * @return \stdClass Modified update list.
		 */
		public function injectUpdate($updates) {
			//Is there an update to insert?
			$update = $this->getUpdate();

			if ( !$this->shouldShowUpdates() ) {
				$update = null;
			}

			if ( !empty($update) ) {
				//Let plugins filter the update info before it's passed on to WordPress.
				$update = apply_filters($this->getUniqueName('pre_inject_update'), $update);
				$updates = $this->addUpdateToList($updates, $update->toWpFormat());
			} else {
				//Clean up any stale update info.
				$updates = $this->removeUpdateFromList($updates);
				//Add a placeholder item to the "no_update" list to enable auto-update support.
				//If we don't do this, the option to enable automatic updates will only show up
				//when an update is available.
				$updates = $this->addNoUpdateItem($updates);
			}

			return $updates;
		}

		/**
		 * @param \stdClass|null $updates
		 * @param \stdClass|array $updateToAdd
		 * @return \stdClass
		 */
		protected function addUpdateToList($updates, $updateToAdd) {
			if ( !is_object($updates) ) {
				$updates = new stdClass();
				$updates->response = array();
			}

			$updates->response[$this->getUpdateListKey()] = $updateToAdd;
			return $updates;
		}

		/**
		 * @param \stdClass|null $updates
		 * @return \stdClass|null
		 */
		protected function removeUpdateFromList($updates) {
			if ( isset($updates, $updates->response) ) {
				unset($updates->response[$this->getUpdateListKey()]);
			}
			return $updates;
		}

		/**
		 * See this post for more information:
		 * @link https://make.wordpress.org/core/2020/07/30/recommended-usage-of-the-updates-api-to-support-the-auto-updates-ui-for-plugins-and-themes-in-wordpress-5-5/
		 *
		 * @param \stdClass|null $updates
		 * @return \stdClass
		 */
		protected function addNoUpdateItem($updates) {
			if ( !is_object($updates) ) {
				$updates = new stdClass();
				$updates->response = array();
				$updates->no_update = array();
			} else if ( !isset($updates->no_update) ) {
				$updates->no_update = array();
			}

			$updates->no_update[$this->getUpdateListKey()] = (object) $this->getNoUpdateItemFields();

			return $updates;
		}

		/**
		 * Subclasses should override this method to add fields that are specific to plugins or themes.
		 * @return array
		 */
		protected function getNoUpdateItemFields() {
			return array(
				'new_version'   => $this->getInstalledVersion(),
				'url'           => '',
				'package'       => '',
				'requires_php'  => '',
			);
		}

		/**
		 * Get the key that will be used when adding updates to the update list that's maintained
		 * by the WordPress core. The list is always an associative array, but the key is different
		 * for plugins and themes.
		 *
		 * @return string
		 */
		abstract protected function getUpdateListKey();

		/**
		 * Should we show available updates?
		 *
		 * Usually the answer is "yes", but there are exceptions. For example, WordPress doesn't
		 * support automatic updates installation for mu-plugins, so PUC usually won't show update
		 * notifications in that case. See the plugin-specific subclass for details.
		 *
		 * Note: This method only applies to updates that are displayed (or not) in the WordPress
		 * admin. It doesn't affect APIs like requestUpdate and getUpdate.
		 *
		 * @return bool
		 */
		protected function shouldShowUpdates() {
			return true;
		}

		/* -------------------------------------------------------------------
		 * JSON-based update API
		 * -------------------------------------------------------------------
		 */

		/**
		 * Retrieve plugin or theme metadata from the JSON document at $this->metadataUrl.
		 *
		 * @param class-string<Update> $metaClass Parse the JSON as an instance of this class. It must have a static fromJson method.
		 * @param string $filterRoot
		 * @param array $queryArgs Additional query arguments.
		 * @return array<Metadata|null, array|WP_Error> A metadata instance and the value returned by wp_remote_get().
		 */
		protected function requestMetadata($metaClass, $filterRoot, $queryArgs = array()) {
			//Query args to append to the URL. Plugins can add their own by using a filter callback (see addQueryArgFilter()).
			$queryArgs = array_merge(
				array(
					'installed_version' => strval($this->getInstalledVersion()),
					'php' => phpversion(),
					'locale' => get_locale(),
				),
				$queryArgs
			);
			$queryArgs = apply_filters($this->getUniqueName($filterRoot . '_query_args'), $queryArgs);

			//Various options for the wp_remote_get() call. Plugins can filter these, too.
			$options = array(
				'timeout' => wp_doing_cron() ? 10 : 3,
				'headers' => array(
					'Accept' => 'application/json',
				),
			);
			$options = apply_filters($this->getUniqueName($filterRoot . '_options'), $options);

			//The metadata file should be at 'http://your-api.com/url/here/$slug/info.json'
			$url = $this->metadataUrl;
			if ( !empty($queryArgs) ){
				$url = add_query_arg($queryArgs, $url);
			}

			$result = wp_remote_get($url, $options);

			$result = apply_filters($this->getUniqueName('request_metadata_http_result'), $result, $url, $options);

			//Try to parse the response
			$status = $this->validateApiResponse($result);
			$metadata = null;
			if ( !is_wp_error($status) ){
				if ( (strpos($metaClass, '\\') === false) ) {
					$metaClass = __NAMESPACE__ . '\\' . $metaClass;
				}
				$metadata = call_user_func(array($metaClass, 'fromJson'), $result['body']);
			} else {
				do_action('puc_api_error', $status, $result, $url, $this->slug);
				$this->triggerError(
					sprintf('The URL %s does not point to a valid metadata file. ', $url)
					. $status->get_error_message(),
					E_USER_WARNING
				);
			}

			return array($metadata, $result);
		}

		/**
		 * Check if $result is a successful update API response.
		 *
		 * @param array|WP_Error $result
		 * @return true|WP_Error
		 */
		protected function validateApiResponse($result) {
			if ( is_wp_error($result) ) { /** @var WP_Error $result */
				return new WP_Error($result->get_error_code(), 'WP HTTP Error: ' . $result->get_error_message());
			}

			if ( !isset($result['response']['code']) ) {
				return new WP_Error(
					'puc_no_response_code',
					'wp_remote_get() returned an unexpected result.'
				);
			}

			if ( $result['response']['code'] !== 200 ) {
				return new WP_Error(
					'puc_unexpected_response_code',
					'HTTP response code is ' . $result['response']['code'] . ' (expected: 200)'
				);
			}

			if ( empty($result['body']) ) {
				return new WP_Error('puc_empty_response', 'The metadata file appears to be empty.');
			}

			return true;
		}

		/* -------------------------------------------------------------------
		 * Language packs / Translation updates
		 * -------------------------------------------------------------------
		 */

		/**
		 * Filter a list of translation updates and return a new list that contains only updates
		 * that apply to the current site.
		 *
		 * @param array $translations
		 * @return array
		 */
		protected function filterApplicableTranslations($translations) {
			$languages = array_flip(array_values(get_available_languages()));
			$installedTranslations = $this->getInstalledTranslations();

			$applicableTranslations = array();
			foreach ($translations as $translation) {
				//Does it match one of the available core languages?
				$isApplicable = array_key_exists($translation->language, $languages);
				//Is it more recent than an already-installed translation?
				if ( isset($installedTranslations[$translation->language]) ) {
					$updateTimestamp = strtotime($translation->updated);
					$installedTimestamp = strtotime($installedTranslations[$translation->language]['PO-Revision-Date']);
					$isApplicable = $updateTimestamp > $installedTimestamp;
				}

				if ( $isApplicable ) {
					$applicableTranslations[] = $translation;
				}
			}

			return $applicableTranslations;
		}

		/**
		 * Get a list of installed translations for this plugin or theme.
		 *
		 * @return array
		 */
		protected function getInstalledTranslations() {
			if ( !function_exists('wp_get_installed_translations') ) {
				return array();
			}
			$installedTranslations = wp_get_installed_translations($this->translationType . 's');
			if ( isset($installedTranslations[$this->directoryName]) ) {
				$installedTranslations = $installedTranslations[$this->directoryName];
			} else {
				$installedTranslations = array();
			}
			return $installedTranslations;
		}

		/**
		 * Insert translation updates into the list maintained by WordPress.
		 *
		 * @param stdClass $updates
		 * @return stdClass
		 */
		public function injectTranslationUpdates($updates) {
			$translationUpdates = $this->getTranslationUpdates();
			if ( empty($translationUpdates) ) {
				return $updates;
			}

			//Being defensive.
			if ( !is_object($updates) ) {
				$updates = new stdClass();
			}
			if ( !isset($updates->translations) ) {
				$updates->translations = array();
			}

			//In case there's a name collision with a plugin or theme hosted on wordpress.org,
			//remove any preexisting updates that match our thing.
			$updates->translations = array_values(array_filter(
				$updates->translations,
				array($this, 'isNotMyTranslation')
			));

			//Add our updates to the list.
			foreach($translationUpdates as $update) {
				$convertedUpdate = array_merge(
					array(
						'type' => $this->translationType,
						'slug' => $this->directoryName,
						'autoupdate' => 0,
						//AFAICT, WordPress doesn't actually use the "version" field for anything.
						//But lets make sure it's there, just in case.
						'version' => isset($update->version) ? $update->version : ('1.' . strtotime($update->updated)),
					),
					(array)$update
				);

				$updates->translations[] = $convertedUpdate;
			}

			return $updates;
		}

		/**
		 * Get a list of available translation updates.
		 *
		 * This method will return an empty array if there are no updates.
		 * Uses cached update data.
		 *
		 * @return array
		 */
		public function getTranslationUpdates() {
			return $this->updateState->getTranslations();
		}

		/**
		 * Remove all cached translation updates.
		 *
		 * @see wp_clean_update_cache
		 */
		public function clearCachedTranslationUpdates() {
			$this->updateState->setTranslations(array());
		}

		/**
		 * Filter callback. Keeps only translations that *don't* match this plugin or theme.
		 *
		 * @param array $translation
		 * @return bool
		 */
		protected function isNotMyTranslation($translation) {
			$isMatch = isset($translation['type'], $translation['slug'])
				&& ($translation['type'] === $this->translationType)
				&& ($translation['slug'] === $this->directoryName);

			return !$isMatch;
		}

		/* -------------------------------------------------------------------
		 * Fix directory name when installing updates
		 * -------------------------------------------------------------------
		 */

		/**
		 * Rename the update directory to match the existing plugin/theme directory.
		 *
		 * When WordPress installs a plugin or theme update, it assumes that the ZIP file will contain
		 * exactly one directory, and that the directory name will be the same as the directory where
		 * the plugin or theme is currently installed.
		 *
		 * GitHub and other repositories provide ZIP downloads, but they often use directory names like
		 * "project-branch" or "project-tag-hash". We need to change the name to the actual plugin folder.
		 *
		 * This is a hook callback. Don't call it from a plugin.
		 *
		 * @access protected
		 *
		 * @param string $source The directory to copy to /wp-content/plugins or /wp-content/themes. Usually a subdirectory of $remoteSource.
		 * @param string $remoteSource WordPress has extracted the update to this directory.
		 * @param \WP_Upgrader $upgrader
		 * @return string|WP_Error
		 */
		public function fixDirectoryName($source, $remoteSource, $upgrader) {
			global $wp_filesystem;
			/** @var \WP_Filesystem_Base $wp_filesystem */

			//Basic sanity checks.
			if ( !isset($source, $remoteSource, $upgrader, $upgrader->skin, $wp_filesystem) ) {
				return $source;
			}

			//If WordPress is upgrading anything other than our plugin/theme, leave the directory name unchanged.
			if ( !$this->isBeingUpgraded($upgrader) ) {
				return $source;
			}

			//Fix the remote source structure if necessary.
			//The update archive should contain a single directory that contains the rest of plugin/theme files.
			//Otherwise, WordPress will try to copy the entire working directory ($source == $remoteSource).
			//We can't rename $remoteSource because that would break WordPress code that cleans up temporary files
			//after update.
			if ( $this->isBadDirectoryStructure($remoteSource) ) {
				//Create a new directory using the plugin slug.
				$newDirectory = trailingslashit($remoteSource) . $this->slug . '/';

				if ( !$wp_filesystem->is_dir($newDirectory) ) {
					$wp_filesystem->mkdir($newDirectory);

					//Move all files to the newly created directory.
					$sourceFiles = $wp_filesystem->dirlist($remoteSource);
					if ( is_array($sourceFiles) ) {
						$sourceFiles = array_keys($sourceFiles);
						$allMoved = true;
						foreach ($sourceFiles as $filename) {
							//Skip our newly created folder.
							if ( $filename === $this->slug ) {
								continue;
							}

							$previousSource = trailingslashit($remoteSource) . $filename;
							$newSource = trailingslashit($newDirectory) . $filename;

							if ( !$wp_filesystem->move($previousSource, $newSource, true) ) {
								$allMoved = false;
								break;
							}
						}

						if ( $allMoved ) {
							//Rename source.
							$source = $newDirectory;
						} else {
							//Delete our newly created folder including all files in it.
							$wp_filesystem->rmdir($newDirectory, true);

							//And return a relevant error.
							return new WP_Error(
								'puc-incorrect-directory-structure',
								sprintf(
									'The directory structure of the update was incorrect. All files should be inside ' .
									'a directory named <span class="code">%s</span>, not at the root of the ZIP archive. Plugin Update Checker tried to fix the directory structure, but failed.',
									esc_html($this->slug)
								)
							);
						}
					}
				}
			}

			//Rename the source to match the existing directory.
			$correctedSource = trailingslashit($remoteSource) . $this->directoryName . '/';
			if ( $source !== $correctedSource ) {
				$upgrader->skin->feedback(sprintf(
					'Renaming %s to %s&#8230;',
					'<span class="code">' . basename($source) . '</span>',
					'<span class="code">' . $this->directoryName . '</span>'
				));

				if ( $wp_filesystem->move($source, $correctedSource, true) ) {
					$upgrader->skin->feedback('Directory successfully renamed.');
					return $correctedSource;
				} else {
					return new WP_Error(
						'puc-rename-failed',
						'Unable to rename the update to match the existing directory.'
					);
				}
			}

			return $source;
		}

		/**
		 * Is there an update being installed right now, for this plugin or theme?
		 *
		 * @param \WP_Upgrader|null $upgrader The upgrader that's performing the current update.
		 * @return bool
		 */
		abstract public function isBeingUpgraded($upgrader = null);

		/**
		 * Check for incorrect update directory structure. An update must contain a single directory,
		 * all other files should be inside that directory.
		 *
		 * @param string $remoteSource Directory path.
		 * @return bool
		 */
		protected function isBadDirectoryStructure($remoteSource) {
			global $wp_filesystem;
			/** @var \WP_Filesystem_Base $wp_filesystem */

			$sourceFiles = $wp_filesystem->dirlist($remoteSource);
			if ( is_array($sourceFiles) ) {
				$sourceFiles = array_keys($sourceFiles);
				$firstFilePath = trailingslashit($remoteSource) . $sourceFiles[0];
				return (count($sourceFiles) > 1) || (!$wp_filesystem->is_dir($firstFilePath));
			}

			//Assume it's fine.
			return false;
		}

		/* -------------------------------------------------------------------
		 * DebugBar integration
		 * -------------------------------------------------------------------
		 */

		/**
		 * Initialize the update checker Debug Bar plugin/add-on thingy.
		 */
		public function maybeInitDebugBar() {
			if (
				class_exists('Debug_Bar', false)
				&& class_exists('Debug_Bar_Panel', false)
				&& file_exists(dirname(__FILE__) . '/DebugBar')
			) {
				$this->debugBarExtension = $this->createDebugBarExtension();
			}
		}

		protected function createDebugBarExtension() {
			return new DebugBar\Extension($this);
		}

		/**
		 * Display additional configuration details in the Debug Bar panel.
		 *
		 * @param DebugBar\Panel $panel
		 */
		public function onDisplayConfiguration($panel) {
			//Do nothing. Subclasses can use this to add additional info to the panel.
		}

	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\UpgraderStatus.php (7248 bytes, 201 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6;

if ( !class_exists(UpgraderStatus::class, false) ):

	/**
	 * A utility class that helps figure out which plugin or theme WordPress is upgrading.
	 *
	 * It may seem strange to have a separate class just for that, but the task is surprisingly complicated.
	 * Core classes like Plugin_Upgrader don't expose the plugin file name during an in-progress update (AFAICT).
	 * This class uses a few workarounds and heuristics to get the file name.
	 */
	class UpgraderStatus {
		private $currentType = null; //This must be either "plugin" or "theme".
		private $currentId = null;   //Plugin basename or theme directory name.

		public function __construct() {
			//Keep track of which plugin/theme WordPress is currently upgrading.
			add_filter('upgrader_pre_install', array($this, 'setUpgradedThing'), 10, 2);
			add_filter('upgrader_package_options', array($this, 'setUpgradedPluginFromOptions'), 10, 1);
			add_filter('upgrader_post_install', array($this, 'clearUpgradedThing'), 10, 1);
			add_action('upgrader_process_complete', array($this, 'clearUpgradedThing'), 10, 1);
		}

		/**
		 * Is there and update being installed RIGHT NOW, for a specific plugin?
		 *
		 * Caution: This method is unreliable. WordPress doesn't make it easy to figure out what it is upgrading,
		 * and upgrader implementations are liable to change without notice.
		 *
		 * @param string $pluginFile The plugin to check.
		 * @param \WP_Upgrader|null $upgrader The upgrader that's performing the current update.
		 * @return bool True if the plugin identified by $pluginFile is being upgraded.
		 */
		public function isPluginBeingUpgraded($pluginFile, $upgrader = null) {
			return $this->isBeingUpgraded('plugin', $pluginFile, $upgrader);
		}

		/**
		 * Is there an update being installed for a specific theme?
		 *
		 * @param string $stylesheet Theme directory name.
		 * @param \WP_Upgrader|null $upgrader The upgrader that's performing the current update.
		 * @return bool
		 */
		public function isThemeBeingUpgraded($stylesheet, $upgrader = null) {
			return $this->isBeingUpgraded('theme', $stylesheet, $upgrader);
		}

		/**
		 * Check if a specific theme or plugin is being upgraded.
		 *
		 * @param string $type
		 * @param string $id
		 * @param \Plugin_Upgrader|\WP_Upgrader|null $upgrader
		 * @return bool
		 */
		protected function isBeingUpgraded($type, $id, $upgrader = null) {
			if ( isset($upgrader) ) {
				list($currentType, $currentId) = $this->getThingBeingUpgradedBy($upgrader);
				if ( $currentType !== null ) {
					$this->currentType = $currentType;
					$this->currentId = $currentId;
				}
			}
			return ($this->currentType === $type) && ($this->currentId === $id);
		}

		/**
		 * Figure out which theme or plugin is being upgraded by a WP_Upgrader instance.
		 *
		 * Returns an array with two items. The first item is the type of the thing that's being
		 * upgraded: "plugin" or "theme". The second item is either the plugin basename or
		 * the theme directory name. If we can't determine what the upgrader is doing, both items
		 * will be NULL.
		 *
		 * Examples:
		 *      ['plugin', 'plugin-dir-name/plugin.php']
		 *      ['theme', 'theme-dir-name']
		 *
		 * @param \Plugin_Upgrader|\WP_Upgrader $upgrader
		 * @return array
		 */
		private function getThingBeingUpgradedBy($upgrader) {
			if ( !isset($upgrader, $upgrader->skin) ) {
				return array(null, null);
			}

			//Figure out which plugin or theme is being upgraded.
			$pluginFile = null;
			$themeDirectoryName = null;

			$skin = $upgrader->skin;
			if ( isset($skin->theme_info) && ($skin->theme_info instanceof \WP_Theme) ) {
				$themeDirectoryName = $skin->theme_info->get_stylesheet();
			} elseif ( $skin instanceof \Plugin_Upgrader_Skin ) {
				if ( isset($skin->plugin) && is_string($skin->plugin) && ($skin->plugin !== '') ) {
					$pluginFile = $skin->plugin;
				}
			} elseif ( $skin instanceof \Theme_Upgrader_Skin ) {
				if ( isset($skin->theme) && is_string($skin->theme) && ($skin->theme !== '') ) {
					$themeDirectoryName = $skin->theme;
				}
			} elseif ( isset($skin->plugin_info) && is_array($skin->plugin_info) ) {
				//This case is tricky because Bulk_Plugin_Upgrader_Skin (etc) doesn't actually store the plugin
				//filename anywhere. Instead, it has the plugin headers in $plugin_info. So the best we can
				//do is compare those headers to the headers of installed plugins.
				$pluginFile = $this->identifyPluginByHeaders($skin->plugin_info);
			}

			if ( $pluginFile !== null ) {
				return array('plugin', $pluginFile);
			} elseif ( $themeDirectoryName !== null ) {
				return array('theme', $themeDirectoryName);
			}
			return array(null, null);
		}

		/**
		 * Identify an installed plugin based on its headers.
		 *
		 * @param array $searchHeaders The plugin file header to look for.
		 * @return string|null Plugin basename ("foo/bar.php"), or NULL if we can't identify the plugin.
		 */
		private function identifyPluginByHeaders($searchHeaders) {
			if ( !function_exists('get_plugins') ){
				require_once( ABSPATH . '/wp-admin/includes/plugin.php' );
			}

			$installedPlugins = get_plugins();
			$matches = array();
			foreach($installedPlugins as $pluginBasename => $headers) {
				$diff1 = array_diff_assoc($headers, $searchHeaders);
				$diff2 = array_diff_assoc($searchHeaders, $headers);
				if ( empty($diff1) && empty($diff2) ) {
					$matches[] = $pluginBasename;
				}
			}

			//It's possible (though very unlikely) that there could be two plugins with identical
			//headers. In that case, we can't unambiguously identify the plugin that's being upgraded.
			if ( count($matches) !== 1 ) {
				return null;
			}

			return reset($matches);
		}

		/**
		 * @access private
		 *
		 * @param mixed $input
		 * @param array $hookExtra
		 * @return mixed Returns $input unaltered.
		 */
		public function setUpgradedThing($input, $hookExtra) {
			if ( !empty($hookExtra['plugin']) && is_string($hookExtra['plugin']) ) {
				$this->currentId = $hookExtra['plugin'];
				$this->currentType = 'plugin';
			} elseif ( !empty($hookExtra['theme']) && is_string($hookExtra['theme']) ) {
				$this->currentId = $hookExtra['theme'];
				$this->currentType = 'theme';
			} else {
				$this->currentType = null;
				$this->currentId = null;
			}
			return $input;
		}

		/**
		 * @access private
		 *
		 * @param array $options
		 * @return array
		 */
		public function setUpgradedPluginFromOptions($options) {
			if ( isset($options['hook_extra']['plugin']) && is_string($options['hook_extra']['plugin']) ) {
				$this->currentType = 'plugin';
				$this->currentId = $options['hook_extra']['plugin'];
			} else {
				$this->currentType = null;
				$this->currentId = null;
			}
			return $options;
		}

		/**
		 * @access private
		 *
		 * @param mixed $input
		 * @return mixed Returns $input unaltered.
		 */
		public function clearUpgradedThing($input = null) {
			$this->currentId = null;
			$this->currentType = null;
			return $input;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Utils.php (1965 bytes, 71 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6;

if ( !class_exists(Utils::class, false) ):

	class Utils {
		/**
		 * Get a value from a nested array or object based on a path.
		 *
		 * @param array|object|null $collection Get an entry from this array.
		 * @param array|string $path A list of array keys in hierarchy order, or a string path like "foo.bar.baz".
		 * @param mixed $default The value to return if the specified path is not found.
		 * @param string $separator Path element separator. Only applies to string paths.
		 * @return mixed
		 */
		public static function get($collection, $path, $default = null, $separator = '.') {
			if ( is_string($path) ) {
				$path = explode($separator, $path);
			}

			//Follow the $path into $input as far as possible.
			$currentValue = $collection;
			foreach ($path as $node) {
				if ( is_array($currentValue) && isset($currentValue[$node]) ) {
					$currentValue = $currentValue[$node];
				} else if ( is_object($currentValue) && isset($currentValue->$node) ) {
					$currentValue = $currentValue->$node;
				} else {
					return $default;
				}
			}

			return $currentValue;
		}

		/**
		 * Get the first array element that is not empty.
		 *
		 * @param array $values
		 * @param mixed|null $default Returns this value if there are no non-empty elements.
		 * @return mixed|null
		 */
		public static function findNotEmpty($values, $default = null) {
			if ( empty($values) ) {
				return $default;
			}

			foreach ($values as $value) {
				if ( !empty($value) ) {
					return $value;
				}
			}

			return $default;
		}

		/**
		 * Check if the input string starts with the specified prefix.
		 *
		 * @param string $input
		 * @param string $prefix
		 * @return bool
		 */
		public static function startsWith($input, $prefix) {
			$length = strlen($prefix);
			return (substr($input, 0, $length) === $prefix);
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\WpCliCheckTrigger.php (2667 bytes, 84 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6;

use WP_CLI;

/**
 * Triggers an update check when relevant WP-CLI commands are executed.
 *
 * When WP-CLI runs certain commands like "wp plugin status" or "wp theme list", it calls
 * wp_update_plugins() and wp_update_themes() to refresh update information. This class hooks into
 * the same commands and triggers an update check when they are executed.
 *
 * Note that wp_update_plugins() and wp_update_themes() do not perform an update check *every* time
 * they are called. They use a context-dependent delay between update checks. Similarly, this class
 * calls Scheduler::maybeCheckForUpdates(), which also dynamically decides whether to actually
 * run a check. If you want to force an update check, call UpdateChecker::checkForUpdates() instead.
 */
class WpCliCheckTrigger {
	/**
	 * @var Scheduler
	 */
	private $scheduler;

	/**
	 * @var string 'plugin' or 'theme'
	 */
	private $componentType;

	/**
	 * @var bool Whether an update check was already triggered during the current request
	 *           or script execution.
	 */
	private $wasCheckTriggered = false;

	public function __construct($componentType, Scheduler $scheduler) {
		if ( !in_array($componentType, ['plugin', 'theme']) ) {
			throw new \InvalidArgumentException('Invalid component type. Must be "plugin" or "theme".');
		}

		$this->componentType = $componentType;
		$this->scheduler = $scheduler;

		if ( !defined('WP_CLI') || !class_exists(WP_CLI::class, false) ) {
			return; //Nothing to do if WP-CLI is not available.
		}

		/*
		 * We can't hook directly into wp_update_plugins(), but we can hook into the WP-CLI
		 * commands that call it. We'll use the "before_invoke:xyz" hook to trigger update checks.
		 */
		foreach ($this->getRelevantCommands() as $command) {
			WP_CLI::add_hook('before_invoke:' . $command, [$this, 'triggerUpdateCheckOnce']);
		}
	}

	private function getRelevantCommands() {
		$result = [];
		foreach (['status', 'list', 'update'] as $subcommand) {
			$result[] = $this->componentType . ' ' . $subcommand;
		}
		return $result;
	}

	/**
	 * Trigger a potential update check once.
	 *
	 * @param mixed $input
	 * @return mixed The input value, unchanged.
	 * @internal This method is public so that it can be used as a WP-CLI hook callback.
	 *           It should not be called directly.
	 *
	 */
	public function triggerUpdateCheckOnce($input = null) {
		if ( $this->wasCheckTriggered ) {
			return $input;
		}

		$this->wasCheckTriggered = true;
		$this->scheduler->maybeCheckForUpdates();

		return $input;
	}
}
`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\DebugBar\Extension.php (6670 bytes, 200 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6\DebugBar;

use YahnisElsts\PluginUpdateChecker\v5p6\PucFactory;
use YahnisElsts\PluginUpdateChecker\v5p6\UpdateChecker;

if ( !class_exists(Extension::class, false) ):

	class Extension {
		const RESPONSE_BODY_LENGTH_LIMIT = 4000;

		/** @var UpdateChecker */
		protected $updateChecker;
		protected $panelClass = Panel::class;

		public function __construct($updateChecker, $panelClass = null) {
			$this->updateChecker = $updateChecker;
			if ( isset($panelClass) ) {
				$this->panelClass = $panelClass;
			}

			if ( (strpos($this->panelClass, '\\') === false) ) {
				$this->panelClass = __NAMESPACE__ . '\\' . $this->panelClass;
			}

			add_filter('debug_bar_panels', array($this, 'addDebugBarPanel'));
			add_action('debug_bar_enqueue_scripts', array($this, 'enqueuePanelDependencies'));

			add_action('wp_ajax_puc_v5_debug_check_now', array($this, 'ajaxCheckNow'));
		}

		/**
		 * Register the PUC Debug Bar panel.
		 *
		 * @param array $panels
		 * @return array
		 */
		public function addDebugBarPanel($panels) {
			if ( $this->updateChecker->userCanInstallUpdates() ) {
				$panels[] = new $this->panelClass($this->updateChecker);
			}
			return $panels;
		}

		/**
		 * Enqueue our Debug Bar scripts and styles.
		 */
		public function enqueuePanelDependencies() {
			wp_enqueue_style(
				'puc-debug-bar-style-v5',
				$this->getLibraryUrl("/css/puc-debug-bar.css"),
				array('debug-bar'),
				'20221008'
			);

			wp_enqueue_script(
				'puc-debug-bar-js-v5',
				$this->getLibraryUrl("/js/debug-bar.js"),
				array('jquery'),
				'20221008'
			);
		}

		/**
		 * Run an update check and output the result. Useful for making sure that
		 * the update checking process works as expected.
		 */
		public function ajaxCheckNow() {
			//phpcs:ignore WordPress.Security.NonceVerification.Missing -- Nonce is checked in preAjaxRequest().
			if ( !isset($_POST['uid']) || ($_POST['uid'] !== $this->updateChecker->getUniqueName('uid')) ) {
				return;
			}
			$this->preAjaxRequest();
			$update = $this->updateChecker->checkForUpdates();
			if ( $update !== null ) {
				echo "An update is available:";
				//phpcs:ignore WordPress.PHP.DevelopmentFunctions.error_log_print_r -- For debugging output.
				echo '<pre>', esc_html(print_r($update, true)), '</pre>';
			} else {
				echo 'No updates found.';
			}

			$errors = $this->updateChecker->getLastRequestApiErrors();
			if ( !empty($errors) ) {
				printf('<p>The update checker encountered %d API error%s.</p>', count($errors), (count($errors) > 1) ? 's' : '');

				foreach (array_values($errors) as $num => $item) {
					$wpError = $item['error'];
					/** @var \WP_Error $wpError */
					printf('<h4>%d) %s</h4>', intval($num + 1), esc_html($wpError->get_error_message()));

					echo '<dl>';
					printf('<dt>Error code:</dt><dd><code>%s</code></dd>', esc_html($wpError->get_error_code()));

					if ( isset($item['url']) ) {
						printf('<dt>Requested URL:</dt><dd><code>%s</code></dd>', esc_html($item['url']));
					}

					if ( isset($item['httpResponse']) ) {
						if ( is_wp_error($item['httpResponse']) ) {
							$httpError = $item['httpResponse'];
							/** @var \WP_Error $httpError */
							printf(
								'<dt>WordPress HTTP API error:</dt><dd>%s (<code>%s</code>)</dd>',
								esc_html($httpError->get_error_message()),
								esc_html($httpError->get_error_code())
							);
						} else {
							//Status code.
							printf(
								'<dt>HTTP status:</dt><dd><code>%d %s</code></dd>',
								esc_html(wp_remote_retrieve_response_code($item['httpResponse'])),
								esc_html(wp_remote_retrieve_response_message($item['httpResponse']))
							);

							//Headers.
							echo '<dt>Response headers:</dt><dd><pre>';
							foreach (wp_remote_retrieve_headers($item['httpResponse']) as $name => $value) {
								printf("%s: %s\n", esc_html($name), esc_html($value));
							}
							echo '</pre></dd>';

							//Body.
							$body = wp_remote_retrieve_body($item['httpResponse']);
							if ( $body === '' ) {
								$body = '(Empty response.)';
							} else if ( strlen($body) > self::RESPONSE_BODY_LENGTH_LIMIT ) {
								$length = strlen($body);
								$body = substr($body, 0, self::RESPONSE_BODY_LENGTH_LIMIT)
									. sprintf("\n(Long string truncated. Total length: %d bytes.)", $length);
							}

							printf('<dt>Response body:</dt><dd><pre>%s</pre></dd>', esc_html($body));
						}
					}
					echo '<dl>';
				}
			}

			exit;
		}

		/**
		 * Check access permissions and enable error display (for debugging).
		 */
		protected function preAjaxRequest() {
			if ( !$this->updateChecker->userCanInstallUpdates() ) {
				die('Access denied');
			}
			check_ajax_referer('puc-ajax');

			//phpcs:ignore WordPress.PHP.DiscouragedPHPFunctions.runtime_configuration_error_reporting -- Part of a debugging feature.
			error_reporting(E_ALL);
			//phpcs:ignore WordPress.PHP.IniSet.display_errors_Blacklisted
			@ini_set('display_errors', 'On');
		}

		/**
		 * Remove hooks that were added by this extension.
		 */
		public function removeHooks() {
			remove_filter('debug_bar_panels', array($this, 'addDebugBarPanel'));
			remove_action('debug_bar_enqueue_scripts', array($this, 'enqueuePanelDependencies'));
			remove_action('wp_ajax_puc_v5_debug_check_now', array($this, 'ajaxCheckNow'));
		}

		/**
		 * @param string $filePath
		 * @return string
		 */
		private function getLibraryUrl($filePath) {
			$absolutePath = realpath(dirname(__FILE__) . '/../../../' . ltrim($filePath, '/'));

			//Where is the library located inside the WordPress directory structure?
			$absolutePath = PucFactory::normalizePath($absolutePath);

			$pluginDir = PucFactory::normalizePath(WP_PLUGIN_DIR);
			$muPluginDir = PucFactory::normalizePath(WPMU_PLUGIN_DIR);
			$themeDir = PucFactory::normalizePath(get_theme_root());

			if ( (strpos($absolutePath, $pluginDir) === 0) || (strpos($absolutePath, $muPluginDir) === 0) ) {
				//It's part of a plugin.
				return plugins_url(basename($absolutePath), $absolutePath);
			} else if ( strpos($absolutePath, $themeDir) === 0 ) {
				//It's part of a theme.
				$relativePath = substr($absolutePath, strlen($themeDir) + 1);
				$template = substr($relativePath, 0, strpos($relativePath, '/'));
				$baseUrl = get_theme_root_uri($template);

				if ( !empty($baseUrl) && $relativePath ) {
					return $baseUrl . '/' . $relativePath;
				}
			}

			return '';
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\DebugBar\Panel.php (6053 bytes, 187 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6\DebugBar;

use YahnisElsts\PluginUpdateChecker\v5p6\UpdateChecker;

if ( !class_exists(Panel::class, false) && class_exists('Debug_Bar_Panel', false) ):

	class Panel extends \Debug_Bar_Panel {
		/** @var UpdateChecker */
		protected $updateChecker;

		private $responseBox = '<div class="puc-ajax-response" style="display: none;"></div>';

		public function __construct($updateChecker) {
			$this->updateChecker = $updateChecker;
			$title = sprintf(
				'<span class="puc-debug-menu-link-%s">PUC (%s)</span>',
				esc_attr($this->updateChecker->getUniqueName('uid')),
				$this->updateChecker->slug
			);
			parent::__construct($title);
		}

		public function render() {
			printf(
				'<div class="puc-debug-bar-panel-v5" id="%1$s" data-slug="%2$s" data-uid="%3$s" data-nonce="%4$s">',
				esc_attr($this->updateChecker->getUniqueName('debug-bar-panel')),
				esc_attr($this->updateChecker->slug),
				esc_attr($this->updateChecker->getUniqueName('uid')),
				esc_attr(wp_create_nonce('puc-ajax'))
			);

			$this->displayConfiguration();
			$this->displayStatus();
			$this->displayCurrentUpdate();

			echo '</div>';
		}

		private function displayConfiguration() {
			echo '<h3>Configuration</h3>';
			echo '<table class="puc-debug-data">';
			$this->displayConfigHeader();
			$this->row('Slug', esc_html($this->updateChecker->slug));
			$this->row('DB option', esc_html($this->updateChecker->optionName));

			$requestInfoButton = $this->getMetadataButton();
			$this->row('Metadata URL', esc_html($this->updateChecker->metadataUrl) . ' ' . $requestInfoButton . $this->responseBox);

			$scheduler = $this->updateChecker->scheduler;
			if ( $scheduler->checkPeriod > 0 ) {
				$this->row('Automatic checks', 'Every ' . $scheduler->checkPeriod . ' hours');
			} else {
				$this->row('Automatic checks', 'Disabled');
			}

			if ( isset($scheduler->throttleRedundantChecks) ) {
				if ( $scheduler->throttleRedundantChecks && ($scheduler->checkPeriod > 0) ) {
					$this->row(
						'Throttling',
						sprintf(
							'Enabled. If an update is already available, check for updates every %1$d hours instead of every %2$d hours.',
							$scheduler->throttledCheckPeriod,
							$scheduler->checkPeriod
						)
					);
				} else {
					$this->row('Throttling', 'Disabled');
				}
			}

			$this->updateChecker->onDisplayConfiguration($this);

			echo '</table>';
		}

		protected function displayConfigHeader() {
			//Do nothing. This should be implemented in subclasses.
		}

		protected function getMetadataButton() {
			return '';
		}

		private function displayStatus() {
			echo '<h3>Status</h3>';
			echo '<table class="puc-debug-data">';
			$state = $this->updateChecker->getUpdateState();
			$checkButtonId = $this->updateChecker->getUniqueName('check-now-button');
			if ( function_exists('get_submit_button')  ) {
				$checkNowButton = get_submit_button(
					'Check Now',
					'secondary',
					'puc-check-now-button',
					false,
					array('id' => $checkButtonId)
				);
			} else {
				//get_submit_button() is not available in the frontend. Make a button directly.
				//It won't look the same without admin styles, but it should still work.
				$checkNowButton = sprintf(
					'<input type="button" id="%1$s" name="puc-check-now-button" value="%2$s" class="button button-secondary" />',
					esc_attr($checkButtonId),
					esc_attr('Check Now')
				);
			}

			if ( $state->getLastCheck() > 0 ) {
				$this->row('Last check', $this->formatTimeWithDelta($state->getLastCheck()) . ' ' . $checkNowButton . $this->responseBox);
			} else {
				$this->row('Last check', 'Never');
			}

			$nextCheck = wp_next_scheduled($this->updateChecker->scheduler->getCronHookName());
			$this->row('Next automatic check', $this->formatTimeWithDelta($nextCheck));

			if ( $state->getCheckedVersion() !== '' ) {
				$this->row('Checked version', esc_html($state->getCheckedVersion()));
				$this->row('Cached update', $state->getUpdate());
			}
			$this->row('Update checker class', esc_html(get_class($this->updateChecker)));
			echo '</table>';
		}

		private function displayCurrentUpdate() {
			$update = $this->updateChecker->getUpdate();
			if ( $update !== null ) {
				echo '<h3>An Update Is Available</h3>';
				echo '<table class="puc-debug-data">';
				$fields = $this->getUpdateFields();
				foreach($fields as $field) {
					if ( property_exists($update, $field) ) {
						$this->row(
							ucwords(str_replace('_', ' ', $field)),
							isset($update->$field) ? esc_html($update->$field) : null
						);
					}
				}
				echo '</table>';
			} else {
				echo '<h3>No updates currently available</h3>';
			}
		}

		protected function getUpdateFields() {
			return array('version', 'download_url', 'slug',);
		}

		private function formatTimeWithDelta($unixTime) {
			if ( empty($unixTime) ) {
				return 'Never';
			}

			$delta = time() - $unixTime;
			$result = human_time_diff(time(), $unixTime);
			if ( $delta < 0 ) {
				$result = 'after ' . $result;
			} else {
				$result = $result . ' ago';
			}
			$result .= ' (' . $this->formatTimestamp($unixTime) . ')';
			return $result;
		}

		private function formatTimestamp($unixTime) {
			return gmdate('Y-m-d H:i:s', $unixTime + (get_option('gmt_offset') * 3600));
		}

		public function row($name, $value) {
			if ( is_object($value) || is_array($value) ) {
				//This is specifically for debugging, so print_r() is fine.
				//phpcs:ignore WordPress.PHP.DevelopmentFunctions.error_log_print_r
				$value = '<pre>' . esc_html(print_r($value, true)) . '</pre>';
			} else if ($value === null) {
				$value = '<code>null</code>';
			}
			printf(
				'<tr><th scope="row">%1$s</th> <td>%2$s</td></tr>',
				esc_html($name),
				//phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped -- Escaped above.
				$value
			);
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\DebugBar\PluginExtension.php (1270 bytes, 41 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\DebugBar;

use YahnisElsts\PluginUpdateChecker\v5p6\Plugin\UpdateChecker;

if ( !class_exists(PluginExtension::class, false) ):

	class PluginExtension extends Extension {
		/** @var UpdateChecker */
		protected $updateChecker;

		public function __construct($updateChecker) {
			parent::__construct($updateChecker, PluginPanel::class);

			add_action('wp_ajax_puc_v5_debug_request_info', array($this, 'ajaxRequestInfo'));
		}

		/**
		 * Request plugin info and output it.
		 */
		public function ajaxRequestInfo() {
			//phpcs:ignore WordPress.Security.NonceVerification.Missing -- Nonce is checked in preAjaxRequest().
			if ( !isset($_POST['uid']) || ($_POST['uid'] !== $this->updateChecker->getUniqueName('uid')) ) {
				return;
			}
			$this->preAjaxRequest();
			$info = $this->updateChecker->requestInfo();
			if ( $info !== null ) {
				echo 'Successfully retrieved plugin info from the metadata URL:';
				//phpcs:ignore WordPress.PHP.DevelopmentFunctions.error_log_print_r -- For debugging output.
				echo '<pre>', esc_html(print_r($info, true)), '</pre>';
			} else {
				echo 'Failed to retrieve plugin info from the metadata URL.';
			}
			exit;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\DebugBar\PluginPanel.php (1248 bytes, 48 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6\DebugBar;

use YahnisElsts\PluginUpdateChecker\v5p6\Plugin\UpdateChecker;

if ( !class_exists(PluginPanel::class, false) ):

	class PluginPanel extends Panel {
		/**
		 * @var UpdateChecker
		 */
		protected $updateChecker;

		protected function displayConfigHeader() {
			$this->row('Plugin file', esc_html($this->updateChecker->pluginFile));
			parent::displayConfigHeader();
		}

		protected function getMetadataButton() {
			$buttonId = $this->updateChecker->getUniqueName('request-info-button');
			if ( function_exists('get_submit_button') ) {
				$requestInfoButton = get_submit_button(
					'Request Info',
					'secondary',
					'puc-request-info-button',
					false,
					array('id' => $buttonId)
				);
			} else {
				$requestInfoButton = sprintf(
					'<input type="button" name="puc-request-info-button" id="%1$s" value="%2$s" class="button button-secondary" />',
					esc_attr($buttonId),
					esc_attr('Request Info')
				);
			}
			return $requestInfoButton;
		}

		protected function getUpdateFields() {
			return array_merge(
				parent::getUpdateFields(),
				array('homepage', 'upgrade_notice', 'tested',)
			);
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\DebugBar\ThemePanel.php (594 bytes, 26 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\DebugBar;

use YahnisElsts\PluginUpdateChecker\v5p6\Theme\UpdateChecker;

if ( !class_exists(ThemePanel::class, false) ):

	class ThemePanel extends Panel {
		/**
		 * @var UpdateChecker
		 */
		protected $updateChecker;

		protected function displayConfigHeader() {
			$this->row('Theme directory', esc_html($this->updateChecker->directoryName));
			parent::displayConfigHeader();
		}

		protected function getUpdateFields() {
			return array_merge(parent::getUpdateFields(), array('details_url'));
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Plugin\Package.php (5735 bytes, 189 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6\Plugin;

use YahnisElsts\PluginUpdateChecker\v5p6\InstalledPackage;
use YahnisElsts\PluginUpdateChecker\v5p6\PucFactory;

if ( !class_exists(Package::class, false) ):

	class Package extends InstalledPackage {
		/**
		 * @var UpdateChecker
		 */
		protected $updateChecker;

		/**
		 * @var string Full path of the main plugin file.
		 */
		protected $pluginAbsolutePath = '';

		/**
		 * @var string Plugin basename.
		 */
		private $pluginFile;

		/**
		 * @var string|null
		 */
		private $cachedInstalledVersion = null;

		public function __construct($pluginAbsolutePath, $updateChecker) {
			$this->pluginAbsolutePath = $pluginAbsolutePath;
			$this->pluginFile = plugin_basename($this->pluginAbsolutePath);

			parent::__construct($updateChecker);

			//Clear the version number cache when something - anything - is upgraded or WP clears the update cache.
			add_filter('upgrader_post_install', array($this, 'clearCachedVersion'));
			add_action('delete_site_transient_update_plugins', array($this, 'clearCachedVersion'));
		}

		public function getInstalledVersion() {
			if ( isset($this->cachedInstalledVersion) ) {
				return $this->cachedInstalledVersion;
			}

			$pluginHeader = $this->getPluginHeader();
			if ( isset($pluginHeader['Version']) ) {
				$this->cachedInstalledVersion = $pluginHeader['Version'];
				return $pluginHeader['Version'];
			} else {
				//This can happen if the filename points to something that is not a plugin.
				$this->updateChecker->triggerError(
					sprintf(
						"Cannot read the Version header for '%s'. The filename is incorrect or is not a plugin.",
						$this->updateChecker->pluginFile
					),
					E_USER_WARNING
				);
				return null;
			}
		}

		/**
		 * Clear the cached plugin version. This method can be set up as a filter (hook) and will
		 * return the filter argument unmodified.
		 *
		 * @param mixed $filterArgument
		 * @return mixed
		 */
		public function clearCachedVersion($filterArgument = null) {
			$this->cachedInstalledVersion = null;
			return $filterArgument;
		}

		public function getAbsoluteDirectoryPath() {
			return dirname($this->pluginAbsolutePath);
		}

		/**
		 * Get the value of a specific plugin or theme header.
		 *
		 * @param string $headerName
		 * @param string $defaultValue
		 * @return string Either the value of the header, or $defaultValue if the header doesn't exist or is empty.
		 */
		public function getHeaderValue($headerName, $defaultValue = '') {
			$headers = $this->getPluginHeader();
			if ( isset($headers[$headerName]) && ($headers[$headerName] !== '') ) {
				return $headers[$headerName];
			}
			return $defaultValue;
		}

		protected function getHeaderNames() {
			return array(
				'Name'              => 'Plugin Name',
				'PluginURI'         => 'Plugin URI',
				'Version'           => 'Version',
				'Description'       => 'Description',
				'Author'            => 'Author',
				'AuthorURI'         => 'Author URI',
				'TextDomain'        => 'Text Domain',
				'DomainPath'        => 'Domain Path',
				'Network'           => 'Network',

				//The newest WordPress version that this plugin requires or has been tested with.
				//We support several different formats for compatibility with other libraries.
				'Tested WP'         => 'Tested WP',
				'Requires WP'       => 'Requires WP',
				'Tested up to'      => 'Tested up to',
				'Requires at least' => 'Requires at least',
			);
		}

		/**
		 * Get the translated plugin title.
		 *
		 * @return string
		 */
		public function getPluginTitle() {
			$title = '';
			$header = $this->getPluginHeader();
			if ( $header && !empty($header['Name']) && isset($header['TextDomain']) ) {
				$title = translate($header['Name'], $header['TextDomain']);
			}
			return $title;
		}

		/**
		 * Get plugin's metadata from its file header.
		 *
		 * @return array
		 */
		public function getPluginHeader() {
			if ( !is_file($this->pluginAbsolutePath) ) {
				//This can happen if the plugin filename is wrong.
				$this->updateChecker->triggerError(
					sprintf(
						"Can't to read the plugin header for '%s'. The file does not exist.",
						$this->updateChecker->pluginFile
					),
					E_USER_WARNING
				);
				return array();
			}

			if ( !function_exists('get_plugin_data') ) {
				require_once(ABSPATH . '/wp-admin/includes/plugin.php');
			}
			return get_plugin_data($this->pluginAbsolutePath, false, false);
		}

		public function removeHooks() {
			remove_filter('upgrader_post_install', array($this, 'clearCachedVersion'));
			remove_action('delete_site_transient_update_plugins', array($this, 'clearCachedVersion'));
		}

		/**
		 * Check if the plugin file is inside the mu-plugins directory.
		 *
		 * @return bool
		 */
		public function isMuPlugin() {
			static $cachedResult = null;

			if ( $cachedResult === null ) {
				if ( !defined('WPMU_PLUGIN_DIR') || !is_string(WPMU_PLUGIN_DIR) ) {
					$cachedResult = false;
					return $cachedResult;
				}

				//Convert both paths to the canonical form before comparison.
				$muPluginDir = realpath(WPMU_PLUGIN_DIR);
				$pluginPath  = realpath($this->pluginAbsolutePath);
				//If realpath() fails, just normalize the syntax instead.
				if (($muPluginDir === false) || ($pluginPath === false)) {
					$muPluginDir = PucFactory::normalizePath(WPMU_PLUGIN_DIR);
					$pluginPath  = PucFactory::normalizePath($this->pluginAbsolutePath);
				}

				$cachedResult = (strpos($pluginPath, $muPluginDir) === 0);
			}

			return $cachedResult;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Plugin\PluginInfo.php (3973 bytes, 137 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6\Plugin;

use YahnisElsts\PluginUpdateChecker\v5p6\Metadata;

if ( !class_exists(PluginInfo::class, false) ):

	/**
	 * A container class for holding and transforming various plugin metadata.
	 *
	 * @author Janis Elsts
	 * @copyright 2016
	 * @access public
	 */
	class PluginInfo extends Metadata {
		//Most fields map directly to the contents of the plugin's info.json file.
		//See the relevant docs for a description of their meaning.
		public $name;
		public $slug;
		public $version;
		public $homepage;
		public $sections = array();
		public $download_url;

		public $banners;
		public $icons = array();
		public $translations = array();

		public $author;
		public $author_homepage;

		public $requires;
		public $tested;
		public $requires_php;
		public $upgrade_notice;

		public $rating;
		public $num_ratings;
		public $downloaded;
		public $active_installs;
		public $last_updated;

		public $id = 0; //The native WP.org API returns numeric plugin IDs, but they're not used for anything.

		public $filename; //Plugin filename relative to the plugins directory.

		/**
		 * Create a new instance of Plugin Info from JSON-encoded plugin info
		 * returned by an external update API.
		 *
		 * @param string $json Valid JSON string representing plugin info.
		 * @return self|null New instance of Plugin Info, or NULL on error.
		 */
		public static function fromJson($json){
			$instance = new self();

			if ( !parent::createFromJson($json, $instance) ) {
				return null;
			}

			//json_decode decodes assoc. arrays as objects. We want them as arrays.
			$instance->sections = (array)$instance->sections;
			$instance->icons = (array)$instance->icons;

			return $instance;
		}

		/**
		 * Very, very basic validation.
		 *
		 * @param \StdClass $apiResponse
		 * @return bool|\WP_Error
		 */
		protected function validateMetadata($apiResponse) {
			if (
				!isset($apiResponse->name, $apiResponse->version)
				|| empty($apiResponse->name)
				|| empty($apiResponse->version)
			) {
				return new \WP_Error(
					'puc-invalid-metadata',
					"The plugin metadata file does not contain the required 'name' and/or 'version' keys."
				);
			}
			return true;
		}


		/**
		 * Transform plugin info into the format used by the native WordPress.org API
		 *
		 * @return object
		 */
		public function toWpFormat(){
			$info = new \stdClass;

			//The custom update API is built so that many fields have the same name and format
			//as those returned by the native WordPress.org API. These can be assigned directly.
			$sameFormat = array(
				'name', 'slug', 'version', 'requires', 'tested', 'rating', 'upgrade_notice',
				'num_ratings', 'downloaded', 'active_installs', 'homepage', 'last_updated',
				'requires_php',
			);
			foreach($sameFormat as $field){
				if ( isset($this->$field) ) {
					$info->$field = $this->$field;
				} else {
					$info->$field = null;
				}
			}

			//Other fields need to be renamed and/or transformed.
			$info->download_link = $this->download_url;
			$info->author = $this->getFormattedAuthor();
			$info->sections = array_merge(array('description' => ''), $this->sections);

			if ( !empty($this->banners) ) {
				//WP expects an array with two keys: "high" and "low". Both are optional.
				//Docs: https://wordpress.org/plugins/about/faq/#banners
				$info->banners = is_object($this->banners) ? get_object_vars($this->banners) : $this->banners;
				$info->banners = array_intersect_key($info->banners, array('high' => true, 'low' => true));
			}

			return $info;
		}

		protected function getFormattedAuthor() {
			if ( !empty($this->author_homepage) ){
				/** @noinspection HtmlUnknownTarget */
				return sprintf('<a href="%s">%s</a>', $this->author_homepage, $this->author);
			}
			return $this->author;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Plugin\Ui.php (10719 bytes, 295 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6\Plugin;

if ( !class_exists(Ui::class, false) ):
	/**
	 * Additional UI elements for plugins.
	 */
	class Ui {
		private $updateChecker;
		private $manualCheckErrorTransient = '';

		/**
		 * @param UpdateChecker $updateChecker
		 */
		public function __construct($updateChecker) {
			$this->updateChecker = $updateChecker;
			$this->manualCheckErrorTransient = $this->updateChecker->getUniqueName('manual_check_errors');

			add_action('admin_init', array($this, 'onAdminInit'));
		}

		public function onAdminInit() {
			if ( $this->updateChecker->userCanInstallUpdates() ) {
				$this->handleManualCheck();

				add_filter('plugin_row_meta', array($this, 'addViewDetailsLink'), 10, 3);
				add_filter('plugin_row_meta', array($this, 'addCheckForUpdatesLink'), 10, 2);
				add_action('all_admin_notices', array($this, 'displayManualCheckResult'));
			}
		}

		/**
		 * Add a "View Details" link to the plugin row in the "Plugins" page. By default,
		 * the new link will appear before the "Visit plugin site" link (if present).
		 *
		 * You can change the link text by using the "puc_view_details_link-$slug" filter.
		 * Returning an empty string from the filter will disable the link.
		 *
		 * You can change the position of the link using the
		 * "puc_view_details_link_position-$slug" filter.
		 * Returning 'before' or 'after' will place the link immediately before/after
		 * the "Visit plugin site" link.
		 * Returning 'append' places the link after any existing links at the time of the hook.
		 * Returning 'replace' replaces the "Visit plugin site" link.
		 * Returning anything else disables the link when there is a "Visit plugin site" link.
		 *
		 * If there is no "Visit plugin site" link 'append' is always used!
		 *
		 * @param array $pluginMeta Array of meta links.
		 * @param string $pluginFile
		 * @param array $pluginData Array of plugin header data.
		 * @return array
		 */
		public function addViewDetailsLink($pluginMeta, $pluginFile, $pluginData = array()) {
			if ( $this->isMyPluginFile($pluginFile) && !isset($pluginData['slug']) ) {
				$linkText = apply_filters($this->updateChecker->getUniqueName('view_details_link'), __('View details'));
				if ( !empty($linkText) ) {
					$viewDetailsLinkPosition = 'append';

					//Find the "Visit plugin site" link (if present).
					$visitPluginSiteLinkIndex = count($pluginMeta) - 1;
					if ( $pluginData['PluginURI'] ) {
						$escapedPluginUri = esc_url($pluginData['PluginURI']);
						foreach ($pluginMeta as $linkIndex => $existingLink) {
							if ( strpos($existingLink, $escapedPluginUri) !== false ) {
								$visitPluginSiteLinkIndex = $linkIndex;
								$viewDetailsLinkPosition = apply_filters(
									$this->updateChecker->getUniqueName('view_details_link_position'),
									'before'
								);
								break;
							}
						}
					}

					$viewDetailsLink = sprintf('<a href="%s" class="thickbox open-plugin-details-modal" aria-label="%s" data-title="%s">%s</a>',
						esc_url(network_admin_url('plugin-install.php?tab=plugin-information&plugin=' . urlencode($this->updateChecker->slug) .
							'&TB_iframe=true&width=600&height=550')),
						esc_attr(sprintf(__('More information about %s'), $pluginData['Name'])),
						esc_attr($pluginData['Name']),
						$linkText
					);
					switch ($viewDetailsLinkPosition) {
						case 'before':
							array_splice($pluginMeta, $visitPluginSiteLinkIndex, 0, $viewDetailsLink);
							break;
						case 'after':
							array_splice($pluginMeta, $visitPluginSiteLinkIndex + 1, 0, $viewDetailsLink);
							break;
						case 'replace':
							$pluginMeta[$visitPluginSiteLinkIndex] = $viewDetailsLink;
							break;
						case 'append':
						default:
							$pluginMeta[] = $viewDetailsLink;
							break;
					}
				}
			}
			return $pluginMeta;
		}

		/**
		 * Add a "Check for updates" link to the plugin row in the "Plugins" page. By default,
		 * the new link will appear after the "Visit plugin site" link if present, otherwise
		 * after the "View plugin details" link.
		 *
		 * You can change the link text by using the "puc_manual_check_link-$slug" filter.
		 * Returning an empty string from the filter will disable the link.
		 *
		 * @param array $pluginMeta Array of meta links.
		 * @param string $pluginFile
		 * @return array
		 */
		public function addCheckForUpdatesLink($pluginMeta, $pluginFile) {
			if ( $this->isMyPluginFile($pluginFile) ) {
				$linkUrl = wp_nonce_url(
					add_query_arg(
						array(
							'puc_check_for_updates' => 1,
							'puc_slug'              => $this->updateChecker->slug,
						),
						self_admin_url('plugins.php')
					),
					'puc_check_for_updates'
				);

				$linkText = apply_filters(
					$this->updateChecker->getUniqueName('manual_check_link'),
					__('Check for updates', 'plugin-update-checker')
				);
				if ( !empty($linkText) ) {
					/** @noinspection HtmlUnknownTarget */
					$pluginMeta[] = sprintf('<a href="%s">%s</a>', esc_attr($linkUrl), $linkText);
				}
			}
			return $pluginMeta;
		}

		protected function isMyPluginFile($pluginFile) {
			return ($pluginFile == $this->updateChecker->pluginFile)
				|| (!empty($this->updateChecker->muPluginFile) && ($pluginFile == $this->updateChecker->muPluginFile));
		}

		/**
		 * Check for updates when the user clicks the "Check for updates" link.
		 *
		 * @see self::addCheckForUpdatesLink()
		 *
		 * @return void
		 */
		public function handleManualCheck() {
			$shouldCheck =
				isset($_GET['puc_check_for_updates'], $_GET['puc_slug'])
				&& $_GET['puc_slug'] == $this->updateChecker->slug
				&& check_admin_referer('puc_check_for_updates');

			if ( $shouldCheck ) {
				$update = $this->updateChecker->checkForUpdates();
				$status = ($update === null) ? 'no_update' : 'update_available';
				$lastRequestApiErrors = $this->updateChecker->getLastRequestApiErrors();

				if ( ($update === null) && !empty($lastRequestApiErrors) ) {
					//Some errors are not critical. For example, if PUC tries to retrieve the readme.txt
					//file from GitHub and gets a 404, that's an API error, but it doesn't prevent updates
					//from working. Maybe the plugin simply doesn't have a readme.
					//Let's only show important errors.
					$foundCriticalErrors = false;
					$questionableErrorCodes = array(
						'puc-github-http-error',
						'puc-gitlab-http-error',
						'puc-bitbucket-http-error',
					);

					foreach ($lastRequestApiErrors as $item) {
						$wpError = $item['error'];
						/** @var \WP_Error $wpError */
						if ( !in_array($wpError->get_error_code(), $questionableErrorCodes) ) {
							$foundCriticalErrors = true;
							break;
						}
					}

					if ( $foundCriticalErrors ) {
						$status = 'error';
						set_site_transient($this->manualCheckErrorTransient, $lastRequestApiErrors, 60);
					}
				}

				wp_safe_redirect(add_query_arg(
					array(
						'puc_update_check_result' => $status,
						'puc_slug'                => $this->updateChecker->slug,
					),
					self_admin_url('plugins.php')
				));
				exit;
			}
		}

		/**
		 * Display the results of a manual update check.
		 *
		 * @see self::handleManualCheck()
		 *
		 * You can change the result message by using the "puc_manual_check_message-$slug" filter.
		 */
		public function displayManualCheckResult() {
			//phpcs:disable WordPress.Security.NonceVerification.Recommended -- Just displaying a message.
			if ( isset($_GET['puc_update_check_result'], $_GET['puc_slug']) && ($_GET['puc_slug'] == $this->updateChecker->slug) ) {
				$status = sanitize_key($_GET['puc_update_check_result']);
				$title = $this->updateChecker->getInstalledPackage()->getPluginTitle();
				$noticeClass = 'updated notice-success';
				$details = '';

				if ( $status == 'no_update' ) {
					$message = sprintf(_x('The %s plugin is up to date.', 'the plugin title', 'plugin-update-checker'), $title);
				} else if ( $status == 'update_available' ) {
					$message = sprintf(_x('A new version of the %s plugin is available.', 'the plugin title', 'plugin-update-checker'), $title);
				} else if ( $status === 'error' ) {
					$message = sprintf(_x('Could not determine if updates are available for %s.', 'the plugin title', 'plugin-update-checker'), $title);
					$noticeClass = 'error notice-error';

					$details = $this->formatManualCheckErrors(get_site_transient($this->manualCheckErrorTransient));
					delete_site_transient($this->manualCheckErrorTransient);
				} else {
					$message = sprintf(__('Unknown update checker status "%s"', 'plugin-update-checker'), $status);
					$noticeClass = 'error notice-error';
				}

				$message = esc_html($message);

				//Plugins can replace the message with their own, including adding HTML.
				$message = apply_filters(
					$this->updateChecker->getUniqueName('manual_check_message'),
					$message,
					$status
				);

				printf(
					'<div class="notice %s is-dismissible"><p>%s</p>%s</div>',
					esc_attr($noticeClass),
					//phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped -- Was escaped above, and plugins can add HTML.
					$message,
					//phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped -- Contains HTML. Content should already be escaped.
					$details
				);
			}
			//phpcs:enable
		}

		/**
		 * Format the list of errors that were thrown during an update check.
		 *
		 * @param array $errors
		 * @return string
		 */
		protected function formatManualCheckErrors($errors) {
			if ( empty($errors) ) {
				return '';
			}
			$output = '';

			$showAsList = count($errors) > 1;
			if ( $showAsList ) {
				$output .= '<ol>';
				$formatString = '<li>%1$s <code>%2$s</code></li>';
			} else {
				$formatString = '<p>%1$s <code>%2$s</code></p>';
			}
			foreach ($errors as $item) {
				$wpError = $item['error'];
				/** @var \WP_Error $wpError */
				$output .= sprintf(
					$formatString,
					esc_html($wpError->get_error_message()),
					esc_html($wpError->get_error_code())
				);
			}
			if ( $showAsList ) {
				$output .= '</ol>';
			}

			return $output;
		}

		public function removeHooks() {
			remove_action('admin_init', array($this, 'onAdminInit'));
			remove_filter('plugin_row_meta', array($this, 'addViewDetailsLink'), 10);
			remove_filter('plugin_row_meta', array($this, 'addCheckForUpdatesLink'), 10);
			remove_action('all_admin_notices', array($this, 'displayManualCheckResult'));
		}
	}
endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Plugin\Update.php (3375 bytes, 117 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6\Plugin;

use YahnisElsts\PluginUpdateChecker\v5p6\Update as BaseUpdate;

if ( !class_exists(Update::class, false) ):

	/**
	 * A simple container class for holding information about an available update.
	 *
	 * @author Janis Elsts
	 * @copyright 2016
	 * @access public
	 */
	class Update extends BaseUpdate {
		public $id = 0;
		public $homepage;
		public $upgrade_notice;
		public $tested;
		public $requires_php = false;
		public $icons = array();
		public $filename; //Plugin filename relative to the plugins directory.

		protected static $extraFields = array(
			'id', 'homepage', 'tested', 'requires_php', 'upgrade_notice', 'icons', 'filename',
		);

		/**
		 * Create a new instance of PluginUpdate from its JSON-encoded representation.
		 *
		 * @param string $json
		 * @return self|null
		 */
		public static function fromJson($json){
			//Since update-related information is simply a subset of the full plugin info,
			//we can parse the update JSON as if it was a plugin info string, then copy over
			//the parts that we care about.
			$pluginInfo = PluginInfo::fromJson($json);
			if ( $pluginInfo !== null ) {
				return self::fromPluginInfo($pluginInfo);
			} else {
				return null;
			}
		}

		/**
		 * Create a new instance of PluginUpdate based on an instance of PluginInfo.
		 * Basically, this just copies a subset of fields from one object to another.
		 *
		 * @param PluginInfo $info
		 * @return static
		 */
		public static function fromPluginInfo($info){
			return static::fromObject($info);
		}

		/**
		 * Create a new instance by copying the necessary fields from another object.
		 *
		 * @param \StdClass|PluginInfo|self $object The source object.
		 * @return self The new copy.
		 */
		public static function fromObject($object) {
			$update = new self();
			$update->copyFields($object, $update);
			return $update;
		}

		/**
		 * @return string[]
		 */
		protected function getFieldNames() {
			return array_merge(parent::getFieldNames(), self::$extraFields);
		}

		/**
		 * Transform the update into the format used by WordPress native plugin API.
		 *
		 * @return object
		 */
		public function toWpFormat() {
			$update = parent::toWpFormat();

			$update->id = $this->id;
			$update->url = $this->homepage;
			$update->tested = $this->tested;
			$update->requires_php = $this->requires_php;
			$update->plugin = $this->filename;

			if ( !empty($this->upgrade_notice) ) {
				$update->upgrade_notice = $this->upgrade_notice;
			}

			if ( !empty($this->icons) && is_array($this->icons) ) {
				//This should be an array with up to 4 keys: 'svg', '1x', '2x' and 'default'.
				//Docs: https://developer.wordpress.org/plugins/wordpress-org/plugin-assets/#plugin-icons
				$icons = array_intersect_key(
					$this->icons,
					array('svg' => true, '1x' => true, '2x' => true, 'default' => true)
				);
				if ( !empty($icons) ) {
					$update->icons = $icons;

					//It appears that the 'default' icon isn't used anywhere in WordPress 4.9,
					//but lets set it just in case a future release needs it.
					if ( !isset($update->icons['default']) ) {
						$update->icons['default'] = current($update->icons);
					}
				}
			}

			return $update;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Plugin\UpdateChecker.php (13780 bytes, 426 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6\Plugin;

use YahnisElsts\PluginUpdateChecker\v5p6\InstalledPackage;
use YahnisElsts\PluginUpdateChecker\v5p6\UpdateChecker as BaseUpdateChecker;
use YahnisElsts\PluginUpdateChecker\v5p6\Scheduler;
use YahnisElsts\PluginUpdateChecker\v5p6\DebugBar;

if ( !class_exists(UpdateChecker::class, false) ):

	/**
	 * A custom plugin update checker.
	 *
	 * @author Janis Elsts
	 * @copyright 2018
	 * @access public
	 */
	class UpdateChecker extends BaseUpdateChecker {
		protected $updateTransient = 'update_plugins';
		protected $componentType = 'plugin';

		public $pluginAbsolutePath = ''; //Full path of the main plugin file.
		public $pluginFile = '';  //Plugin filename relative to the plugins directory. Many WP APIs use this to identify plugins.
		public $muPluginFile = ''; //For MU plugins, the plugin filename relative to the mu-plugins directory.

		/**
		 * @var Package
		 */
		protected $package;

		private $extraUi = null;

		/**
		 * Class constructor.
		 *
		 * @param string $metadataUrl The URL of the plugin's metadata file.
		 * @param string $pluginFile Fully qualified path to the main plugin file.
		 * @param string $slug The plugin's 'slug'. If not specified, the filename part of $pluginFile sans '.php' will be used as the slug.
		 * @param integer $checkPeriod How often to check for updates (in hours). Defaults to checking every 12 hours. Set to 0 to disable automatic update checks.
		 * @param string $optionName Where to store book-keeping info about update checks. Defaults to 'external_updates-$slug'.
		 * @param string $muPluginFile Optional. The plugin filename relative to the mu-plugins directory.
		 */
		public function __construct($metadataUrl, $pluginFile, $slug = '', $checkPeriod = 12, $optionName = '', $muPluginFile = ''){
			$this->pluginAbsolutePath = $pluginFile;
			$this->pluginFile = plugin_basename($this->pluginAbsolutePath);
			$this->muPluginFile = $muPluginFile;

			//If no slug is specified, use the name of the main plugin file as the slug.
			//For example, 'my-cool-plugin/cool-plugin.php' becomes 'cool-plugin'.
			if ( empty($slug) ){
				$slug = basename($this->pluginFile, '.php');
			}

			//Plugin slugs must be unique.
			$slugCheckFilter = 'puc_is_slug_in_use-' . $slug;
			$slugUsedBy = apply_filters($slugCheckFilter, false);
			if ( $slugUsedBy ) {
				$this->triggerError(sprintf(
					'Plugin slug "%s" is already in use by %s. Slugs must be unique.',
					$slug,
					$slugUsedBy
				), E_USER_ERROR);
			}
			add_filter($slugCheckFilter, array($this, 'getAbsolutePath'));

			parent::__construct($metadataUrl, dirname($this->pluginFile), $slug, $checkPeriod, $optionName);

			//Backwards compatibility: If the plugin is a mu-plugin but no $muPluginFile is specified, assume
			//it's the same as $pluginFile given that it's not in a subdirectory (WP only looks in the base dir).
			if ( (strpbrk($this->pluginFile, '/\\') === false) && $this->isUnknownMuPlugin() ) {
				$this->muPluginFile = $this->pluginFile;
			}

			//To prevent a crash during plugin uninstallation, remove updater hooks when the user removes the plugin.
			//Details: https://github.com/YahnisElsts/plugin-update-checker/issues/138#issuecomment-335590964
			add_action('uninstall_' . $this->pluginFile, array($this, 'removeHooks'));

			$this->extraUi = new Ui($this);
		}

		/**
		 * Create an instance of the scheduler.
		 *
		 * @param int $checkPeriod
		 * @return Scheduler
		 */
		protected function createScheduler($checkPeriod) {
			$scheduler = new Scheduler($this, $checkPeriod, array('load-plugins.php'));
			register_deactivation_hook($this->pluginFile, array($scheduler, 'removeUpdaterCron'));
			return $scheduler;
		}

		/**
		 * Install the hooks required to run periodic update checks and inject update info
		 * into WP data structures.
		 *
		 * @return void
		 */
		protected function installHooks(){
			//Override requests for plugin information
			add_filter('plugins_api', array($this, 'injectInfo'), 20, 3);

			parent::installHooks();
		}

		/**
		 * Remove update checker hooks.
		 *
		 * The intent is to prevent a fatal error that can happen if the plugin has an uninstall
		 * hook. During uninstallation, WP includes the main plugin file (which creates a PUC instance),
		 * the uninstall hook runs, WP deletes the plugin files and then updates some transients.
		 * If PUC hooks are still around at this time, they could throw an error while trying to
		 * autoload classes from files that no longer exist.
		 *
		 * The "site_transient_{$transient}" filter is the main problem here, but let's also remove
		 * most other PUC hooks to be safe.
		 *
		 * @internal
		 */
		public function removeHooks() {
			parent::removeHooks();
			$this->extraUi->removeHooks();
			$this->package->removeHooks();

			remove_filter('plugins_api', array($this, 'injectInfo'), 20);
		}

		/**
		 * Retrieve plugin info from the configured API endpoint.
		 *
		 * @uses wp_remote_get()
		 *
		 * @param array $queryArgs Additional query arguments to append to the request. Optional.
		 * @return PluginInfo
		 */
		public function requestInfo($queryArgs = array()) {
			list($pluginInfo, $result) = $this->requestMetadata(
				PluginInfo::class,
				'request_info',
				$queryArgs
			);

			if ( $pluginInfo !== null ) {
				/** @var PluginInfo $pluginInfo */
				$pluginInfo->filename = $this->pluginFile;
				$pluginInfo->slug = $this->slug;
			}

			$pluginInfo = apply_filters($this->getUniqueName('request_info_result'), $pluginInfo, $result);
			return $pluginInfo;
		}

		/**
		 * Retrieve the latest update (if any) from the configured API endpoint.
		 *
		 * @uses UpdateChecker::requestInfo()
		 *
		 * @return Update|null An instance of Plugin Update, or NULL when no updates are available.
		 */
		public function requestUpdate() {
			//For the sake of simplicity, this function just calls requestInfo()
			//and transforms the result accordingly.
			$pluginInfo = $this->requestInfo(array('checking_for_updates' => '1'));
			if ( $pluginInfo === null ){
				return null;
			}
			$update = Update::fromPluginInfo($pluginInfo);

			$update = $this->filterUpdateResult($update);

			return $update;
		}

		/**
		 * Intercept plugins_api() calls that request information about our plugin and
		 * use the configured API endpoint to satisfy them.
		 *
		 * @see plugins_api()
		 *
		 * @param mixed $result
		 * @param string $action
		 * @param array|object $args
		 * @return mixed
		 */
		public function injectInfo($result, $action = null, $args = null){
			$relevant = ($action == 'plugin_information') && isset($args->slug) && (
					($args->slug == $this->slug) || ($args->slug == dirname($this->pluginFile))
				);
			if ( !$relevant ) {
				return $result;
			}

			$pluginInfo = $this->requestInfo();
			$this->fixSupportedWordpressVersion($pluginInfo);

			$pluginInfo = apply_filters($this->getUniqueName('pre_inject_info'), $pluginInfo);
			if ( $pluginInfo ) {
				return $pluginInfo->toWpFormat();
			}

			return $result;
		}

		protected function shouldShowUpdates() {
			//No update notifications for mu-plugins unless explicitly enabled. The MU plugin file
			//is usually different from the main plugin file so the update wouldn't show up properly anyway.
			return !$this->isUnknownMuPlugin();
		}

		/**
		 * @param \stdClass|null $updates
		 * @param \stdClass $updateToAdd
		 * @return \stdClass
		 */
		protected function addUpdateToList($updates, $updateToAdd) {
			if ( $this->package->isMuPlugin() ) {
				//WP does not support automatic update installation for mu-plugins, but we can
				//still display a notice.
				$updateToAdd->package = null;
			}
			return parent::addUpdateToList($updates, $updateToAdd);
		}

		/**
		 * @param \stdClass|null $updates
		 * @return \stdClass|null
		 */
		protected function removeUpdateFromList($updates) {
			$updates = parent::removeUpdateFromList($updates);
			if ( !empty($this->muPluginFile) && isset($updates, $updates->response) ) {
				unset($updates->response[$this->muPluginFile]);
			}
			return $updates;
		}

		/**
		 * For plugins, the update array is indexed by the plugin filename relative to the "plugins"
		 * directory. Example: "plugin-name/plugin.php".
		 *
		 * @return string
		 */
		protected function getUpdateListKey() {
			if ( $this->package->isMuPlugin() ) {
				return $this->muPluginFile;
			}
			return $this->pluginFile;
		}

		protected function getNoUpdateItemFields() {
			return array_merge(
				parent::getNoUpdateItemFields(),
				array(
					'id'            => $this->pluginFile,
					'slug'          => $this->slug,
					'plugin'        => $this->pluginFile,
					'icons'         => array(),
					'banners'       => array(),
					'banners_rtl'   => array(),
					'tested'        => '',
					'compatibility' => new \stdClass(),
				)
			);
		}

		/**
		 * Alias for isBeingUpgraded().
		 *
		 * @deprecated
		 * @param \WP_Upgrader|null $upgrader The upgrader that's performing the current update.
		 * @return bool
		 */
		public function isPluginBeingUpgraded($upgrader = null) {
			return $this->isBeingUpgraded($upgrader);
		}

		/**
		 * Is there an update being installed for this plugin, right now?
		 *
		 * @param \WP_Upgrader|null $upgrader
		 * @return bool
		 */
		public function isBeingUpgraded($upgrader = null) {
			return $this->upgraderStatus->isPluginBeingUpgraded($this->pluginFile, $upgrader);
		}

		/**
		 * Get the details of the currently available update, if any.
		 *
		 * If no updates are available, or if the last known update version is below or equal
		 * to the currently installed version, this method will return NULL.
		 *
		 * Uses cached update data. To retrieve update information straight from
		 * the metadata URL, call requestUpdate() instead.
		 *
		 * @return Update|null
		 */
		public function getUpdate() {
			$update = parent::getUpdate();
			if ( isset($update) ) {
				/** @var Update $update */
				$update->filename = $this->pluginFile;
			}
			return $update;
		}

		/**
		 * Get the translated plugin title.
		 *
		 * @deprecated
		 * @return string
		 */
		public function getPluginTitle() {
			return $this->package->getPluginTitle();
		}

		/**
		 * Check if the current user has the required permissions to install updates.
		 *
		 * @return bool
		 */
		public function userCanInstallUpdates() {
			return current_user_can('update_plugins');
		}

		/**
		 * Check if the plugin file is inside the mu-plugins directory.
		 *
		 * @deprecated
		 * @return bool
		 */
		protected function isMuPlugin() {
			return $this->package->isMuPlugin();
		}

		/**
		 * MU plugins are partially supported, but only when we know which file in mu-plugins
		 * corresponds to this plugin.
		 *
		 * @return bool
		 */
		protected function isUnknownMuPlugin() {
			return empty($this->muPluginFile) && $this->package->isMuPlugin();
		}

		/**
		 * Get absolute path to the main plugin file.
		 *
		 * @return string
		 */
		public function getAbsolutePath() {
			return $this->pluginAbsolutePath;
		}

		/**
		 * Register a callback for filtering query arguments.
		 *
		 * The callback function should take one argument - an associative array of query arguments.
		 * It should return a modified array of query arguments.
		 *
		 * @uses add_filter() This method is a convenience wrapper for add_filter().
		 *
		 * @param callable $callback
		 * @return void
		 */
		public function addQueryArgFilter($callback){
			$this->addFilter('request_info_query_args', $callback);
		}

		/**
		 * Register a callback for filtering arguments passed to wp_remote_get().
		 *
		 * The callback function should take one argument - an associative array of arguments -
		 * and return a modified array or arguments. See the WP documentation on wp_remote_get()
		 * for details on what arguments are available and how they work.
		 *
		 * @uses add_filter() This method is a convenience wrapper for add_filter().
		 *
		 * @param callable $callback
		 * @return void
		 */
		public function addHttpRequestArgFilter($callback) {
			$this->addFilter('request_info_options', $callback);
		}

		/**
		 * Register a callback for filtering the plugin info retrieved from the external API.
		 *
		 * The callback function should take two arguments. If the plugin info was retrieved
		 * successfully, the first argument passed will be an instance of  PluginInfo. Otherwise,
		 * it will be NULL. The second argument will be the corresponding return value of
		 * wp_remote_get (see WP docs for details).
		 *
		 * The callback function should return a new or modified instance of PluginInfo or NULL.
		 *
		 * @uses add_filter() This method is a convenience wrapper for add_filter().
		 *
		 * @param callable $callback
		 * @return void
		 */
		public function addResultFilter($callback) {
			$this->addFilter('request_info_result', $callback, 10, 2);
		}

		protected function createDebugBarExtension() {
			return new DebugBar\PluginExtension($this);
		}

		/**
		 * Create a package instance that represents this plugin or theme.
		 *
		 * @return InstalledPackage
		 */
		protected function createInstalledPackage() {
			return new Package($this->pluginAbsolutePath, $this);
		}

		/**
		 * @return Package
		 */
		public function getInstalledPackage() {
			return $this->package;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Theme\Package.php (1898 bytes, 70 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6\Theme;

use YahnisElsts\PluginUpdateChecker\v5p6\InstalledPackage;

if ( !class_exists(Package::class, false) ):

	class Package extends InstalledPackage {
		/**
		 * @var string Theme directory name.
		 */
		protected $stylesheet;

		/**
		 * @var \WP_Theme Theme object.
		 */
		protected $theme;

		public function __construct($stylesheet, $updateChecker) {
			$this->stylesheet = $stylesheet;
			$this->theme = wp_get_theme($this->stylesheet);

			parent::__construct($updateChecker);
		}

		public function getInstalledVersion() {
			return $this->theme->get('Version');
		}

		public function getAbsoluteDirectoryPath() {
			if ( method_exists($this->theme, 'get_stylesheet_directory') ) {
				return $this->theme->get_stylesheet_directory(); //Available since WP 3.4.
			}
			return get_theme_root($this->stylesheet) . '/' . $this->stylesheet;
		}

		/**
		 * Get the value of a specific plugin or theme header.
		 *
		 * @param string $headerName
		 * @param string $defaultValue
		 * @return string Either the value of the header, or $defaultValue if the header doesn't exist or is empty.
		 */
		public function getHeaderValue($headerName, $defaultValue = '') {
			$value = $this->theme->get($headerName);
			if ( ($headerName === false) || ($headerName === '') ) {
				return $defaultValue;
			}
			return $value;
		}

		protected function getHeaderNames() {
			return array(
				'Name'        => 'Theme Name',
				'ThemeURI'    => 'Theme URI',
				'Description' => 'Description',
				'Author'      => 'Author',
				'AuthorURI'   => 'Author URI',
				'Version'     => 'Version',
				'Template'    => 'Template',
				'Status'      => 'Status',
				'Tags'        => 'Tags',
				'TextDomain'  => 'Text Domain',
				'DomainPath'  => 'Domain Path',
			);
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Theme\Update.php (2299 bytes, 89 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\Theme;

use YahnisElsts\PluginUpdateChecker\v5p6\Update as BaseUpdate;

if ( !class_exists(Update::class, false) ):

	class Update extends BaseUpdate {
		public $details_url = '';

		protected static $extraFields = array('details_url');

		/**
		 * Transform the metadata into the format used by WordPress core.
		 * Note the inconsistency: WP stores plugin updates as objects and theme updates as arrays.
		 *
		 * @return array
		 */
		public function toWpFormat() {
			$update = array(
				'theme' => $this->slug,
				'new_version' => $this->version,
				'url' => $this->details_url,
			);

			if ( !empty($this->download_url) ) {
				$update['package'] = $this->download_url;
			}

			return $update;
		}

		/**
		 * Create a new instance of Theme_Update from its JSON-encoded representation.
		 *
		 * @param string $json Valid JSON string representing a theme information object.
		 * @return self New instance of ThemeUpdate, or NULL on error.
		 */
		public static function fromJson($json) {
			$instance = new self();
			if ( !parent::createFromJson($json, $instance) ) {
				return null;
			}
			return $instance;
		}

		/**
		 * Create a new instance by copying the necessary fields from another object.
		 *
		 * @param \StdClass|self $object The source object.
		 * @return self The new copy.
		 */
		public static function fromObject($object) {
			$update = new self();
			$update->copyFields($object, $update);
			return $update;
		}

		/**
		 * Basic validation.
		 *
		 * @param \StdClass $apiResponse
		 * @return bool|\WP_Error
		 */
		protected function validateMetadata($apiResponse) {
			$required = array('version', 'details_url');
			foreach($required as $key) {
				if ( !isset($apiResponse->$key) || empty($apiResponse->$key) ) {
					return new \WP_Error(
						'tuc-invalid-metadata',
						sprintf('The theme metadata is missing the required "%s" key.', $key)
					);
				}
			}
			return true;
		}

		protected function getFieldNames() {
			return array_merge(parent::getFieldNames(), self::$extraFields);
		}

		protected function getPrefixedFilter($tag) {
			return parent::getPrefixedFilter($tag) . '_theme';
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Theme\UpdateChecker.php (4837 bytes, 160 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\Theme;

use YahnisElsts\PluginUpdateChecker\v5p6\UpdateChecker as BaseUpdateChecker;
use YahnisElsts\PluginUpdateChecker\v5p6\InstalledPackage;
use YahnisElsts\PluginUpdateChecker\v5p6\Scheduler;
use YahnisElsts\PluginUpdateChecker\v5p6\DebugBar;

if ( !class_exists(UpdateChecker::class, false) ):

	class UpdateChecker extends BaseUpdateChecker {
		protected $filterSuffix = 'theme';
		protected $updateTransient = 'update_themes';
		protected $componentType = 'theme';

		/**
		 * @var string Theme directory name.
		 */
		protected $stylesheet;

		public function __construct($metadataUrl, $stylesheet = null, $customSlug = null, $checkPeriod = 12, $optionName = '') {
			if ( $stylesheet === null ) {
				$stylesheet = get_stylesheet();
			}
			$this->stylesheet = $stylesheet;

			parent::__construct(
				$metadataUrl,
				$stylesheet,
				$customSlug ? $customSlug : $stylesheet,
				$checkPeriod,
				$optionName
			);
		}

		/**
		 * For themes, the update array is indexed by theme directory name.
		 *
		 * @return string
		 */
		protected function getUpdateListKey() {
			return $this->directoryName;
		}

		/**
		 * Retrieve the latest update (if any) from the configured API endpoint.
		 *
		 * @return Update|null An instance of Update, or NULL when no updates are available.
		 */
		public function requestUpdate() {
			list($themeUpdate, $result) = $this->requestMetadata(Update::class, 'request_update');

			if ( $themeUpdate !== null ) {
				/** @var Update $themeUpdate */
				$themeUpdate->slug = $this->slug;
			}

			$themeUpdate = $this->filterUpdateResult($themeUpdate, $result);
			return $themeUpdate;
		}

		protected function getNoUpdateItemFields() {
			return array_merge(
				parent::getNoUpdateItemFields(),
				array(
					'theme'        => $this->directoryName,
					'requires'     => '',
				)
			);
		}

		public function userCanInstallUpdates() {
			return current_user_can('update_themes');
		}

		/**
		 * Create an instance of the scheduler.
		 *
		 * @param int $checkPeriod
		 * @return Scheduler
		 */
		protected function createScheduler($checkPeriod) {
			return new Scheduler($this, $checkPeriod, array('load-themes.php'));
		}

		/**
		 * Is there an update being installed right now for this theme?
		 *
		 * @param \WP_Upgrader|null $upgrader The upgrader that's performing the current update.
		 * @return bool
		 */
		public function isBeingUpgraded($upgrader = null) {
			return $this->upgraderStatus->isThemeBeingUpgraded($this->stylesheet, $upgrader);
		}

		protected function createDebugBarExtension() {
			return new DebugBar\Extension($this, DebugBar\ThemePanel::class);
		}

		/**
		 * Register a callback for filtering query arguments.
		 *
		 * The callback function should take one argument - an associative array of query arguments.
		 * It should return a modified array of query arguments.
		 *
		 * @param callable $callback
		 * @return void
		 */
		public function addQueryArgFilter($callback){
			$this->addFilter('request_update_query_args', $callback);
		}

		/**
		 * Register a callback for filtering arguments passed to wp_remote_get().
		 *
		 * The callback function should take one argument - an associative array of arguments -
		 * and return a modified array or arguments. See the WP documentation on wp_remote_get()
		 * for details on what arguments are available and how they work.
		 *
		 * @uses add_filter() This method is a convenience wrapper for add_filter().
		 *
		 * @param callable $callback
		 * @return void
		 */
		public function addHttpRequestArgFilter($callback) {
			$this->addFilter('request_update_options', $callback);
		}

		/**
		 * Register a callback for filtering theme updates retrieved from the external API.
		 *
		 * The callback function should take two arguments. If the theme update was retrieved
		 * successfully, the first argument passed will be an instance of Theme_Update. Otherwise,
		 * it will be NULL. The second argument will be the corresponding return value of
		 * wp_remote_get (see WP docs for details).
		 *
		 * The callback function should return a new or modified instance of Theme_Update or NULL.
		 *
		 * @uses add_filter() This method is a convenience wrapper for add_filter().
		 *
		 * @param callable $callback
		 * @return void
		 */
		public function addResultFilter($callback) {
			$this->addFilter('request_update_result', $callback, 10, 2);
		}

		/**
		 * Create a package instance that represents this plugin or theme.
		 *
		 * @return InstalledPackage
		 */
		protected function createInstalledPackage() {
			return new Package($this->stylesheet, $this);
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Vcs\Api.php (10264 bytes, 380 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

use Parsedown;
use PucReadmeParser;

if ( !class_exists(Api::class, false) ):

	abstract class Api {
		const STRATEGY_LATEST_RELEASE = 'latest_release';
		const STRATEGY_LATEST_TAG = 'latest_tag';
		const STRATEGY_STABLE_TAG = 'stable_tag';
		const STRATEGY_BRANCH = 'branch';

		/**
		 * Consider all releases regardless of their version number or prerelease/upcoming
		 * release status.
		 */
		const RELEASE_FILTER_ALL = 3;

		/**
		 * Exclude releases that have the "prerelease" or "upcoming release" flag.
		 *
		 * This does *not* look for prerelease keywords like "beta" in the version number.
		 * It only uses the data provided by the API. For example, on GitHub, you can
		 * manually mark a release as a prerelease.
		 */
		const RELEASE_FILTER_SKIP_PRERELEASE = 1;

		/**
		 * If there are no release assets or none of them match the configured filter,
		 * fall back to the automatically generated source code archive.
		 */
		const PREFER_RELEASE_ASSETS = 1;
		/**
		 * Skip releases that don't have any matching release assets.
		 */
		const REQUIRE_RELEASE_ASSETS = 2;

		protected $tagNameProperty = 'name';
		protected $slug = '';

		/**
		 * @var string
		 */
		protected $repositoryUrl = '';

		/**
		 * @var mixed Authentication details for private repositories. Format depends on service.
		 */
		protected $credentials = null;

		/**
		 * @var string The filter tag that's used to filter options passed to wp_remote_get.
		 * For example, "puc_request_info_options-slug" or "puc_request_update_options_theme-slug".
		 */
		protected $httpFilterName = '';

		/**
		 * @var string The filter applied to the list of update detection strategies that
		 * are used to find the latest version.
		 */
		protected $strategyFilterName = '';

		/**
		 * @var string|null
		 */
		protected $localDirectory = null;

		/**
		 * Api constructor.
		 *
		 * @param string $repositoryUrl
		 * @param array|string|null $credentials
		 */
		public function __construct($repositoryUrl, $credentials = null) {
			$this->repositoryUrl = $repositoryUrl;
			$this->setAuthentication($credentials);
		}

		/**
		 * @return string
		 */
		public function getRepositoryUrl() {
			return $this->repositoryUrl;
		}

		/**
		 * Figure out which reference (i.e. tag or branch) contains the latest version.
		 *
		 * @param string $configBranch Start looking in this branch.
		 * @return null|Reference
		 */
		public function chooseReference($configBranch) {
			$strategies = $this->getUpdateDetectionStrategies($configBranch);

			if ( !empty($this->strategyFilterName) ) {
				$strategies = apply_filters(
					$this->strategyFilterName,
					$strategies,
					$this->slug
				);
			}

			foreach ($strategies as $strategy) {
				$reference = call_user_func($strategy);
				if ( !empty($reference) ) {
					return $reference;
				}
			}
			return null;
		}

		/**
		 * Get an ordered list of strategies that can be used to find the latest version.
		 *
		 * The update checker will try each strategy in order until one of them
		 * returns a valid reference.
		 *
		 * @param string $configBranch
		 * @return array<callable> Array of callables that return Vcs_Reference objects.
		 */
		abstract protected function getUpdateDetectionStrategies($configBranch);

		/**
		 * Get the readme.txt file from the remote repository and parse it
		 * according to the plugin readme standard.
		 *
		 * @param string $ref Tag or branch name.
		 * @return array Parsed readme.
		 */
		public function getRemoteReadme($ref = 'master') {
			$fileContents = $this->getRemoteFile($this->getLocalReadmeName(), $ref);
			if ( empty($fileContents) ) {
				return array();
			}

			$parser = new PucReadmeParser();
			return $parser->parse_readme_contents($fileContents);
		}

		/**
		 * Get the case-sensitive name of the local readme.txt file.
		 *
		 * In most cases it should just be called "readme.txt", but some plugins call it "README.txt",
		 * "README.TXT", or even "Readme.txt". Most VCS are case-sensitive so we need to know the correct
		 * capitalization.
		 *
		 * Defaults to "readme.txt" (all lowercase).
		 *
		 * @return string
		 */
		public function getLocalReadmeName() {
			static $fileName = null;
			if ( $fileName !== null ) {
				return $fileName;
			}

			$fileName = 'readme.txt';
			if ( isset($this->localDirectory) ) {
				$files = scandir($this->localDirectory);
				if ( !empty($files) ) {
					foreach ($files as $possibleFileName) {
						if ( strcasecmp($possibleFileName, 'readme.txt') === 0 ) {
							$fileName = $possibleFileName;
							break;
						}
					}
				}
			}
			return $fileName;
		}

		/**
		 * Get a branch.
		 *
		 * @param string $branchName
		 * @return Reference|null
		 */
		abstract public function getBranch($branchName);

		/**
		 * Get a specific tag.
		 *
		 * @param string $tagName
		 * @return Reference|null
		 */
		abstract public function getTag($tagName);

		/**
		 * Get the tag that looks like the highest version number.
		 * (Implementations should skip pre-release versions if possible.)
		 *
		 * @return Reference|null
		 */
		abstract public function getLatestTag();

		/**
		 * Check if a tag name string looks like a version number.
		 *
		 * @param string $name
		 * @return bool
		 */
		protected function looksLikeVersion($name) {
			//Tag names may be prefixed with "v", e.g. "v1.2.3".
			$name = ltrim($name, 'v');

			//The version string must start with a number.
			if ( !is_numeric(substr($name, 0, 1)) ) {
				return false;
			}

			//The goal is to accept any SemVer-compatible or "PHP-standardized" version number.
			return (preg_match('@^(\d{1,5}?)(\.\d{1,10}?){0,4}?($|[abrdp+_\-]|\s)@i', $name) === 1);
		}

		/**
		 * Check if a tag appears to be named like a version number.
		 *
		 * @param \stdClass $tag
		 * @return bool
		 */
		protected function isVersionTag($tag) {
			$property = $this->tagNameProperty;
			return isset($tag->$property) && $this->looksLikeVersion($tag->$property);
		}

		/**
		 * Sort a list of tags as if they were version numbers.
		 * Tags that don't look like version number will be removed.
		 *
		 * @param \stdClass[] $tags Array of tag objects.
		 * @return \stdClass[] Filtered array of tags sorted in descending order.
		 */
		protected function sortTagsByVersion($tags) {
			//Keep only those tags that look like version numbers.
			$versionTags = array_filter($tags, array($this, 'isVersionTag'));
			//Sort them in descending order.
			usort($versionTags, array($this, 'compareTagNames'));

			return $versionTags;
		}

		/**
		 * Compare two tags as if they were version number.
		 *
		 * @param \stdClass $tag1 Tag object.
		 * @param \stdClass $tag2 Another tag object.
		 * @return int
		 */
		protected function compareTagNames($tag1, $tag2) {
			$property = $this->tagNameProperty;
			if ( !isset($tag1->$property) ) {
				return 1;
			}
			if ( !isset($tag2->$property) ) {
				return -1;
			}
			return -version_compare(ltrim($tag1->$property, 'v'), ltrim($tag2->$property, 'v'));
		}

		/**
		 * Get the contents of a file from a specific branch or tag.
		 *
		 * @param string $path File name.
		 * @param string $ref
		 * @return null|string Either the contents of the file, or null if the file doesn't exist or there's an error.
		 */
		abstract public function getRemoteFile($path, $ref = 'master');

		/**
		 * Get the timestamp of the latest commit that changed the specified branch or tag.
		 *
		 * @param string $ref Reference name (e.g. branch or tag).
		 * @return string|null
		 */
		abstract public function getLatestCommitTime($ref);

		/**
		 * Get the contents of the changelog file from the repository.
		 *
		 * @param string $ref
		 * @param string $localDirectory Full path to the local plugin or theme directory.
		 * @return null|string The HTML contents of the changelog.
		 */
		public function getRemoteChangelog($ref, $localDirectory) {
			$filename = $this->findChangelogName($localDirectory);
			if ( empty($filename) ) {
				return null;
			}

			$changelog = $this->getRemoteFile($filename, $ref);
			if ( $changelog === null ) {
				return null;
			}

			return Parsedown::instance()->text($changelog);
		}

		/**
		 * Guess the name of the changelog file.
		 *
		 * @param string $directory
		 * @return string|null
		 */
		protected function findChangelogName($directory = null) {
			if ( !isset($directory) ) {
				$directory = $this->localDirectory;
			}
			if ( empty($directory) || !is_dir($directory) || ($directory === '.') ) {
				return null;
			}

			$possibleNames = array('CHANGES.md', 'CHANGELOG.md', 'changes.md', 'changelog.md');
			$files = scandir($directory);
			$foundNames = array_intersect($possibleNames, $files);

			if ( !empty($foundNames) ) {
				return reset($foundNames);
			}
			return null;
		}

		/**
		 * Set authentication credentials.
		 *
		 * @param $credentials
		 */
		public function setAuthentication($credentials) {
			$this->credentials = $credentials;
		}

		public function isAuthenticationEnabled() {
			return !empty($this->credentials);
		}

		/**
		 * @param string $url
		 * @return string
		 */
		public function signDownloadUrl($url) {
			return $url;
		}

		/**
		 * @param string $filterName
		 */
		public function setHttpFilterName($filterName) {
			$this->httpFilterName = $filterName;
		}

		/**
		 * @param string $filterName
		 */
		public function setStrategyFilterName($filterName) {
			$this->strategyFilterName = $filterName;
		}

		/**
		 * @param string $directory
		 */
		public function setLocalDirectory($directory) {
			if ( empty($directory) || !is_dir($directory) || ($directory === '.') ) {
				$this->localDirectory = null;
			} else {
				$this->localDirectory = $directory;
			}
		}

		/**
		 * @param string $slug
		 */
		public function setSlug($slug) {
			$this->slug = $slug;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Vcs\BaseChecker.php (576 bytes, 30 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

if ( !interface_exists(BaseChecker::class, false) ):

	interface BaseChecker {
		/**
		 * Set the repository branch to use for updates. Defaults to 'master'.
		 *
		 * @param string $branch
		 * @return $this
		 */
		public function setBranch($branch);

		/**
		 * Set authentication credentials.
		 *
		 * @param array|string $credentials
		 * @return $this
		 */
		public function setAuthentication($credentials);

		/**
		 * @return Api
		 */
		public function getVcsApi();
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Vcs\BitBucketApi.php (7626 bytes, 273 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

use YahnisElsts\PluginUpdateChecker\v5p6\OAuthSignature;
use YahnisElsts\PluginUpdateChecker\v5p6\Utils;

if ( !class_exists(BitBucketApi::class, false) ):

	class BitBucketApi extends Api {
		/**
		 * @var OAuthSignature
		 */
		private $oauth = null;

		/**
		 * @var string
		 */
		private $username;

		/**
		 * @var string
		 */
		private $repository;

		public function __construct($repositoryUrl, $credentials = array()) {
			$path = wp_parse_url($repositoryUrl, PHP_URL_PATH);
			if ( preg_match('@^/?(?P<username>[^/]+?)/(?P<repository>[^/#?&]+?)/?$@', $path, $matches) ) {
				$this->username = $matches['username'];
				$this->repository = $matches['repository'];
			} else {
				throw new \InvalidArgumentException('Invalid BitBucket repository URL: "' . $repositoryUrl . '"');
			}

			parent::__construct($repositoryUrl, $credentials);
		}

		protected function getUpdateDetectionStrategies($configBranch) {
			$strategies = array(
				self::STRATEGY_STABLE_TAG => function () use ($configBranch) {
					return $this->getStableTag($configBranch);
				},
			);

			if ( ($configBranch === 'master' || $configBranch === 'main') ) {
				$strategies[self::STRATEGY_LATEST_TAG] = array($this, 'getLatestTag');
			}

			$strategies[self::STRATEGY_BRANCH] = function () use ($configBranch) {
				return $this->getBranch($configBranch);
			};
			return $strategies;
		}

		public function getBranch($branchName) {
			$branch = $this->api('/refs/branches/' . $branchName);
			if ( is_wp_error($branch) || empty($branch) ) {
				return null;
			}

			//The "/src/{stuff}/{path}" endpoint doesn't seem to handle branch names that contain slashes.
			//If we don't encode the slash, we get a 404. If we encode it as "%2F", we get a 401.
			//To avoid issues, if the branch name is not URL-safe, let's use the commit hash instead.
			$ref = $branch->name;
			if ((urlencode($ref) !== $ref) && isset($branch->target->hash)) {
				$ref = $branch->target->hash;
			}

			return new Reference(array(
				'name' => $ref,
				'updated' => $branch->target->date,
				'downloadUrl' => $this->getDownloadUrl($branch->name),
			));
		}

		/**
		 * Get a specific tag.
		 *
		 * @param string $tagName
		 * @return Reference|null
		 */
		public function getTag($tagName) {
			$tag = $this->api('/refs/tags/' . $tagName);
			if ( is_wp_error($tag) || empty($tag) ) {
				return null;
			}

			return new Reference(array(
				'name' => $tag->name,
				'version' => ltrim($tag->name, 'v'),
				'updated' => $tag->target->date,
				'downloadUrl' => $this->getDownloadUrl($tag->name),
			));
		}

		/**
		 * Get the tag that looks like the highest version number.
		 *
		 * @return Reference|null
		 */
		public function getLatestTag() {
			$tags = $this->api('/refs/tags?sort=-target.date');
			if ( !isset($tags, $tags->values) || !is_array($tags->values) ) {
				return null;
			}

			//Filter and sort the list of tags.
			$versionTags = $this->sortTagsByVersion($tags->values);

			//Return the first result.
			if ( !empty($versionTags) ) {
				$tag = $versionTags[0];
				return new Reference(array(
					'name' => $tag->name,
					'version' => ltrim($tag->name, 'v'),
					'updated' => $tag->target->date,
					'downloadUrl' => $this->getDownloadUrl($tag->name),
				));
			}
			return null;
		}

		/**
		 * Get the tag/ref specified by the "Stable tag" header in the readme.txt of a given branch.
		 *
		 * @param string $branch
		 * @return null|Reference
		 */
		protected function getStableTag($branch) {
			$remoteReadme = $this->getRemoteReadme($branch);
			if ( !empty($remoteReadme['stable_tag']) ) {
				$tag = $remoteReadme['stable_tag'];

				//You can explicitly opt out of using tags by setting "Stable tag" to
				//"trunk" or the name of the current branch.
				if ( ($tag === $branch) || ($tag === 'trunk') ) {
					return $this->getBranch($branch);
				}

				return $this->getTag($tag);
			}

			return null;
		}

		/**
		 * @param string $ref
		 * @return string
		 */
		protected function getDownloadUrl($ref) {
			return sprintf(
				'https://bitbucket.org/%s/%s/get/%s.zip',
				$this->username,
				$this->repository,
				$ref
			);
		}

		/**
		 * Get the contents of a file from a specific branch or tag.
		 *
		 * @param string $path File name.
		 * @param string $ref
		 * @return null|string Either the contents of the file, or null if the file doesn't exist or there's an error.
		 */
		public function getRemoteFile($path, $ref = 'master') {
			$response = $this->api('src/' . $ref . '/' . ltrim($path));
			if ( is_wp_error($response) || !is_string($response) ) {
				return null;
			}
			return $response;
		}

		/**
		 * Get the timestamp of the latest commit that changed the specified branch or tag.
		 *
		 * @param string $ref Reference name (e.g. branch or tag).
		 * @return string|null
		 */
		public function getLatestCommitTime($ref) {
			$response = $this->api('commits/' . $ref);
			if ( isset($response->values, $response->values[0], $response->values[0]->date) ) {
				return $response->values[0]->date;
			}
			return null;
		}

		/**
		 * Perform a BitBucket API 2.0 request.
		 *
		 * @param string $url
		 * @param string $version
		 * @return mixed|\WP_Error
		 */
		public function api($url, $version = '2.0') {
			$url = ltrim($url, '/');
			$isSrcResource = Utils::startsWith($url, 'src/');

			$url = implode('/', array(
				'https://api.bitbucket.org',
				$version,
				'repositories',
				$this->username,
				$this->repository,
				$url
			));
			$baseUrl = $url;

			if ( $this->oauth ) {
				$url = $this->oauth->sign($url,'GET');
			}

			$options = array('timeout' => wp_doing_cron() ? 10 : 3);
			if ( !empty($this->httpFilterName) ) {
				$options = apply_filters($this->httpFilterName, $options);
			}
			$response = wp_remote_get($url, $options);
			if ( is_wp_error($response) ) {
				do_action('puc_api_error', $response, null, $url, $this->slug);
				return $response;
			}

			$code = wp_remote_retrieve_response_code($response);
			$body = wp_remote_retrieve_body($response);
			if ( $code === 200 ) {
				if ( $isSrcResource ) {
					//Most responses are JSON-encoded, but src resources just
					//return raw file contents.
					$document = $body;
				} else {
					$document = json_decode($body);
				}
				return $document;
			}

			$error = new \WP_Error(
				'puc-bitbucket-http-error',
				sprintf('BitBucket API error. Base URL: "%s",  HTTP status code: %d.', $baseUrl, $code)
			);
			do_action('puc_api_error', $error, $response, $url, $this->slug);

			return $error;
		}

		/**
		 * @param array $credentials
		 */
		public function setAuthentication($credentials) {
			parent::setAuthentication($credentials);

			if ( !empty($credentials) && !empty($credentials['consumer_key']) ) {
				$this->oauth = new OAuthSignature(
					$credentials['consumer_key'],
					$credentials['consumer_secret']
				);
			} else {
				$this->oauth = null;
			}
		}

		public function signDownloadUrl($url) {
			//Add authentication data to download URLs. Since OAuth signatures incorporate
			//timestamps, we have to do this immediately before inserting the update. Otherwise,
			//authentication could fail due to a stale timestamp.
			if ( $this->oauth ) {
				$url = $this->oauth->sign($url);
			}
			return $url;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Vcs\GitHubApi.php (14207 bytes, 468 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

use Parsedown;

if ( !class_exists(GitHubApi::class, false) ):

	class GitHubApi extends Api {
		use ReleaseAssetSupport;
		use ReleaseFilteringFeature;

		/**
		 * @var string GitHub username.
		 */
		protected $userName;
		/**
		 * @var string GitHub repository name.
		 */
		protected $repositoryName;

		/**
		 * @var string Either a fully qualified repository URL, or just "user/repo-name".
		 */
		protected $repositoryUrl;

		/**
		 * @var string GitHub authentication token. Optional.
		 */
		protected $accessToken;

		/**
		 * @var bool
		 */
		private $downloadFilterAdded = false;

		public function __construct($repositoryUrl, $accessToken = null) {
			$path = wp_parse_url($repositoryUrl, PHP_URL_PATH);
			if ( preg_match('@^/?(?P<username>[^/]+?)/(?P<repository>[^/#?&]+?)/?$@', $path, $matches) ) {
				$this->userName = $matches['username'];
				$this->repositoryName = $matches['repository'];
			} else {
				throw new \InvalidArgumentException('Invalid GitHub repository URL: "' . $repositoryUrl . '"');
			}

			parent::__construct($repositoryUrl, $accessToken);
		}

		/**
		 * Get the latest release from GitHub.
		 *
		 * @return Reference|null
		 */
		public function getLatestRelease() {
			//The "latest release" endpoint returns one release and always skips pre-releases,
			//so we can only use it if that's compatible with the current filter settings.
			if (
				$this->shouldSkipPreReleases()
				&& (
					($this->releaseFilterMaxReleases === 1) || !$this->hasCustomReleaseFilter()
				)
			) {
				//Just get the latest release.
				$release = $this->api('/repos/:user/:repo/releases/latest');
				if ( is_wp_error($release) || !is_object($release) || !isset($release->tag_name) ) {
					return null;
				}
				$foundReleases = array($release);
			} else {
				//Get a list of the most recent releases.
				$foundReleases = $this->api(
					'/repos/:user/:repo/releases',
					array('per_page' => $this->releaseFilterMaxReleases)
				);
				if ( is_wp_error($foundReleases) || !is_array($foundReleases) ) {
					return null;
				}
			}

			foreach ($foundReleases as $release) {
				//Always skip drafts.
				if ( isset($release->draft) && !empty($release->draft) ) {
					continue;
				}

				//Skip pre-releases unless specifically included.
				if (
					$this->shouldSkipPreReleases()
					&& isset($release->prerelease)
					&& !empty($release->prerelease)
				) {
					continue;
				}

				$versionNumber = ltrim($release->tag_name, 'v'); //Remove the "v" prefix from "v1.2.3".

				//Custom release filtering.
				if ( !$this->matchesCustomReleaseFilter($versionNumber, $release) ) {
					continue;
				}

				$reference = new Reference(array(
					'name'        => $release->tag_name,
					'version'     => $versionNumber,
					'downloadUrl' => $release->zipball_url,
					'updated'     => $release->created_at,
					'apiResponse' => $release,
				));

				if ( isset($release->assets[0]) ) {
					$reference->downloadCount = $release->assets[0]->download_count;
				}

				if ( $this->releaseAssetsEnabled ) {
					//Use the first release asset that matches the specified regular expression.
					if ( isset($release->assets, $release->assets[0]) ) {
						$matchingAssets = array_values(array_filter($release->assets, array($this, 'matchesAssetFilter')));
					} else {
						$matchingAssets = array();
					}

					if ( !empty($matchingAssets) ) {
						if ( $this->isAuthenticationEnabled() ) {
							/**
							 * Keep in mind that we'll need to add an "Accept" header to download this asset.
							 *
							 * @see setUpdateDownloadHeaders()
							 */
							$reference->downloadUrl = $matchingAssets[0]->url;
						} else {
							//It seems that browser_download_url only works for public repositories.
							//Using an access_token doesn't help. Maybe OAuth would work?
							$reference->downloadUrl = $matchingAssets[0]->browser_download_url;
						}

						$reference->downloadCount = $matchingAssets[0]->download_count;
					} else if ( $this->releaseAssetPreference === Api::REQUIRE_RELEASE_ASSETS ) {
						//None of the assets match the filter, and we're not allowed
						//to fall back to the auto-generated source ZIP.
						return null;
					}
				}

				if ( !empty($release->body) ) {
					$reference->changelog = Parsedown::instance()->text($release->body);
				}

				return $reference;
			}

			return null;
		}

		/**
		 * Get the tag that looks like the highest version number.
		 *
		 * @return Reference|null
		 */
		public function getLatestTag() {
			$tags = $this->api('/repos/:user/:repo/tags');

			if ( is_wp_error($tags) || !is_array($tags) ) {
				return null;
			}

			$versionTags = $this->sortTagsByVersion($tags);
			if ( empty($versionTags) ) {
				return null;
			}

			$tag = $versionTags[0];
			return new Reference(array(
				'name'        => $tag->name,
				'version'     => ltrim($tag->name, 'v'),
				'downloadUrl' => $tag->zipball_url,
				'apiResponse' => $tag,
			));
		}

		/**
		 * Get a branch by name.
		 *
		 * @param string $branchName
		 * @return null|Reference
		 */
		public function getBranch($branchName) {
			$branch = $this->api('/repos/:user/:repo/branches/' . $branchName);
			if ( is_wp_error($branch) || empty($branch) ) {
				return null;
			}

			$reference = new Reference(array(
				'name'        => $branch->name,
				'downloadUrl' => $this->buildArchiveDownloadUrl($branch->name),
				'apiResponse' => $branch,
			));

			if ( isset($branch->commit, $branch->commit->commit, $branch->commit->commit->author->date) ) {
				$reference->updated = $branch->commit->commit->author->date;
			}

			return $reference;
		}

		/**
		 * Get the latest commit that changed the specified file.
		 *
		 * @param string $filename
		 * @param string $ref Reference name (e.g. branch or tag).
		 * @return \StdClass|null
		 */
		public function getLatestCommit($filename, $ref = 'master') {
			$commits = $this->api(
				'/repos/:user/:repo/commits',
				array(
					'path' => $filename,
					'sha'  => $ref,
				)
			);
			if ( !is_wp_error($commits) && isset($commits[0]) ) {
				return $commits[0];
			}
			return null;
		}

		/**
		 * Get the timestamp of the latest commit that changed the specified branch or tag.
		 *
		 * @param string $ref Reference name (e.g. branch or tag).
		 * @return string|null
		 */
		public function getLatestCommitTime($ref) {
			$commits = $this->api('/repos/:user/:repo/commits', array('sha' => $ref));
			if ( !is_wp_error($commits) && isset($commits[0]) ) {
				return $commits[0]->commit->author->date;
			}
			return null;
		}

		/**
		 * Perform a GitHub API request.
		 *
		 * @param string $url
		 * @param array $queryParams
		 * @return mixed|\WP_Error
		 */
		protected function api($url, $queryParams = array()) {
			$baseUrl = $url;
			$url = $this->buildApiUrl($url, $queryParams);

			$options = array('timeout' => wp_doing_cron() ? 10 : 3);
			if ( $this->isAuthenticationEnabled() ) {
				$options['headers'] = array('Authorization' => $this->getAuthorizationHeader());
			}

			if ( !empty($this->httpFilterName) ) {
				$options = apply_filters($this->httpFilterName, $options);
			}
			$response = wp_remote_get($url, $options);
			if ( is_wp_error($response) ) {
				do_action('puc_api_error', $response, null, $url, $this->slug);
				return $response;
			}

			$code = wp_remote_retrieve_response_code($response);
			$body = wp_remote_retrieve_body($response);
			if ( $code === 200 ) {
				$document = json_decode($body);
				return $document;
			}

			$error = new \WP_Error(
				'puc-github-http-error',
				sprintf('GitHub API error. Base URL: "%s",  HTTP status code: %d.', $baseUrl, $code)
			);
			do_action('puc_api_error', $error, $response, $url, $this->slug);

			return $error;
		}

		/**
		 * Build a fully qualified URL for an API request.
		 *
		 * @param string $url
		 * @param array $queryParams
		 * @return string
		 */
		protected function buildApiUrl($url, $queryParams) {
			$variables = array(
				'user' => $this->userName,
				'repo' => $this->repositoryName,
			);
			foreach ($variables as $name => $value) {
				$url = str_replace('/:' . $name, '/' . urlencode($value), $url);
			}
			$url = 'https://api.github.com' . $url;

			if ( !empty($queryParams) ) {
				$url = add_query_arg($queryParams, $url);
			}

			return $url;
		}

		/**
		 * Get the contents of a file from a specific branch or tag.
		 *
		 * @param string $path File name.
		 * @param string $ref
		 * @return null|string Either the contents of the file, or null if the file doesn't exist or there's an error.
		 */
		public function getRemoteFile($path, $ref = 'master') {
			$apiUrl = '/repos/:user/:repo/contents/' . $path;
			$response = $this->api($apiUrl, array('ref' => $ref));

			if ( is_wp_error($response) || !isset($response->content) || ($response->encoding !== 'base64') ) {
				return null;
			}
			return base64_decode($response->content);
		}

		/**
		 * Generate a URL to download a ZIP archive of the specified branch/tag/etc.
		 *
		 * @param string $ref
		 * @return string
		 */
		public function buildArchiveDownloadUrl($ref = 'master') {
			$url = sprintf(
				'https://api.github.com/repos/%1$s/%2$s/zipball/%3$s',
				urlencode($this->userName),
				urlencode($this->repositoryName),
				urlencode($ref)
			);
			return $url;
		}

		/**
		 * Get a specific tag.
		 *
		 * @param string $tagName
		 * @return void
		 */
		public function getTag($tagName) {
			//The current GitHub update checker doesn't use getTag, so I didn't bother to implement it.
			throw new \LogicException('The ' . __METHOD__ . ' method is not implemented and should not be used.');
		}

		public function setAuthentication($credentials) {
			parent::setAuthentication($credentials);
			$this->accessToken = is_string($credentials) ? $credentials : null;

			//Optimization: Instead of filtering all HTTP requests, let's do it only when
			//WordPress is about to download an update.
			add_filter('upgrader_pre_download', array($this, 'addHttpRequestFilter'), 10, 1); //WP 3.7+
		}

		protected function getUpdateDetectionStrategies($configBranch) {
			$strategies = array();

			if ( $configBranch === 'master' || $configBranch === 'main') {
				//Use the latest release.
				$strategies[self::STRATEGY_LATEST_RELEASE] = array($this, 'getLatestRelease');
				//Failing that, use the tag with the highest version number.
				$strategies[self::STRATEGY_LATEST_TAG] = array($this, 'getLatestTag');
			}

			//Alternatively, just use the branch itself.
			$strategies[self::STRATEGY_BRANCH] = function () use ($configBranch) {
				return $this->getBranch($configBranch);
			};

			return $strategies;
		}

		/**
		 * Get the unchanging part of a release asset URL. Used to identify download attempts.
		 *
		 * @return string
		 */
		protected function getAssetApiBaseUrl() {
			return sprintf(
				'//api.github.com/repos/%1$s/%2$s/releases/assets/',
				$this->userName,
				$this->repositoryName
			);
		}

		protected function getFilterableAssetName($releaseAsset) {
			if ( isset($releaseAsset->name) ) {
				return $releaseAsset->name;
			}
			return null;
		}

		/**
		 * @param bool $result
		 * @return bool
		 * @internal
		 */
		public function addHttpRequestFilter($result) {
			if ( !$this->downloadFilterAdded && $this->isAuthenticationEnabled() ) {
				//phpcs:ignore WordPressVIPMinimum.Hooks.RestrictedHooks.http_request_args -- The callback doesn't change the timeout.
				add_filter('http_request_args', array($this, 'setUpdateDownloadHeaders'), 10, 2);
				add_action('requests-requests.before_redirect', array($this, 'removeAuthHeaderFromRedirects'), 10, 4);
				$this->downloadFilterAdded = true;
			}
			return $result;
		}

		/**
		 * Set the HTTP headers that are necessary to download updates from private repositories.
		 *
		 * See GitHub docs:
		 *
		 * @link https://developer.github.com/v3/repos/releases/#get-a-single-release-asset
		 * @link https://developer.github.com/v3/auth/#basic-authentication
		 *
		 * @internal
		 * @param array $requestArgs
		 * @param string $url
		 * @return array
		 */
		public function setUpdateDownloadHeaders($requestArgs, $url = '') {
			//Is WordPress trying to download one of our release assets?
			if ( $this->releaseAssetsEnabled && (strpos($url, $this->getAssetApiBaseUrl()) !== false) ) {
				$requestArgs['headers']['Accept'] = 'application/octet-stream';
			}
			//Use Basic authentication, but only if the download is from our repository.
			$repoApiBaseUrl = $this->buildApiUrl('/repos/:user/:repo/', array());
			if ( $this->isAuthenticationEnabled() && (strpos($url, $repoApiBaseUrl)) === 0 ) {
				$requestArgs['headers']['Authorization'] = $this->getAuthorizationHeader();
			}
			return $requestArgs;
		}

		/**
		 * When following a redirect, the Requests library will automatically forward
		 * the authorization header to other hosts. We don't want that because it breaks
		 * AWS downloads and can leak authorization information.
		 *
		 * @param string $location
		 * @param array $headers
		 * @internal
		 */
		public function removeAuthHeaderFromRedirects(&$location, &$headers) {
			$repoApiBaseUrl = $this->buildApiUrl('/repos/:user/:repo/', array());
			if ( strpos($location, $repoApiBaseUrl) === 0 ) {
				return; //This request is going to GitHub, so it's fine.
			}
			//Remove the header.
			if ( isset($headers['Authorization']) ) {
				unset($headers['Authorization']);
			}
		}

		/**
		 * Generate the value of the "Authorization" header.
		 *
		 * @return string
		 */
		protected function getAuthorizationHeader() {
			return 'Basic ' . base64_encode($this->userName . ':' . $this->accessToken);
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Vcs\GitLabApi.php (12135 bytes, 415 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

if ( !class_exists(GitLabApi::class, false) ):

	class GitLabApi extends Api {
		use ReleaseAssetSupport;
		use ReleaseFilteringFeature;

		/**
		 * @var string GitLab username.
		 */
		protected $userName;

		/**
		 * @var string GitLab server host.
		 */
		protected $repositoryHost;

		/**
		 * @var string Protocol used by this GitLab server: "http" or "https".
		 */
		protected $repositoryProtocol = 'https';

		/**
		 * @var string GitLab repository name.
		 */
		protected $repositoryName;

		/**
		 * @var string GitLab authentication token. Optional.
		 */
		protected $accessToken;

		/**
		 * @deprecated
		 * @var bool No longer used.
		 */
		protected $releasePackageEnabled = false;

		public function __construct($repositoryUrl, $accessToken = null, $subgroup = null) {
			//Parse the repository host to support custom hosts.
			$port = wp_parse_url($repositoryUrl, PHP_URL_PORT);
			if ( !empty($port) ) {
				$port = ':' . $port;
			}
			$this->repositoryHost = wp_parse_url($repositoryUrl, PHP_URL_HOST) . $port;

			if ( $this->repositoryHost !== 'gitlab.com' ) {
				$this->repositoryProtocol = wp_parse_url($repositoryUrl, PHP_URL_SCHEME);
			}

			//Find the repository information
			$path = wp_parse_url($repositoryUrl, PHP_URL_PATH);
			if ( preg_match('@^/?(?P<username>[^/]+?)/(?P<repository>[^/#?&]+?)/?$@', $path, $matches) ) {
				$this->userName = $matches['username'];
				$this->repositoryName = $matches['repository'];
			} elseif ( ($this->repositoryHost === 'gitlab.com') ) {
				//This is probably a repository in a subgroup, e.g. "/organization/category/repo".
				$parts = explode('/', trim($path, '/'));
				if ( count($parts) < 3 ) {
					throw new \InvalidArgumentException('Invalid GitLab.com repository URL: "' . $repositoryUrl . '"');
				}
				$lastPart = array_pop($parts);
				$this->userName = implode('/', $parts);
				$this->repositoryName = $lastPart;
			} else {
				//There could be subgroups in the URL:  gitlab.domain.com/group/subgroup/subgroup2/repository
				if ( $subgroup !== null ) {
					$path = str_replace(trailingslashit($subgroup), '', $path);
				}

				//This is not a traditional url, it could be gitlab is in a deeper subdirectory.
				//Get the path segments.
				$segments = explode('/', untrailingslashit(ltrim($path, '/')));

				//We need at least /user-name/repository-name/
				if ( count($segments) < 2 ) {
					throw new \InvalidArgumentException('Invalid GitLab repository URL: "' . $repositoryUrl . '"');
				}

				//Get the username and repository name.
				$usernameRepo = array_splice($segments, -2, 2);
				$this->userName = $usernameRepo[0];
				$this->repositoryName = $usernameRepo[1];

				//Append the remaining segments to the host if there are segments left.
				if ( count($segments) > 0 ) {
					$this->repositoryHost = trailingslashit($this->repositoryHost) . implode('/', $segments);
				}

				//Add subgroups to username.
				if ( $subgroup !== null ) {
					$this->userName = $usernameRepo[0] . '/' . untrailingslashit($subgroup);
				}
			}

			parent::__construct($repositoryUrl, $accessToken);
		}

		/**
		 * Get the latest release from GitLab.
		 *
		 * @return Reference|null
		 */
		public function getLatestRelease() {
			$releases = $this->api('/:id/releases', array('per_page' => $this->releaseFilterMaxReleases));
			if ( is_wp_error($releases) || empty($releases) || !is_array($releases) ) {
				return null;
			}

			foreach ($releases as $release) {
				if (
					//Skip invalid/unsupported releases.
					!is_object($release)
					|| !isset($release->tag_name)
					//Skip upcoming releases.
					|| (
						!empty($release->upcoming_release)
						&& $this->shouldSkipPreReleases()
					)
				) {
					continue;
				}

				$versionNumber = ltrim($release->tag_name, 'v'); //Remove the "v" prefix from "v1.2.3".

				//Apply custom filters.
				if ( !$this->matchesCustomReleaseFilter($versionNumber, $release) ) {
					continue;
				}

				$downloadUrl = $this->findReleaseDownloadUrl($release);
				if ( empty($downloadUrl) ) {
					//The latest release doesn't have valid download URL.
					return null;
				}

				if ( !empty($this->accessToken) ) {
					$downloadUrl = add_query_arg('private_token', $this->accessToken, $downloadUrl);
				}

				return new Reference(array(
					'name'        => $release->tag_name,
					'version'     => $versionNumber,
					'downloadUrl' => $downloadUrl,
					'updated'     => $release->released_at,
					'apiResponse' => $release,
				));
			}

			return null;
		}

		/**
		 * @param object $release
		 * @return string|null
		 */
		protected function findReleaseDownloadUrl($release) {
			if ( $this->releaseAssetsEnabled ) {
				if ( isset($release->assets, $release->assets->links) ) {
					//Use the first asset link where the URL matches the filter.
					foreach ($release->assets->links as $link) {
						if ( $this->matchesAssetFilter($link) ) {
							return $link->url;
						}
					}
				}

				if ( $this->releaseAssetPreference === Api::REQUIRE_RELEASE_ASSETS ) {
					//Falling back to source archives is not allowed, so give up.
					return null;
				}
			}

			//Use the first source code archive that's in ZIP format.
			foreach ($release->assets->sources as $source) {
				if ( isset($source->format) && ($source->format === 'zip') ) {
					return $source->url;
				}
			}

			return null;
		}

		/**
		 * Get the tag that looks like the highest version number.
		 *
		 * @return Reference|null
		 */
		public function getLatestTag() {
			$tags = $this->api('/:id/repository/tags');
			if ( is_wp_error($tags) || empty($tags) || !is_array($tags) ) {
				return null;
			}

			$versionTags = $this->sortTagsByVersion($tags);
			if ( empty($versionTags) ) {
				return null;
			}

			$tag = $versionTags[0];
			return new Reference(array(
				'name'        => $tag->name,
				'version'     => ltrim($tag->name, 'v'),
				'downloadUrl' => $this->buildArchiveDownloadUrl($tag->name),
				'apiResponse' => $tag,
			));
		}

		/**
		 * Get a branch by name.
		 *
		 * @param string $branchName
		 * @return null|Reference
		 */
		public function getBranch($branchName) {
			$branch = $this->api('/:id/repository/branches/' . $branchName);
			if ( is_wp_error($branch) || empty($branch) ) {
				return null;
			}

			$reference = new Reference(array(
				'name'        => $branch->name,
				'downloadUrl' => $this->buildArchiveDownloadUrl($branch->name),
				'apiResponse' => $branch,
			));

			if ( isset($branch->commit, $branch->commit->committed_date) ) {
				$reference->updated = $branch->commit->committed_date;
			}

			return $reference;
		}

		/**
		 * Get the timestamp of the latest commit that changed the specified branch or tag.
		 *
		 * @param string $ref Reference name (e.g. branch or tag).
		 * @return string|null
		 */
		public function getLatestCommitTime($ref) {
			$commits = $this->api('/:id/repository/commits/', array('ref_name' => $ref));
			if ( is_wp_error($commits) || !is_array($commits) || !isset($commits[0]) ) {
				return null;
			}

			return $commits[0]->committed_date;
		}

		/**
		 * Perform a GitLab API request.
		 *
		 * @param string $url
		 * @param array $queryParams
		 * @return mixed|\WP_Error
		 */
		protected function api($url, $queryParams = array()) {
			$baseUrl = $url;
			$url = $this->buildApiUrl($url, $queryParams);

			$options = array('timeout' => wp_doing_cron() ? 10 : 3);
			if ( !empty($this->httpFilterName) ) {
				$options = apply_filters($this->httpFilterName, $options);
			}

			$response = wp_remote_get($url, $options);
			if ( is_wp_error($response) ) {
				do_action('puc_api_error', $response, null, $url, $this->slug);
				return $response;
			}

			$code = wp_remote_retrieve_response_code($response);
			$body = wp_remote_retrieve_body($response);
			if ( $code === 200 ) {
				return json_decode($body);
			}

			$error = new \WP_Error(
				'puc-gitlab-http-error',
				sprintf('GitLab API error. URL: "%s",  HTTP status code: %d.', $baseUrl, $code)
			);
			do_action('puc_api_error', $error, $response, $url, $this->slug);

			return $error;
		}

		/**
		 * Build a fully qualified URL for an API request.
		 *
		 * @param string $url
		 * @param array $queryParams
		 * @return string
		 */
		protected function buildApiUrl($url, $queryParams) {
			$variables = array(
				'user' => $this->userName,
				'repo' => $this->repositoryName,
				'id'   => $this->userName . '/' . $this->repositoryName,
			);

			foreach ($variables as $name => $value) {
				$url = str_replace("/:{$name}", '/' . urlencode($value), $url);
			}

			$url = substr($url, 1);
			$url = sprintf('%1$s://%2$s/api/v4/projects/%3$s', $this->repositoryProtocol, $this->repositoryHost, $url);

			if ( !empty($this->accessToken) ) {
				$queryParams['private_token'] = $this->accessToken;
			}

			if ( !empty($queryParams) ) {
				$url = add_query_arg($queryParams, $url);
			}

			return $url;
		}

		/**
		 * Get the contents of a file from a specific branch or tag.
		 *
		 * @param string $path File name.
		 * @param string $ref
		 * @return null|string Either the contents of the file, or null if the file doesn't exist or there's an error.
		 */
		public function getRemoteFile($path, $ref = 'master') {
			$response = $this->api('/:id/repository/files/' . $path, array('ref' => $ref));
			if ( is_wp_error($response) || !isset($response->content) || $response->encoding !== 'base64' ) {
				return null;
			}

			return base64_decode($response->content);
		}

		/**
		 * Generate a URL to download a ZIP archive of the specified branch/tag/etc.
		 *
		 * @param string $ref
		 * @return string
		 */
		public function buildArchiveDownloadUrl($ref = 'master') {
			$url = sprintf(
				'%1$s://%2$s/api/v4/projects/%3$s/repository/archive.zip',
				$this->repositoryProtocol,
				$this->repositoryHost,
				urlencode($this->userName . '/' . $this->repositoryName)
			);
			$url = add_query_arg('sha', urlencode($ref), $url);

			if ( !empty($this->accessToken) ) {
				$url = add_query_arg('private_token', $this->accessToken, $url);
			}

			return $url;
		}

		/**
		 * Get a specific tag.
		 *
		 * @param string $tagName
		 * @return void
		 */
		public function getTag($tagName) {
			throw new \LogicException('The ' . __METHOD__ . ' method is not implemented and should not be used.');
		}

		protected function getUpdateDetectionStrategies($configBranch) {
			$strategies = array();

			if ( ($configBranch === 'main') || ($configBranch === 'master') ) {
				$strategies[self::STRATEGY_LATEST_RELEASE] = array($this, 'getLatestRelease');
				$strategies[self::STRATEGY_LATEST_TAG] = array($this, 'getLatestTag');
			}

			$strategies[self::STRATEGY_BRANCH] = function () use ($configBranch) {
				return $this->getBranch($configBranch);
			};

			return $strategies;
		}

		public function setAuthentication($credentials) {
			parent::setAuthentication($credentials);
			$this->accessToken = is_string($credentials) ? $credentials : null;
		}

		/**
		 * Use release assets that link to GitLab generic packages (e.g. .zip files)
		 * instead of automatically generated source archives.
		 *
		 * This is included for backwards compatibility with older versions of PUC.
		 *
		 * @return void
		 * @deprecated   Use enableReleaseAssets() instead.
		 * @noinspection PhpUnused -- Public API
		 */
		public function enableReleasePackages() {
			$this->enableReleaseAssets(
			/** @lang RegExp */ '/\.zip($|[?&#])/i',
				Api::REQUIRE_RELEASE_ASSETS
			);
		}

		protected function getFilterableAssetName($releaseAsset) {
			if ( isset($releaseAsset->url) ) {
				return $releaseAsset->url;
			}
			return null;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Vcs\PluginUpdateChecker.php (9381 bytes, 276 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

use YahnisElsts\PluginUpdateChecker\v5p6\Plugin;

if ( !class_exists(PluginUpdateChecker::class, false) ):

	class PluginUpdateChecker extends Plugin\UpdateChecker implements BaseChecker {
		use VcsCheckerMethods;

		/**
		 * PluginUpdateChecker constructor.
		 *
		 * @param Api $api
		 * @param string $pluginFile
		 * @param string $slug
		 * @param int $checkPeriod
		 * @param string $optionName
		 * @param string $muPluginFile
		 */
		public function __construct($api, $pluginFile, $slug = '', $checkPeriod = 12, $optionName = '', $muPluginFile = '') {
			$this->api = $api;

			parent::__construct($api->getRepositoryUrl(), $pluginFile, $slug, $checkPeriod, $optionName, $muPluginFile);

			$this->api->setHttpFilterName($this->getUniqueName('request_info_options'));
			$this->api->setStrategyFilterName($this->getUniqueName('vcs_update_detection_strategies'));
			$this->api->setSlug($this->slug);
		}

		public function requestInfo($unusedParameter = null) {
			//We have to make several remote API requests to gather all the necessary info
			//which can take a while on slow networks.
			if ( function_exists('set_time_limit') ) {
				@set_time_limit(60);
			}

			$api = $this->api;
			$api->setLocalDirectory($this->package->getAbsoluteDirectoryPath());

			$info = new Plugin\PluginInfo();
			$info->filename = $this->pluginFile;
			$info->slug = $this->slug;

			$this->setInfoFromHeader($this->package->getPluginHeader(), $info);
			$this->setIconsFromLocalAssets($info);
			$this->setBannersFromLocalAssets($info);

			//Pick a branch or tag.
			$updateSource = $api->chooseReference($this->branch);
			if ( $updateSource ) {
				$ref = $updateSource->name;
				$info->version = $updateSource->version;
				$info->last_updated = $updateSource->updated;
				$info->download_url = $updateSource->downloadUrl;

				if ( !empty($updateSource->changelog) ) {
					$info->sections['changelog'] = $updateSource->changelog;
				}
				if ( isset($updateSource->downloadCount) ) {
					$info->downloaded = $updateSource->downloadCount;
				}
			} else {
				//There's probably a network problem or an authentication error.
				do_action(
					'puc_api_error',
					new \WP_Error(
						'puc-no-update-source',
						'Could not retrieve version information from the repository. '
						. 'This usually means that the update checker either can\'t connect '
						. 'to the repository or it\'s configured incorrectly.'
					),
					null, null, $this->slug
				);
				return null;
			}

			//Get headers from the main plugin file in this branch/tag. Its "Version" header and other metadata
			//are what the WordPress install will actually see after upgrading, so they take precedence over releases/tags.
			$mainPluginFile = basename($this->pluginFile);
			$remotePlugin = $api->getRemoteFile($mainPluginFile, $ref);
			if ( !empty($remotePlugin) ) {
				$remoteHeader = $this->package->getFileHeader($remotePlugin);
				$this->setInfoFromHeader($remoteHeader, $info);
			}

			//Sanity check: Reject updates that don't have a version number.
			//This can happen when we're using a branch, and we either fail to retrieve the main plugin
			//file or the file doesn't have a "Version" header.
			if ( empty($info->version) ) {
				do_action(
					'puc_api_error',
					new \WP_Error(
						'puc-no-plugin-version',
						'Could not find the version number in the repository.'
					),
					null, null, $this->slug
				);
				return null;
			}

			//Try parsing readme.txt. If it's formatted according to WordPress.org standards, it will contain
			//a lot of useful information like the required/tested WP version, changelog, and so on.
			if ( $this->readmeTxtExistsLocally() ) {
				$this->setInfoFromRemoteReadme($ref, $info);
			}

			//The changelog might be in a separate file.
			if ( empty($info->sections['changelog']) ) {
				$info->sections['changelog'] = $api->getRemoteChangelog($ref, $this->package->getAbsoluteDirectoryPath());
				if ( empty($info->sections['changelog']) ) {
					$info->sections['changelog'] = __('There is no changelog available.', 'plugin-update-checker');
				}
			}

			if ( empty($info->last_updated) ) {
				//Fetch the latest commit that changed the tag or branch and use it as the "last_updated" date.
				$latestCommitTime = $api->getLatestCommitTime($ref);
				if ( $latestCommitTime !== null ) {
					$info->last_updated = $latestCommitTime;
				}
			}

			$info = apply_filters($this->getUniqueName('request_info_result'), $info, null);
			return $info;
		}

		/**
		 * Check if the currently installed version has a readme.txt file.
		 *
		 * @return bool
		 */
		protected function readmeTxtExistsLocally() {
			return $this->package->fileExists($this->api->getLocalReadmeName());
		}

		/**
		 * Copy plugin metadata from a file header to a Plugin Info object.
		 *
		 * @param array $fileHeader
		 * @param Plugin\PluginInfo $pluginInfo
		 */
		protected function setInfoFromHeader($fileHeader, $pluginInfo) {
			$headerToPropertyMap = array(
				'Version' => 'version',
				'Name' => 'name',
				'PluginURI' => 'homepage',
				'Author' => 'author',
				'AuthorName' => 'author',
				'AuthorURI' => 'author_homepage',

				'Requires WP' => 'requires',
				'Tested WP' => 'tested',
				'Requires at least' => 'requires',
				'Tested up to' => 'tested',

				'Requires PHP' => 'requires_php',
			);
			foreach ($headerToPropertyMap as $headerName => $property) {
				if ( isset($fileHeader[$headerName]) && !empty($fileHeader[$headerName]) ) {
					$pluginInfo->$property = $fileHeader[$headerName];
				}
			}

			if ( !empty($fileHeader['Description']) ) {
				$pluginInfo->sections['description'] = $fileHeader['Description'];
			}
		}

		/**
		 * Copy plugin metadata from the remote readme.txt file.
		 *
		 * @param string $ref GitHub tag or branch where to look for the readme.
		 * @param Plugin\PluginInfo $pluginInfo
		 */
		protected function setInfoFromRemoteReadme($ref, $pluginInfo) {
			$readme = $this->api->getRemoteReadme($ref);
			if ( empty($readme) ) {
				return;
			}

			if ( isset($readme['sections']) ) {
				$pluginInfo->sections = array_merge($pluginInfo->sections, $readme['sections']);
			}
			if ( !empty($readme['tested_up_to']) ) {
				$pluginInfo->tested = $readme['tested_up_to'];
			}
			if ( !empty($readme['requires_at_least']) ) {
				$pluginInfo->requires = $readme['requires_at_least'];
			}
			if ( !empty($readme['requires_php']) ) {
				$pluginInfo->requires_php = $readme['requires_php'];
			}

			if ( isset($readme['upgrade_notice'], $readme['upgrade_notice'][$pluginInfo->version]) ) {
				$pluginInfo->upgrade_notice = $readme['upgrade_notice'][$pluginInfo->version];
			}
		}

		/**
		 * Add icons from the currently installed version to a Plugin Info object.
		 *
		 * The icons should be in a subdirectory named "assets". Supported image formats
		 * and file names are described here:
		 * @link https://developer.wordpress.org/plugins/wordpress-org/plugin-assets/#plugin-icons
		 *
		 * @param Plugin\PluginInfo $pluginInfo
		 */
		protected function setIconsFromLocalAssets($pluginInfo) {
			$icons = $this->getLocalAssetUrls(array(
				'icon.svg'         => 'svg',
				'icon-256x256.png' => '2x',
				'icon-256x256.jpg' => '2x',
				'icon-128x128.png' => '1x',
				'icon-128x128.jpg' => '1x',
			));

			if ( !empty($icons) ) {
				//The "default" key seems to be used only as last-resort fallback in WP core (5.8/5.9),
				//but we'll set it anyway in case some code somewhere needs it.
				reset($icons);
				$firstKey = key($icons);
				$icons['default'] = $icons[$firstKey];

				$pluginInfo->icons = $icons;
			}
		}

		/**
		 * Add banners from the currently installed version to a Plugin Info object.
		 *
		 * The banners should be in a subdirectory named "assets". Supported image formats
		 * and file names are described here:
		 * @link https://developer.wordpress.org/plugins/wordpress-org/plugin-assets/#plugin-headers
		 *
		 * @param Plugin\PluginInfo $pluginInfo
		 */
		protected function setBannersFromLocalAssets($pluginInfo) {
			$banners = $this->getLocalAssetUrls(array(
				'banner-772x250.png' => 'high',
				'banner-772x250.jpg' => 'high',
				'banner-1544x500.png' => 'low',
				'banner-1544x500.jpg' => 'low',
			));

			if ( !empty($banners) ) {
				$pluginInfo->banners = $banners;
			}
		}

		/**
		 * @param array<string, string> $filesToKeys
		 * @return array<string, string>
		 */
		protected function getLocalAssetUrls($filesToKeys) {
			$assetDirectory = $this->package->getAbsoluteDirectoryPath() . DIRECTORY_SEPARATOR . 'assets';
			if ( !is_dir($assetDirectory) ) {
				return array();
			}
			$assetBaseUrl = trailingslashit(plugins_url('', $assetDirectory . '/imaginary.file'));

			$foundAssets = array();
			foreach ($filesToKeys as $fileName => $key) {
				$fullBannerPath = $assetDirectory . DIRECTORY_SEPARATOR . $fileName;
				if ( !isset($icons[$key]) && is_file($fullBannerPath) ) {
					$foundAssets[$key] = $assetBaseUrl . $fileName;
				}
			}

			return $foundAssets;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Vcs\Reference.php (1173 bytes, 52 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

if ( !class_exists(Reference::class, false) ):

	/**
	 * This class represents a VCS branch or tag. It's intended as a read only, short-lived container
	 * that only exists to provide a limited degree of type checking.
	 *
	 * @property string $name
	 * @property string|null version
	 * @property string $downloadUrl
	 * @property string $updated
	 *
	 * @property string|null $changelog
	 * @property int|null $downloadCount
	 */
	class Reference {
		private $properties = array();

		public function __construct($properties = array()) {
			$this->properties = $properties;
		}

		/**
		 * @param string $name
		 * @return mixed|null
		 */
		public function __get($name) {
			return array_key_exists($name, $this->properties) ? $this->properties[$name] : null;
		}

		/**
		 * @param string $name
		 * @param mixed $value
		 */
		public function __set($name, $value) {
			$this->properties[$name] = $value;
		}

		/**
		 * @param string $name
		 * @return bool
		 */
		public function __isset($name) {
			return isset($this->properties[$name]);
		}

	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Vcs\ReleaseAssetSupport.php (2465 bytes, 83 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

if ( !trait_exists(ReleaseAssetSupport::class, false) ) :

	trait ReleaseAssetSupport {
		/**
		 * @var bool Whether to download release assets instead of the auto-generated
		 *           source code archives.
		 */
		protected $releaseAssetsEnabled = false;

		/**
		 * @var string|null Regular expression that's used to filter release assets
		 *                  by file name or URL. Optional.
		 */
		protected $assetFilterRegex = null;

		/**
		 * How to handle releases that don't have any matching release assets.
		 *
		 * @var int
		 */
		protected $releaseAssetPreference = Api::PREFER_RELEASE_ASSETS;

		/**
		 * Enable updating via release assets.
		 *
		 * If the latest release contains no usable assets, the update checker
		 * will fall back to using the automatically generated ZIP archive.
		 *
		 * @param string|null $nameRegex Optional. Use only those assets where
		 *                               the file name or URL matches this regex.
		 * @param int $preference Optional. How to handle releases that don't have
		 *                        any matching release assets.
		 */
		public function enableReleaseAssets($nameRegex = null, $preference = Api::PREFER_RELEASE_ASSETS) {
			$this->releaseAssetsEnabled = true;
			$this->assetFilterRegex = $nameRegex;
			$this->releaseAssetPreference = $preference;
		}

		/**
		 * Disable release assets.
		 *
		 * @return void
		 * @noinspection PhpUnused -- Public API
		 */
		public function disableReleaseAssets() {
			$this->releaseAssetsEnabled = false;
			$this->assetFilterRegex = null;
		}

		/**
		 * Does the specified asset match the name regex?
		 *
		 * @param mixed $releaseAsset Data type and structure depend on the host/API.
		 * @return bool
		 */
		protected function matchesAssetFilter($releaseAsset) {
			if ( $this->assetFilterRegex === null ) {
				//The default is to accept all assets.
				return true;
			}

			$name = $this->getFilterableAssetName($releaseAsset);
			if ( !is_string($name) ) {
				return false;
			}
			return (bool)preg_match($this->assetFilterRegex, $releaseAsset->name);
		}

		/**
		 * Get the part of asset data that will be checked against the filter regex.
		 *
		 * @param mixed $releaseAsset
		 * @return string|null
		 */
		abstract protected function getFilterableAssetName($releaseAsset);
	}

endif;
`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Vcs\ReleaseFilteringFeature.php (3287 bytes, 108 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

if ( !trait_exists(ReleaseFilteringFeature::class, false) ) :

	trait ReleaseFilteringFeature {
		/**
		 * @var callable|null
		 */
		protected $releaseFilterCallback = null;
		/**
		 * @var int
		 */
		protected $releaseFilterMaxReleases = 1;
		/**
		 * @var string One of the Api::RELEASE_FILTER_* constants.
		 */
		protected $releaseFilterByType = Api::RELEASE_FILTER_SKIP_PRERELEASE;

		/**
		 * Set a custom release filter.
		 *
		 * Setting a new filter will override the old filter, if any.
		 *
		 * @param callable $callback A callback that accepts a version number and a release
		 *                           object, and returns a boolean.
		 * @param int $releaseTypes  One of the Api::RELEASE_FILTER_* constants.
		 * @param int $maxReleases   Optional. The maximum number of recent releases to examine
		 *                           when trying to find a release that matches the filter. 1 to 100.
		 * @return $this
		 */
		public function setReleaseFilter(
			$callback,
			$releaseTypes = Api::RELEASE_FILTER_SKIP_PRERELEASE,
			$maxReleases = 20
		) {
			if ( $maxReleases > 100 ) {
				throw new \InvalidArgumentException(sprintf(
					'The max number of releases is too high (%d). It must be 100 or less.',
					$maxReleases
				));
			} else if ( $maxReleases < 1 ) {
				throw new \InvalidArgumentException(sprintf(
					'The max number of releases is too low (%d). It must be at least 1.',
					$maxReleases
				));
			}

			$this->releaseFilterCallback = $callback;
			$this->releaseFilterByType = $releaseTypes;
			$this->releaseFilterMaxReleases = $maxReleases;
			return $this;
		}

		/**
		 * Filter releases by their version number.
		 *
		 * @param string $regex A regular expression. The release version number must match this regex.
		 * @param int $releaseTypes
		 * @param int $maxReleasesToExamine
		 * @return $this
		 * @noinspection PhpUnused -- Public API
		 */
		public function setReleaseVersionFilter(
			$regex,
			$releaseTypes = Api::RELEASE_FILTER_SKIP_PRERELEASE,
			$maxReleasesToExamine = 20
		) {
			return $this->setReleaseFilter(
				function ($versionNumber) use ($regex) {
					return (preg_match($regex, $versionNumber) === 1);
				},
				$releaseTypes,
				$maxReleasesToExamine
			);
		}

		/**
		 * @param string $versionNumber The detected release version number.
		 * @param object $releaseObject Varies depending on the host/API.
		 * @return bool
		 */
		protected function matchesCustomReleaseFilter($versionNumber, $releaseObject) {
			if ( !is_callable($this->releaseFilterCallback) ) {
				return true; //No custom filter.
			}
			return call_user_func($this->releaseFilterCallback, $versionNumber, $releaseObject);
		}

		/**
		 * @return bool
		 */
		protected function shouldSkipPreReleases() {
			//Maybe this could be a bitfield in the future, if we need to support
			//more release types.
			return ($this->releaseFilterByType !== Api::RELEASE_FILTER_ALL);
		}

		/**
		 * @return bool
		 */
		protected function hasCustomReleaseFilter() {
			return isset($this->releaseFilterCallback) && is_callable($this->releaseFilterCallback);
		}
	}

endif;
`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Vcs\ThemeUpdateChecker.php (2786 bytes, 84 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

use YahnisElsts\PluginUpdateChecker\v5p6\Theme;
use YahnisElsts\PluginUpdateChecker\v5p6\Utils;

if ( !class_exists(ThemeUpdateChecker::class, false) ):

	class ThemeUpdateChecker extends Theme\UpdateChecker implements BaseChecker {
		use VcsCheckerMethods;

		/**
		 * ThemeUpdateChecker constructor.
		 *
		 * @param Api $api
		 * @param null $stylesheet
		 * @param null $customSlug
		 * @param int $checkPeriod
		 * @param string $optionName
		 */
		public function __construct($api, $stylesheet = null, $customSlug = null, $checkPeriod = 12, $optionName = '') {
			$this->api = $api;

			parent::__construct($api->getRepositoryUrl(), $stylesheet, $customSlug, $checkPeriod, $optionName);

			$this->api->setHttpFilterName($this->getUniqueName('request_update_options'));
			$this->api->setStrategyFilterName($this->getUniqueName('vcs_update_detection_strategies'));
			$this->api->setSlug($this->slug);
		}

		public function requestUpdate() {
			$api = $this->api;
			$api->setLocalDirectory($this->package->getAbsoluteDirectoryPath());

			$update = new Theme\Update();
			$update->slug = $this->slug;

			//Figure out which reference (tag or branch) we'll use to get the latest version of the theme.
			$updateSource = $api->chooseReference($this->branch);
			if ( $updateSource ) {
				$ref = $updateSource->name;
				$update->download_url = $updateSource->downloadUrl;
			} else {
				do_action(
					'puc_api_error',
					new \WP_Error(
						'puc-no-update-source',
						'Could not retrieve version information from the repository. '
						. 'This usually means that the update checker either can\'t connect '
						. 'to the repository or it\'s configured incorrectly.'
					),
					null, null, $this->slug
				);
				$ref = $this->branch;
			}

			//Get headers from the main stylesheet in this branch/tag. Its "Version" header and other metadata
			//are what the WordPress install will actually see after upgrading, so they take precedence over releases/tags.
			$remoteHeader = $this->package->getFileHeader($api->getRemoteFile('style.css', $ref));
			$update->version = Utils::findNotEmpty(array(
				$remoteHeader['Version'],
				Utils::get($updateSource, 'version'),
			));

			//The details URL defaults to the Theme URI header or the repository URL.
			$update->details_url = Utils::findNotEmpty(array(
				$remoteHeader['ThemeURI'],
				$this->package->getHeaderValue('ThemeURI'),
				$this->metadataUrl,
			));

			if ( empty($update->version) ) {
				//It looks like we didn't find a valid update after all.
				$update = null;
			}

			$update = $this->filterUpdateResult($update);
			return $update;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Vcs\VcsCheckerMethods.php (1344 bytes, 59 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

if ( !trait_exists(VcsCheckerMethods::class, false) ) :

	trait VcsCheckerMethods {
		/**
		 * @var string The branch where to look for updates. Defaults to "master".
		 */
		protected $branch = 'master';

		/**
		 * @var Api Repository API client.
		 */
		protected $api = null;

		public function setBranch($branch) {
			$this->branch = $branch;
			return $this;
		}

		/**
		 * Set authentication credentials.
		 *
		 * @param array|string $credentials
		 * @return $this
		 */
		public function setAuthentication($credentials) {
			$this->api->setAuthentication($credentials);
			return $this;
		}

		/**
		 * @return Api
		 */
		public function getVcsApi() {
			return $this->api;
		}

		public function getUpdate() {
			$update = parent::getUpdate();

			if ( isset($update) && !empty($update->download_url) ) {
				$update->download_url = $this->api->signDownloadUrl($update->download_url);
			}

			return $update;
		}

		public function onDisplayConfiguration($panel) {
			parent::onDisplayConfiguration($panel);
			$panel->row('Branch', $this->branch);
			$panel->row('Authentication enabled', $this->api->isAuthenticationEnabled() ? 'Yes' : 'No');
			$panel->row('API client', get_class($this->api));
		}
	}

endif;
`$nl

`$nl
===== FILE: pack-code.ps1 (4063 bytes, 113 lines) =====
`$ext
param(
  [string]$Root = ".",
  [string]$Out = "codepack.txt",
  [string]$IncludeExt = ".php,.js,.ts,.css,.scss,.html,.htm,.json,.md,.yml,.yaml,.xml,.sh,.ps1,.ini,.txt,.sql,.twig,.vue",
  # 제외할 디렉터리들 (쉼표로 구분)
  [string]$ExcludeDirs = "node_modules,dist,build,vendor,.git,.github,.idea,.vscode,.next,.cache,growth-checklist\plugin-update-checker",
  # 제외할 파일 패턴들 (쉼표로 구분)
  [string]$ExcludeFiles = "*.min.js,*.min.css,*.map,*.lock,*.zip,*.tar,*.gz,*.png,*.jpg,*.jpeg,*.gif,*.webp,*.svg,*.woff,*.woff2,*.ttf,*.eot,*.pdf",
  # 용량 한도
  [int]$MaxFileBytes = 1000000,    # 파일당 최대 1MB
  [int]$MaxTotalBytes = 20000000,  # 전체 최대 20MB
  # 변경 파일만 모드
  [switch]$ChangedOnly,
  [string]$GitRange = ""
)

$ErrorActionPreference = "Stop"
$Root = (Resolve-Path $Root).Path
$include = $IncludeExt.Split(",") | ForEach-Object { $_.Trim().ToLower() } | Where-Object { $_ -ne "" }
$exDirs  = $ExcludeDirs.Split(",")  | ForEach-Object { $_.Trim() }        | Where-Object { $_ -ne "" }
$exFiles = $ExcludeFiles.Split(",") | ForEach-Object { $_.Trim() }        | Where-Object { $_ -ne "" }

function IsTextExt($path) {
  $ext = [IO.Path]::GetExtension($path).ToLower()
  return $include -contains $ext
}
function IsExcludedDir($path) {
  foreach ($d in $exDirs) {
    if ($path -like "*$d*") { return $true }
  }
  return $false
}
function IsExcludedFile($file) {
  foreach ($p in $exFiles) {
    if ([IO.Path]::GetFileName($file) -like $p) { return $true }
  }
  return $false
}

# 파일 목록 수집
$files = @()
if ($ChangedOnly) {
  $gitArgs = @("diff","--name-only")
  if ($GitRange) { $gitArgs += $GitRange }
  $changed = & git @gitArgs 2>$null
  foreach ($rel in $changed) {
    $p = Join-Path $Root $rel
    if (Test-Path $p -PathType Leaf) { $files += (Resolve-Path $p).Path }
  }
} else {
  $files = Get-ChildItem -Path $Root -Recurse -File | ForEach-Object { $_.FullName }
}

# 필터링
$files = $files | Where-Object {
  -not (IsExcludedDir $_) -and
  -not (IsExcludedFile $_) -and
  (IsTextExt $_)
}

# 출력 빌드
$sb = New-Object System.Text.StringBuilder
$totalBytes = 0
$nl = [Environment]::NewLine

# 상단 메타
try {
  $repoUrl = (git -C $Root config --get remote.origin.url)
  $branch  = (git -C $Root rev-parse --abbrev-ref HEAD)
  $tag     = (git -C $Root describe --tags --abbrev=0) 2>$null
  $commit  = (git -C $Root rev-parse --short HEAD)
  $time    = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
  $null = $sb.AppendLine("===== META =====")
  $null = $sb.AppendLine("Repo: $repoUrl")
  $null = $sb.AppendLine("Branch: $branch  |  Tag: $tag  |  Commit: $commit")
  $null = $sb.AppendLine("Generated: $time")
  $null = $sb.AppendLine("")
} catch {}

foreach ($f in $files) {
  try {
    $fi = Get-Item $f
    $size = $fi.Length
    if ($size -gt $MaxFileBytes) {
      $rel = $f.Substring($Root.Length+1)
      $null = $sb.AppendLine("===== FILE: $rel ($size bytes) SKIPPED: > $MaxFileBytes =====$nl")
      continue
    }
    if (($totalBytes + $size) -gt $MaxTotalBytes) {
      $null = $sb.AppendLine("===== STOP: total size would exceed $MaxTotalBytes bytes. Remaining files omitted. =====$nl")
      break
    }

    $rel = $f.Substring($Root.Length+1)
    $content = (Get-Content -Path $f -Raw -Encoding UTF8)
    $lineCount = ($content -split "`r?`n").Count
    $ext = [IO.Path]::GetExtension($f).TrimStart(".").ToLower()
    if (-not $ext) { $ext = "text" }

    $null = $sb.AppendLine("===== FILE: $rel ($size bytes, $lineCount lines) =====")
    $null = $sb.AppendLine("```$ext")
    $null = $sb.AppendLine($content)
    $null = $sb.AppendLine("```$nl")

    $totalBytes += $size
  } catch {
    $null = $sb.AppendLine("===== FILE: $f ERROR: $($_.Exception.Message) =====$nl")
  }
}

[IO.File]::WriteAllText((Join-Path $Root $Out), $sb.ToString(), [Text.Encoding]::UTF8)
"생성 완료: $(Join-Path $Root $Out)  (총 approx $totalBytes bytes)"

`$nl
===== FILE: berrywalk-feedback-acf\berrywalk-feedback-acf.php (3764 bytes, 94 lines) =====
`$ext
<?php
/*
Plugin Name: Berrywalk Feedback (ACF)
Description: 대표 질문지 + 대표 회원가입 + 마이페이지 (ACF 기반 경량 플러그인)
Version: 1.0.5
Author: Berrywalk
Text Domain: berrywalk-feedback-acf
*/

if (!defined('ABSPATH')) exit;

/** ───────────────── 기본 상수 ───────────────── */
define('BWFB_VER',  '1.0.5');
define('BWFB_FILE', __FILE__);
define('BWFB_DIR',  plugin_dir_path(__FILE__));
define('BWFB_URL',  plugin_dir_url(__FILE__));

/** ───────────────── (선택) 텔레그램 설정 ─────────────────
 * 보안을 위해 wp-config.php 에 아래처럼 두는 것을 권장합니다.
 *   define('BW_TG_BOT_TOKEN', '1234:AAAA...'); // BotFather
 *   define('BW_TG_CHAT_ID',   '@your_public_channel_id'); // @로 시작(공개채널)
 * 플러그인 파일에 두고 싶으면 아래 주석을 풀어 사용하세요.
 */
if (!defined('BW_TG_BOT_TOKEN')) define('BW_TG_BOT_TOKEN', '');
if (!defined('BW_TG_CHAT_ID'))   define('BW_TG_CHAT_ID',   '');

/** ──────────────── 필수 파일 로더(누락 시 안전 종료) ──────────────── */
$__need = [
  'includes/cpt-admin.php',
  'includes/form.php',
  'includes/signup.php',
  'includes/save.php',
  'includes/view-list.php',
  'includes/acf-fields.php',
];
foreach ($__need as $__rel) {
  $__path = BWFB_DIR . $__rel;
  if (file_exists($__path)) {
    require_once $__path;
  } else {
    // 파일 누락이면 활성화 즉시 비활성화 + 관리자 알림
    add_action('admin_init', function(){ deactivate_plugins(plugin_basename(BWFB_FILE)); });
    add_action('admin_notices', function() use ($__rel){
      echo '<div class="notice notice-error"><p><strong>Berrywalk Feedback</strong> — 누락된 파일: <code>' .
        esc_html($__rel) . '</code> 전체 폴더를 업로드하세요.</p></div>';
    });
    return;
  }
}

/** ──────────────── 에셋 등록(핸들 호환 유지) ──────────────── */
add_action('wp_enqueue_scripts', function(){
  $css = BWFB_URL.'assets/owner-form.css';
  $js  = BWFB_URL.'assets/owner-form.js';
  wp_register_style ('bwos-form', $css, [], BWFB_VER);
  wp_register_style ('bwf-forms', $css, [], BWFB_VER); // alias
  wp_register_script('bwos-form', $js,  ['jquery'], BWFB_VER, true);
  wp_register_script('bwf-forms', $js,  ['jquery'], BWFB_VER, true); // alias
});

/** ──────────────── (선택) 깃허브 자동 업데이트 ────────────────
 * /plugin-update-checker/ 폴더가 있으면 사용합니다.
 * 리포 경로를 "사용자명/리포명"으로 바꿔주세요.
 */
add_action('init', function () {
  $puc = BWFB_DIR.'plugin-update-checker/plugin-update-checker.php';
  if (!is_admin() || !file_exists($puc)) return;

  require_once $puc;

  // ❗여기를 본인 깃허브 리포에 맞게 수정: 예) 'jakvis2/berrywalk-feedback-acf'
  $repo = 'jakvis2/berrywalk-feedback-acf';

  // PUC v5 / v4 모두 자동 호환
  if (class_exists('Puc_v5_Factory')) {
    $up = Puc_v5_Factory::buildUpdateChecker(
      'https://github.com/'.$repo.'/',
      BWFB_FILE,
      'berrywalk-feedback-acf' // 플러그인 슬러그(폴더명과 맞추기)
    );
  } elseif (class_exists('Puc_v4_Factory')) {
    $up = Puc_v4_Factory::buildUpdateChecker(
      'https://github.com/'.$repo.'/',
      BWFB_FILE,
      'berrywalk-feedback-acf'
    );
  } else {
    return;
  }

  // 기본 브랜치(main/master)에 맞게 설정
  if (method_exists($up, 'setBranch')) $up->setBranch('main');
});

`$nl
===== FILE: berrywalk-feedback-acf\README.md (1409 bytes, 40 lines) =====
`$ext
# BW Owner Suite (ACF Minimal)

워드프레스 표준 + ACF만 사용하여
- 회원가입 → 프로필 수정
- 대표 질문(CPT) 작성/수정/보기/목록/복제/삭제
- 저장 알림(메일/텔레그램)

을 한 번에 처리하는 경량 플러그인입니다.

## 설치
1) `Advanced Custom Fields`(ACF) 플러그인을 활성화
2) 워드프레스 관리자 → 플러그인 → 새로 추가 → 플러그인 업로드 → 이 ZIP 업로드 후 활성화
3) 활성화 즉시 아래 페이지가 자동 생성됩니다.
   - `/owner-questions/` 작성
   - `/owner-edit/?id=글ID` 수정
   - `/my-question-view/?id=글ID` 보기
   - `/my-questions/` 내 저장본(보기/수정/복제/삭제)
   - `/my-profile/` 마이프로필
   - `/register/` 회원가입

## 텔레그램 알림(선택)
`wp-config.php`에 아래 상수를 추가하면 저장 시 텔레그램 알림이 전송됩니다.

```php
define('BWF_TG_BOT','123456:ABC...');       // 봇 토큰
define('BWF_TG_CHAT','-1001234567890');     // 채팅 ID
```

## 짧은코드(Shortcodes)
- [bw_register]
- [bw_profile_form]
- [bw_owner_form_acf]
- [bw_owner_edit id="123"]  (또는 /owner-edit/?id=123)
- [bwf_owner_view id="123"]
- [bw_my_questions]

## 주의
- 플러그인 동작을 위해 ACF가 필요합니다.
- 데이터는 CPT `bwf_owner_answer`에 저장되며 리비전이 활성화되어 되돌리기가 가능합니다.

`$nl
===== FILE: berrywalk-feedback-acf\assets\owner-form.css (5415 bytes, 109 lines) =====
`$ext
/* /assets/owner-form.css */

/* ====== Base ====== */
:root{
  --bw-font:17.5px;
  --bw-muted:#64748b;
  --bw-border:#e5e7eb;
  --bw-accent:#6366f1;
  --bw-ok:#16a34a;
  --bw-warn:#ef4444;
  --bw-bg:#f8fafc;
}
body{font-size:var(--bw-font);background:var(--bw-bg)}
.bwos-wrap{max-width:920px;margin:40px auto;padding:0 16px}               /* ⬆ 여백 확대 */
.bwf-title{font-size:30px;line-height:1.25;margin:22px 0 16px}
.bwf-help{color:#0f172a;margin:0 0 18px}

/* ====== Sticky progress (카드형, 배경/테두리 추가) ====== */
.bwos-progress{
  position:sticky;top:64px;z-index:1000;margin:0 0 18px;
  background:#ffffff; border:1px solid var(--bw-border); border-radius:14px;
  padding:12px 14px; box-shadow:0 6px 18px rgba(2,6,23,.06);
}
body.admin-bar .bwos-progress{top:96px}
.bwos-progress .bar{height:10px;background:#f2f4f7;border-radius:999px;overflow:hidden}
.bwos-progress .bar>span{display:block;height:100%;width:0%;background:linear-gradient(90deg,#22d3ee,#6366f1);border-radius:999px;transition:width .2s}
.bwos-progress .status{font-size:12px;color:#334155;margin-top:8px}

/* ====== Field ====== */
.bwf-field{margin:28px 0}                                                  /* ⬆ 여백 확대 */
.bwf-field label{display:block;font-weight:700;margin:0 0 14px;font-size:18px}
.bwf-field textarea,
.bwf-field input[type="text"],
.bwf-field input[type="number"],
.bwf-field input[type="email"],
.bwf-field input[type="tel"],
.bwf-field input[type="url"],
.bwf-field select{
  width:100%;box-sizing:border-box;padding:13px 14px;border:1px solid #d1d5db;border-radius:12px;background:#fff;font-size:16.5px;outline:none
}
.bwf-field textarea:focus,
.bwf-field input:focus,
.bwf-field select:focus{border-color:var(--bw-accent);box-shadow:0 0 0 3px rgba(99,102,241,.15)}

.bwos-field.bwos-error textarea,
.bwos-field.bwos-error input,
.bwos-field.bwos-error select{border-color:var(--bw-warn);background:#fff1f2}
.bwf-invalid{border-color:var(--bw-warn) !important;background:#fff1f2 !important}

/* ====== 설명/예시 – 한국형 카드 스타일 ====== */
.bwf-desc, .bwf-examples{
  margin:10px 0 10px;padding:12px 14px;border:1px dashed #dbe1ea;border-radius:12px;background:#fbfdff
}
.bwf-desc::before{
  content:"설명"; display:inline-block; font-size:12px; font-weight:800; color:#0ea5e9;
  background:#e6f6fb; border:1px solid #bde7f4; border-radius:999px; padding:2px 8px; margin-right:8px
}
.bwf-examples::before{
  content:"예시"; display:inline-block; font-size:12px; font-weight:800; color:#6366f1;
  background:#eef0ff; border:1px solid #dfe3ff; border-radius:999px; padding:2px 8px; margin-right:8px
}
.bwf-examples ul,.bwf-examples ol{margin:6px 0 0 18px}

/* ====== Counter ====== */
.bwos-count{
  display:inline-block;margin-top:8px;font-size:12px;font-weight:700;
  color:var(--bw-muted);background:#f3f4f6;border:1px solid #e5e7eb;border-radius:999px;padding:4px 8px
}
.bwos-count.ok{color:#065f46;background:#ecfdf5;border-color:#bbf7d0}
.bwos-count.need{color:#7c2d12;background:#fff7ed;border-color:#fed7aa}

/* ====== Buttons ====== */
.bwf-actions{display:flex;gap:10px;align-items:center;justify-content:center;margin-top:20px}
.bwf-btn{display:inline-block;padding:12px 18px;border-radius:14px;border:none;background:var(--bw-accent);color:#fff;text-decoration:none;font-weight:700}
.bwf-btn-secondary{display:inline-block;padding:12px 18px;border-radius:14px;border:1px solid #cbd5e1;background:#fff;color:#0f172a;text-decoration:none;font-weight:700}


/* ====== Modal (공용) ====== */
.bwos-modal, .bwf-modal{
  position:fixed;inset:0;display:none;align-items:flex-start;justify-content:center;padding-top:18vh;background:rgba(0,0,0,.45);z-index:100000
}
body.admin-bar .bwos-modal, body.admin-bar .bwf-modal{padding-top:calc(18vh + 32px)}
.bwos-modal.is-open, .bwf-modal.is-open{display:flex}
.bwos-modal-inner, .bwf-modal .bwf-modal__card{
  background:#fff;max-width:560px;width:92vw;padding:22px;border-radius:16px;box-shadow:0 22px 44px rgba(2,6,23,.18)
}
.bwos-modal-inner h4, .bwf-modal h3{margin:0 0 10px;font-size:18px}
.bwos-modal-inner p, .bwf-modal p{margin:0 0 12px;color:#334155}
.bwf-modal__list{margin:6px 0 0 18px;font-size:14px;color:#1f2937}

/* ====== List / View ====== */
.bwf-card{border:1px solid var(--bw-border);background:#fff;border-radius:12px;padding:12px 14px}

/* ====== Signup grid ====== */
.bwf-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px 14px}
.bwf-col-full{grid-column:1/-1}
@media (max-width:720px){.bwf-grid{grid-template-columns:1fr}}
.bwf-hidden{display:none}

/* 마이페이지 카드 & 페이지네이션 */
.bwos-list{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:16px}
@media (max-width:920px){.bwos-list{grid-template-columns:1fr}}
.bwos-card{border:1px solid #e5e7eb;border-radius:14px;padding:14px 16px;background:#fff;box-shadow:0 6px 14px rgba(2,6,23,.05)}
.bwos-card h4{margin:0 0 6px;font-size:17px}
.bwos-card .meta{font-size:12px;color:#64748b;margin-bottom:10px}
.bwos-card .row a{display:inline-block;padding:8px 12px;border-radius:10px;background:#f1f5f9;text-decoration:none;color:#0f172a}
.bwos-pg{margin:18px 0 8px;text-align:center}
.bwos-pg .page-numbers{display:inline-block;padding:8px 12px;border:1px solid #e5e7eb;border-radius:10px;margin:0 3px;text-decoration:none;color:#0f172a}
.bwos-pg .current{background:#6366f1;color:#fff;border-color:#6366f1}
`$nl
===== FILE: berrywalk-feedback-acf\assets\owner-form.js (4147 bytes, 94 lines) =====
`$ext
/* /assets/owner-form.js  (카운터 텍스트 – "몇자 남음" 친절 메시지로) */
(function($){
  if(!$ || !$('.bwos-form').length) return;

  const $form = $('.bwos-form').first();
  const $progress = $form.find('.bwos-progress');
  const reqs = []; let submitted=false;

  function updateProgress(){
    const total=reqs.length, done=reqs.filter(r=>r.valid()).length, pct=total?Math.round(done/total*100):0;
    $progress.find('.bar>span').css('width',pct+'%');
    $progress.find('.status').text('작성 '+done+'/'+total+' ('+pct+'%)');
  }

  function wire($wrap){
    const min = parseInt($wrap.data('min')||200,10);
    const $subs = $wrap.find('.bwf-sub textarea');
    const isGroup = $subs.length>0;
    let $cnt = $wrap.find('.bwos-count'); if(!$cnt.length) $cnt=$('<small class="bwos-count"></small>').appendTo($wrap);

    const setError = bad => $wrap.toggleClass('bwos-error', submitted && !!bad);
    const valid = ()=>{
      if(isGroup){ let ok=true; $subs.each(function(){ if(($(this).val()||'').trim()==='') ok=false; }); return ok; }
      return (($wrap.find('textarea,input[type="text"]').first().val()||'').trim().length >= min);
    };

    const update = ()=>{
      if(isGroup){
        let anyEmpty=false; $subs.each(function(){ if(($(this).val()||'').trim()==='') anyEmpty=true; });
        $cnt.text(anyEmpty ? '질문 3개 모두 작성' : '충족').toggleClass('need',anyEmpty).toggleClass('ok',!anyEmpty);
        setError(anyEmpty);
      }else{
        const v=($wrap.find('textarea,input[type="text"]').first().val()||'').trim();
        const diff = min - v.length;
        if(diff>0){ $cnt.text(diff+'자 남음'); $cnt.removeClass('ok').addClass('need'); }
        else      { $cnt.text('충족'); $cnt.removeClass('need').addClass('ok'); }
        setError(v.length < min);
      }
      updateProgress();
    };

    (isGroup ? $subs : $wrap.find('textarea,input[type="text"]').first()).on('input blur', update);
    reqs.push({wrap:$wrap, valid, update, min}); update();
  }

  $form.find('.bwos-required').each(function(){ wire($(this)); });
  updateProgress();

  const $modal=$('<div class="bwos-modal"><div class="bwos-modal-inner"><h4>입력이 필요한 항목이 있어요</h4><p>아래 항목을 확인해 주세요.</p><ul class="bwf-modal__list"></ul><button type="button" class="bwf-btn-secondary ok">확인</button></div></div>').appendTo('body');
  $modal.on('click','.ok',()=> $modal.removeClass('is-open'));

  let locked=false;
  $form.on('submit',function(e){
    submitted=true; let bad=false; const items=[];
    reqs.forEach(r=>{
      if(!r.valid()){
        bad=true; const lab=r.wrap.find('label').first().text().replace(/\*.*$/,'').trim();
        if(r.wrap.find('.bwf-sub').length){ items.push('· '+lab+' — 3개 질문 모두 작성'); }
        else{
          const len=($r=r.wrap.find('textarea,input[type="text"]').first()).val().trim().length;
          const diff=(r.min||200)-len; items.push('· '+lab+' — 최소 글자수 부족 ('+diff+'자 남음)');
        }
        r.update();
      }
    });
    if(bad){
      e.preventDefault();
      const ul=$modal.find('.bwf-modal__list').empty();
      items.forEach(t=> $('<li/>').text(t).appendTo(ul));
      $modal.addClass('is-open');
      const $first=$form.find('.bwos-error').first(); if($first.length) $('html,body').animate({scrollTop:$first.offset().top-120},180);
      return;
    }
    if(locked){ e.preventDefault(); return; }
    locked=true; $form.find('.bwos-submit').prop('disabled',true).text('저장 중…');
    setTimeout(()=>{ locked=false; $form.find('.bwos-submit').prop('disabled',false).text('저장'); }, 6000);
  });
})(jQuery);

/* === Tab 이동: textarea에서 Tab 누르면 다음 필드로 포커스 === */
(function($){
  const $areas = $('.bwos-form textarea:visible');
  $areas.on('keydown', function(e){
    if(e.key === 'Tab' && !e.shiftKey){
      const list = $('.bwos-form textarea:visible');
      const idx = list.index(this);
      if(idx > -1 && idx < list.length - 1){
        e.preventDefault();
        list.eq(idx + 1).focus();
      }
    }
  });
})(jQuery);

`$nl
===== FILE: berrywalk-feedback-acf\includes\acf-fields.php (3509 bytes, 76 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

add_action('acf/init', function(){
  if (!function_exists('acf_add_local_field_group')) return;

  acf_add_local_field_group([
    'key'=>'group_bwos_owner_v5','title'=>'대표 질문지',
    'fields'=>[
      ['key'=>'f_problem','label'=>'1) 지금, 우리 사업의 가장 큰 고민은 무엇인가요?','name'=>'_acf_problem','type'=>'textarea','required'=>1,'rows'=>8,'instructions'=>'최소 200자 권장'],
      ['key'=>'f_value','label'=>'2) 우리 서비스의 핵심 가치는 무엇인가요?','name'=>'_acf_value','type'=>'textarea','required'=>1,'rows'=>6],
      ['key'=>'f_whom','label'=>'3) 누가 이용해야 하나요? 왜 우리인가요?','name'=>'_acf_ideal_customer','type'=>'textarea','required'=>1,'rows'=>6],
      ['key'=>'f_ask1','label'=>'4-1) 고객에게 묻고 싶은 질문 #1','name'=>'_acf_cq1','type'=>'text'],
      ['key'=>'f_ask2','label'=>'4-2) 고객에게 묻고 싶은 질문 #2','name'=>'_acf_cq2','type'=>'text'],
      ['key'=>'f_ask3','label'=>'4-3) 고객에게 묻고 싶은 질문 #3','name'=>'_acf_cq3','type'=>'text'],
      ['key'=>'f_comp','label'=>'5) 경쟁사 대비 차별점','name'=>'_acf_competitors','type'=>'textarea','required'=>1,'rows'=>6],
    ],
    'location'=>[[['param'=>'post_type','operator'=>'==','value'=>'bwf_owner_answer']]],
    'position'=>'normal','style'=>'default','active'=>true,
  ]);
});


/** 200자 필드 서버 검증 */
add_filter('acf/validate_value', function($valid, $value, $field){
  if ($valid !== true) return $valid;
  $min200 = ['problem','core_value','target_customer','differentiation','sales_blockers','current_channels','growth_goal','next_action'];
  if (in_array($field['name'] ?? '', $min200, true)) {
    if (mb_strlen(trim((string)$value)) < 200) return '최소 200자 이상 작성해 주세요.';
  }
  return $valid;
}, 10, 3);
/* ------- ACF <-> bwf_answers 동기화 ------- */
function bwos_acf_meta_keys(){ // ACF 메타키(name) 매핑
  return [
    '_acf_problem'       => ['id'=>'problem'],
    '_acf_value'         => ['id'=>'value'],
    '_acf_ideal_customer'=> ['id'=>'ideal_customer'],
    '_acf_cq1'           => ['id'=>'ask3','sub'=>'q1'],
    '_acf_cq2'           => ['id'=>'ask3','sub'=>'q2'],
    '_acf_cq3'           => ['id'=>'ask3','sub'=>'q3'],
    '_acf_competitors'   => ['id'=>'competitors'],
  ];
}

/* 편집 화면 로드시 ACF 메타 채워넣기(관리자에서 비어 보이던 문제 해결) */
add_action('load-post.php', function(){
  $pid = isset($_GET['post']) ? (int)$_GET['post'] : 0;
  if(!$pid) return;
  $p = get_post($pid);
  if(!$p || $p->post_type!=='bwf_owner_answer') return;

  $ans = (array)get_post_meta($pid,'bwf_answers',true);
  foreach(bwos_acf_meta_keys() as $meta=>$m){
    $val = '';
    if(empty($m['sub'])) $val = (string)($ans[$m['id']] ?? '');
    else                 $val = (string)($ans[$m['id']][$m['sub']] ?? '');
    update_post_meta($pid, $meta, $val);
  }
});

/* 저장 시 ACF 값으로 bwf_answers 재생성(양방향 동기화) */
add_action('save_post_bwf_owner_answer', function($post_id){
  if(defined('DOING_AUTOSAVE') && DOING_AUTOSAVE) return;
  $ans = [];
  foreach(bwos_acf_meta_keys() as $meta=>$m){
    $v = (string)get_post_meta($post_id,$meta,true);
    if(empty($m['sub'])) $ans[$m['id']] = $v;
    else {
      if(empty($ans[$m['id']])) $ans[$m['id']] = [];
      $ans[$m['id']][$m['sub']] = $v;
    }
  }
  if($ans) update_post_meta($post_id,'bwf_answers',$ans);
}, 20);

`$nl
===== FILE: berrywalk-feedback-acf\includes\cpt-admin.php (871 bytes, 21 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

add_action('init', function(){
  register_post_type('bwf_owner_answer', [
    'label'=>'대표 질문지','labels'=>['name'=>'대표 질문지','add_new_item'=>'새 대표 질문 생성','edit_item'=>'대표 질문 편집'],
    'public'=>false,'exclude_from_search'=>true,'publicly_queryable'=>false,'show_ui'=>true,'show_in_menu'=>true,
    'menu_icon'=>'dashicons-editor-help','supports'=>['author','custom-fields'],'map_meta_cap'=>true,
  ]);
});

add_filter('manage_bwf_owner_answer_posts_columns', function($c){
  return ['cb'=>$c['cb'],'title'=>'제목','author'=>'작성자','created'=>'저장 시각'];
});
add_action('manage_bwf_owner_answer_posts_custom_column', function($col,$post_id){
  if($col==='created'){
    $ts = get_post_timestamp($post_id,'date');
    echo esc_html( wp_date('Y-m-d H:i', $ts) );
  }
}, 10, 2);

`$nl
===== FILE: berrywalk-feedback-acf\includes\form.php (7759 bytes, 127 lines) =====
`$ext
<?php
/* /includes/form.php (핵심 변경만) */
if (!defined('ABSPATH')) exit;

/** 공용 URL (중복 선언 방지) */
if (!function_exists('bwf_owner_view_url'))  { function bwf_owner_view_url(){ return home_url('/my-question-view/'); } }
if (!function_exists('bwf_owner_edit_url'))  { function bwf_owner_edit_url(){ return home_url('/owner-edit/'); } }
if (!function_exists('bwf_owner_list_url'))  { function bwf_owner_list_url(){ return home_url('/my-questions/'); } }


function bwf_owner_cfg(){
  return [
    'title'=>'대표님 핵심 질문지',
    'min'=>200,
    'intro'=>'사업의 본질을 파악하고 고객에게 정말 묻고 싶은 질문을 구체화합니다. 각 문항은 최소 <strong>{MIN}</strong>자입니다. <em>(단, <strong>“고객에게 물어보고 싶은 3가지”</strong>는 글자수 제한 없음)</em>',
    'qs'=>[
      [
        'id'=>'problem','label'=>'1. 지금, 우리 사업의 가장 큰 고민은 무엇인가요?','required'=>true,'min'=>200,
        'desc'=>'성장이 정체되었다고 느낀 **구체적 상황**을 한두 문장으로. 숫자/행동 기반이면 좋아요.',
        'ex'=>'<ul><li>“클릭은 많은데 체류 30초 미만 이탈이 많아요.”</li><li>“재구매율이 낮아 신규 유입 의존도가 큽니다.”</li></ul>'
      ],
      [
        'id'=>'value','label'=>'2. 우리 서비스는 고객의 어떤 문제를 해결하나요?','required'=>true,'min'=>200,
        'desc'=>'고객의 **전/후 변화**를 한 문장으로 요약.',
        'ex'=>'<ol><li>“반복 서류작업을 5분 자동화 → 본업 집중”</li><li>“바쁜 직장인도 집밥처럼 건강한 한 끼 확보”</li></ol>'
      ],
      [
        'id'=>'ideal_customer','label'=>'3. 누가 이용해야 하나요? 왜 우리여야 하나요?','required'=>true,'min'=>200,
        'desc'=>'핵심 타깃의 특징 + 우리를 선택할 **결정적 이유**.',
        'ex'=>'<p>“시간/비용이 부족한 20대 대학생 → 15분 홈트 영상으로 꾸준함 확보.”</p>'
      ],
      [
        'id'=>'ask3','type'=>'group','label'=>'4. 고객에게 물어보고 싶은 3가지','required'=>true,
        'desc'=>'실제 경험 기반으로 **구체적인 질문 3개**를 작성.',
        'ex'=>'<p><strong>예)</strong> 첫인상/결심포인트/아쉬운점</p>',
        'sub'=>[
          ['id'=>'q1','label'=>'질문 1','ph'=>'예: 어떻게 알게 되었나요?','required'=>true],
          ['id'=>'q2','label'=>'질문 2','ph'=>'예: 결심 포인트는 무엇이었나요?','required'=>true],
          ['id'=>'q3','label'=>'질문 3','ph'=>'예: 가장 아쉬웠던 점은?','required'=>true],
        ]
      ],
      [
        'id'=>'competitors','label'=>'5. 경쟁사와의 차별점은?','required'=>true,'min'=>200,
        'desc'=>'주요 경쟁사 1~2곳과 비교해 강/약점 정리.',
        'ex'=>'<p>“A는 저렴하지만 CS 느림 / B는 비싸지만 품질 우수 → 우리는 적정가+빠른 CS”</p>'
      ],
    ]
  ];
}

function bwf_owner_view_url(){ return home_url('/my-question-view/'); }
function bwf_owner_edit_url(){ return home_url('/owner-edit/'); }
function bwf_owner_list_url(){ return home_url('/my-questions/'); }

function bwf_render_owner_form($args=[]){
  $cfg=bwf_owner_cfg(); $min=(int)$cfg['min']; $mode=$args['mode']??'create';
  $post=$args['post']??null; $saved=$args['saved']??[]; $errs=$args['errs']??[];
  if($mode==='edit' && $post){ $existing=(array)get_post_meta($post->ID,'bwf_answers',true); $saved=$saved ?: $existing; }
  wp_enqueue_style('bwf-forms'); wp_enqueue_script('bwos-form');

  ob_start(); ?>
  <form id="bwfOwnerForm" class="bwf-form bwos-form" method="post" action="<?php echo esc_url(admin_url('admin-post.php')); ?>" novalidate>
    <input type="hidden" name="action" value="bwf_owner_save">
    <?php wp_nonce_field('bwf_owner_save','bwf_owner_nonce'); ?>
    <input type="hidden" name="post_id" value="<?php echo $post ? (int)$post->ID : 0; ?>">

    <div class="bwos-progress"><div class="bar"><span></span></div><div class="status">작성 0/0 (0%)</div></div>

    <h2 class="bwf-title"><?php echo esc_html($cfg['title']); ?></h2>
    <p class="bwf-help"><?php echo str_replace('{MIN}', $min, $cfg['intro']); ?></p>

    <?php foreach($cfg['qs'] as $q): $type=$q['type']??'textarea'; $id=$q['id']; ?>
      <div class="bwf-field bwos-field bwos-required" data-min="<?php echo (int)($q['min']??$min); ?>">
        <label><?php echo esc_html($q['label']); ?><?php if(!empty($q['required'])): ?><span class="bwf-required">*</span><?php endif; ?></label>

        <?php if(!empty($q['desc'])): ?><div class="bwf-desc"><?php echo wp_kses_post($q['desc']); ?></div><?php endif; ?>
        <?php if(!empty($q['ex'])):   ?><div class="bwf-examples"><?php echo wp_kses_post($q['ex']); ?></div><?php endif; ?>

        <?php if($type==='group'): ?>
          <?php foreach(($q['sub']??[]) as $sub): $sid=$sub['id']; $v=$saved[$id][$sid]??''; ?>
            <div class="bwf-sub">
              <div class="bwf-help" style="margin:6px 0 6px;"><?php echo esc_html($sub['label']); ?></div>
              <textarea name="q[<?php echo esc_attr($id); ?>][<?php echo esc_attr($sid); ?>]" rows="4" placeholder="<?php echo esc_attr($sub['ph']??''); ?>"><?php echo esc_textarea($v); ?></textarea>
            </div>
          <?php endforeach; ?>
        <?php else: $v=$saved[$id]??''; ?>
          <textarea name="q[<?php echo esc_attr($id); ?>]" rows="6"><?php echo esc_textarea($v); ?></textarea>
          <small class="bwos-count">0/<?php echo (int)($q['min']??$min); ?></small>
        <?php endif; ?>
      </div>
    <?php endforeach; ?>

    <div class="bwf-actions">
      <button type="submit" class="bwf-btn bwos-submit"><?php echo $mode==='edit'?'수정 저장':'저장'; ?></button>
      <!-- 마이페이지 버튼 제거 요청 반영 -->
    </div>
  </form>
  <?php return ob_get_clean();
}

add_shortcode('bwf_owner_questions', function(){
  wp_enqueue_style('bwf-forms');

  if (!is_user_logged_in()){
    wp_enqueue_style('bwf-forms');
    $signup = esc_url('https://berrywalk.co.kr/bwf-owner-signup/');
    $login  = esc_url( wp_login_url( home_url('/owner-questions/') ) );
    return '<div class="bwos-wrap"><div class="bwf-need-login"><p>대표님 핵심 질문지를 작성하려면 로그인이 필요합니다.</p><div class="bwf-login-actions"><a class="bwf-btn" href="'.$login.'">로그인하러 가기</a><a class="bwf-btn-secondary" href="'.$signup.'">회원가입하러 가기</a></div></div></div>';
  }
  $uid=get_current_user_id();
  $old=get_transient('bwf_owner_old_'.$uid)?:[]; delete_transient('bwf_owner_old_'.$uid);
  $err=get_transient('bwf_owner_err_'.$uid)?:[]; delete_transient('bwf_owner_err_'.$uid);
  return bwf_render_owner_form(['mode'=>'create','saved'=>$old,'errs'=>$err]);
});
add_shortcode('bw_owner_form', fn()=>do_shortcode('[bwf_owner_questions]'));
add_shortcode('bw_owner_edit', function($atts){
  if (!is_user_logged_in()) return '<div class="bwf-form">로그인이 필요합니다.</div>';
  $id=(int)($atts['id']??($_GET['id']??0));
  $post=get_post($id);
  if(!$post || $post->post_type!=='bwf_owner_answer') return '<div class="bwf-form">데이터가 없습니다.</div>';
  if((int)$post->post_author!==get_current_user_id() && !current_user_can('edit_post',$id)) return '<div class="bwf-form">권한이 없습니다.</div>';
  $uid=get_current_user_id();
  $old=get_transient('bwf_owner_old_'.$uid)?:[]; delete_transient('bwf_owner_old_'.$uid);
  $err=get_transient('bwf_owner_err_'.$uid)?:[]; delete_transient('bwf_owner_err_'.$uid);
  return bwf_render_owner_form(['mode'=>'edit','post'=>$post,'saved'=>$old,'errs'=>$err]);
});

`$nl
===== FILE: berrywalk-feedback-acf\includes\save.php (7163 bytes, 203 lines) =====
`$ext
<?php
/**
 * 대표 질문지 저장 + 텔레그램 알림(디버그 포함)
 */
if (!defined('ABSPATH')) exit;

/* 혹시 남아있을지 모르는 이전 핸들러 제거 */
remove_action('admin_post_bwf_owner_save',     'bwf_owner_handle_save');
remove_action('admin_post_nopriv_bwf_owner_save','bwf_owner_handle_save');

/* 저장 엔드포인트 */
add_action('admin_post_bwf_owner_save',      'bwf_owner_save');
add_action('admin_post_nopriv_bwf_owner_save','bwf_owner_save');

function bwf_owner_save(){
  if (!is_user_logged_in()) { wp_safe_redirect(home_url('/')); exit; }
  check_admin_referer('bwf_owner_save','bwf_owner_nonce');

  $uid = get_current_user_id();

  /** 중복 제출 잠금(8초) */
  $lock_key = 'bwf_owner_lock_'.$uid;
  if (get_transient($lock_key)) { wp_safe_redirect(home_url('/my-questions/')); exit; }
  set_transient($lock_key, 1, 8);

  /** 폼 값 */
  $post_id = (int)($_POST['post_id'] ?? 0);
  $src     = (array)($_POST['q'] ?? []);

  /** 질문 정의/검증 */
  $cfg = function_exists('bwf_owner_cfg') ? bwf_owner_cfg() : ['qs'=>[], 'min'=>200];
  $min = (int)($cfg['min'] ?? 200);
  $ans = []; $err = [];

  foreach ($cfg['qs'] as $q) {
    $id   = $q['id'];
    $type = $q['type'] ?? 'textarea';
    $req  = !empty($q['required']);
    $m    = (int)($q['min'] ?? $min);

    if ($type === 'group') {
      $ans[$id] = [];
      foreach (($q['sub'] ?? []) as $sub) {
        $sid = $sub['id'];
        $v   = trim((string)($src[$id][$sid] ?? ''));
        $ans[$id][$sid] = sanitize_textarea_field($v);
        if (!empty($sub['required']) && $v==='') { $err[$id][$sid] = true; }
      }
    } else {
      $v = trim((string)($src[$id] ?? ''));
      $ans[$id] = sanitize_textarea_field($v);
      if ($req && mb_strlen($v) < $m) { $err[$id] = true; }
    }
  }

  /** 검증 실패 → 폼으로 되돌리기 */
  if (!empty($err)) {
    set_transient('bwf_owner_old_'.$uid, $src, 60);
    set_transient('bwf_owner_err_'.$uid, $err, 60);
    delete_transient($lock_key);
    wp_safe_redirect(wp_get_referer() ?: home_url('/owner-questions/'));
    exit;
  }

  /** 제목 규칙: "회사명 - #N 피드백" (새로 만들 때만 계산) */
  $company = trim((string)get_user_meta($uid,'bw_company_name',true));
  if ($company==='') $company = wp_get_current_user()->display_name;

  $is_new = ($post_id === 0);
  if ($is_new) {
    $count = (int) (new WP_Query([
      'post_type'      => 'bwf_owner_answer',
      'post_status'    => 'any',
      'author'         => $uid,
      'fields'         => 'ids',
      'posts_per_page' => -1
    ]))->found_posts;
    $seq   = $count + 1;
    $title = sprintf('%s - #%d 피드백', $company, $seq);
  } else {
    $title = get_post_field('post_title', $post_id);
  }

  /** 저장/수정 */
  $postarr = [
    'post_type'   => 'bwf_owner_answer',
    'post_status' => 'private',
    'post_title'  => $title,
    'post_author' => $uid,
  ];
  if ($post_id) { $postarr['ID'] = $post_id; $pid = wp_update_post($postarr, true); }
  else          { $pid = wp_insert_post($postarr, true); }

  if (is_wp_error($pid)) { delete_transient($lock_key); wp_die($pid); }

  update_post_meta($pid, 'bwf_answers', $ans);

  // 번호 캐시(목록 보정용)
  if ($is_new && preg_match('~#(\d+)~', $title, $m)) {
    update_post_meta($pid, '_bw_seq_cache', (int)$m[1]);
  }

  /** 텔레그램 알림 */
  bwf_send_telegram_notice($pid, $uid, $is_new);

  delete_transient($lock_key);
  wp_safe_redirect( add_query_arg(['id'=>$pid], home_url('/my-question-view/')) );
  exit;
}


/* ===================== 텔레그램 전송 + 디버그 ===================== */
/**
 * 상수(둘 중 아무 세트나 사용 가능):
 *   define('BWF_TG_BOT',  '123456789:BOT_TOKEN');
 *   define('BWF_TG_CHAT', '@your_channel_or_-100xxxxxxxxxx');
 *  또는
 *   define('BW_TG_BOT_TOKEN', '123456789:BOT_TOKEN');
 *   define('BW_TG_CHAT_ID',   '@your_channel_or_-100xxxxxxxxxx');
 */

function bwf__tg_conf(){
  $bot  = defined('BWF_TG_BOT')       ? BWF_TG_BOT
        : (defined('BW_TG_BOT_TOKEN') ? BW_TG_BOT_TOKEN : '');
  $chat = defined('BWF_TG_CHAT')      ? BWF_TG_CHAT
        : (defined('BW_TG_CHAT_ID')   ? BW_TG_CHAT_ID   : '');
  return [$bot, $chat];
}
function bwf__tg_log($data){
  set_transient('bwf_tg_debug', $data, 120);
  error_log('[BWF_TG] '.print_r($data, true));
}

/** 전송 */
function bwf_send_telegram_notice($post_id, $user_id, $is_new){
  list($BOT, $CHAT_RAW) = bwf__tg_conf();
  if (!$BOT || !$CHAT_RAW) { bwf__tg_log(['stage'=>'skip','reason'=>'missing_bot_or_chat']); return; }

  // chat_id 정규화
  $chat = trim($CHAT_RAW);
  if (preg_match('~t\.me/([A-Za-z0-9_]+)$~i', $chat, $m)) $chat = '@'.$m[1];
  if ($chat !== '' && $chat[0] !== '@' && $chat[0] !== '-' && !preg_match('~^-?\d+$~', $chat)) $chat = '@'.$chat;
  if (preg_match('~bot$~i', $chat)) { bwf__tg_log(['stage'=>'abort','reason'=>'chat_is_bot_username','chat'=>$chat]); return; }

  $u       = get_userdata($user_id);
  $company = get_user_meta($user_id,'bw_company_name',true);
  $phone   = get_user_meta($user_id,'bw_phone',true);
  $title   = $post_id ? get_post_field('post_title', $post_id) : '테스트';
  $url     = $post_id ? add_query_arg(['id'=>$post_id], home_url('/my-question-view/')) : home_url('/');
  $verb    = $is_new ? '새 피드백 작성' : '피드백 수정';

  $lines = [
    "✅ {$verb}",
    "제목: {$title}",
    "대표: {$u->display_name} (@{$u->user_login})",
    "회사: " . ($company ?: '—'),
    "연락처: " . ($phone ?: '—'),
    "보기: {$url}",
  ];
  $text = implode("\n", $lines);

  $endpoint = 'https://api.telegram.org/bot'.$BOT.'/sendMessage';
  $args = [
    'timeout' => 15,
    'headers' => ['Accept'=>'application/json'],
    'body'    => [
      'chat_id'                 => $chat,
      'text'                    => $text,
      'parse_mode'              => 'HTML',
      'disable_web_page_preview'=> true,
    ]
  ];

  $res = wp_remote_post($endpoint, $args);

  if (is_wp_error($res)) {
    bwf__tg_log(['stage'=>'request','ok'=>false,'error'=>$res->get_error_message(),'chat'=>$chat]);
  } else {
    $code = wp_remote_retrieve_response_code($res);
    $body = wp_remote_retrieve_body($res);
    $json = json_decode($body, true);
    bwf__tg_log(['stage'=>'request','ok'=>($code===200 && !empty($json['ok'])),'code'=>$code,'chat'=>$chat,'body'=>$body]);
  }
}

/** 관리자에게 1회성 디버그 알림 */
add_action('admin_notices', function(){
  if (!current_user_can('manage_options')) return;
  $d = get_transient('bwf_tg_debug'); if(!$d) return;
  delete_transient('bwf_tg_debug');
  echo '<div class="notice notice-info"><p><strong>텔레그램 전송 디버그</strong></p><pre style="white-space:pre-wrap">';
  echo esc_html(print_r($d, true));
  echo '</pre></div>';
});

/** 전송 테스트: /wp-admin/?bw_tg_test=1 */
add_action('admin_init', function(){
  if (current_user_can('manage_options') && isset($_GET['bw_tg_test'])) {
    bwf_send_telegram_notice(0, get_current_user_id(), true);
    wp_die('텔레그램 테스트 전송 시도 완료 — 관리자 알림 또는 PHP error_log에서 결과 확인');
  }
});

`$nl
===== FILE: berrywalk-feedback-acf\includes\signup.php (14434 bytes, 263 lines) =====
`$ext
<?php
if (!defined('ABSPATH')) exit;

/* 역할 보장 */
add_action('init', function(){
  if (!get_role('bw_owner')) add_role('bw_owner','대표',['read'=>true]);
});

/* --- 관리자 사용자 목록 컬럼 + 프로필 편집 영역 --- */
add_filter('manage_users_columns', function($cols){
  $cols['bw_owner_meta'] = '대표 인적사항';
  return $cols;
});
add_filter('manage_users_custom_column', function($out, $col, $user_id){
  if ($col !== 'bw_owner_meta') return $out;
  $u = get_userdata($user_id);
  $pairs = [
    '회사'     => get_user_meta($user_id,'bw_company_name',true),
    '업종'     => get_user_meta($user_id,'bw_industry',true),
    '직원 수'  => get_user_meta($user_id,'bw_employees',true),
    '휴대폰'   => get_user_meta($user_id,'bw_phone',true),
    '연락시간' => get_user_meta($user_id,'bw_contact_window',true),
    '유입경로' => get_user_meta($user_id,'bw_discover',true),
    '웹사이트' => $u ? $u->user_url : '',
  ];
  $html  = '<div style="line-height:1.5">';
  foreach($pairs as $k=>$v){
    $val = ($v === '' ? '—' : $v);
    $html .= '<div><strong>'.$k.'</strong> '.$val.'</div>';
  }
  $html .= '</div>';
  return $html;
}, 10, 3);

/* 프로필 편집 폼 */
add_action('show_user_profile','bwf_owner_profile_fields');
add_action('edit_user_profile','bwf_owner_profile_fields');
function bwf_owner_profile_fields($user){
  ?>
  <h2>대표 인적사항</h2>
  <table class="form-table" role="presentation">
    <tr><th><label>회사명</label></th><td><input type="text" name="bw_company_name" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_company_name',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>업종</label></th><td><input type="text" name="bw_industry" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_industry',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>직원 수</label></th><td><input type="number" name="bw_employees" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_employees',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>휴대폰</label></th><td><input type="text" name="bw_phone" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_phone',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>연락 가능한 시간대</label></th><td><input type="text" name="bw_contact_window" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_contact_window',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>알게 된 경로</label></th><td><input type="text" name="bw_discover" value="<?php echo esc_attr(get_user_meta($user->ID,'bw_discover',true)); ?>" class="regular-text"></td></tr>
    <tr><th><label>웹사이트 URL</label></th><td><input type="url" name="user_url_bwf" value="<?php echo esc_attr(get_userdata($user->ID)->user_url); ?>" class="regular-text" placeholder="https://"></td></tr>
  </table>
  <?php
}
add_action('personal_options_update','bwf_owner_profile_save');
add_action('edit_user_profile_update','bwf_owner_profile_save');
function bwf_owner_profile_save($user_id){
  foreach(['bw_company_name','bw_industry','bw_employees','bw_phone','bw_contact_window','bw_discover'] as $k){
    if(isset($_POST[$k])) update_user_meta($user_id,$k, sanitize_text_field($_POST[$k]));
  }
  if(isset($_POST['user_url_bwf'])){
    wp_update_user(['ID'=>$user_id,'user_url'=>esc_url_raw($_POST['user_url_bwf'])]);
  }
}

/* --- 대표 회원가입 폼 --- */
add_shortcode('bwf_signup_representative', function () {
  wp_enqueue_style('bwf-forms');

  // 에러/이전값 표시
  $err = get_transient('bwf_signup_err'); delete_transient('bwf_signup_err');
  $old = get_transient('bwf_signup_old'); delete_transient('bwf_signup_old');

  if (is_user_logged_in()) {
    return '<div class="bwos-wrap" style="margin-top:40px;margin-bottom:24px">
      <p style="margin:0 0 18px;font-weight:700">로그인되었습니다.</p>
      <div class="bwf-actions" style="margin-top:0">
        <a class="bwf-btn" href="'.esc_url(home_url('/owner-questions/')).'">질문 등록하기</a>
        <a class="bwf-btn-secondary" href="'.esc_url(home_url('/my-questions/')).'">내 질문 목록 보기</a>
      </div>
    </div>';
  }

  ob_start(); ?>
  <form method="post" class="bwf-form bwf-grid" id="bwf-signup-rep" action="<?php echo esc_url(admin_url('admin-post.php')); ?>" novalidate>
    <input type="hidden" name="action" value="bwf_signup_rep">
    <?php wp_nonce_field('bwf_signup_rep','bwf_nonce'); ?>

    <h2 class="bwf-title bwf-col-full" style="margin-top:8px;margin-bottom:10px">대표 회원가입</h2>
    <?php if($err): ?>
      <div class="bwf-card bwf-col-full" style="border-color:#fecaca;background:#fff1f2;color:#7f1d1d;margin-bottom:10px"><?php echo esc_html($err); ?></div>
    <?php endif; ?>
    <p class="bwf-required-note bwf-col-full" style="margin-top:0;margin-bottom:14px">* 표시는 필수 입력</p>

    <div><label style="margin-bottom:14px">아이디 *</label><input type="text" name="user_login" value="<?php echo esc_attr($old['user_login']??''); ?>" pattern="[A-Za-z0-9_\.\-]{4,32}" required></div>
    <div><label style="margin-bottom:14px">비밀번호 *</label><input type="password" name="user_pass" required></div>
    <div><label style="margin-bottom:14px">이메일 *</label><input type="email" name="user_email" value="<?php echo esc_attr($old['user_email']??''); ?>" required></div>
    <div><label style="margin-bottom:14px">이름 *</label><input type="text" name="first_name" value="<?php echo esc_attr($old['first_name']??''); ?>" required></div>

    <div><label style="margin-bottom:14px">회사명 *</label><input type="text" name="bw_company_name" value="<?php echo esc_attr($old['bw_company_name']??''); ?>" required></div>
    <div><label style="margin-bottom:14px">업종 *</label>
      <select name="bw_industry" required>
        <?php $sel = $old['bw_industry']??''; ?>
        <option value="">선택</option>
        <option value="IT/서비스" <?php selected($sel,'IT/서비스'); ?>>IT/서비스</option>
        <option value="커머스" <?php selected($sel,'커머스'); ?>>커머스</option>
        <option value="기타" <?php selected($sel,'기타'); ?>>기타</option>
      </select>
    </div>
    <div><label style="margin-bottom:14px">직원 수 *</label><input type="number" name="bw_employees" value="<?php echo esc_attr($old['bw_employees']??''); ?>" min="1" required></div>
    <div><label style="margin-bottom:14px">홈페이지 URL</label><input type="url" name="user_url" value="<?php echo esc_attr($old['user_url']??''); ?>" placeholder="https://"></div>

    <div class="bwf-col-full">
      <label style="margin-bottom:14px">알게 된 경로 *</label>
      <?php $srcSel = $old['bw_discover']??''; ?>
      <select name="bw_discover" id="bwf-source" required>
        <option value="">선택</option><option value="검색" <?php selected($srcSel,'검색'); ?>>검색</option><option value="SNS" <?php selected($srcSel,'SNS'); ?>>SNS</option><option value="지인추천" <?php selected($srcSel,'지인추천'); ?>>지인추천</option><option value="기타" <?php selected($srcSel,'기타'); ?>>기타</option>
      </select>
      <input type="text" name="source_etc" id="bwf-source-etc" placeholder="기타 경로" class="bwf-col-full <?php echo ($srcSel==='기타'?'':'bwf-hidden'); ?>" style="margin-top:8px" value="<?php echo esc_attr($old['source_etc']??''); ?>">
    </div>

    <div><label style="margin-bottom:14px">휴대폰 번호 *</label>
      <input type="tel" name="bw_phone" id="bwf-phone" inputmode="numeric" placeholder="010-1234-5678" maxlength="13" value="<?php echo esc_attr($old['bw_phone']??''); ?>" required>
    </div>
    <div><label style="margin-bottom:14px">연락 가능한 시간대 *</label><input type="text" name="bw_contact_window" value="<?php echo esc_attr($old['bw_contact_window']??''); ?>" placeholder="예: 평일 13:00~18:00" required></div>

    <div class="bwf-actions bwf-col-full" style="margin-top:18px">
      <button type="submit" name="bwf_register" class="bwf-btn">회원가입</button>
      <span id="bwf-hint" style="font-size:13px;color:#475569"></span>
    </div>

    <script>
    (function(){
      const f=document.getElementById('bwf-signup-rep'),
            src=f.querySelector('#bwf-source'),
            etc=f.querySelector('#bwf-source-etc'),
            tel=f.querySelector('#bwf-phone'),
            hint=document.getElementById('bwf-hint');

      function showEtc(){ if(src.value==='기타'){ etc.classList.remove('bwf-hidden'); } else { etc.classList.add('bwf-hidden'); etc.value=''; } }
      src.addEventListener('change',showEtc); showEtc();

      const dig=s=>String(s||'').replace(/\D/g,'');
      function fmt(raw){ const d=dig(raw).slice(0,11); if(d.length<=3) return d; if(d.length<=7) return d.replace(/^(\d{3})(\d{0,4})$/,'$1-$2'); return d.replace(/^(\d{3})(\d{4})(\d{0,4}).*$/,'$1-$2-$3'); }
      function norm(){ tel.value=fmt(tel.value); try{ tel.setSelectionRange(tel.value.length,tel.value.length);}catch(e){} }
      ['input','keyup','change','paste','blur','focus'].forEach(ev=> tel.addEventListener(ev,norm)); norm();

      f.addEventListener('submit',function(ev){
        norm();
        // 필수항목 검증
        const must=[...f.querySelectorAll('[required]')]; let ok=true; let first=null;
        must.forEach(el=>{
          el.classList.remove('bwf-invalid'); el.setCustomValidity('');
          if(el===tel && !/^010-\d{3,4}-\d{4}$/.test(tel.value)){ el.setCustomValidity('휴대폰 번호는 010-1234-5678 형식'); }
          if(el.name==='bw_discover' && src.value==='기타' && (etc.value||'').trim()===''){ el.setCustomValidity('기타 경로를 입력해 주세요'); }
          if(!el.checkValidity()){ ok=false; if(!first) first=el; el.classList.add('bwf-invalid'); }
        });
        if(!ok){ ev.preventDefault(); hint.textContent='입력이 필요한 항목이 있어요.'; hint.style.color='#ef4444'; first.scrollIntoView({behavior:'smooth',block:'center'}); }
        else   { hint.textContent='제출 중입니다…'; hint.style.color='#475569'; }
      });
    })();
    </script>
  </form>
  <?php
  return ob_get_clean();
});

/* 제출 처리 */
add_action('admin_post_nopriv_bwf_signup_rep','bwf_handle_signup_rep');
function bwf_handle_signup_rep(){
  $old = $_POST; unset($old['action'],$old['bwf_nonce'],$old['user_pass']);
  set_transient('bwf_signup_old',$old,60);

  $nonce = sanitize_text_field($_POST['bwf_nonce'] ?? '');
  if (!wp_verify_nonce($nonce,'bwf_signup_rep')) { set_transient('bwf_signup_err','유효하지 않은 요청입니다.',60); wp_safe_redirect(wp_get_referer()?:home_url('/')); exit; }

  $user_login=sanitize_user($_POST['user_login']??'');
  $user_email=sanitize_email($_POST['user_email']??'');
  $user_pass =$_POST['user_pass']??'';
  $first_name=sanitize_text_field($_POST['first_name']??'');

  if (!$user_login||!$user_email||!$user_pass||!$first_name){ set_transient('bwf_signup_err','필수 항목이 누락되었습니다.',60); wp_safe_redirect(wp_get_referer()?:home_url('/')); exit; }

  $uid = wp_insert_user([
    'user_login'=>$user_login,'user_email'=>$user_email,'user_pass'=>$user_pass,
    'first_name'=>$first_name,'role'=>'bw_owner','user_url'=>esc_url_raw($_POST['user_url']??'')
  ]);

  if (is_wp_error($uid)) {
    set_transient('bwf_signup_err', $uid->get_error_message(), 60);
    wp_safe_redirect(wp_get_referer()?:home_url('/')); exit;
  }

  foreach(['bw_company_name','bw_industry','bw_employees','bw_contact_window','bw_discover','bw_phone'] as $k){
    if(isset($_POST[$k])) update_user_meta($uid,$k,sanitize_text_field($_POST[$k]));
  }
  if (($_POST['bw_discover']??'')==='기타' && !empty($_POST['source_etc'])) {
    update_user_meta($uid,'bw_discover','etc: '.sanitize_text_field($_POST['source_etc']));
  }

  delete_transient('bwf_signup_old');

  wp_set_current_user($uid); wp_set_auth_cookie($uid);
  wp_safe_redirect(home_url('/owner-questions/')); exit;
}


/* ===== 관리자 > 대표 질문지( CPT ) 목록 컬럼/제목 ===== */
add_filter('manage_edit-bwf_owner_answer_columns', function($cols){
  $new = [];
  $new['cb']      = $cols['cb'];
  $new['title']   = '제목';
  $new['author']  = '작성자';
  $new['company'] = '회사명';
  $new['website'] = '웹사이트';
  $new['date']    = '저장 시각';
  return $new;
});
add_action('manage_bwf_owner_answer_posts_custom_column', function($col, $post_id){
  if($col==='company'){
    $author = (int)get_post_field('post_author',$post_id);
    echo esc_html( get_user_meta($author,'bw_company_name',true) ?: '—' );
  } elseif($col==='website'){
    $author = (int)get_post_field('post_author',$post_id);
    $url = get_userdata($author)->user_url;
    echo $url ? '<a href="'.esc_url($url).'" target="_blank" rel="noopener">열기</a>' : '—';
  }
},10,2);

/* 관리자 목록에서 예전 글도 보기 좋은 제목으로 표시 */
add_filter('the_title', function($title, $post_id){
  if (!is_admin()) return $title;
  $p = get_post($post_id);
  if(!$p || $p->post_type!=='bwf_owner_answer') return $title;

  // 이미 새 규칙이면 그대로
  if (strpos($title,'#')!==false && strpos($title,'피드백')!==false) return $title;

  $author  = (int)$p->post_author;
  $company = get_user_meta($author,'bw_company_name',true);
  if($company==='') $company = get_userdata($author)->display_name;

  // 사용자 기준 순번 계산 (오래된 순서)
  $ids = get_posts(['post_type'=>'bwf_owner_answer','author'=>$author,'post_status'=>'any','fields'=>'ids','numberposts'=>-1,'orderby'=>'date','order'=>'ASC']);
  $pos = array_search($post_id, $ids, true);
  $idx = ($pos===false? count($ids): $pos) + 1;

  return sprintf('%s - #%d 피드백', $company, $idx);
},10,2);

// ① 우리 대표 가입 폼으로 제출이면, 그 요청에 한해 '새 사용자 기본역할'을 bw_owner로 임시 변경
add_filter('pre_option_default_role', function($default){
  if (!empty($_POST['bwf_role']) && $_POST['bwf_role'] === 'bw_owner') {
    return 'bw_owner';
  }
  return $default;
});

// ② 어떤 경로로 가입되었든, 우리 폼 마커가 있으면 최종적으로 bw_owner로 강제
add_action('user_register', function($user_id){
  if (!empty($_POST['bwf_role']) && $_POST['bwf_role'] === 'bw_owner') {
    $u = new WP_User($user_id);
    $u->set_role('bw_owner');
  }
}, 10);

`$nl
===== FILE: berrywalk-feedback-acf\includes\view-list.php (7622 bytes, 186 lines) =====
`$ext
<?php
/* /includes/view-list.php — 단건 보기 + 마이페이지 목록 */
if (!defined('ABSPATH')) exit;

/* 공통 URL 헬퍼 (중복 선언 방지) */
if (!function_exists('bwf_owner_view_url')) { function bwf_owner_view_url(){ return home_url('/my-question-view/'); } }
if (!function_exists('bwf_owner_edit_url')) { function bwf_owner_edit_url(){ return home_url('/owner-edit/'); } }
if (!function_exists('bwf_owner_list_url')) { function bwf_owner_list_url(){ return home_url('/my-questions/'); } }

/** 단건 보기: [bw_owner_view] / [bwf_owner_view] */
function bwos_render_single_view($atts){
  if (!is_user_logged_in()) return '<div class="bwf-form">로그인이 필요합니다.</div>';

  $id = (int)($atts['id'] ?? ($_GET['id'] ?? 0));
  $p  = get_post($id);
  if(!$p || $p->post_type !== 'bwf_owner_answer') return '<div class="bwf-form">데이터가 없습니다.</div>';
  if((int)$p->post_author !== get_current_user_id() && !current_user_can('read_post', $id)) return '<div class="bwf-form">권한이 없습니다.</div>';

  wp_enqueue_style('bwf-forms');

  // 질문 정의 & 답변
  $cfg = function_exists('bwf_owner_cfg') ? bwf_owner_cfg() : ['title'=>'대표 질문지','qs'=>[]];
  $ans = (array)get_post_meta($id, 'bwf_answers', true);

  // 작성자 메타(요청에 따라 최소 표시만)
  $au   = get_userdata($p->post_author);
  $meta = [
    '회사명'   => get_user_meta($p->post_author,'bw_company_name',true),
    '웹사이트' => $au && $au->user_url ? $au->user_url : '',
    '연락시간' => get_user_meta($p->post_author,'bw_contact_window',true),
    '휴대폰'   => get_user_meta($p->post_author,'bw_phone',true),
  ];

  ob_start(); ?>
  <div class="bwos-wrap">
    <h2 class="bwf-title"><?php echo esc_html($cfg['title']); ?></h2>

    <div class="bwf-card" style="margin-bottom:16px">
      <strong>작성 정보</strong>
      <div style="display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:6px 14px;margin-top:8px">
        <?php foreach($meta as $k=>$v): ?>
          <div>
            <span style="color:#64748b"><?php echo esc_html($k); ?></span> :
            <?php
              if ($k==='웹사이트' && $v) {
                echo '<a href="'.esc_url($v).'" target="_blank" rel="noopener">'.esc_html($v).'</a>';
              } else {
                echo $v ? esc_html($v) : '—';
              }
            ?>
          </div>
        <?php endforeach; ?>
      </div>
    </div>

    <?php foreach(($cfg['qs'] ?? []) as $q):
      $qid = $q['id'] ?? '';
      if(!$qid) continue; ?>
      <div class="bwf-field">
        <label><?php echo esc_html($q['label']); ?></label>
        <?php if(($q['type'] ?? '') === 'group'): ?>
          <?php foreach(($q['sub'] ?? []) as $sub):
            $sid = $sub['id']; $v = trim((string)($ans[$qid][$sid] ?? '')); ?>
            <div class="bwf-sub">
              <div class="bwf-help"><?php echo esc_html($sub['label']); ?></div>
              <div class="bwf-card"><?php echo nl2br(esc_html($v)); ?></div>
            </div>
          <?php endforeach; ?>
        <?php else:
          $v = trim((string)($ans[$qid] ?? '')); ?>
          <div class="bwf-card"><?php echo nl2br(esc_html($v)); ?></div>
        <?php endif; ?>
      </div>
    <?php endforeach; ?>

    <div class="bwf-actions" style="justify-content:center">
      <a class="bwf-btn" href="<?php echo esc_url(add_query_arg(['id'=>$p->ID], bwf_owner_edit_url())); ?>">수정</a>
      <a class="bwf-btn-secondary" href="<?php echo esc_url(bwf_owner_list_url()); ?>">목록</a>
    </div>
  </div>
  <?php
  return ob_get_clean();
}
add_shortcode('bw_owner_view','bwos_render_single_view');
add_shortcode('bwf_owner_view','bwos_render_single_view'); // alias

/** 마이페이지 목록: [bw_owner_list] / [bw_my_questions] */
add_shortcode('bw_owner_list', function($atts){
  if (!is_user_logged_in()) return '<div class="bwf-form">로그인이 필요합니다.</div>';

  $paged = max(1, (int)get_query_var('paged', 0));
  if(!$paged) $paged = max(1, (int)($_GET['pg'] ?? 1));

  $q = new WP_Query([
    'post_type'      => 'bwf_owner_answer',
    'post_status'    => 'private',
    'author'         => get_current_user_id(),
    'posts_per_page' => 8,
    'orderby'        => 'date',
    'order'          => 'DESC',
    'paged'          => $paged,
    'fields'         => 'ids'
  ]);

  wp_enqueue_style('bwf-forms');

  // 사용자 회사명
  $uid     = get_current_user_id();
  $company = trim((string)get_user_meta($uid,'bw_company_name',true));
  if($company==='') $company = wp_get_current_user()->display_name;

  ob_start(); ?>
  <div class="bwos-wrap">
    <h2 class="bwf-title" style="margin-bottom:16px">마이페이지</h2>

    <div class="bwf-actions" style="justify-content:flex-start;margin:0 0 14px">
      <a class="bwf-btn" href="<?php echo esc_url(home_url('/owner-questions/')); ?>">새 피드백 질문하기</a>
    </div>

    <div class="bwos-list">
      <?php
      if ($q->have_posts()):
        foreach ($q->posts as $pid):
          // 제목은 저장된 raw post_title 사용(‘비공개:’ 접두 회피)
          $raw_title = get_post_field('post_title', $pid);

          // 혹시 과거 글(구 규칙)이라면 회사명 - #N 피드백으로 보정
          if (strpos($raw_title,'#') === false || strpos($raw_title,'피드백') === false) {
            // 최신글부터 역순이지만, 사용자는 번호만 구분하면 되므로 글ID 끝 3자리 정도를 보조로 표기할 수도 있음
            // 여기서는 간단히 저장 시각 기준 시퀀스를 표시
            $seq = (int) get_post_meta($pid, '_bw_seq_cache', true);
            if ($seq <= 0) {
              // 없으면 임시 계산: 내 글 전부에서 현재 PID의 역순 인덱스
              $all = new WP_Query([
                'post_type'=>'bwf_owner_answer','post_status'=>'any','author'=>$uid,
                'orderby'=>'date','order'=>'ASC','fields'=>'ids','posts_per_page'=>-1
              ]);
              $seq = 0;
              foreach ($all->posts as $i=>$id) { if ($id == $pid) { $seq = $i+1; break; } }
            }
            $display = sprintf('%s - #%d 피드백', $company, max(1,$seq));
          } else {
            $display = $raw_title;
          }

          $when = get_the_date('Y-m-d H:i', $pid);
          $view = esc_url(add_query_arg(['id'=>$pid], bwf_owner_view_url()));
          $edit = esc_url(add_query_arg(['id'=>$pid], bwf_owner_edit_url()));
      ?>
        <div class="bwos-card">
          <h4><?php echo esc_html($display); ?></h4>
          <div class="meta"><?php echo esc_html($when); ?></div>
          <div class="row">
            <a href="<?php echo $view; ?>">보기</a>
            <a href="<?php echo $edit; ?>">수정</a>
          </div>
        </div>
      <?php
        endforeach;
      else: ?>
        <p>작성한 내역이 없습니다. <a href="<?php echo esc_url(home_url('/owner-questions/')); ?>">새 피드백 질문하기</a>로 첫 저장본을 만들어 보세요.</p>
      <?php endif; ?>
    </div>

    <?php
    $links = paginate_links([
      'total'     => max(1,(int)$q->max_num_pages),
      'current'   => $paged,
      'type'      => 'array',
      'mid_size'  => 2,
      'prev_text' => '이전',
      'next_text' => '다음'
    ]);
    if ($links) {
      echo '<div class="bwos-pg">';
      foreach($links as $l) echo $l.' ';
      echo '</div>';
    }
    wp_reset_postdata();
    ?>
  </div>
  <?php
  return ob_get_clean();
});
add_shortcode('bw_my_questions', fn($a)=>do_shortcode('[bw_owner_list]'));

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\composer.json (719 bytes, 24 lines) =====
`$ext
{
	"name": "yahnis-elsts/plugin-update-checker",
	"type": "library",
	"description": "A custom update checker for WordPress plugins and themes. Useful if you can't host your plugin in the official WP repository but still want it to support automatic updates.",
	"keywords": ["wordpress", "plugin updates", "automatic updates", "theme updates"],
	"homepage": "https://github.com/YahnisElsts/plugin-update-checker/",
	"license": "MIT",
	"authors": [
		{
			"name": "Yahnis Elsts",
			"email": "whiteshadow@w-shadow.com",
			"homepage": "https://w-shadow.com/",
			"role": "Developer"
		}
	],
	"require": {
		"php": ">=5.6.20",
		"ext-json": "*"
	},
	"autoload": {
		"files": ["load-v5p6.php"]
	}
}

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\license.txt (1063 bytes, 8 lines) =====
`$ext
Copyright (c) 2023 Jānis Elsts

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\load-v5p6.php (1182 bytes, 35 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6;

use YahnisElsts\PluginUpdateChecker\v5\PucFactory as MajorFactory;
use YahnisElsts\PluginUpdateChecker\v5p6\PucFactory as MinorFactory;

require __DIR__ . '/Puc/v5p6/Autoloader.php';
new Autoloader();

require __DIR__ . '/Puc/v5p6/PucFactory.php';
require __DIR__ . '/Puc/v5/PucFactory.php';

//Register classes defined in this version with the factory.
foreach (
	array(
		'Plugin\\UpdateChecker' => Plugin\UpdateChecker::class,
		'Theme\\UpdateChecker'  => Theme\UpdateChecker::class,

		'Vcs\\PluginUpdateChecker' => Vcs\PluginUpdateChecker::class,
		'Vcs\\ThemeUpdateChecker'  => Vcs\ThemeUpdateChecker::class,

		'GitHubApi'    => Vcs\GitHubApi::class,
		'BitBucketApi' => Vcs\BitBucketApi::class,
		'GitLabApi'    => Vcs\GitLabApi::class,
	)
	as $pucGeneralClass => $pucVersionedClass
) {
	MajorFactory::addVersion($pucGeneralClass, $pucVersionedClass, '5.6');
	//Also add it to the minor-version factory in case the major-version factory
	//was already defined by another, older version of the update checker.
	MinorFactory::addVersion($pucGeneralClass, $pucVersionedClass, '5.6');
}


`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\plugin-update-checker.php (227 bytes, 10 lines) =====
`$ext
<?php
/**
 * Plugin Update Checker Library 5.6
 * http://w-shadow.com/
 *
 * Copyright 2025 Janis Elsts
 * Released under the MIT license. See license.txt for details.
 */

require dirname(__FILE__) . '/load-v5p6.php';
`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\README.md (21190 bytes, 373 lines) =====
`$ext
Plugin Update Checker
=====================

This is a custom update checker library for WordPress plugins and themes. It lets you add automatic update notifications and one-click upgrades to your commercial plugins, private themes, and so on. All you need to do is put your plugin/theme details in a JSON file, place the file on your server, and pass the URL to the library. The library periodically checks the URL to see if there's a new version available and displays an update notification to the user if necessary.

From the users' perspective, it works just like with plugins and themes hosted on WordPress.org. The update checker uses the default upgrade UI that is familiar to most WordPress users.

<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->
**Table of Contents**

- [Getting Started](#getting-started)
  - [Self-hosted Plugins and Themes](#self-hosted-plugins-and-themes)
    - [How to Release an Update](#how-to-release-an-update)
    - [Notes](#notes)
  - [GitHub Integration](#github-integration)
    - [How to Release an Update](#how-to-release-an-update-1)
    - [Notes](#notes-1)
  - [BitBucket Integration](#bitbucket-integration)
    - [How to Release an Update](#how-to-release-an-update-2)
  - [GitLab Integration](#gitlab-integration)
    - [How to Release a GitLab Update](#how-to-release-a-gitlab-update)
- [Migrating from 4.x](#migrating-from-4x)
- [License Management](#license-management)
- [Resources](#resources)

<!-- END doctoc generated TOC please keep comment here to allow auto update -->

Getting Started
---------------

*Note:* In each of the below examples, part of the instructions is to create an instance of the update checker class. It's recommended to do this either during the `plugins_loaded` action or outside of any hooks. If you do it only during an `admin_*` action, then updates will not be visible to a wide variety of WordPress management tools; they will only be visible to logged-in users on dashboard pages.

### Self-hosted Plugins and Themes

1. Download [the latest release](https://github.com/YahnisElsts/plugin-update-checker/releases/latest) and copy the `plugin-update-checker` directory to your plugin or theme.
2. Go to the `examples` subdirectory and open the .json file that fits your project type. Replace the placeholder data with your plugin/theme details. 
	- Plugin example:
	
		```json
		{
			"name" : "Plugin Name",
			"version" : "2.0",
			"download_url" : "https://example.com/plugin-name-2.0.zip",
			"sections" : {
				"description" : "Plugin description here. You can use HTML."
			}
		}
		```
		
        This is a minimal example that leaves out optional fields. See [this table](https://docs.google.com/spreadsheets/d/1eOBbW7Go2qEQXReOOCdidMTf_tDYRq4JfegcO1CBPIs/edit?usp=sharing) for a full list of supported fields and their descriptions.
	- Theme example:
	
		```json
		{
			"version": "2.0",
			"details_url": "https://example.com/version-2.0-details.html",
			"download_url": "https://example.com/example-theme-2.0.zip"
		}
		```
		
		This is actually a complete example that shows all theme-related fields. `version` and `download_url` should be self-explanatory. The `details_url` key specifies the page that the user will see if they click the "View version 1.2.3 details" link in an update notification.  
3. Upload the JSON file to a publicly accessible location.
4. Add the following code to the main plugin file or to the `functions.php` file:

	```php
	require 'path/to/plugin-update-checker/plugin-update-checker.php';
	use YahnisElsts\PluginUpdateChecker\v5\PucFactory;
 
	$myUpdateChecker = PucFactory::buildUpdateChecker(
		'https://example.com/path/to/details.json',
		__FILE__, //Full path to the main plugin file or functions.php.
		'unique-plugin-or-theme-slug'
	);
	```
	Note: If you're using the Composer autoloader, you don't need to explicitly `require` the library.

#### How to Release an Update

Change the `version` number in the JSON file and make sure that `download_url` points to the latest version. Update the other fields if necessary. Tip: You can use [wp-update-server](https://github.com/YahnisElsts/wp-update-server) to automate this process.

By default, the library will check the specified URL for changes every 12 hours. You can force it to check immediately by clicking the "Check for updates" link on the "Plugins" page (it's next to the "Visit plugin site" link). Themes don't have that link, but you can also trigger an update check like this:
 
 1. Install [Debug Bar](https://srd.wordpress.org/plugins/debug-bar/).
 2. Click the "Debug" menu in the Admin Bar (a.k.a Toolbar).
 3. Open the "PUC (your-slug)" panel. 
 4. Click the "Check Now" button.  

#### Notes
- The second argument passed to `buildUpdateChecker` must be the absolute path to the main plugin file or any file in the theme directory. If you followed the "getting started" instructions, you can just use the `__FILE__` constant.
- The third argument - i.e. the slug - is optional but recommended. In most cases, the slug should be the same as the name of your plugin directory. For example, if your plugin lives in `/wp-content/plugins/my-plugin`, set the slug to `my-plugin`. If the slug is omitted, the update checker will use the name of the main plugin file as the slug (e.g. `my-cool-plugin.php` &rarr; `my-cool-plugin`). This can lead to conflicts if your plugin has a generic file name like `plugin.php`. 
	
	This doesn't affect themes because PUC uses the theme directory name as the default slug. Still, if you're planning to use the slug in your own code - e.g. to filter updates or override update checker behaviour - it can be a good idea to set it explicitly. 

### GitHub Integration

1. Download [the latest release](https://github.com/YahnisElsts/plugin-update-checker/releases/latest) and copy the `plugin-update-checker` directory to your plugin or theme.
2. Add the following code to the main plugin file or `functions.php`:

	```php
	require 'plugin-update-checker/plugin-update-checker.php';
	use YahnisElsts\PluginUpdateChecker\v5\PucFactory;
 
	$myUpdateChecker = PucFactory::buildUpdateChecker(
		'https://github.com/user-name/repo-name/',
		__FILE__,
		'unique-plugin-or-theme-slug'
	);
	
	//Set the branch that contains the stable release.
	$myUpdateChecker->setBranch('stable-branch-name');

	//Optional: If you're using a private repository, specify the access token like this:
	$myUpdateChecker->setAuthentication('your-token-here');
	```
3. Plugins only: Add a `readme.txt` file formatted according to the [WordPress.org plugin readme standard](https://wordpress.org/plugins/readme.txt) to your repository. The contents of this file will be shown when the user clicks the "View version 1.2.3 details" link.

#### How to Release an Update

This library supports a couple of different ways to release updates on GitHub. Pick the one that best fits your workflow.

- **GitHub releases** 
	
	Create a new release using the "Releases" feature on GitHub. The tag name and release title don't matter. The description is optional, but if you do provide one, it will be displayed when the user clicks the "View version x.y.z details" link on the "Plugins" page. Note that PUC ignores releases marked as "This is a pre-release".
	
	If you want to use release assets, call the `enableReleaseAssets()` method after creating the update checker instance:
	```php
	$myUpdateChecker->getVcsApi()->enableReleaseAssets();
	```
	
- **Tags** 
	
	To release version 1.2.3, create a new Git tag named `v1.2.3` or `1.2.3`. That's it.
	
	PUC doesn't require strict adherence to [SemVer](https://semver.org/). These are all valid tag names: `v1.2.3`, `v1.2-foo`, `1.2.3_rc1-ABC`, `1.2.3.4.5`. However, be warned that it's not smart enough to filter out alpha/beta/RC versions. If that's a problem, you might want to use GitHub releases or branches instead.
	
- **Stable branch** 
	
	Point the update checker at a stable, production-ready branch: 
	 ```php
	 $updateChecker->setBranch('branch-name');
	 ```
	 PUC will periodically check the `Version` header in the main plugin file or `style.css` and display a notification if it's greater than the installed version.
	 
	 Caveat: If you set the branch to `master` (the default), the update checker will look for recent releases and tags first. It'll only use the `master` branch if it doesn't find anything else suitable.

#### Notes

The library will pull update details from the following parts of a release/tag/branch:

- Version number
	- The "Version" plugin header.
	- The latest GitHub release or tag name.
- Changelog
	- The "Changelog" section of `readme.txt`.
	- One of the following files:
		CHANGES.md, CHANGELOG.md, changes.md, changelog.md
	- GitHub release notes.
- Required and tested WordPress versions
	- The "Requires at least" and "Tested up to" fields in `readme.txt`.
	- The following plugin headers:
		`Required WP`, `Tested WP`, `Requires at least`, `Tested up to`
- "Last updated" timestamp
	- The creation timestamp of the latest GitHub release.
	- The latest commit in the selected tag or branch.
- Number of downloads
	- The `download_count` statistic of the latest release.
	- If you're not using GitHub releases, there will be no download stats.
- Other plugin details - author, homepage URL, description
	- The "Description" section of `readme.txt`.
	- Remote plugin headers (i.e. the latest version on GitHub).
	- Local plugin headers (i.e. the currently installed version).
- Ratings, banners, screenshots
	- Not supported.
	
### BitBucket Integration

1. Download [the latest release](https://github.com/YahnisElsts/plugin-update-checker/releases/latest) and copy the `plugin-update-checker` directory to your plugin or theme.
2. Add the following code to the main plugin file or `functions.php`:

	```php
	require 'plugin-update-checker/plugin-update-checker.php';
	use YahnisElsts\PluginUpdateChecker\v5\PucFactory;
 
	$myUpdateChecker = PucFactory::buildUpdateChecker(
		'https://bitbucket.org/user-name/repo-name',
		__FILE__,
		'unique-plugin-or-theme-slug'
	);

	//Optional: If you're using a private repository, create an OAuth consumer
	//and set the authentication credentials like this:
	//Note: For now you need to check "This is a private consumer" when
	//creating the consumer to work around #134:
	// https://github.com/YahnisElsts/plugin-update-checker/issues/134
	$myUpdateChecker->setAuthentication(array(
		'consumer_key' => '...',
		'consumer_secret' => '...',
	));

	//Optional: Set the branch that contains the stable release.
	$myUpdateChecker->setBranch('stable-branch-name');
	```
3. Optional: Add a `readme.txt` file formatted according to the [WordPress.org plugin readme standard](https://wordpress.org/plugins/readme.txt) to your repository. For plugins, the contents of this file will be shown when the user clicks the "View version 1.2.3 details" link.

#### How to Release an Update

BitBucket doesn't have an equivalent to GitHub's releases, so the process is slightly different. You can use any of the following approaches: 

- **`Stable tag` header** 
	
	This is the recommended approach if you're using tags to mark each version. Add a `readme.txt` file formatted according to the [WordPress.org plugin readme standard](https://wordpress.org/plugins/readme.txt) to your repository. Set the "stable tag" header to the tag that represents the latest release. Example:
	```text
	Stable tag: v1.2.3
	```
	The tag doesn't have to start with a "v" or follow any particular format. You can use any name you like as long as it's a valid Git tag.
	
	Tip: If you explicitly set a stable branch, the update checker will look for a `readme.txt` in that branch. Otherwise it will only look at the `master` branch.
	
- **Tags** 
	
	You can skip the "stable tag" bit and just create a new Git tag named `v1.2.3` or `1.2.3`. The update checker will look at the most recent tags and pick the one that looks like the highest version number.
	
	PUC doesn't require strict adherence to [SemVer](https://semver.org/). These are all valid tag names: `v1.2.3`, `v1.2-foo`, `1.2.3_rc1-ABC`, `1.2.3.4.5`. However, be warned that it's not smart enough to filter out alpha/beta/RC versions.
	
- **Stable branch** 
	
	Point the update checker at a stable, production-ready branch: 
	 ```php
	 $updateChecker->setBranch('branch-name');
	 ```
	 PUC will periodically check the `Version` header in the main plugin file or `style.css` and display a notification if it's greater than the installed version. Caveat: If you set the branch to `master`, the update checker will still look for tags first.

### GitLab Integration

1. Download [the latest release](https://github.com/YahnisElsts/plugin-update-checker/releases/latest) and copy the `plugin-update-checker` directory to your plugin or theme.
2. Add the following code to the main plugin file or `functions.php` and define how you want to check for updates from Gitlab (refer to: [Gitlab: How to Release an Update](#how-to-release-a-gitlab-update)):

	```php
	require 'plugin-update-checker/plugin-update-checker.php';
	use YahnisElsts\PluginUpdateChecker\v5\PucFactory;

	$myUpdateChecker = PucFactory::buildUpdateChecker(
		'https://gitlab.com/user-name/repo-name/',
		__FILE__,
		'unique-plugin-or-theme-slug'
	);

	//Optional: If you're using a private repository, specify the access token like this:
	$myUpdateChecker->setAuthentication('your-token-here');
	```

	Alternatively, if you're using a self-hosted GitLab instance, initialize the update checker like this:
	```php
	use YahnisElsts\PluginUpdateChecker\v5p6\Vcs\PluginUpdateChecker;
	use YahnisElsts\PluginUpdateChecker\v5p6\Vcs\GitLabApi;
	
	$myUpdateChecker = new PluginUpdateChecker(
		new GitLabApi('https://myserver.com/user-name/repo-name/'),
		__FILE__,
		'unique-plugin-or-theme-slug'
	);
	//Optional: Add setAuthentication(...) and setBranch(...) as shown above.  
	```
	If you're using a self-hosted GitLab instance and [subgroups or nested groups](https://docs.gitlab.com/ce/user/group/subgroups/index.html), you have to tell the update checker which parts of the URL are subgroups:
	```php
	use YahnisElsts\PluginUpdateChecker\v5p6\Vcs\PluginUpdateChecker;
	use YahnisElsts\PluginUpdateChecker\v5p6\Vcs\GitLabApi;
   
	$myUpdateChecker = new PluginUpdateChecker(
		new GitLabApi(
			'https://myserver.com/group-name/subgroup-level1/subgroup-level2/subgroup-level3/repo-name/', 
			null, 
			'subgroup-level1/subgroup-level2/subgroup-level3'
		),
		__FILE__,
		'unique-plugin-or-theme-slug'
	);
	```

3. Plugins only: Add a `readme.txt` file formatted according to the [WordPress.org plugin readme standard](https://wordpress.org/plugins/readme.txt) to your repository. The contents of this file will be shown when the user clicks the "View version 1.2.3 details" link.

#### How to Release a GitLab Update

A GitLab repository can be checked for updates in 3 different ways.

- **GitLab releases**
	
	Create a new release using the "Releases" feature on GitLab. The tag name should match the version number. You can add a `v` prefix to the tag, like `v1.2.3`. Releases that are marked as ["Upcoming Release"](https://docs.gitlab.com/ee/user/project/releases/index.html#upcoming-releases) will be automatically ignored.
	
	If you want to use custom release assets, call the `enableReleaseAssets()` method after creating the update checker instance:
	```php
	$myUpdateChecker->getVcsApi()->enableReleaseAssets();
	```
	
	By default, PUC will use the first available asset link, regardless of type. You can pass a regular expression to `enableReleaseAssets()` to make it pick the first link where the URL matches the regex. For example:
	```php
	$myUpdateChecker->getVcsApi()->enableReleaseAssets('/\.zip($|[?&#])/i');
	```
	
	**Tip:** You can use a Gitlab CI/CD Pipeline to automatically generate your update on release using a Generic Package. For more information about generic packages, refer to the following links:
		- [Gitlab CI/CD Release Documentation](https://docs.gitlab.com/ee/user/project/releases/#create-release-from-gitlab-ci)
		- [Gitlab Release Assets as Generic Package Documentation](https://gitlab.com/gitlab-org/release-cli/-/tree/master/docs/examples/release-assets-as-generic-package/)
		- [Example .gitlab-ci.yml file using Release Generic Packages for generating a update package from the Sensei-LMS wordpress plugin](https://gist.github.com/timwiel/9dfd3526c768efad4973254085e065ce)

- **Tags**

	To release version 1.2.3, create a new Git tag named `v1.2.3` or `1.2.3`. The update checker will look at recent tags and use the one that looks like the highest version number.
	
	PUC doesn't require strict adherence to [SemVer](https://semver.org/). However, be warned that it's not smart enough to filter out alpha/beta/RC versions. If that's a problem, you might want to use GitLab branches instead.

- **Stable branch**

	Point the update checker at any stable, production-ready branch:
	```php
	$myUpdateChecker->setBranch('stable-branch-name');
	```
	PUC will periodically check the `Version` header in the main plugin file or `style.css` and display a notification if it's greater than the installed version. Caveat: Even if you set the branch to `main` (the default) or `master` (the historical default), the update checker will still look for recent releases and tags first.

Migrating from 4.x
------------------

Older versions of the library didn't use namespaces. Code that was written for those versions will need to be updated to work with the current version. At a minimum, you'll need to change the factory class name. 

Old code:
```php
$myUpdateChecker = Puc_v4_Factory::buildUpdateChecker(
	'https://example.com/info.json',
	__FILE__,
	'my-slug'
);
```

New code:
```php
use YahnisElsts\PluginUpdateChecker\v5\PucFactory;

$myUpdateChecker = PucFactory::buildUpdateChecker(
	'https://example.com/info.json',
	__FILE__,
	'my-slug'
);
```

Other classes have also been renamed, usually by simply removing the `Puc_vXpY_` prefix and converting `Category_Thing` to `Category\Thing`. Here's a table of the most commonly used classes and their new names:

| Old class name                      | New class name                                                 |
|-------------------------------------|----------------------------------------------------------------|
| `Puc_v4_Factory`                    | `YahnisElsts\PluginUpdateChecker\v5\PucFactory`                |
| `Puc_v4p13_Factory`                 | `YahnisElsts\PluginUpdateChecker\v5p6\PucFactory`              |
| `Puc_v4p13_Plugin_UpdateChecker`    | `YahnisElsts\PluginUpdateChecker\v5p6\Plugin\UpdateChecker`    |
| `Puc_v4p13_Theme_UpdateChecker`     | `YahnisElsts\PluginUpdateChecker\v5p6\Theme\UpdateChecker`     |
| `Puc_v4p13_Vcs_PluginUpdateChecker` | `YahnisElsts\PluginUpdateChecker\v5p6\Vcs\PluginUpdateChecker` |
| `Puc_v4p13_Vcs_ThemeUpdateChecker`  | `YahnisElsts\PluginUpdateChecker\v5p6\Vcs\ThemeUpdateChecker`  |
| `Puc_v4p13_Vcs_GitHubApi`           | `YahnisElsts\PluginUpdateChecker\v5p6\Vcs\GitHubApi`           |
| `Puc_v4p13_Vcs_GitLabApi`           | `YahnisElsts\PluginUpdateChecker\v5p6\Vcs\GitLabApi`           |
| `Puc_v4p13_Vcs_BitBucketApi`        | `YahnisElsts\PluginUpdateChecker\v5p6\Vcs\BitBucketApi`        |

License Management
------------------

Currently, the update checker doesn't have any built-in license management features. It only provides some hooks that you can use to, for example, append license keys to update requests (`$updateChecker->addQueryArgFilter()`). If you're looking for ways to manage and verify licenses, please post your feedback in [this issue](https://github.com/YahnisElsts/plugin-update-checker/issues/222).

Resources
---------

- [This blog post](https://w-shadow.com/blog/2010/09/02/automatic-updates-for-any-plugin/) has more information about the update checker API. *Slightly out of date.*
- [Debug Bar](https://wordpress.org/plugins/debug-bar/) - useful for testing and debugging the update checker.
- [Update format reference](https://docs.google.com/spreadsheets/d/1eOBbW7Go2qEQXReOOCdidMTf_tDYRq4JfegcO1CBPIs/edit?usp=sharing) - describes all fields supported by the JSON-based update information format used by the update checker. Only covers plugins. Themes use a similar but more limited format.
- [Securing download links](https://w-shadow.com/blog/2013/03/19/plugin-updates-securing-download-links/) - a general overview.
- [A GUI for entering download credentials](https://open-tools.net/documentation/tutorial-automatic-updates.html#wordpress)
- [Theme Update Checker](https://w-shadow.com/blog/2011/06/02/automatic-updates-for-commercial-themes/) - an older, theme-only variant of this update checker.

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\css\puc-debug-bar.css (1334 bytes, 71 lines) =====
`$ext
.puc-debug-bar-panel-v5 pre {
	margin-top: 0;
}

/* Style the debug data table to match "widefat" table style used by WordPress. */
table.puc-debug-data {
    width: 100%;
    clear: both;
    margin: 0;

    border-spacing: 0;
    background-color: #f9f9f9;

    border-radius: 3px;
    border: 1px solid #dfdfdf;
    border-collapse: separate;
}

table.puc-debug-data * {
    word-wrap: break-word;
}

table.puc-debug-data th {
	width: 11em;
    padding: 7px 7px 8px;
    text-align: left;

    font-family: "Georgia", "Times New Roman", "Bitstream Charter", "Times", serif;
    font-weight: 400;
    font-size: 14px;
    line-height: 1.3em;
    text-shadow: rgba(255, 255, 255, 0.804) 0 1px 0;
}

table.puc-debug-data td, table.puc-debug-data th {
    border-width: 1px 0;
    border-style: solid;

    border-top-color: #fff;
    border-bottom-color: #dfdfdf;

    text-transform: none;
}

table.puc-debug-data td {
    color: #555;
    font-size: 12px;
    padding: 4px 7px 2px;
    vertical-align: top;
}

.puc-ajax-response {
	border: 1px solid #dfdfdf;
	border-radius: 3px;
	padding: 0.5em;
	margin: 5px 0;
	background-color: white;
}

.puc-ajax-nonce {
	display: none;
}

.puc-ajax-response dt {
	margin: 0;
}

.puc-ajax-response dd {
	margin: 0 0 1em;
}

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\js\debug-bar.js (1793 bytes, 54 lines) =====
`$ext
jQuery(function($) {

	function runAjaxAction(button, action) {
		button = $(button);
		var panel = button.closest('.puc-debug-bar-panel-v5');
		var responseBox = button.closest('td').find('.puc-ajax-response');

		responseBox.text('Processing...').show();
		$.post(
			ajaxurl,
			{
				action  : action,
				uid     : panel.data('uid'),
				_wpnonce: panel.data('nonce')
			},
			function(data) {
				//The response contains HTML that should already be escaped in server-side code.
				//phpcs:ignore WordPressVIPMinimum.JS.HTMLExecutingFunctions.html
				responseBox.html(data);
			},
			'html'
		);
	}

	$('.puc-debug-bar-panel-v5 input[name="puc-check-now-button"]').on('click', function() {
		runAjaxAction(this, 'puc_v5_debug_check_now');
		return false;
	});

	$('.puc-debug-bar-panel-v5 input[name="puc-request-info-button"]').on('click', function() {
		runAjaxAction(this, 'puc_v5_debug_request_info');
		return false;
	});


	// Debug Bar uses the panel class name as part of its link and container IDs. This means we can
	// end up with multiple identical IDs if more than one plugin uses the update checker library.
	// Fix it by replacing the class name with the plugin slug.
	var panels = $('#debug-menu-targets').find('.puc-debug-bar-panel-v5');
	panels.each(function() {
		var panel = $(this);
		var uid = panel.data('uid');
		var target = panel.closest('.debug-menu-target');

		//Change the panel wrapper ID.
		target.attr('id', 'debug-menu-target-puc-' + uid);

		//Change the menu link ID as well and point it at the new target ID.
		$('#debug-bar-menu').find('.puc-debug-menu-link-' + uid)
			.closest('.debug-menu-link')
			.attr('id', 'debug-menu-link-puc-' + uid)
			.attr('href', '#' + target.attr('id'));
	});
});
`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5\PucFactory.php (201 bytes, 11 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5;

if ( !class_exists(PucFactory::class, false) ):

	class PucFactory extends \YahnisElsts\PluginUpdateChecker\v5p6\PucFactory {
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Autoloader.php (2774 bytes, 87 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6;

if ( !class_exists(Autoloader::class, false) ):

	class Autoloader {
		const DEFAULT_NS_PREFIX = 'YahnisElsts\\PluginUpdateChecker\\';

		private $prefix;
		private $rootDir;
		private $libraryDir;

		private $staticMap;

		public function __construct() {
			$this->rootDir = dirname(__FILE__) . '/';

			$namespaceWithSlash = __NAMESPACE__ . '\\';
			$this->prefix = $namespaceWithSlash;

			$this->libraryDir = $this->rootDir . '../..';
			if ( !self::isPhar() ) {
				$this->libraryDir = realpath($this->libraryDir);
			}
			$this->libraryDir = $this->libraryDir . '/';

			//Usually, dependencies like Parsedown are in the global namespace,
			//but if someone adds a custom namespace to the entire library, they
			//will be in the same namespace as this class.
			$isCustomNamespace = (
				substr($namespaceWithSlash, 0, strlen(self::DEFAULT_NS_PREFIX)) !== self::DEFAULT_NS_PREFIX
			);
			$libraryPrefix = $isCustomNamespace ? $namespaceWithSlash : '';

			$this->staticMap = array(
				$libraryPrefix . 'PucReadmeParser' => 'vendor/PucReadmeParser.php',
				$libraryPrefix . 'Parsedown'       => 'vendor/Parsedown.php',
			);

			//Add the generic, major-version-only factory class to the static map.
			$versionSeparatorPos = strrpos(__NAMESPACE__, '\\v');
			if ( $versionSeparatorPos !== false ) {
				$versionSegment = substr(__NAMESPACE__, $versionSeparatorPos + 1);
				$pointPos = strpos($versionSegment, 'p');
				if ( ($pointPos !== false) && ($pointPos > 1) ) {
					$majorVersionSegment = substr($versionSegment, 0, $pointPos);
					$majorVersionNs = __NAMESPACE__ . '\\' . $majorVersionSegment;
					$this->staticMap[$majorVersionNs . '\\PucFactory'] =
						'Puc/' . $majorVersionSegment . '/Factory.php';
				}
			}

			spl_autoload_register(array($this, 'autoload'));
		}

		/**
		 * Determine if this file is running as part of a Phar archive.
		 *
		 * @return bool
		 */
		private static function isPhar() {
			//Check if the current file path starts with "phar://".
			static $pharProtocol = 'phar://';
			return (substr(__FILE__, 0, strlen($pharProtocol)) === $pharProtocol);
		}

		public function autoload($className) {
			if ( isset($this->staticMap[$className]) && file_exists($this->libraryDir . $this->staticMap[$className]) ) {
				include($this->libraryDir . $this->staticMap[$className]);
				return;
			}

			if ( strpos($className, $this->prefix) === 0 ) {
				$path = substr($className, strlen($this->prefix));
				$path = str_replace(array('_', '\\'), '/', $path);
				$path = $this->rootDir . $path . '.php';

				if ( file_exists($path) ) {
					include $path;
				}
			}
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\InstalledPackage.php (3042 bytes, 106 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6;

if ( !class_exists(InstalledPackage::class, false) ):

	/**
	 * This class represents a currently installed plugin or theme.
	 *
	 * Not to be confused with the "package" field in WP update API responses that contains
	 * the download URL of a the new version.
	 */
	abstract class InstalledPackage {
		/**
		 * @var UpdateChecker
		 */
		protected $updateChecker;

		public function __construct($updateChecker) {
			$this->updateChecker = $updateChecker;
		}

		/**
		 * Get the currently installed version of the plugin or theme.
		 *
		 * @return string|null Version number.
		 */
		abstract public function getInstalledVersion();

		/**
		 * Get the full path of the plugin or theme directory (without a trailing slash).
		 *
		 * @return string
		 */
		abstract public function getAbsoluteDirectoryPath();

		/**
		 * Check whether a regular file exists in the package's directory.
		 *
		 * @param string $relativeFileName File name relative to the package directory.
		 * @return bool
		 */
		public function fileExists($relativeFileName) {
			return is_file(
				$this->getAbsoluteDirectoryPath()
				. DIRECTORY_SEPARATOR
				. ltrim($relativeFileName, '/\\')
			);
		}

		/* -------------------------------------------------------------------
		 * File header parsing
		 * -------------------------------------------------------------------
		 */

		/**
		 * Parse plugin or theme metadata from the header comment.
		 *
		 * This is basically a simplified version of the get_file_data() function from /wp-includes/functions.php.
		 * It's intended as a utility for subclasses that detect updates by parsing files in a VCS.
		 *
		 * @param string|null $content File contents.
		 * @return string[]
		 */
		public function getFileHeader($content) {
			$content = (string)$content;

			//WordPress only looks at the first 8 KiB of the file, so we do the same.
			$content = substr($content, 0, 8192);
			//Normalize line endings.
			$content = str_replace("\r", "\n", $content);

			$headers = $this->getHeaderNames();
			$results = array();
			foreach ($headers as $field => $name) {
				$success = preg_match('/^[ \t\/*#@]*' . preg_quote($name, '/') . ':(.*)$/mi', $content, $matches);

				if ( ($success === 1) && $matches[1] ) {
					$value = $matches[1];
					if ( function_exists('_cleanup_header_comment') ) {
						$value = _cleanup_header_comment($value);
					}
					$results[$field] = $value;
				} else {
					$results[$field] = '';
				}
			}

			return $results;
		}

		/**
		 * @return array Format: ['HeaderKey' => 'Header Name']
		 */
		abstract protected function getHeaderNames();

		/**
		 * Get the value of a specific plugin or theme header.
		 *
		 * @param string $headerName
		 * @return string Either the value of the header, or an empty string if the header doesn't exist.
		 */
		abstract public function getHeaderValue($headerName);

	}
endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Metadata.php (4401 bytes, 163 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6;

use LogicException;
use stdClass;
use WP_Error;

if ( !class_exists(Metadata::class, false) ):

	/**
	 * A base container for holding information about updates and plugin metadata.
	 *
	 * @author Janis Elsts
	 * @copyright 2016
	 * @access public
	 */
	abstract class Metadata {
		/**
		 * Additional dynamic properties, usually copied from the API response.
		 *
		 * @var array<string,mixed>
		 */
		protected $extraProperties = array();

		/**
		 * Create an instance of this class from a JSON document.
		 *
		 * @abstract
		 * @param string $json
		 * @return self
		 */
		public static function fromJson($json) {
			throw new LogicException('The ' . __METHOD__ . ' method must be implemented by subclasses');
		}

		/**
		 * @param string $json
		 * @param self $target
		 * @return bool
		 */
		protected static function createFromJson($json, $target) {
			/** @var \StdClass $apiResponse */
			$apiResponse = json_decode($json);
			if ( empty($apiResponse) || !is_object($apiResponse) ){
				$errorMessage = "Failed to parse update metadata. Try validating your .json file with https://jsonlint.com/";
				do_action('puc_api_error', new WP_Error('puc-invalid-json', $errorMessage));
				//phpcs:ignore WordPress.PHP.DevelopmentFunctions.error_log_trigger_error -- For plugin developers.
				trigger_error(esc_html($errorMessage), E_USER_NOTICE);
				return false;
			}

			$valid = $target->validateMetadata($apiResponse);
			if ( is_wp_error($valid) ){
				do_action('puc_api_error', $valid);
				//phpcs:ignore WordPress.PHP.DevelopmentFunctions.error_log_trigger_error -- For plugin developers.
				trigger_error(esc_html($valid->get_error_message()), E_USER_NOTICE);
				return false;
			}

			foreach(get_object_vars($apiResponse) as $key => $value){
				$target->$key = $value;
			}

			return true;
		}

		/**
		 * No validation by default! Subclasses should check that the required fields are present.
		 *
		 * @param \StdClass $apiResponse
		 * @return bool|\WP_Error
		 */
		protected function validateMetadata($apiResponse) {
			return true;
		}

		/**
		 * Create a new instance by copying the necessary fields from another object.
		 *
		 * @abstract
		 * @param \StdClass|self $object The source object.
		 * @return self The new copy.
		 */
		public static function fromObject($object) {
			throw new LogicException('The ' . __METHOD__ . ' method must be implemented by subclasses');
		}

		/**
		 * Create an instance of StdClass that can later be converted back to an
		 * update or info container. Useful for serialization and caching, as it
		 * avoids the "incomplete object" problem if the cached value is loaded
		 * before this class.
		 *
		 * @return \StdClass
		 */
		public function toStdClass() {
			$object = new stdClass();
			$this->copyFields($this, $object);
			return $object;
		}

		/**
		 * Transform the metadata into the format used by WordPress core.
		 *
		 * @return object
		 */
		abstract public function toWpFormat();

		/**
		 * Copy known fields from one object to another.
		 *
		 * @param \StdClass|self $from
		 * @param \StdClass|self $to
		 */
		protected function copyFields($from, $to) {
			$fields = $this->getFieldNames();

			if ( property_exists($from, 'slug') && !empty($from->slug) ) {
				//Let plugins add extra fields without having to create subclasses.
				$fields = apply_filters($this->getPrefixedFilter('retain_fields') . '-' . $from->slug, $fields);
			}

			foreach ($fields as $field) {
				if ( property_exists($from, $field) ) {
					$to->$field = $from->$field;
				}
			}
		}

		/**
		 * @return string[]
		 */
		protected function getFieldNames() {
			return array();
		}

		/**
		 * @param string $tag
		 * @return string
		 */
		protected function getPrefixedFilter($tag) {
			return 'puc_' . $tag;
		}

		public function __set($name, $value) {
			$this->extraProperties[$name] = $value;
		}

		public function __get($name) {
			return isset($this->extraProperties[$name]) ? $this->extraProperties[$name] : null;
		}

		public function __isset($name) {
			return isset($this->extraProperties[$name]);
		}

		public function __unset($name) {
			unset($this->extraProperties[$name]);
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\OAuthSignature.php (3167 bytes, 103 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6;

if ( !class_exists(OAuthSignature::class, false) ):

	/**
	 * A basic signature generator for zero-legged OAuth 1.0.
	 */
	class OAuthSignature {
		private $consumerKey = '';
		private $consumerSecret = '';

		public function __construct($consumerKey, $consumerSecret) {
			$this->consumerKey = $consumerKey;
			$this->consumerSecret = $consumerSecret;
		}

		/**
		 * Sign a URL using OAuth 1.0.
		 *
		 * @param string $url The URL to be signed. It may contain query parameters.
		 * @param string $method HTTP method such as "GET", "POST" and so on.
		 * @return string The signed URL.
		 */
		public function sign($url, $method = 'GET') {
			$parameters = array();

			//Parse query parameters.
			$query = wp_parse_url($url, PHP_URL_QUERY);
			if ( !empty($query) ) {
				parse_str($query, $parsedParams);
				if ( is_array($parsedParams) ) {
					$parameters = $parsedParams;
				}
				//Remove the query string from the URL. We'll replace it later.
				$url = substr($url, 0, strpos($url, '?'));
			}

			$parameters = array_merge(
				$parameters,
				array(
					'oauth_consumer_key' => $this->consumerKey,
					'oauth_nonce' => $this->nonce(),
					'oauth_signature_method' => 'HMAC-SHA1',
					'oauth_timestamp' => time(),
					'oauth_version' => '1.0',
				)
			);
			unset($parameters['oauth_signature']);

			//Parameters must be sorted alphabetically before signing.
			ksort($parameters);

			//The most complicated part of the request - generating the signature.
			//The string to sign contains the HTTP method, the URL path, and all of
			//our query parameters. Everything is URL encoded. Then we concatenate
			//them with ampersands into a single string to hash.
			$encodedVerb = urlencode($method);
			$encodedUrl = urlencode($url);
			$encodedParams = urlencode(http_build_query($parameters, '', '&'));

			$stringToSign = $encodedVerb . '&' . $encodedUrl . '&' . $encodedParams;

			//Since we only have one OAuth token (the consumer secret) we only have
			//to use it as our HMAC key. However, we still have to append an & to it
			//as if we were using it with additional tokens.
			$secret = urlencode($this->consumerSecret) . '&';

			//The signature is a hash of the consumer key and the base string. Note
			//that we have to get the raw output from hash_hmac and base64 encode
			//the binary data result.
			$parameters['oauth_signature'] = base64_encode(hash_hmac('sha1', $stringToSign, $secret, true));

			return ($url . '?' . http_build_query($parameters));
		}

		/**
		 * Generate a random nonce.
		 *
		 * @return string
		 */
		private function nonce() {
			$mt = microtime();

			$rand = null;
			if ( is_callable('random_bytes') ) {
				try {
					$rand = random_bytes(16);
				} catch (\Exception $ex) {
					//Fall back to mt_rand (below).
				}
			}
			if ( $rand === null ) {
				//phpcs:ignore WordPress.WP.AlternativeFunctions.rand_mt_rand
				$rand = function_exists('wp_rand') ? wp_rand() : mt_rand();
			}

			return md5($mt . '_' . $rand);
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\PucFactory.php (12121 bytes, 363 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6;

use YahnisElsts\PluginUpdateChecker\v5p6\Plugin;
use YahnisElsts\PluginUpdateChecker\v5p6\Theme;
use YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

if ( !class_exists(PucFactory::class, false) ):

	/**
	 * A factory that builds update checker instances.
	 *
	 * When multiple versions of the same class have been loaded (e.g. PluginUpdateChecker 4.0
	 * and 4.1), this factory will always use the latest available minor version. Register class
	 * versions by calling {@link PucFactory::addVersion()}.
	 *
	 * At the moment it can only build instances of the UpdateChecker class. Other classes are
	 * intended mainly for internal use and refer directly to specific implementations.
	 */
	class PucFactory {
		protected static $classVersions = array();
		protected static $sorted = false;

		protected static $myMajorVersion = '';
		protected static $latestCompatibleVersion = '';

		/**
		 * A wrapper method for buildUpdateChecker() that reads the metadata URL from the plugin or theme header.
		 *
		 * @param string $fullPath Full path to the main plugin file or the theme's style.css.
		 * @param array $args Optional arguments. Keys should match the argument names of the buildUpdateChecker() method.
		 * @return Plugin\UpdateChecker|Theme\UpdateChecker|Vcs\BaseChecker
		 */
		public static function buildFromHeader($fullPath, $args = array()) {
			$fullPath = self::normalizePath($fullPath);

			//Set up defaults.
			$defaults = array(
				'metadataUrl'  => '',
				'slug'         => '',
				'checkPeriod'  => 12,
				'optionName'   => '',
				'muPluginFile' => '',
			);
			$args = array_merge($defaults, array_intersect_key($args, $defaults));
			extract($args, EXTR_SKIP);

			//Check for the service URI
			if ( empty($metadataUrl) ) {
				$metadataUrl = self::getServiceURI($fullPath);
			}

			return self::buildUpdateChecker($metadataUrl, $fullPath, $slug, $checkPeriod, $optionName, $muPluginFile);
		}

		/**
		 * Create a new instance of the update checker.
		 *
		 * This method automatically detects if you're using it for a plugin or a theme and chooses
		 * the appropriate implementation for your update source (JSON file, GitHub, BitBucket, etc).
		 *
		 * @see UpdateChecker::__construct
		 *
		 * @param string $metadataUrl The URL of the metadata file, a GitHub repository, or another supported update source.
		 * @param string $fullPath Full path to the main plugin file or to the theme directory.
		 * @param string $slug Custom slug. Defaults to the name of the main plugin file or the theme directory.
		 * @param int $checkPeriod How often to check for updates (in hours).
		 * @param string $optionName Where to store bookkeeping info about update checks.
		 * @param string $muPluginFile The plugin filename relative to the mu-plugins directory.
		 * @return Plugin\UpdateChecker|Theme\UpdateChecker|Vcs\BaseChecker
		 */
		public static function buildUpdateChecker($metadataUrl, $fullPath, $slug = '', $checkPeriod = 12, $optionName = '', $muPluginFile = '') {
			$fullPath = self::normalizePath($fullPath);
			$id = null;

			//Plugin or theme?
			$themeDirectory = self::getThemeDirectoryName($fullPath);
			if ( self::isPluginFile($fullPath) ) {
				$type = 'Plugin';
				$id = $fullPath;
			} else if ( $themeDirectory !== null ) {
				$type = 'Theme';
				$id = $themeDirectory;
			} else {
				throw new \RuntimeException(sprintf(
					'The update checker cannot determine if "%s" is a plugin or a theme. ' .
					'This is a bug. Please contact the PUC developer.',
					esc_html($fullPath)
				));
			}

			//Which hosting service does the URL point to?
			$service = self::getVcsService($metadataUrl);

			$apiClass = null;
			if ( empty($service) ) {
				//The default is to get update information from a remote JSON file.
				$checkerClass = $type . '\\UpdateChecker';
			} else {
				//You can also use a VCS repository like GitHub.
				$checkerClass = 'Vcs\\' . $type . 'UpdateChecker';
				$apiClass = $service . 'Api';
			}

			$checkerClass = self::getCompatibleClassVersion($checkerClass);
			if ( $checkerClass === null ) {
				//phpcs:ignore WordPress.PHP.DevelopmentFunctions.error_log_trigger_error
				trigger_error(
					esc_html(sprintf(
						'PUC %s does not support updates for %ss %s',
						self::$latestCompatibleVersion,
						strtolower($type),
						$service ? ('hosted on ' . $service) : 'using JSON metadata'
					)),
					E_USER_ERROR
				);
			}

			if ( !isset($apiClass) ) {
				//Plain old update checker.
				return new $checkerClass($metadataUrl, $id, $slug, $checkPeriod, $optionName, $muPluginFile);
			} else {
				//VCS checker + an API client.
				$apiClass = self::getCompatibleClassVersion($apiClass);
				if ( $apiClass === null ) {
					//phpcs:ignore WordPress.PHP.DevelopmentFunctions.error_log_trigger_error
					trigger_error(esc_html(sprintf(
						'PUC %s does not support %s',
						self::$latestCompatibleVersion,
						$service
					)), E_USER_ERROR);
				}

				return new $checkerClass(
					new $apiClass($metadataUrl),
					$id,
					$slug,
					$checkPeriod,
					$optionName,
					$muPluginFile
				);
			}
		}

		/**
		 *
		 * Normalize a filesystem path. Introduced in WP 3.9.
		 * Copying here allows use of the class on earlier versions.
		 * This version adapted from WP 4.8.2 (unchanged since 4.5.6)
		 *
		 * @param string $path Path to normalize.
		 * @return string Normalized path.
		 */
		public static function normalizePath($path) {
			if ( function_exists('wp_normalize_path') ) {
				return wp_normalize_path($path);
			}
			$path = str_replace('\\', '/', $path);
			$path = preg_replace('|(?<=.)/+|', '/', $path);
			if ( substr($path, 1, 1) === ':' ) {
				$path = ucfirst($path);
			}
			return $path;
		}

		/**
		 * Check if the path points to a plugin file.
		 *
		 * @param string $absolutePath Normalized path.
		 * @return bool
		 */
		protected static function isPluginFile($absolutePath) {
			//Is the file inside the "plugins" or "mu-plugins" directory?
			$pluginDir = self::normalizePath(WP_PLUGIN_DIR);
			$muPluginDir = self::normalizePath(WPMU_PLUGIN_DIR);
			if ( (strpos($absolutePath, $pluginDir) === 0) || (strpos($absolutePath, $muPluginDir) === 0) ) {
				return true;
			}

			//Is it a file at all? Caution: is_file() can fail if the parent dir. doesn't have the +x permission set.
			if ( !is_file($absolutePath) ) {
				return false;
			}

			//Does it have a valid plugin header?
			//This is a last-ditch check for plugins symlinked from outside the WP root.
			if ( function_exists('get_file_data') ) {
				$headers = get_file_data($absolutePath, array('Name' => 'Plugin Name'), 'plugin');
				return !empty($headers['Name']);
			}

			return false;
		}

		/**
		 * Get the name of the theme's directory from a full path to a file inside that directory.
		 * E.g. "/abc/public_html/wp-content/themes/foo/whatever.php" => "foo".
		 *
		 * Note that subdirectories are currently not supported. For example,
		 * "/xyz/wp-content/themes/my-theme/includes/whatever.php" => NULL.
		 *
		 * @param string $absolutePath Normalized path.
		 * @return string|null Directory name, or NULL if the path doesn't point to a theme.
		 */
		protected static function getThemeDirectoryName($absolutePath) {
			if ( is_file($absolutePath) ) {
				$absolutePath = dirname($absolutePath);
			}

			if ( file_exists($absolutePath . '/style.css') ) {
				return basename($absolutePath);
			}
			return null;
		}

		/**
		 * Get the service URI from the file header.
		 *
		 * @param string $fullPath
		 * @return string
		 */
		private static function getServiceURI($fullPath) {
			//Look for the URI
			if ( is_readable($fullPath) ) {
				$seek = array(
					'github' => 'GitHub URI',
					'gitlab' => 'GitLab URI',
					'bucket' => 'BitBucket URI',
				);
				$seek = apply_filters('puc_get_source_uri', $seek);
				$data = get_file_data($fullPath, $seek);
				foreach ($data as $key => $uri) {
					if ( $uri ) {
						return $uri;
					}
				}
			}

			//URI was not found so throw an error.
			throw new \RuntimeException(
				sprintf('Unable to locate URI in header of "%s"', esc_html($fullPath))
			);
		}

		/**
		 * Get the name of the hosting service that the URL points to.
		 *
		 * @param string $metadataUrl
		 * @return string|null
		 */
		private static function getVcsService($metadataUrl) {
			$service = null;

			//Which hosting service does the URL point to?
			$host = (string)(wp_parse_url($metadataUrl, PHP_URL_HOST));
			$path = (string)(wp_parse_url($metadataUrl, PHP_URL_PATH));

			//Check if the path looks like "/user-name/repository".
			//For GitLab.com it can also be "/user/group1/group2/.../repository".
			$repoRegex = '@^/?([^/]+?)/([^/#?&]+?)/?$@';
			if ( $host === 'gitlab.com' ) {
				$repoRegex = '@^/?(?:[^/#?&]++/){1,20}(?:[^/#?&]++)/?$@';
			}
			if ( preg_match($repoRegex, $path) ) {
				$knownServices = array(
					'github.com' => 'GitHub',
					'bitbucket.org' => 'BitBucket',
					'gitlab.com' => 'GitLab',
				);
				if ( isset($knownServices[$host]) ) {
					$service = $knownServices[$host];
				}
			}

			return apply_filters('puc_get_vcs_service', $service, $host, $path, $metadataUrl);
		}

		/**
		 * Get the latest version of the specified class that has the same major version number
		 * as this factory class.
		 *
		 * @param string $class Partial class name.
		 * @return string|null Full class name.
		 */
		protected static function getCompatibleClassVersion($class) {
			if ( isset(self::$classVersions[$class][self::$latestCompatibleVersion]) ) {
				return self::$classVersions[$class][self::$latestCompatibleVersion];
			}
			return null;
		}

		/**
		 * Get the specific class name for the latest available version of a class.
		 *
		 * @param string $class
		 * @return null|string
		 */
		public static function getLatestClassVersion($class) {
			if ( !self::$sorted ) {
				self::sortVersions();
			}

			if ( isset(self::$classVersions[$class]) ) {
				return reset(self::$classVersions[$class]);
			} else {
				return null;
			}
		}

		/**
		 * Sort available class versions in descending order (i.e. newest first).
		 */
		protected static function sortVersions() {
			foreach ( self::$classVersions as $class => $versions ) {
				uksort($versions, array(__CLASS__, 'compareVersions'));
				self::$classVersions[$class] = $versions;
			}
			self::$sorted = true;
		}

		protected static function compareVersions($a, $b) {
			return -version_compare($a, $b);
		}

		/**
		 * Register a version of a class.
		 *
		 * @access private This method is only for internal use by the library.
		 *
		 * @param string $generalClass Class name without version numbers, e.g. 'PluginUpdateChecker'.
		 * @param string $versionedClass Actual class name, e.g. 'PluginUpdateChecker_1_2'.
		 * @param string $version Version number, e.g. '1.2'.
		 */
		public static function addVersion($generalClass, $versionedClass, $version) {
			if ( empty(self::$myMajorVersion) ) {
				$lastNamespaceSegment = substr(__NAMESPACE__, strrpos(__NAMESPACE__, '\\') + 1);
				self::$myMajorVersion = substr(ltrim($lastNamespaceSegment, 'v'), 0, 1);
			}

			//Store the greatest version number that matches our major version.
			$components = explode('.', $version);
			if ( $components[0] === self::$myMajorVersion ) {

				if (
					empty(self::$latestCompatibleVersion)
					|| version_compare($version, self::$latestCompatibleVersion, '>')
				) {
					self::$latestCompatibleVersion = $version;
				}

			}

			if ( !isset(self::$classVersions[$generalClass]) ) {
				self::$classVersions[$generalClass] = array();
			}
			self::$classVersions[$generalClass][$version] = $versionedClass;
			self::$sorted = false;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Scheduler.php (11167 bytes, 301 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6;

if ( !class_exists(Scheduler::class, false) ):

	/**
	 * The scheduler decides when and how often to check for updates.
	 * It calls @see UpdateChecker::checkForUpdates() to perform the actual checks.
	 */
	class Scheduler {
		public $checkPeriod = 12; //How often to check for updates (in hours).
		public $throttleRedundantChecks = false; //Check less often if we already know that an update is available.
		public $throttledCheckPeriod = 72;

		protected $hourlyCheckHooks = array('load-update.php');

		/**
		 * @var UpdateChecker
		 */
		protected $updateChecker;

		private $cronHook = null;

		/**
		 * Scheduler constructor.
		 *
		 * @param UpdateChecker $updateChecker
		 * @param int $checkPeriod How often to check for updates (in hours).
		 * @param array $hourlyHooks
		 */
		public function __construct($updateChecker, $checkPeriod, $hourlyHooks = array('load-plugins.php')) {
			$this->updateChecker = $updateChecker;
			$this->checkPeriod = $checkPeriod;

			//Set up the periodic update checks
			$this->cronHook = $this->updateChecker->getUniqueName('cron_check_updates');
			if ( $this->checkPeriod > 0 ){

				//Trigger the check via Cron.
				//Try to use one of the default schedules if possible as it's less likely to conflict
				//with other plugins and their custom schedules.
				$defaultSchedules = array(
					1  => 'hourly',
					12 => 'twicedaily',
					24 => 'daily',
				);
				if ( array_key_exists($this->checkPeriod, $defaultSchedules) ) {
					$scheduleName = $defaultSchedules[$this->checkPeriod];
				} else {
					//Use a custom cron schedule.
					$scheduleName = 'every' . $this->checkPeriod . 'hours';
					//phpcs:ignore WordPress.WP.CronInterval.ChangeDetected -- WPCS fails to parse the callback.
					add_filter('cron_schedules', array($this, '_addCustomSchedule'));
				}

				if ( !wp_next_scheduled($this->cronHook) && !defined('WP_INSTALLING') ) {
					//Randomly offset the schedule to help prevent update server traffic spikes. Without this
					//most checks may happen during times of day when people are most likely to install new plugins.
					$upperLimit = max($this->checkPeriod * 3600 - 15 * 60, 1);
					if ( function_exists('wp_rand') ) {
						$randomOffset = wp_rand(0, $upperLimit);
					} else {
						//This constructor may be called before wp_rand() is available.
						//phpcs:ignore WordPress.WP.AlternativeFunctions.rand_rand
						$randomOffset = rand(0, $upperLimit);
					}
					$firstCheckTime = time() - $randomOffset;
					$firstCheckTime = apply_filters(
						$this->updateChecker->getUniqueName('first_check_time'),
						$firstCheckTime
					);
					wp_schedule_event($firstCheckTime, $scheduleName, $this->cronHook);
				}
				add_action($this->cronHook, array($this, 'maybeCheckForUpdates'));

				//In case Cron is disabled or unreliable, we also manually trigger
				//the periodic checks while the user is browsing the Dashboard.
				add_action( 'admin_init', array($this, 'maybeCheckForUpdates') );

				//Like WordPress itself, we check more often on certain pages.
				/** @see wp_update_plugins */
				add_action('load-update-core.php', array($this, 'maybeCheckForUpdates'));
				//phpcs:ignore Squiz.PHP.CommentedOutCode.Found -- Not actually code, just file names.
				//"load-update.php" and "load-plugins.php" or "load-themes.php".
				$this->hourlyCheckHooks = array_merge($this->hourlyCheckHooks, $hourlyHooks);
				foreach($this->hourlyCheckHooks as $hook) {
					add_action($hook, array($this, 'maybeCheckForUpdates'));
				}
				//This hook fires after a bulk update is complete.
				add_action('upgrader_process_complete', array($this, 'removeHooksIfLibraryGone'), 1, 0);
				add_action('upgrader_process_complete', array($this, 'upgraderProcessComplete'), 11, 2);

			} else {
				//Periodic checks are disabled.
				wp_clear_scheduled_hook($this->cronHook);
			}
		}

		/**
		 * Remove all hooks if this version of PUC has been deleted or overwritten.
		 *
		 * Callback for the "upgrader_process_complete" action.
		 */
		public function removeHooksIfLibraryGone() {
			//Cancel all further actions if the current version of PUC has been deleted or overwritten
			//by a different version during the upgrade. If we try to do anything more in that situation,
			//we could trigger a fatal error by trying to autoload a deleted class.
			clearstatcache();
			if ( !file_exists(__FILE__) ) {
				$this->removeHooks();
				$this->updateChecker->removeHooks();
			}
		}

		/**
		 * Runs upon the WP action upgrader_process_complete.
		 *
		 * We look at the parameters to decide whether to call maybeCheckForUpdates() or not.
		 * We also check if the update checker has been removed by the update.
		 *
		 * @param \WP_Upgrader $upgrader  WP_Upgrader instance
		 * @param array $upgradeInfo extra information about the upgrade
		 */
		public function upgraderProcessComplete(
			/** @noinspection PhpUnusedParameterInspection */
			$upgrader, $upgradeInfo
		) {
			//Sanity check and limitation to relevant types.
			if (
				!is_array($upgradeInfo) || !isset($upgradeInfo['type'], $upgradeInfo['action'])
				|| 'update' !== $upgradeInfo['action'] || !in_array($upgradeInfo['type'], array('plugin', 'theme'))
			) {
				return;
			}

			//Filter out notifications of upgrades that should have no bearing upon whether or not our
			//current info is up-to-date.
			if ( is_a($this->updateChecker, Theme\UpdateChecker::class) ) {
				if ( 'theme' !== $upgradeInfo['type'] || !isset($upgradeInfo['themes']) ) {
					return;
				}

				//Letting too many things going through for checks is not a real problem, so we compare widely.
				if ( !in_array(
					strtolower($this->updateChecker->directoryName),
					array_map('strtolower', $upgradeInfo['themes'])
				) ) {
					return;
				}
			}

			if ( is_a($this->updateChecker, Plugin\UpdateChecker::class) ) {
				if ( 'plugin' !== $upgradeInfo['type'] || !isset($upgradeInfo['plugins']) ) {
					return;
				}

				//Themes pass in directory names in the information array, but plugins use the relative plugin path.
				if ( !in_array(
					strtolower($this->updateChecker->directoryName),
					array_map('dirname', array_map('strtolower', $upgradeInfo['plugins']))
				) ) {
					return;
				}
			}

			$this->maybeCheckForUpdates();
		}

		/**
		 * Check for updates if the configured check interval has already elapsed.
		 * Will use a shorter check interval on certain admin pages like "Dashboard -> Updates" or when doing cron.
		 *
		 * You can override the default behaviour by using the "puc_check_now-$slug" filter.
		 * The filter callback will be passed three parameters:
		 *     - Current decision. TRUE = check updates now, FALSE = don't check now.
		 *     - Last check time as a Unix timestamp.
		 *     - Configured check period in hours.
		 * Return TRUE to check for updates immediately, or FALSE to cancel.
		 *
		 * This method is declared public because it's a hook callback. Calling it directly is not recommended.
		 */
		public function maybeCheckForUpdates() {
			if ( empty($this->checkPeriod) ){
				return;
			}

			$state = $this->updateChecker->getUpdateState();
			$shouldCheck = ($state->timeSinceLastCheck() >= $this->getEffectiveCheckPeriod());

			if ( $shouldCheck ) {
				//Sanity check: Do not proceed if one of the critical classes is missing.
				//That can happen - theoretically and extremely rarely - if maybeCheckForUpdates()
				//is called before the old version of our plugin has been fully deleted, or
				//called from an independent AJAX request during deletion.
				if ( !(
					class_exists(Utils::class)
					&& class_exists(Metadata::class)
					&& class_exists(Plugin\Update::class)
					&& class_exists(Theme\Update::class)
				) ) {
					return;
				}
			}

			//Let plugin authors substitute their own algorithm.
			$shouldCheck = apply_filters(
				$this->updateChecker->getUniqueName('check_now'),
				$shouldCheck,
				$state->getLastCheck(),
				$this->checkPeriod
			);

			if ( $shouldCheck ) {
				$this->updateChecker->checkForUpdates();
			}
		}

		/**
		 * Calculate the actual check period based on the current status and environment.
		 *
		 * @return int Check period in seconds.
		 */
		protected function getEffectiveCheckPeriod() {
			$currentFilter = current_filter();
			if ( in_array($currentFilter, array('load-update-core.php', 'upgrader_process_complete')) ) {
				//Check more often when the user visits "Dashboard -> Updates" or does a bulk update.
				$period = 60;
			} else if ( in_array($currentFilter, $this->hourlyCheckHooks) ) {
				//Also check more often on /wp-admin/update.php and the "Plugins" or "Themes" page.
				$period = 3600;
			} else if ( $this->throttleRedundantChecks && ($this->updateChecker->getUpdate() !== null) ) {
				//Check less frequently if it's already known that an update is available.
				$period = $this->throttledCheckPeriod * 3600;
			} else if ( defined('DOING_CRON') && constant('DOING_CRON') ) {
				//WordPress cron schedules are not exact, so let's do an update check even
				//if slightly less than $checkPeriod hours have elapsed since the last check.
				$cronFuzziness = 20 * 60;
				$period = $this->checkPeriod * 3600 - $cronFuzziness;
			} else {
				$period = $this->checkPeriod * 3600;
			}

			return $period;
		}

		/**
		 * Add our custom schedule to the array of Cron schedules used by WP.
		 *
		 * @param array $schedules
		 * @return array
		 */
		public function _addCustomSchedule($schedules) {
			if ( $this->checkPeriod && ($this->checkPeriod > 0) ){
				$scheduleName = 'every' . $this->checkPeriod . 'hours';
				$schedules[$scheduleName] = array(
					'interval' => $this->checkPeriod * 3600,
					'display' => sprintf('Every %d hours', $this->checkPeriod),
				);
			}
			return $schedules;
		}

		/**
		 * Remove the scheduled cron event that the library uses to check for updates.
		 *
		 * @return void
		 */
		public function removeUpdaterCron() {
			wp_clear_scheduled_hook($this->cronHook);
		}

		/**
		 * Get the name of the update checker's WP-cron hook. Mostly useful for debugging.
		 *
		 * @return string
		 */
		public function getCronHookName() {
			return $this->cronHook;
		}

		/**
		 * Remove most hooks added by the scheduler.
		 */
		public function removeHooks() {
			remove_filter('cron_schedules', array($this, '_addCustomSchedule'));
			remove_action('admin_init', array($this, 'maybeCheckForUpdates'));
			remove_action('load-update-core.php', array($this, 'maybeCheckForUpdates'));

			if ( $this->cronHook !== null ) {
				remove_action($this->cronHook, array($this, 'maybeCheckForUpdates'));
			}
			if ( !empty($this->hourlyCheckHooks) ) {
				foreach ($this->hourlyCheckHooks as $hook) {
					remove_action($hook, array($this, 'maybeCheckForUpdates'));
				}
			}
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\StateStore.php (4972 bytes, 215 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6;

if ( !class_exists(StateStore::class, false) ):

	class StateStore {
		/**
		 * @var int Last update check timestamp.
		 */
		protected $lastCheck = 0;

		/**
		 * @var string Version number.
		 */
		protected $checkedVersion = '';

		/**
		 * @var Update|null Cached update.
		 */
		protected $update = null;

		/**
		 * @var string Site option name.
		 */
		private $optionName = '';

		/**
		 * @var bool Whether we've already tried to load the state from the database.
		 */
		private $isLoaded = false;

		public function __construct($optionName) {
			$this->optionName = $optionName;
		}

		/**
		 * Get time elapsed since the last update check.
		 *
		 * If there are no recorded update checks, this method returns a large arbitrary number
		 * (i.e. time since the Unix epoch).
		 *
		 * @return int Elapsed time in seconds.
		 */
		public function timeSinceLastCheck() {
			$this->lazyLoad();
			return time() - $this->lastCheck;
		}

		/**
		 * @return int
		 */
		public function getLastCheck() {
			$this->lazyLoad();
			return $this->lastCheck;
		}

		/**
		 * Set the time of the last update check to the current timestamp.
		 *
		 * @return $this
		 */
		public function setLastCheckToNow() {
			$this->lazyLoad();
			$this->lastCheck = time();
			return $this;
		}

		/**
		 * @return null|Update
		 */
		public function getUpdate() {
			$this->lazyLoad();
			return $this->update;
		}

		/**
		 * @param Update|null $update
		 * @return $this
		 */
		public function setUpdate($update = null) {
			$this->lazyLoad();
			$this->update = $update;
			return $this;
		}

		/**
		 * @return string
		 */
		public function getCheckedVersion() {
			$this->lazyLoad();
			return $this->checkedVersion;
		}

		/**
		 * @param string $version
		 * @return $this
		 */
		public function setCheckedVersion($version) {
			$this->lazyLoad();
			$this->checkedVersion = strval($version);
			return $this;
		}

		/**
		 * Get translation updates.
		 *
		 * @return array
		 */
		public function getTranslations() {
			$this->lazyLoad();
			if ( isset($this->update, $this->update->translations) ) {
				return $this->update->translations;
			}
			return array();
		}

		/**
		 * Set translation updates.
		 *
		 * @param array $translationUpdates
		 */
		public function setTranslations($translationUpdates) {
			$this->lazyLoad();
			if ( isset($this->update) ) {
				$this->update->translations = $translationUpdates;
				$this->save();
			}
		}

		public function save() {
			$state = new \stdClass();

			$state->lastCheck = $this->lastCheck;
			$state->checkedVersion = $this->checkedVersion;

			if ( isset($this->update)) {
				$state->update = $this->update->toStdClass();

				$updateClass = get_class($this->update);
				$state->updateClass = $updateClass;
				$prefix = $this->getLibPrefix();
				if ( Utils::startsWith($updateClass, $prefix) ) {
					$state->updateBaseClass = substr($updateClass, strlen($prefix));
				}
			}

			update_site_option($this->optionName, $state);
			$this->isLoaded = true;
		}

		/**
		 * @return $this
		 */
		public function lazyLoad() {
			if ( !$this->isLoaded ) {
				$this->load();
			}
			return $this;
		}

		protected function load() {
			$this->isLoaded = true;

			$state = get_site_option($this->optionName, null);

			if (
				!is_object($state)
				//Sanity check: If the Utils class is missing, the plugin is probably in the process
				//of being deleted (e.g. the old version gets deleted during an update).
				|| !class_exists(Utils::class)
			) {
				$this->lastCheck = 0;
				$this->checkedVersion = '';
				$this->update = null;
				return;
			}

			$this->lastCheck = intval(Utils::get($state, 'lastCheck', 0));
			$this->checkedVersion = Utils::get($state, 'checkedVersion', '');
			$this->update = null;

			if ( isset($state->update) ) {
				//This mess is due to the fact that the want the update class from this version
				//of the library, not the version that saved the update.

				$updateClass = null;
				if ( isset($state->updateBaseClass) ) {
					$updateClass = $this->getLibPrefix() . $state->updateBaseClass;
				} else if ( isset($state->updateClass) ) {
					$updateClass = $state->updateClass;
				}

				$factory = array($updateClass, 'fromObject');
				if ( ($updateClass !== null) && is_callable($factory) ) {
					$this->update = call_user_func($factory, $state->update);
				}
			}
		}

		public function delete() {
			delete_site_option($this->optionName);

			$this->lastCheck = 0;
			$this->checkedVersion = '';
			$this->update = null;
		}

		private function getLibPrefix() {
			//This assumes that the current class is at the top of the versioned namespace.
			return __NAMESPACE__ . '\\';
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Update.php (787 bytes, 39 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6;

use stdClass;

if ( !class_exists(Update::class, false) ):

	/**
	 * A simple container class for holding information about an available update.
	 *
	 * @author Janis Elsts
	 * @access public
	 */
	abstract class Update extends Metadata {
		public $slug;
		public $version;
		public $download_url;
		public $translations = array();

		/**
		 * @return string[]
		 */
		protected function getFieldNames() {
			return array('slug', 'version', 'download_url', 'translations');
		}

		public function toWpFormat() {
			$update = new stdClass();

			$update->slug = $this->slug;
			$update->new_version = $this->version;
			$update->package = $this->download_url;

			return $update;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\UpdateChecker.php (37442 bytes, 1142 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6;

use stdClass;
use WP_Error;

if ( !class_exists(UpdateChecker::class, false) ):

	abstract class UpdateChecker {
		protected $filterSuffix = '';
		protected $updateTransient = '';

		/**
		 * @var string This can be "plugin" or "theme".
		 */
		protected $componentType = '';
		/**
		 * @var string Currently the same as $componentType, but this is an implementation detail that
		 *             depends on how WP works internally, and could therefore change.
		 */
		protected $translationType = '';

		/**
		 * Set to TRUE to enable error reporting. Errors are raised using trigger_error()
		 * and should be logged to the standard PHP error log.
		 * @var bool
		 */
		public $debugMode = null;

		/**
		 * @var string Where to store the update info.
		 */
		public $optionName = '';

		/**
		 * @var string The URL of the metadata file.
		 */
		public $metadataUrl = '';

		/**
		 * @var string Plugin or theme directory name.
		 */
		public $directoryName = '';

		/**
		 * @var string The slug that will be used in update checker hooks and remote API requests.
		 * Usually matches the directory name unless the plugin/theme directory has been renamed.
		 */
		public $slug = '';

		/**
		 * @var InstalledPackage
		 */
		protected $package;

		/**
		 * @var Scheduler
		 */
		public $scheduler;

		/**
		 * @var UpgraderStatus
		 */
		protected $upgraderStatus;

		/**
		 * @var StateStore
		 */
		protected $updateState;

		/**
		 * @var array List of API errors triggered during the last checkForUpdates() call.
		 */
		protected $lastRequestApiErrors = array();

		/**
		 * @var string|mixed The default is 0 because parse_url() can return NULL or FALSE.
		 */
		protected $cachedMetadataHost = 0;

		/**
		 * @var DebugBar\Extension|null
		 */
		protected $debugBarExtension = null;

		/**
		 * @var WpCliCheckTrigger|null
		 */
		protected $wpCliCheckTrigger = null;

		public function __construct($metadataUrl, $directoryName, $slug = null, $checkPeriod = 12, $optionName = '') {
			$this->debugMode = (bool)(constant('WP_DEBUG'));
			$this->metadataUrl = $metadataUrl;
			$this->directoryName = $directoryName;
			$this->slug = !empty($slug) ? $slug : $this->directoryName;

			$this->optionName = $optionName;
			if ( empty($this->optionName) ) {
				//BC: Initially the library only supported plugin updates and didn't use type prefixes
				//in the option name. Lets use the same prefix-less name when possible.
				if ( $this->filterSuffix === '' ) {
					$this->optionName = 'external_updates-' . $this->slug;
				} else {
					$this->optionName = $this->getUniqueName('external_updates');
				}
			}

			if ( empty($this->translationType) ) {
				$this->translationType = $this->componentType;
			}

			$this->package = $this->createInstalledPackage();
			$this->scheduler = $this->createScheduler($checkPeriod);
			$this->upgraderStatus = new UpgraderStatus();
			$this->updateState = new StateStore($this->optionName);

			if ( did_action('init') ) {
				$this->loadTextDomain();
			} else {
				add_action('init', array($this, 'loadTextDomain'));
			}

			$this->installHooks();

			if ( ($this->wpCliCheckTrigger === null) && defined('WP_CLI') ) {
				$this->wpCliCheckTrigger = new WpCliCheckTrigger($this->componentType, $this->scheduler);
			}
		}

		/**
		 * @internal
		 */
		public function loadTextDomain() {
			//We're not using load_plugin_textdomain() or its siblings because figuring out where
			//the library is located (plugin, mu-plugin, theme, custom wp-content paths) is messy.
			$domain = 'plugin-update-checker';
			$locale = apply_filters(
				'plugin_locale',
				(is_admin() && function_exists('get_user_locale')) ? get_user_locale() : get_locale(),
				$domain
			);

			$moFile = $domain . '-' . $locale . '.mo';
			$path = realpath(dirname(__FILE__) . '/../../languages');

			if ($path && file_exists($path)) {
				load_textdomain($domain, $path . '/' . $moFile);
			}
		}

		protected function installHooks() {
			//Insert our update info into the update array maintained by WP.
			add_filter('site_transient_' . $this->updateTransient, array($this,'injectUpdate'));

			//Insert translation updates into the update list.
			add_filter('site_transient_' . $this->updateTransient, array($this, 'injectTranslationUpdates'));

			//Clear translation updates when WP clears the update cache.
			//This needs to be done directly because the library doesn't actually remove obsolete plugin updates,
			//it just hides them (see getUpdate()). We can't do that with translations - too much disk I/O.
			add_action(
				'delete_site_transient_' . $this->updateTransient,
				array($this, 'clearCachedTranslationUpdates')
			);

			//Rename the update directory to be the same as the existing directory.
			if ( $this->directoryName !== '.' ) {
				add_filter('upgrader_source_selection', array($this, 'fixDirectoryName'), 10, 3);
			}

			//Allow HTTP requests to the metadata URL even if it's on a local host.
			add_filter('http_request_host_is_external', array($this, 'allowMetadataHost'), 10, 2);

			//Potentially exclude information about this entity from core update check requests to api.wordpress.org.
			//phpcs:ignore WordPressVIPMinimum.Hooks.RestrictedHooks.http_request_args -- Doesn't modify timeouts.
			add_filter('http_request_args', array($this, 'excludeEntityFromWordPressAPI'), 10, 2);

			//DebugBar integration.
			if ( did_action('plugins_loaded') ) {
				$this->maybeInitDebugBar();
			} else {
				add_action('plugins_loaded', array($this, 'maybeInitDebugBar'));
			}
		}

		/**
		 * Remove hooks that were added by this update checker instance.
		 */
		public function removeHooks() {
			remove_filter('site_transient_' . $this->updateTransient, array($this,'injectUpdate'));
			remove_filter('site_transient_' . $this->updateTransient, array($this, 'injectTranslationUpdates'));
			remove_action(
				'delete_site_transient_' . $this->updateTransient,
				array($this, 'clearCachedTranslationUpdates')
			);

			remove_filter('upgrader_source_selection', array($this, 'fixDirectoryName'), 10);
			remove_filter('http_request_host_is_external', array($this, 'allowMetadataHost'), 10);
			remove_filter('http_request_args', array($this, 'excludeEntityFromWordPressAPI'));
			remove_action('plugins_loaded', array($this, 'maybeInitDebugBar'));

			remove_action('init', array($this, 'loadTextDomain'));

			if ( $this->scheduler ) {
				$this->scheduler->removeHooks();
			}

			if ( $this->debugBarExtension ) {
				$this->debugBarExtension->removeHooks();
			}
		}

		/**
		 * Check if the current user has the required permissions to install updates.
		 *
		 * @return bool
		 */
		abstract public function userCanInstallUpdates();

		/**
		 * Explicitly allow HTTP requests to the metadata URL.
		 *
		 * WordPress has a security feature where the HTTP API will reject all requests that are sent to
		 * another site hosted on the same server as the current site (IP match), a local host, or a local
		 * IP, unless the host exactly matches the current site.
		 *
		 * This feature is opt-in (at least in WP 4.4). Apparently some people enable it.
		 *
		 * That can be a problem when you're developing your plugin and you decide to host the update information
		 * on the same server as your test site. Update requests will mysteriously fail.
		 *
		 * We fix that by adding an exception for the metadata host.
		 *
		 * @param bool $allow
		 * @param string $host
		 * @return bool
		 */
		public function allowMetadataHost($allow, $host) {
			if ( $this->cachedMetadataHost === 0 ) {
				$this->cachedMetadataHost = wp_parse_url($this->metadataUrl, PHP_URL_HOST);
			}

			if ( is_string($this->cachedMetadataHost) && (strtolower($host) === strtolower($this->cachedMetadataHost)) ) {
				return true;
			}
			return $allow;
		}

		/**
		 * Create a package instance that represents this plugin or theme.
		 *
		 * @return InstalledPackage
		 */
		abstract protected function createInstalledPackage();

		/**
		 * @return InstalledPackage
		 */
		public function getInstalledPackage() {
			return $this->package;
		}

		/**
		 * Create an instance of the scheduler.
		 *
		 * This is implemented as a method to make it possible for plugins to subclass the update checker
		 * and substitute their own scheduler.
		 *
		 * @param int $checkPeriod
		 * @return Scheduler
		 */
		abstract protected function createScheduler($checkPeriod);

		/**
		 * Remove information about this plugin or theme from the requests that WordPress core sends
		 * to api.wordpress.org when checking for updates.
		 *
		 * @param array $args
		 * @param string $url
		 * @return array
		 */
		public function excludeEntityFromWordPressAPI($args, $url) {
			//Is this an api.wordpress.org update check request?
			$parsedUrl = wp_parse_url($url);
			if ( !isset($parsedUrl['host']) || (strtolower($parsedUrl['host']) !== 'api.wordpress.org') ) {
				return $args;
			}

			$typePluralised = $this->componentType . 's';
			$expectedPathPrefix = '/' . $typePluralised . '/update-check/1.';  //e.g. "/plugins/update-check/1.1/"
			if ( !isset($parsedUrl['path']) || !Utils::startsWith($parsedUrl['path'], $expectedPathPrefix) ) {
				return $args;
			}

			//Plugins and themes can disable this feature by using the filter below.
			if ( !apply_filters(
				$this->getUniqueName('remove_from_default_update_checks'),
				true, $this, $args, $url
			) ) {
				return $args;
			}

			if ( empty($args['body'][$typePluralised]) ) {
				return $args;
			}

			$reportingItems = json_decode($args['body'][$typePluralised], true);
			if ( $reportingItems === null ) {
				return $args;
			}

			//The list of installed items uses different key formats for plugins and themes.
			//Luckily, we can reuse the getUpdateListKey() method here.
			$updateListKey = $this->getUpdateListKey();
			if ( isset($reportingItems[$typePluralised][$updateListKey]) ) {
				unset($reportingItems[$typePluralised][$updateListKey]);
			}

			if ( !empty($reportingItems['active']) ) {
				if ( is_array($reportingItems['active']) ) {
					foreach ($reportingItems['active'] as $index => $relativePath) {
						if ( $relativePath === $updateListKey ) {
							unset($reportingItems['active'][$index]);
						}
					}
					//Re-index the array.
					$reportingItems['active'] = array_values($reportingItems['active']);
				} else if ( $reportingItems['active'] === $updateListKey ) {
					//For themes, the "active" field is a string that contains the theme's directory name.
					//Pretend that the default theme is active so that we don't reveal the actual theme.
					if ( defined('WP_DEFAULT_THEME') ) {
						$reportingItems['active'] = WP_DEFAULT_THEME;
					}

					//Unfortunately, it doesn't seem to be documented if we can safely remove the "active"
					//key. So when we don't know the default theme, we'll just leave it as is.
				}
			}

			$args['body'][$typePluralised] = wp_json_encode($reportingItems);
			return $args;
		}

		/**
		 * Check for updates. The results are stored in the DB option specified in $optionName.
		 *
		 * @return Update|null
		 */
		public function checkForUpdates() {
			$installedVersion = $this->getInstalledVersion();
			//Fail silently if we can't find the plugin/theme or read its header.
			if ( $installedVersion === null ) {
				$this->triggerError(
					sprintf('Skipping update check for %s - installed version unknown.', $this->slug),
					E_USER_WARNING
				);
				return null;
			}

			//Start collecting API errors.
			$this->lastRequestApiErrors = array();
			add_action('puc_api_error', array($this, 'collectApiErrors'), 10, 4);

			$state = $this->updateState;
			$state->setLastCheckToNow()
				->setCheckedVersion($installedVersion)
				->save(); //Save before checking in case something goes wrong

			$state->setUpdate($this->requestUpdate());
			$state->save();

			//Stop collecting API errors.
			remove_action('puc_api_error', array($this, 'collectApiErrors'), 10);

			return $this->getUpdate();
		}

		/**
		 * Load the update checker state from the DB.
		 *
		 * @return StateStore
		 */
		public function getUpdateState() {
			return $this->updateState->lazyLoad();
		}

		/**
		 * Reset update checker state - i.e. last check time, cached update data and so on.
		 *
		 * Call this when your plugin is being uninstalled, or if you want to
		 * clear the update cache.
		 */
		public function resetUpdateState() {
			$this->updateState->delete();
		}

		/**
		 * Get the details of the currently available update, if any.
		 *
		 * If no updates are available, or if the last known update version is below or equal
		 * to the currently installed version, this method will return NULL.
		 *
		 * Uses cached update data. To retrieve update information straight from
		 * the metadata URL, call requestUpdate() instead.
		 *
		 * @return Update|null
		 */
		public function getUpdate() {
			$update = $this->updateState->getUpdate();

			//Is there an update available?
			if ( isset($update) ) {
				//Check if the update is actually newer than the currently installed version.
				$installedVersion = $this->getInstalledVersion();
				if ( ($installedVersion !== null) && version_compare($update->version, $installedVersion, '>') ){
					return $update;
				}
			}
			return null;
		}

		/**
		 * Retrieve the latest update (if any) from the configured API endpoint.
		 *
		 * Subclasses should run the update through filterUpdateResult before returning it.
		 *
		 * @return Update An instance of Update, or NULL when no updates are available.
		 */
		abstract public function requestUpdate();

		/**
		 * Filter the result of a requestUpdate() call.
		 *
		 * @template T of Update
		 * @param T|null $update
		 * @param array|WP_Error|null $httpResult The value returned by wp_remote_get(), if any.
		 * @return T
		 */
		protected function filterUpdateResult($update, $httpResult = null) {
			//Let plugins/themes modify the update.
			$update = apply_filters($this->getUniqueName('request_update_result'), $update, $httpResult);

			$this->fixSupportedWordpressVersion($update);

			if ( isset($update, $update->translations) ) {
				//Keep only those translation updates that apply to this site.
				$update->translations = $this->filterApplicableTranslations($update->translations);
			}

			return $update;
		}

		/**
		 * The "Tested up to" field in the plugin metadata is supposed to be in the form of "major.minor",
		 * while WordPress core's list_plugin_updates() expects the $update->tested field to be an exact
		 * version, e.g. "major.minor.patch", to say it's compatible. In other case it shows
		 * "Compatibility: Unknown".
		 * The function mimics how wordpress.org API crafts the "tested" field out of "Tested up to".
		 *
		 * @param Metadata|null $update
		 */
		protected function fixSupportedWordpressVersion($update = null) {
			if ( !isset($update->tested) || !preg_match('/^\d++\.\d++$/', $update->tested) ) {
				return;
			}

			$actualWpVersions = array();

			$wpVersion = $GLOBALS['wp_version'];

			if ( function_exists('get_core_updates') ) {
				$coreUpdates = get_core_updates();
				if ( is_array($coreUpdates) ) {
					foreach ($coreUpdates as $coreUpdate) {
						if ( isset($coreUpdate->current) ) {
							$actualWpVersions[] = $coreUpdate->current;
						}
					}
				}
			}

			$actualWpVersions[] = $wpVersion;

			$actualWpPatchNumber = null;
			foreach ($actualWpVersions as $version) {
				if ( preg_match('/^(?P<majorMinor>\d++\.\d++)(?:\.(?P<patch>\d++))?/', $version, $versionParts) ) {
					if ( $versionParts['majorMinor'] === $update->tested ) {
						$patch = isset($versionParts['patch']) ? intval($versionParts['patch']) : 0;
						if ( $actualWpPatchNumber === null ) {
							$actualWpPatchNumber = $patch;
						} else {
							$actualWpPatchNumber = max($actualWpPatchNumber, $patch);
						}
					}
				}
			}
			if ( $actualWpPatchNumber === null ) {
				$actualWpPatchNumber = 999;
			}

			if ( $actualWpPatchNumber > 0 ) {
				$update->tested .= '.' . $actualWpPatchNumber;
			}
		}

		/**
		 * Get the currently installed version of the plugin or theme.
		 *
		 * @return string|null Version number.
		 */
		public function getInstalledVersion() {
			return $this->package->getInstalledVersion();
		}

		/**
		 * Get the full path of the plugin or theme directory.
		 *
		 * @return string
		 */
		public function getAbsoluteDirectoryPath() {
			return $this->package->getAbsoluteDirectoryPath();
		}

		/**
		 * Trigger a PHP error, but only when $debugMode is enabled.
		 *
		 * @param string $message
		 * @param int $errorType
		 */
		public function triggerError($message, $errorType) {
			if ( $this->isDebugModeEnabled() ) {
				//phpcs:ignore WordPress.PHP.DevelopmentFunctions.error_log_trigger_error -- Only happens in debug mode.
				trigger_error(esc_html($message), $errorType);
			}
		}

		/**
		 * @return bool
		 */
		protected function isDebugModeEnabled() {
			if ( $this->debugMode === null ) {
				$this->debugMode = (bool)(constant('WP_DEBUG'));
			}
			return $this->debugMode;
		}

		/**
		 * Get the full name of an update checker filter, action or DB entry.
		 *
		 * This method adds the "puc_" prefix and the "-$slug" suffix to the filter name.
		 * For example, "pre_inject_update" becomes "puc_pre_inject_update-plugin-slug".
		 *
		 * @param string $baseTag
		 * @return string
		 */
		public function getUniqueName($baseTag) {
			$name = 'puc_' . $baseTag;
			if ( $this->filterSuffix !== '' ) {
				$name .= '_' . $this->filterSuffix;
			}
			return $name . '-' . $this->slug;
		}

		/**
		 * Store API errors that are generated when checking for updates.
		 *
		 * @internal
		 * @param \WP_Error $error
		 * @param array|null $httpResponse
		 * @param string|null $url
		 * @param string|null $slug
		 */
		public function collectApiErrors($error, $httpResponse = null, $url = null, $slug = null) {
			if ( isset($slug) && ($slug !== $this->slug) ) {
				return;
			}

			$this->lastRequestApiErrors[] = array(
				'error'        => $error,
				'httpResponse' => $httpResponse,
				'url'          => $url,
			);
		}

		/**
		 * @return array
		 */
		public function getLastRequestApiErrors() {
			return $this->lastRequestApiErrors;
		}

		/* -------------------------------------------------------------------
		 * PUC filters and filter utilities
		 * -------------------------------------------------------------------
		 */

		/**
		 * Register a callback for one of the update checker filters.
		 *
		 * Identical to add_filter(), except it automatically adds the "puc_" prefix
		 * and the "-$slug" suffix to the filter name. For example, "request_info_result"
		 * becomes "puc_request_info_result-your_plugin_slug".
		 *
		 * @param string $tag
		 * @param callable $callback
		 * @param int $priority
		 * @param int $acceptedArgs
		 */
		public function addFilter($tag, $callback, $priority = 10, $acceptedArgs = 1) {
			add_filter($this->getUniqueName($tag), $callback, $priority, $acceptedArgs);
		}

		/* -------------------------------------------------------------------
		 * Inject updates
		 * -------------------------------------------------------------------
		 */

		/**
		 * Insert the latest update (if any) into the update list maintained by WP.
		 *
		 * @param \stdClass $updates Update list.
		 * @return \stdClass Modified update list.
		 */
		public function injectUpdate($updates) {
			//Is there an update to insert?
			$update = $this->getUpdate();

			if ( !$this->shouldShowUpdates() ) {
				$update = null;
			}

			if ( !empty($update) ) {
				//Let plugins filter the update info before it's passed on to WordPress.
				$update = apply_filters($this->getUniqueName('pre_inject_update'), $update);
				$updates = $this->addUpdateToList($updates, $update->toWpFormat());
			} else {
				//Clean up any stale update info.
				$updates = $this->removeUpdateFromList($updates);
				//Add a placeholder item to the "no_update" list to enable auto-update support.
				//If we don't do this, the option to enable automatic updates will only show up
				//when an update is available.
				$updates = $this->addNoUpdateItem($updates);
			}

			return $updates;
		}

		/**
		 * @param \stdClass|null $updates
		 * @param \stdClass|array $updateToAdd
		 * @return \stdClass
		 */
		protected function addUpdateToList($updates, $updateToAdd) {
			if ( !is_object($updates) ) {
				$updates = new stdClass();
				$updates->response = array();
			}

			$updates->response[$this->getUpdateListKey()] = $updateToAdd;
			return $updates;
		}

		/**
		 * @param \stdClass|null $updates
		 * @return \stdClass|null
		 */
		protected function removeUpdateFromList($updates) {
			if ( isset($updates, $updates->response) ) {
				unset($updates->response[$this->getUpdateListKey()]);
			}
			return $updates;
		}

		/**
		 * See this post for more information:
		 * @link https://make.wordpress.org/core/2020/07/30/recommended-usage-of-the-updates-api-to-support-the-auto-updates-ui-for-plugins-and-themes-in-wordpress-5-5/
		 *
		 * @param \stdClass|null $updates
		 * @return \stdClass
		 */
		protected function addNoUpdateItem($updates) {
			if ( !is_object($updates) ) {
				$updates = new stdClass();
				$updates->response = array();
				$updates->no_update = array();
			} else if ( !isset($updates->no_update) ) {
				$updates->no_update = array();
			}

			$updates->no_update[$this->getUpdateListKey()] = (object) $this->getNoUpdateItemFields();

			return $updates;
		}

		/**
		 * Subclasses should override this method to add fields that are specific to plugins or themes.
		 * @return array
		 */
		protected function getNoUpdateItemFields() {
			return array(
				'new_version'   => $this->getInstalledVersion(),
				'url'           => '',
				'package'       => '',
				'requires_php'  => '',
			);
		}

		/**
		 * Get the key that will be used when adding updates to the update list that's maintained
		 * by the WordPress core. The list is always an associative array, but the key is different
		 * for plugins and themes.
		 *
		 * @return string
		 */
		abstract protected function getUpdateListKey();

		/**
		 * Should we show available updates?
		 *
		 * Usually the answer is "yes", but there are exceptions. For example, WordPress doesn't
		 * support automatic updates installation for mu-plugins, so PUC usually won't show update
		 * notifications in that case. See the plugin-specific subclass for details.
		 *
		 * Note: This method only applies to updates that are displayed (or not) in the WordPress
		 * admin. It doesn't affect APIs like requestUpdate and getUpdate.
		 *
		 * @return bool
		 */
		protected function shouldShowUpdates() {
			return true;
		}

		/* -------------------------------------------------------------------
		 * JSON-based update API
		 * -------------------------------------------------------------------
		 */

		/**
		 * Retrieve plugin or theme metadata from the JSON document at $this->metadataUrl.
		 *
		 * @param class-string<Update> $metaClass Parse the JSON as an instance of this class. It must have a static fromJson method.
		 * @param string $filterRoot
		 * @param array $queryArgs Additional query arguments.
		 * @return array<Metadata|null, array|WP_Error> A metadata instance and the value returned by wp_remote_get().
		 */
		protected function requestMetadata($metaClass, $filterRoot, $queryArgs = array()) {
			//Query args to append to the URL. Plugins can add their own by using a filter callback (see addQueryArgFilter()).
			$queryArgs = array_merge(
				array(
					'installed_version' => strval($this->getInstalledVersion()),
					'php' => phpversion(),
					'locale' => get_locale(),
				),
				$queryArgs
			);
			$queryArgs = apply_filters($this->getUniqueName($filterRoot . '_query_args'), $queryArgs);

			//Various options for the wp_remote_get() call. Plugins can filter these, too.
			$options = array(
				'timeout' => wp_doing_cron() ? 10 : 3,
				'headers' => array(
					'Accept' => 'application/json',
				),
			);
			$options = apply_filters($this->getUniqueName($filterRoot . '_options'), $options);

			//The metadata file should be at 'http://your-api.com/url/here/$slug/info.json'
			$url = $this->metadataUrl;
			if ( !empty($queryArgs) ){
				$url = add_query_arg($queryArgs, $url);
			}

			$result = wp_remote_get($url, $options);

			$result = apply_filters($this->getUniqueName('request_metadata_http_result'), $result, $url, $options);

			//Try to parse the response
			$status = $this->validateApiResponse($result);
			$metadata = null;
			if ( !is_wp_error($status) ){
				if ( (strpos($metaClass, '\\') === false) ) {
					$metaClass = __NAMESPACE__ . '\\' . $metaClass;
				}
				$metadata = call_user_func(array($metaClass, 'fromJson'), $result['body']);
			} else {
				do_action('puc_api_error', $status, $result, $url, $this->slug);
				$this->triggerError(
					sprintf('The URL %s does not point to a valid metadata file. ', $url)
					. $status->get_error_message(),
					E_USER_WARNING
				);
			}

			return array($metadata, $result);
		}

		/**
		 * Check if $result is a successful update API response.
		 *
		 * @param array|WP_Error $result
		 * @return true|WP_Error
		 */
		protected function validateApiResponse($result) {
			if ( is_wp_error($result) ) { /** @var WP_Error $result */
				return new WP_Error($result->get_error_code(), 'WP HTTP Error: ' . $result->get_error_message());
			}

			if ( !isset($result['response']['code']) ) {
				return new WP_Error(
					'puc_no_response_code',
					'wp_remote_get() returned an unexpected result.'
				);
			}

			if ( $result['response']['code'] !== 200 ) {
				return new WP_Error(
					'puc_unexpected_response_code',
					'HTTP response code is ' . $result['response']['code'] . ' (expected: 200)'
				);
			}

			if ( empty($result['body']) ) {
				return new WP_Error('puc_empty_response', 'The metadata file appears to be empty.');
			}

			return true;
		}

		/* -------------------------------------------------------------------
		 * Language packs / Translation updates
		 * -------------------------------------------------------------------
		 */

		/**
		 * Filter a list of translation updates and return a new list that contains only updates
		 * that apply to the current site.
		 *
		 * @param array $translations
		 * @return array
		 */
		protected function filterApplicableTranslations($translations) {
			$languages = array_flip(array_values(get_available_languages()));
			$installedTranslations = $this->getInstalledTranslations();

			$applicableTranslations = array();
			foreach ($translations as $translation) {
				//Does it match one of the available core languages?
				$isApplicable = array_key_exists($translation->language, $languages);
				//Is it more recent than an already-installed translation?
				if ( isset($installedTranslations[$translation->language]) ) {
					$updateTimestamp = strtotime($translation->updated);
					$installedTimestamp = strtotime($installedTranslations[$translation->language]['PO-Revision-Date']);
					$isApplicable = $updateTimestamp > $installedTimestamp;
				}

				if ( $isApplicable ) {
					$applicableTranslations[] = $translation;
				}
			}

			return $applicableTranslations;
		}

		/**
		 * Get a list of installed translations for this plugin or theme.
		 *
		 * @return array
		 */
		protected function getInstalledTranslations() {
			if ( !function_exists('wp_get_installed_translations') ) {
				return array();
			}
			$installedTranslations = wp_get_installed_translations($this->translationType . 's');
			if ( isset($installedTranslations[$this->directoryName]) ) {
				$installedTranslations = $installedTranslations[$this->directoryName];
			} else {
				$installedTranslations = array();
			}
			return $installedTranslations;
		}

		/**
		 * Insert translation updates into the list maintained by WordPress.
		 *
		 * @param stdClass $updates
		 * @return stdClass
		 */
		public function injectTranslationUpdates($updates) {
			$translationUpdates = $this->getTranslationUpdates();
			if ( empty($translationUpdates) ) {
				return $updates;
			}

			//Being defensive.
			if ( !is_object($updates) ) {
				$updates = new stdClass();
			}
			if ( !isset($updates->translations) ) {
				$updates->translations = array();
			}

			//In case there's a name collision with a plugin or theme hosted on wordpress.org,
			//remove any preexisting updates that match our thing.
			$updates->translations = array_values(array_filter(
				$updates->translations,
				array($this, 'isNotMyTranslation')
			));

			//Add our updates to the list.
			foreach($translationUpdates as $update) {
				$convertedUpdate = array_merge(
					array(
						'type' => $this->translationType,
						'slug' => $this->directoryName,
						'autoupdate' => 0,
						//AFAICT, WordPress doesn't actually use the "version" field for anything.
						//But lets make sure it's there, just in case.
						'version' => isset($update->version) ? $update->version : ('1.' . strtotime($update->updated)),
					),
					(array)$update
				);

				$updates->translations[] = $convertedUpdate;
			}

			return $updates;
		}

		/**
		 * Get a list of available translation updates.
		 *
		 * This method will return an empty array if there are no updates.
		 * Uses cached update data.
		 *
		 * @return array
		 */
		public function getTranslationUpdates() {
			return $this->updateState->getTranslations();
		}

		/**
		 * Remove all cached translation updates.
		 *
		 * @see wp_clean_update_cache
		 */
		public function clearCachedTranslationUpdates() {
			$this->updateState->setTranslations(array());
		}

		/**
		 * Filter callback. Keeps only translations that *don't* match this plugin or theme.
		 *
		 * @param array $translation
		 * @return bool
		 */
		protected function isNotMyTranslation($translation) {
			$isMatch = isset($translation['type'], $translation['slug'])
				&& ($translation['type'] === $this->translationType)
				&& ($translation['slug'] === $this->directoryName);

			return !$isMatch;
		}

		/* -------------------------------------------------------------------
		 * Fix directory name when installing updates
		 * -------------------------------------------------------------------
		 */

		/**
		 * Rename the update directory to match the existing plugin/theme directory.
		 *
		 * When WordPress installs a plugin or theme update, it assumes that the ZIP file will contain
		 * exactly one directory, and that the directory name will be the same as the directory where
		 * the plugin or theme is currently installed.
		 *
		 * GitHub and other repositories provide ZIP downloads, but they often use directory names like
		 * "project-branch" or "project-tag-hash". We need to change the name to the actual plugin folder.
		 *
		 * This is a hook callback. Don't call it from a plugin.
		 *
		 * @access protected
		 *
		 * @param string $source The directory to copy to /wp-content/plugins or /wp-content/themes. Usually a subdirectory of $remoteSource.
		 * @param string $remoteSource WordPress has extracted the update to this directory.
		 * @param \WP_Upgrader $upgrader
		 * @return string|WP_Error
		 */
		public function fixDirectoryName($source, $remoteSource, $upgrader) {
			global $wp_filesystem;
			/** @var \WP_Filesystem_Base $wp_filesystem */

			//Basic sanity checks.
			if ( !isset($source, $remoteSource, $upgrader, $upgrader->skin, $wp_filesystem) ) {
				return $source;
			}

			//If WordPress is upgrading anything other than our plugin/theme, leave the directory name unchanged.
			if ( !$this->isBeingUpgraded($upgrader) ) {
				return $source;
			}

			//Fix the remote source structure if necessary.
			//The update archive should contain a single directory that contains the rest of plugin/theme files.
			//Otherwise, WordPress will try to copy the entire working directory ($source == $remoteSource).
			//We can't rename $remoteSource because that would break WordPress code that cleans up temporary files
			//after update.
			if ( $this->isBadDirectoryStructure($remoteSource) ) {
				//Create a new directory using the plugin slug.
				$newDirectory = trailingslashit($remoteSource) . $this->slug . '/';

				if ( !$wp_filesystem->is_dir($newDirectory) ) {
					$wp_filesystem->mkdir($newDirectory);

					//Move all files to the newly created directory.
					$sourceFiles = $wp_filesystem->dirlist($remoteSource);
					if ( is_array($sourceFiles) ) {
						$sourceFiles = array_keys($sourceFiles);
						$allMoved = true;
						foreach ($sourceFiles as $filename) {
							//Skip our newly created folder.
							if ( $filename === $this->slug ) {
								continue;
							}

							$previousSource = trailingslashit($remoteSource) . $filename;
							$newSource = trailingslashit($newDirectory) . $filename;

							if ( !$wp_filesystem->move($previousSource, $newSource, true) ) {
								$allMoved = false;
								break;
							}
						}

						if ( $allMoved ) {
							//Rename source.
							$source = $newDirectory;
						} else {
							//Delete our newly created folder including all files in it.
							$wp_filesystem->rmdir($newDirectory, true);

							//And return a relevant error.
							return new WP_Error(
								'puc-incorrect-directory-structure',
								sprintf(
									'The directory structure of the update was incorrect. All files should be inside ' .
									'a directory named <span class="code">%s</span>, not at the root of the ZIP archive. Plugin Update Checker tried to fix the directory structure, but failed.',
									esc_html($this->slug)
								)
							);
						}
					}
				}
			}

			//Rename the source to match the existing directory.
			$correctedSource = trailingslashit($remoteSource) . $this->directoryName . '/';
			if ( $source !== $correctedSource ) {
				$upgrader->skin->feedback(sprintf(
					'Renaming %s to %s&#8230;',
					'<span class="code">' . basename($source) . '</span>',
					'<span class="code">' . $this->directoryName . '</span>'
				));

				if ( $wp_filesystem->move($source, $correctedSource, true) ) {
					$upgrader->skin->feedback('Directory successfully renamed.');
					return $correctedSource;
				} else {
					return new WP_Error(
						'puc-rename-failed',
						'Unable to rename the update to match the existing directory.'
					);
				}
			}

			return $source;
		}

		/**
		 * Is there an update being installed right now, for this plugin or theme?
		 *
		 * @param \WP_Upgrader|null $upgrader The upgrader that's performing the current update.
		 * @return bool
		 */
		abstract public function isBeingUpgraded($upgrader = null);

		/**
		 * Check for incorrect update directory structure. An update must contain a single directory,
		 * all other files should be inside that directory.
		 *
		 * @param string $remoteSource Directory path.
		 * @return bool
		 */
		protected function isBadDirectoryStructure($remoteSource) {
			global $wp_filesystem;
			/** @var \WP_Filesystem_Base $wp_filesystem */

			$sourceFiles = $wp_filesystem->dirlist($remoteSource);
			if ( is_array($sourceFiles) ) {
				$sourceFiles = array_keys($sourceFiles);
				$firstFilePath = trailingslashit($remoteSource) . $sourceFiles[0];
				return (count($sourceFiles) > 1) || (!$wp_filesystem->is_dir($firstFilePath));
			}

			//Assume it's fine.
			return false;
		}

		/* -------------------------------------------------------------------
		 * DebugBar integration
		 * -------------------------------------------------------------------
		 */

		/**
		 * Initialize the update checker Debug Bar plugin/add-on thingy.
		 */
		public function maybeInitDebugBar() {
			if (
				class_exists('Debug_Bar', false)
				&& class_exists('Debug_Bar_Panel', false)
				&& file_exists(dirname(__FILE__) . '/DebugBar')
			) {
				$this->debugBarExtension = $this->createDebugBarExtension();
			}
		}

		protected function createDebugBarExtension() {
			return new DebugBar\Extension($this);
		}

		/**
		 * Display additional configuration details in the Debug Bar panel.
		 *
		 * @param DebugBar\Panel $panel
		 */
		public function onDisplayConfiguration($panel) {
			//Do nothing. Subclasses can use this to add additional info to the panel.
		}

	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\UpgraderStatus.php (7248 bytes, 201 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6;

if ( !class_exists(UpgraderStatus::class, false) ):

	/**
	 * A utility class that helps figure out which plugin or theme WordPress is upgrading.
	 *
	 * It may seem strange to have a separate class just for that, but the task is surprisingly complicated.
	 * Core classes like Plugin_Upgrader don't expose the plugin file name during an in-progress update (AFAICT).
	 * This class uses a few workarounds and heuristics to get the file name.
	 */
	class UpgraderStatus {
		private $currentType = null; //This must be either "plugin" or "theme".
		private $currentId = null;   //Plugin basename or theme directory name.

		public function __construct() {
			//Keep track of which plugin/theme WordPress is currently upgrading.
			add_filter('upgrader_pre_install', array($this, 'setUpgradedThing'), 10, 2);
			add_filter('upgrader_package_options', array($this, 'setUpgradedPluginFromOptions'), 10, 1);
			add_filter('upgrader_post_install', array($this, 'clearUpgradedThing'), 10, 1);
			add_action('upgrader_process_complete', array($this, 'clearUpgradedThing'), 10, 1);
		}

		/**
		 * Is there and update being installed RIGHT NOW, for a specific plugin?
		 *
		 * Caution: This method is unreliable. WordPress doesn't make it easy to figure out what it is upgrading,
		 * and upgrader implementations are liable to change without notice.
		 *
		 * @param string $pluginFile The plugin to check.
		 * @param \WP_Upgrader|null $upgrader The upgrader that's performing the current update.
		 * @return bool True if the plugin identified by $pluginFile is being upgraded.
		 */
		public function isPluginBeingUpgraded($pluginFile, $upgrader = null) {
			return $this->isBeingUpgraded('plugin', $pluginFile, $upgrader);
		}

		/**
		 * Is there an update being installed for a specific theme?
		 *
		 * @param string $stylesheet Theme directory name.
		 * @param \WP_Upgrader|null $upgrader The upgrader that's performing the current update.
		 * @return bool
		 */
		public function isThemeBeingUpgraded($stylesheet, $upgrader = null) {
			return $this->isBeingUpgraded('theme', $stylesheet, $upgrader);
		}

		/**
		 * Check if a specific theme or plugin is being upgraded.
		 *
		 * @param string $type
		 * @param string $id
		 * @param \Plugin_Upgrader|\WP_Upgrader|null $upgrader
		 * @return bool
		 */
		protected function isBeingUpgraded($type, $id, $upgrader = null) {
			if ( isset($upgrader) ) {
				list($currentType, $currentId) = $this->getThingBeingUpgradedBy($upgrader);
				if ( $currentType !== null ) {
					$this->currentType = $currentType;
					$this->currentId = $currentId;
				}
			}
			return ($this->currentType === $type) && ($this->currentId === $id);
		}

		/**
		 * Figure out which theme or plugin is being upgraded by a WP_Upgrader instance.
		 *
		 * Returns an array with two items. The first item is the type of the thing that's being
		 * upgraded: "plugin" or "theme". The second item is either the plugin basename or
		 * the theme directory name. If we can't determine what the upgrader is doing, both items
		 * will be NULL.
		 *
		 * Examples:
		 *      ['plugin', 'plugin-dir-name/plugin.php']
		 *      ['theme', 'theme-dir-name']
		 *
		 * @param \Plugin_Upgrader|\WP_Upgrader $upgrader
		 * @return array
		 */
		private function getThingBeingUpgradedBy($upgrader) {
			if ( !isset($upgrader, $upgrader->skin) ) {
				return array(null, null);
			}

			//Figure out which plugin or theme is being upgraded.
			$pluginFile = null;
			$themeDirectoryName = null;

			$skin = $upgrader->skin;
			if ( isset($skin->theme_info) && ($skin->theme_info instanceof \WP_Theme) ) {
				$themeDirectoryName = $skin->theme_info->get_stylesheet();
			} elseif ( $skin instanceof \Plugin_Upgrader_Skin ) {
				if ( isset($skin->plugin) && is_string($skin->plugin) && ($skin->plugin !== '') ) {
					$pluginFile = $skin->plugin;
				}
			} elseif ( $skin instanceof \Theme_Upgrader_Skin ) {
				if ( isset($skin->theme) && is_string($skin->theme) && ($skin->theme !== '') ) {
					$themeDirectoryName = $skin->theme;
				}
			} elseif ( isset($skin->plugin_info) && is_array($skin->plugin_info) ) {
				//This case is tricky because Bulk_Plugin_Upgrader_Skin (etc) doesn't actually store the plugin
				//filename anywhere. Instead, it has the plugin headers in $plugin_info. So the best we can
				//do is compare those headers to the headers of installed plugins.
				$pluginFile = $this->identifyPluginByHeaders($skin->plugin_info);
			}

			if ( $pluginFile !== null ) {
				return array('plugin', $pluginFile);
			} elseif ( $themeDirectoryName !== null ) {
				return array('theme', $themeDirectoryName);
			}
			return array(null, null);
		}

		/**
		 * Identify an installed plugin based on its headers.
		 *
		 * @param array $searchHeaders The plugin file header to look for.
		 * @return string|null Plugin basename ("foo/bar.php"), or NULL if we can't identify the plugin.
		 */
		private function identifyPluginByHeaders($searchHeaders) {
			if ( !function_exists('get_plugins') ){
				require_once( ABSPATH . '/wp-admin/includes/plugin.php' );
			}

			$installedPlugins = get_plugins();
			$matches = array();
			foreach($installedPlugins as $pluginBasename => $headers) {
				$diff1 = array_diff_assoc($headers, $searchHeaders);
				$diff2 = array_diff_assoc($searchHeaders, $headers);
				if ( empty($diff1) && empty($diff2) ) {
					$matches[] = $pluginBasename;
				}
			}

			//It's possible (though very unlikely) that there could be two plugins with identical
			//headers. In that case, we can't unambiguously identify the plugin that's being upgraded.
			if ( count($matches) !== 1 ) {
				return null;
			}

			return reset($matches);
		}

		/**
		 * @access private
		 *
		 * @param mixed $input
		 * @param array $hookExtra
		 * @return mixed Returns $input unaltered.
		 */
		public function setUpgradedThing($input, $hookExtra) {
			if ( !empty($hookExtra['plugin']) && is_string($hookExtra['plugin']) ) {
				$this->currentId = $hookExtra['plugin'];
				$this->currentType = 'plugin';
			} elseif ( !empty($hookExtra['theme']) && is_string($hookExtra['theme']) ) {
				$this->currentId = $hookExtra['theme'];
				$this->currentType = 'theme';
			} else {
				$this->currentType = null;
				$this->currentId = null;
			}
			return $input;
		}

		/**
		 * @access private
		 *
		 * @param array $options
		 * @return array
		 */
		public function setUpgradedPluginFromOptions($options) {
			if ( isset($options['hook_extra']['plugin']) && is_string($options['hook_extra']['plugin']) ) {
				$this->currentType = 'plugin';
				$this->currentId = $options['hook_extra']['plugin'];
			} else {
				$this->currentType = null;
				$this->currentId = null;
			}
			return $options;
		}

		/**
		 * @access private
		 *
		 * @param mixed $input
		 * @return mixed Returns $input unaltered.
		 */
		public function clearUpgradedThing($input = null) {
			$this->currentId = null;
			$this->currentType = null;
			return $input;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Utils.php (1965 bytes, 71 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6;

if ( !class_exists(Utils::class, false) ):

	class Utils {
		/**
		 * Get a value from a nested array or object based on a path.
		 *
		 * @param array|object|null $collection Get an entry from this array.
		 * @param array|string $path A list of array keys in hierarchy order, or a string path like "foo.bar.baz".
		 * @param mixed $default The value to return if the specified path is not found.
		 * @param string $separator Path element separator. Only applies to string paths.
		 * @return mixed
		 */
		public static function get($collection, $path, $default = null, $separator = '.') {
			if ( is_string($path) ) {
				$path = explode($separator, $path);
			}

			//Follow the $path into $input as far as possible.
			$currentValue = $collection;
			foreach ($path as $node) {
				if ( is_array($currentValue) && isset($currentValue[$node]) ) {
					$currentValue = $currentValue[$node];
				} else if ( is_object($currentValue) && isset($currentValue->$node) ) {
					$currentValue = $currentValue->$node;
				} else {
					return $default;
				}
			}

			return $currentValue;
		}

		/**
		 * Get the first array element that is not empty.
		 *
		 * @param array $values
		 * @param mixed|null $default Returns this value if there are no non-empty elements.
		 * @return mixed|null
		 */
		public static function findNotEmpty($values, $default = null) {
			if ( empty($values) ) {
				return $default;
			}

			foreach ($values as $value) {
				if ( !empty($value) ) {
					return $value;
				}
			}

			return $default;
		}

		/**
		 * Check if the input string starts with the specified prefix.
		 *
		 * @param string $input
		 * @param string $prefix
		 * @return bool
		 */
		public static function startsWith($input, $prefix) {
			$length = strlen($prefix);
			return (substr($input, 0, $length) === $prefix);
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\WpCliCheckTrigger.php (2667 bytes, 84 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6;

use WP_CLI;

/**
 * Triggers an update check when relevant WP-CLI commands are executed.
 *
 * When WP-CLI runs certain commands like "wp plugin status" or "wp theme list", it calls
 * wp_update_plugins() and wp_update_themes() to refresh update information. This class hooks into
 * the same commands and triggers an update check when they are executed.
 *
 * Note that wp_update_plugins() and wp_update_themes() do not perform an update check *every* time
 * they are called. They use a context-dependent delay between update checks. Similarly, this class
 * calls Scheduler::maybeCheckForUpdates(), which also dynamically decides whether to actually
 * run a check. If you want to force an update check, call UpdateChecker::checkForUpdates() instead.
 */
class WpCliCheckTrigger {
	/**
	 * @var Scheduler
	 */
	private $scheduler;

	/**
	 * @var string 'plugin' or 'theme'
	 */
	private $componentType;

	/**
	 * @var bool Whether an update check was already triggered during the current request
	 *           or script execution.
	 */
	private $wasCheckTriggered = false;

	public function __construct($componentType, Scheduler $scheduler) {
		if ( !in_array($componentType, ['plugin', 'theme']) ) {
			throw new \InvalidArgumentException('Invalid component type. Must be "plugin" or "theme".');
		}

		$this->componentType = $componentType;
		$this->scheduler = $scheduler;

		if ( !defined('WP_CLI') || !class_exists(WP_CLI::class, false) ) {
			return; //Nothing to do if WP-CLI is not available.
		}

		/*
		 * We can't hook directly into wp_update_plugins(), but we can hook into the WP-CLI
		 * commands that call it. We'll use the "before_invoke:xyz" hook to trigger update checks.
		 */
		foreach ($this->getRelevantCommands() as $command) {
			WP_CLI::add_hook('before_invoke:' . $command, [$this, 'triggerUpdateCheckOnce']);
		}
	}

	private function getRelevantCommands() {
		$result = [];
		foreach (['status', 'list', 'update'] as $subcommand) {
			$result[] = $this->componentType . ' ' . $subcommand;
		}
		return $result;
	}

	/**
	 * Trigger a potential update check once.
	 *
	 * @param mixed $input
	 * @return mixed The input value, unchanged.
	 * @internal This method is public so that it can be used as a WP-CLI hook callback.
	 *           It should not be called directly.
	 *
	 */
	public function triggerUpdateCheckOnce($input = null) {
		if ( $this->wasCheckTriggered ) {
			return $input;
		}

		$this->wasCheckTriggered = true;
		$this->scheduler->maybeCheckForUpdates();

		return $input;
	}
}
`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\DebugBar\Extension.php (6670 bytes, 200 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6\DebugBar;

use YahnisElsts\PluginUpdateChecker\v5p6\PucFactory;
use YahnisElsts\PluginUpdateChecker\v5p6\UpdateChecker;

if ( !class_exists(Extension::class, false) ):

	class Extension {
		const RESPONSE_BODY_LENGTH_LIMIT = 4000;

		/** @var UpdateChecker */
		protected $updateChecker;
		protected $panelClass = Panel::class;

		public function __construct($updateChecker, $panelClass = null) {
			$this->updateChecker = $updateChecker;
			if ( isset($panelClass) ) {
				$this->panelClass = $panelClass;
			}

			if ( (strpos($this->panelClass, '\\') === false) ) {
				$this->panelClass = __NAMESPACE__ . '\\' . $this->panelClass;
			}

			add_filter('debug_bar_panels', array($this, 'addDebugBarPanel'));
			add_action('debug_bar_enqueue_scripts', array($this, 'enqueuePanelDependencies'));

			add_action('wp_ajax_puc_v5_debug_check_now', array($this, 'ajaxCheckNow'));
		}

		/**
		 * Register the PUC Debug Bar panel.
		 *
		 * @param array $panels
		 * @return array
		 */
		public function addDebugBarPanel($panels) {
			if ( $this->updateChecker->userCanInstallUpdates() ) {
				$panels[] = new $this->panelClass($this->updateChecker);
			}
			return $panels;
		}

		/**
		 * Enqueue our Debug Bar scripts and styles.
		 */
		public function enqueuePanelDependencies() {
			wp_enqueue_style(
				'puc-debug-bar-style-v5',
				$this->getLibraryUrl("/css/puc-debug-bar.css"),
				array('debug-bar'),
				'20221008'
			);

			wp_enqueue_script(
				'puc-debug-bar-js-v5',
				$this->getLibraryUrl("/js/debug-bar.js"),
				array('jquery'),
				'20221008'
			);
		}

		/**
		 * Run an update check and output the result. Useful for making sure that
		 * the update checking process works as expected.
		 */
		public function ajaxCheckNow() {
			//phpcs:ignore WordPress.Security.NonceVerification.Missing -- Nonce is checked in preAjaxRequest().
			if ( !isset($_POST['uid']) || ($_POST['uid'] !== $this->updateChecker->getUniqueName('uid')) ) {
				return;
			}
			$this->preAjaxRequest();
			$update = $this->updateChecker->checkForUpdates();
			if ( $update !== null ) {
				echo "An update is available:";
				//phpcs:ignore WordPress.PHP.DevelopmentFunctions.error_log_print_r -- For debugging output.
				echo '<pre>', esc_html(print_r($update, true)), '</pre>';
			} else {
				echo 'No updates found.';
			}

			$errors = $this->updateChecker->getLastRequestApiErrors();
			if ( !empty($errors) ) {
				printf('<p>The update checker encountered %d API error%s.</p>', count($errors), (count($errors) > 1) ? 's' : '');

				foreach (array_values($errors) as $num => $item) {
					$wpError = $item['error'];
					/** @var \WP_Error $wpError */
					printf('<h4>%d) %s</h4>', intval($num + 1), esc_html($wpError->get_error_message()));

					echo '<dl>';
					printf('<dt>Error code:</dt><dd><code>%s</code></dd>', esc_html($wpError->get_error_code()));

					if ( isset($item['url']) ) {
						printf('<dt>Requested URL:</dt><dd><code>%s</code></dd>', esc_html($item['url']));
					}

					if ( isset($item['httpResponse']) ) {
						if ( is_wp_error($item['httpResponse']) ) {
							$httpError = $item['httpResponse'];
							/** @var \WP_Error $httpError */
							printf(
								'<dt>WordPress HTTP API error:</dt><dd>%s (<code>%s</code>)</dd>',
								esc_html($httpError->get_error_message()),
								esc_html($httpError->get_error_code())
							);
						} else {
							//Status code.
							printf(
								'<dt>HTTP status:</dt><dd><code>%d %s</code></dd>',
								esc_html(wp_remote_retrieve_response_code($item['httpResponse'])),
								esc_html(wp_remote_retrieve_response_message($item['httpResponse']))
							);

							//Headers.
							echo '<dt>Response headers:</dt><dd><pre>';
							foreach (wp_remote_retrieve_headers($item['httpResponse']) as $name => $value) {
								printf("%s: %s\n", esc_html($name), esc_html($value));
							}
							echo '</pre></dd>';

							//Body.
							$body = wp_remote_retrieve_body($item['httpResponse']);
							if ( $body === '' ) {
								$body = '(Empty response.)';
							} else if ( strlen($body) > self::RESPONSE_BODY_LENGTH_LIMIT ) {
								$length = strlen($body);
								$body = substr($body, 0, self::RESPONSE_BODY_LENGTH_LIMIT)
									. sprintf("\n(Long string truncated. Total length: %d bytes.)", $length);
							}

							printf('<dt>Response body:</dt><dd><pre>%s</pre></dd>', esc_html($body));
						}
					}
					echo '<dl>';
				}
			}

			exit;
		}

		/**
		 * Check access permissions and enable error display (for debugging).
		 */
		protected function preAjaxRequest() {
			if ( !$this->updateChecker->userCanInstallUpdates() ) {
				die('Access denied');
			}
			check_ajax_referer('puc-ajax');

			//phpcs:ignore WordPress.PHP.DiscouragedPHPFunctions.runtime_configuration_error_reporting -- Part of a debugging feature.
			error_reporting(E_ALL);
			//phpcs:ignore WordPress.PHP.IniSet.display_errors_Blacklisted
			@ini_set('display_errors', 'On');
		}

		/**
		 * Remove hooks that were added by this extension.
		 */
		public function removeHooks() {
			remove_filter('debug_bar_panels', array($this, 'addDebugBarPanel'));
			remove_action('debug_bar_enqueue_scripts', array($this, 'enqueuePanelDependencies'));
			remove_action('wp_ajax_puc_v5_debug_check_now', array($this, 'ajaxCheckNow'));
		}

		/**
		 * @param string $filePath
		 * @return string
		 */
		private function getLibraryUrl($filePath) {
			$absolutePath = realpath(dirname(__FILE__) . '/../../../' . ltrim($filePath, '/'));

			//Where is the library located inside the WordPress directory structure?
			$absolutePath = PucFactory::normalizePath($absolutePath);

			$pluginDir = PucFactory::normalizePath(WP_PLUGIN_DIR);
			$muPluginDir = PucFactory::normalizePath(WPMU_PLUGIN_DIR);
			$themeDir = PucFactory::normalizePath(get_theme_root());

			if ( (strpos($absolutePath, $pluginDir) === 0) || (strpos($absolutePath, $muPluginDir) === 0) ) {
				//It's part of a plugin.
				return plugins_url(basename($absolutePath), $absolutePath);
			} else if ( strpos($absolutePath, $themeDir) === 0 ) {
				//It's part of a theme.
				$relativePath = substr($absolutePath, strlen($themeDir) + 1);
				$template = substr($relativePath, 0, strpos($relativePath, '/'));
				$baseUrl = get_theme_root_uri($template);

				if ( !empty($baseUrl) && $relativePath ) {
					return $baseUrl . '/' . $relativePath;
				}
			}

			return '';
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\DebugBar\Panel.php (6053 bytes, 187 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6\DebugBar;

use YahnisElsts\PluginUpdateChecker\v5p6\UpdateChecker;

if ( !class_exists(Panel::class, false) && class_exists('Debug_Bar_Panel', false) ):

	class Panel extends \Debug_Bar_Panel {
		/** @var UpdateChecker */
		protected $updateChecker;

		private $responseBox = '<div class="puc-ajax-response" style="display: none;"></div>';

		public function __construct($updateChecker) {
			$this->updateChecker = $updateChecker;
			$title = sprintf(
				'<span class="puc-debug-menu-link-%s">PUC (%s)</span>',
				esc_attr($this->updateChecker->getUniqueName('uid')),
				$this->updateChecker->slug
			);
			parent::__construct($title);
		}

		public function render() {
			printf(
				'<div class="puc-debug-bar-panel-v5" id="%1$s" data-slug="%2$s" data-uid="%3$s" data-nonce="%4$s">',
				esc_attr($this->updateChecker->getUniqueName('debug-bar-panel')),
				esc_attr($this->updateChecker->slug),
				esc_attr($this->updateChecker->getUniqueName('uid')),
				esc_attr(wp_create_nonce('puc-ajax'))
			);

			$this->displayConfiguration();
			$this->displayStatus();
			$this->displayCurrentUpdate();

			echo '</div>';
		}

		private function displayConfiguration() {
			echo '<h3>Configuration</h3>';
			echo '<table class="puc-debug-data">';
			$this->displayConfigHeader();
			$this->row('Slug', esc_html($this->updateChecker->slug));
			$this->row('DB option', esc_html($this->updateChecker->optionName));

			$requestInfoButton = $this->getMetadataButton();
			$this->row('Metadata URL', esc_html($this->updateChecker->metadataUrl) . ' ' . $requestInfoButton . $this->responseBox);

			$scheduler = $this->updateChecker->scheduler;
			if ( $scheduler->checkPeriod > 0 ) {
				$this->row('Automatic checks', 'Every ' . $scheduler->checkPeriod . ' hours');
			} else {
				$this->row('Automatic checks', 'Disabled');
			}

			if ( isset($scheduler->throttleRedundantChecks) ) {
				if ( $scheduler->throttleRedundantChecks && ($scheduler->checkPeriod > 0) ) {
					$this->row(
						'Throttling',
						sprintf(
							'Enabled. If an update is already available, check for updates every %1$d hours instead of every %2$d hours.',
							$scheduler->throttledCheckPeriod,
							$scheduler->checkPeriod
						)
					);
				} else {
					$this->row('Throttling', 'Disabled');
				}
			}

			$this->updateChecker->onDisplayConfiguration($this);

			echo '</table>';
		}

		protected function displayConfigHeader() {
			//Do nothing. This should be implemented in subclasses.
		}

		protected function getMetadataButton() {
			return '';
		}

		private function displayStatus() {
			echo '<h3>Status</h3>';
			echo '<table class="puc-debug-data">';
			$state = $this->updateChecker->getUpdateState();
			$checkButtonId = $this->updateChecker->getUniqueName('check-now-button');
			if ( function_exists('get_submit_button')  ) {
				$checkNowButton = get_submit_button(
					'Check Now',
					'secondary',
					'puc-check-now-button',
					false,
					array('id' => $checkButtonId)
				);
			} else {
				//get_submit_button() is not available in the frontend. Make a button directly.
				//It won't look the same without admin styles, but it should still work.
				$checkNowButton = sprintf(
					'<input type="button" id="%1$s" name="puc-check-now-button" value="%2$s" class="button button-secondary" />',
					esc_attr($checkButtonId),
					esc_attr('Check Now')
				);
			}

			if ( $state->getLastCheck() > 0 ) {
				$this->row('Last check', $this->formatTimeWithDelta($state->getLastCheck()) . ' ' . $checkNowButton . $this->responseBox);
			} else {
				$this->row('Last check', 'Never');
			}

			$nextCheck = wp_next_scheduled($this->updateChecker->scheduler->getCronHookName());
			$this->row('Next automatic check', $this->formatTimeWithDelta($nextCheck));

			if ( $state->getCheckedVersion() !== '' ) {
				$this->row('Checked version', esc_html($state->getCheckedVersion()));
				$this->row('Cached update', $state->getUpdate());
			}
			$this->row('Update checker class', esc_html(get_class($this->updateChecker)));
			echo '</table>';
		}

		private function displayCurrentUpdate() {
			$update = $this->updateChecker->getUpdate();
			if ( $update !== null ) {
				echo '<h3>An Update Is Available</h3>';
				echo '<table class="puc-debug-data">';
				$fields = $this->getUpdateFields();
				foreach($fields as $field) {
					if ( property_exists($update, $field) ) {
						$this->row(
							ucwords(str_replace('_', ' ', $field)),
							isset($update->$field) ? esc_html($update->$field) : null
						);
					}
				}
				echo '</table>';
			} else {
				echo '<h3>No updates currently available</h3>';
			}
		}

		protected function getUpdateFields() {
			return array('version', 'download_url', 'slug',);
		}

		private function formatTimeWithDelta($unixTime) {
			if ( empty($unixTime) ) {
				return 'Never';
			}

			$delta = time() - $unixTime;
			$result = human_time_diff(time(), $unixTime);
			if ( $delta < 0 ) {
				$result = 'after ' . $result;
			} else {
				$result = $result . ' ago';
			}
			$result .= ' (' . $this->formatTimestamp($unixTime) . ')';
			return $result;
		}

		private function formatTimestamp($unixTime) {
			return gmdate('Y-m-d H:i:s', $unixTime + (get_option('gmt_offset') * 3600));
		}

		public function row($name, $value) {
			if ( is_object($value) || is_array($value) ) {
				//This is specifically for debugging, so print_r() is fine.
				//phpcs:ignore WordPress.PHP.DevelopmentFunctions.error_log_print_r
				$value = '<pre>' . esc_html(print_r($value, true)) . '</pre>';
			} else if ($value === null) {
				$value = '<code>null</code>';
			}
			printf(
				'<tr><th scope="row">%1$s</th> <td>%2$s</td></tr>',
				esc_html($name),
				//phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped -- Escaped above.
				$value
			);
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\DebugBar\PluginExtension.php (1270 bytes, 41 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\DebugBar;

use YahnisElsts\PluginUpdateChecker\v5p6\Plugin\UpdateChecker;

if ( !class_exists(PluginExtension::class, false) ):

	class PluginExtension extends Extension {
		/** @var UpdateChecker */
		protected $updateChecker;

		public function __construct($updateChecker) {
			parent::__construct($updateChecker, PluginPanel::class);

			add_action('wp_ajax_puc_v5_debug_request_info', array($this, 'ajaxRequestInfo'));
		}

		/**
		 * Request plugin info and output it.
		 */
		public function ajaxRequestInfo() {
			//phpcs:ignore WordPress.Security.NonceVerification.Missing -- Nonce is checked in preAjaxRequest().
			if ( !isset($_POST['uid']) || ($_POST['uid'] !== $this->updateChecker->getUniqueName('uid')) ) {
				return;
			}
			$this->preAjaxRequest();
			$info = $this->updateChecker->requestInfo();
			if ( $info !== null ) {
				echo 'Successfully retrieved plugin info from the metadata URL:';
				//phpcs:ignore WordPress.PHP.DevelopmentFunctions.error_log_print_r -- For debugging output.
				echo '<pre>', esc_html(print_r($info, true)), '</pre>';
			} else {
				echo 'Failed to retrieve plugin info from the metadata URL.';
			}
			exit;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\DebugBar\PluginPanel.php (1248 bytes, 48 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6\DebugBar;

use YahnisElsts\PluginUpdateChecker\v5p6\Plugin\UpdateChecker;

if ( !class_exists(PluginPanel::class, false) ):

	class PluginPanel extends Panel {
		/**
		 * @var UpdateChecker
		 */
		protected $updateChecker;

		protected function displayConfigHeader() {
			$this->row('Plugin file', esc_html($this->updateChecker->pluginFile));
			parent::displayConfigHeader();
		}

		protected function getMetadataButton() {
			$buttonId = $this->updateChecker->getUniqueName('request-info-button');
			if ( function_exists('get_submit_button') ) {
				$requestInfoButton = get_submit_button(
					'Request Info',
					'secondary',
					'puc-request-info-button',
					false,
					array('id' => $buttonId)
				);
			} else {
				$requestInfoButton = sprintf(
					'<input type="button" name="puc-request-info-button" id="%1$s" value="%2$s" class="button button-secondary" />',
					esc_attr($buttonId),
					esc_attr('Request Info')
				);
			}
			return $requestInfoButton;
		}

		protected function getUpdateFields() {
			return array_merge(
				parent::getUpdateFields(),
				array('homepage', 'upgrade_notice', 'tested',)
			);
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\DebugBar\ThemePanel.php (594 bytes, 26 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\DebugBar;

use YahnisElsts\PluginUpdateChecker\v5p6\Theme\UpdateChecker;

if ( !class_exists(ThemePanel::class, false) ):

	class ThemePanel extends Panel {
		/**
		 * @var UpdateChecker
		 */
		protected $updateChecker;

		protected function displayConfigHeader() {
			$this->row('Theme directory', esc_html($this->updateChecker->directoryName));
			parent::displayConfigHeader();
		}

		protected function getUpdateFields() {
			return array_merge(parent::getUpdateFields(), array('details_url'));
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Plugin\Package.php (5735 bytes, 189 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6\Plugin;

use YahnisElsts\PluginUpdateChecker\v5p6\InstalledPackage;
use YahnisElsts\PluginUpdateChecker\v5p6\PucFactory;

if ( !class_exists(Package::class, false) ):

	class Package extends InstalledPackage {
		/**
		 * @var UpdateChecker
		 */
		protected $updateChecker;

		/**
		 * @var string Full path of the main plugin file.
		 */
		protected $pluginAbsolutePath = '';

		/**
		 * @var string Plugin basename.
		 */
		private $pluginFile;

		/**
		 * @var string|null
		 */
		private $cachedInstalledVersion = null;

		public function __construct($pluginAbsolutePath, $updateChecker) {
			$this->pluginAbsolutePath = $pluginAbsolutePath;
			$this->pluginFile = plugin_basename($this->pluginAbsolutePath);

			parent::__construct($updateChecker);

			//Clear the version number cache when something - anything - is upgraded or WP clears the update cache.
			add_filter('upgrader_post_install', array($this, 'clearCachedVersion'));
			add_action('delete_site_transient_update_plugins', array($this, 'clearCachedVersion'));
		}

		public function getInstalledVersion() {
			if ( isset($this->cachedInstalledVersion) ) {
				return $this->cachedInstalledVersion;
			}

			$pluginHeader = $this->getPluginHeader();
			if ( isset($pluginHeader['Version']) ) {
				$this->cachedInstalledVersion = $pluginHeader['Version'];
				return $pluginHeader['Version'];
			} else {
				//This can happen if the filename points to something that is not a plugin.
				$this->updateChecker->triggerError(
					sprintf(
						"Cannot read the Version header for '%s'. The filename is incorrect or is not a plugin.",
						$this->updateChecker->pluginFile
					),
					E_USER_WARNING
				);
				return null;
			}
		}

		/**
		 * Clear the cached plugin version. This method can be set up as a filter (hook) and will
		 * return the filter argument unmodified.
		 *
		 * @param mixed $filterArgument
		 * @return mixed
		 */
		public function clearCachedVersion($filterArgument = null) {
			$this->cachedInstalledVersion = null;
			return $filterArgument;
		}

		public function getAbsoluteDirectoryPath() {
			return dirname($this->pluginAbsolutePath);
		}

		/**
		 * Get the value of a specific plugin or theme header.
		 *
		 * @param string $headerName
		 * @param string $defaultValue
		 * @return string Either the value of the header, or $defaultValue if the header doesn't exist or is empty.
		 */
		public function getHeaderValue($headerName, $defaultValue = '') {
			$headers = $this->getPluginHeader();
			if ( isset($headers[$headerName]) && ($headers[$headerName] !== '') ) {
				return $headers[$headerName];
			}
			return $defaultValue;
		}

		protected function getHeaderNames() {
			return array(
				'Name'              => 'Plugin Name',
				'PluginURI'         => 'Plugin URI',
				'Version'           => 'Version',
				'Description'       => 'Description',
				'Author'            => 'Author',
				'AuthorURI'         => 'Author URI',
				'TextDomain'        => 'Text Domain',
				'DomainPath'        => 'Domain Path',
				'Network'           => 'Network',

				//The newest WordPress version that this plugin requires or has been tested with.
				//We support several different formats for compatibility with other libraries.
				'Tested WP'         => 'Tested WP',
				'Requires WP'       => 'Requires WP',
				'Tested up to'      => 'Tested up to',
				'Requires at least' => 'Requires at least',
			);
		}

		/**
		 * Get the translated plugin title.
		 *
		 * @return string
		 */
		public function getPluginTitle() {
			$title = '';
			$header = $this->getPluginHeader();
			if ( $header && !empty($header['Name']) && isset($header['TextDomain']) ) {
				$title = translate($header['Name'], $header['TextDomain']);
			}
			return $title;
		}

		/**
		 * Get plugin's metadata from its file header.
		 *
		 * @return array
		 */
		public function getPluginHeader() {
			if ( !is_file($this->pluginAbsolutePath) ) {
				//This can happen if the plugin filename is wrong.
				$this->updateChecker->triggerError(
					sprintf(
						"Can't to read the plugin header for '%s'. The file does not exist.",
						$this->updateChecker->pluginFile
					),
					E_USER_WARNING
				);
				return array();
			}

			if ( !function_exists('get_plugin_data') ) {
				require_once(ABSPATH . '/wp-admin/includes/plugin.php');
			}
			return get_plugin_data($this->pluginAbsolutePath, false, false);
		}

		public function removeHooks() {
			remove_filter('upgrader_post_install', array($this, 'clearCachedVersion'));
			remove_action('delete_site_transient_update_plugins', array($this, 'clearCachedVersion'));
		}

		/**
		 * Check if the plugin file is inside the mu-plugins directory.
		 *
		 * @return bool
		 */
		public function isMuPlugin() {
			static $cachedResult = null;

			if ( $cachedResult === null ) {
				if ( !defined('WPMU_PLUGIN_DIR') || !is_string(WPMU_PLUGIN_DIR) ) {
					$cachedResult = false;
					return $cachedResult;
				}

				//Convert both paths to the canonical form before comparison.
				$muPluginDir = realpath(WPMU_PLUGIN_DIR);
				$pluginPath  = realpath($this->pluginAbsolutePath);
				//If realpath() fails, just normalize the syntax instead.
				if (($muPluginDir === false) || ($pluginPath === false)) {
					$muPluginDir = PucFactory::normalizePath(WPMU_PLUGIN_DIR);
					$pluginPath  = PucFactory::normalizePath($this->pluginAbsolutePath);
				}

				$cachedResult = (strpos($pluginPath, $muPluginDir) === 0);
			}

			return $cachedResult;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Plugin\PluginInfo.php (3973 bytes, 137 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6\Plugin;

use YahnisElsts\PluginUpdateChecker\v5p6\Metadata;

if ( !class_exists(PluginInfo::class, false) ):

	/**
	 * A container class for holding and transforming various plugin metadata.
	 *
	 * @author Janis Elsts
	 * @copyright 2016
	 * @access public
	 */
	class PluginInfo extends Metadata {
		//Most fields map directly to the contents of the plugin's info.json file.
		//See the relevant docs for a description of their meaning.
		public $name;
		public $slug;
		public $version;
		public $homepage;
		public $sections = array();
		public $download_url;

		public $banners;
		public $icons = array();
		public $translations = array();

		public $author;
		public $author_homepage;

		public $requires;
		public $tested;
		public $requires_php;
		public $upgrade_notice;

		public $rating;
		public $num_ratings;
		public $downloaded;
		public $active_installs;
		public $last_updated;

		public $id = 0; //The native WP.org API returns numeric plugin IDs, but they're not used for anything.

		public $filename; //Plugin filename relative to the plugins directory.

		/**
		 * Create a new instance of Plugin Info from JSON-encoded plugin info
		 * returned by an external update API.
		 *
		 * @param string $json Valid JSON string representing plugin info.
		 * @return self|null New instance of Plugin Info, or NULL on error.
		 */
		public static function fromJson($json){
			$instance = new self();

			if ( !parent::createFromJson($json, $instance) ) {
				return null;
			}

			//json_decode decodes assoc. arrays as objects. We want them as arrays.
			$instance->sections = (array)$instance->sections;
			$instance->icons = (array)$instance->icons;

			return $instance;
		}

		/**
		 * Very, very basic validation.
		 *
		 * @param \StdClass $apiResponse
		 * @return bool|\WP_Error
		 */
		protected function validateMetadata($apiResponse) {
			if (
				!isset($apiResponse->name, $apiResponse->version)
				|| empty($apiResponse->name)
				|| empty($apiResponse->version)
			) {
				return new \WP_Error(
					'puc-invalid-metadata',
					"The plugin metadata file does not contain the required 'name' and/or 'version' keys."
				);
			}
			return true;
		}


		/**
		 * Transform plugin info into the format used by the native WordPress.org API
		 *
		 * @return object
		 */
		public function toWpFormat(){
			$info = new \stdClass;

			//The custom update API is built so that many fields have the same name and format
			//as those returned by the native WordPress.org API. These can be assigned directly.
			$sameFormat = array(
				'name', 'slug', 'version', 'requires', 'tested', 'rating', 'upgrade_notice',
				'num_ratings', 'downloaded', 'active_installs', 'homepage', 'last_updated',
				'requires_php',
			);
			foreach($sameFormat as $field){
				if ( isset($this->$field) ) {
					$info->$field = $this->$field;
				} else {
					$info->$field = null;
				}
			}

			//Other fields need to be renamed and/or transformed.
			$info->download_link = $this->download_url;
			$info->author = $this->getFormattedAuthor();
			$info->sections = array_merge(array('description' => ''), $this->sections);

			if ( !empty($this->banners) ) {
				//WP expects an array with two keys: "high" and "low". Both are optional.
				//Docs: https://wordpress.org/plugins/about/faq/#banners
				$info->banners = is_object($this->banners) ? get_object_vars($this->banners) : $this->banners;
				$info->banners = array_intersect_key($info->banners, array('high' => true, 'low' => true));
			}

			return $info;
		}

		protected function getFormattedAuthor() {
			if ( !empty($this->author_homepage) ){
				/** @noinspection HtmlUnknownTarget */
				return sprintf('<a href="%s">%s</a>', $this->author_homepage, $this->author);
			}
			return $this->author;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Plugin\Ui.php (10719 bytes, 295 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6\Plugin;

if ( !class_exists(Ui::class, false) ):
	/**
	 * Additional UI elements for plugins.
	 */
	class Ui {
		private $updateChecker;
		private $manualCheckErrorTransient = '';

		/**
		 * @param UpdateChecker $updateChecker
		 */
		public function __construct($updateChecker) {
			$this->updateChecker = $updateChecker;
			$this->manualCheckErrorTransient = $this->updateChecker->getUniqueName('manual_check_errors');

			add_action('admin_init', array($this, 'onAdminInit'));
		}

		public function onAdminInit() {
			if ( $this->updateChecker->userCanInstallUpdates() ) {
				$this->handleManualCheck();

				add_filter('plugin_row_meta', array($this, 'addViewDetailsLink'), 10, 3);
				add_filter('plugin_row_meta', array($this, 'addCheckForUpdatesLink'), 10, 2);
				add_action('all_admin_notices', array($this, 'displayManualCheckResult'));
			}
		}

		/**
		 * Add a "View Details" link to the plugin row in the "Plugins" page. By default,
		 * the new link will appear before the "Visit plugin site" link (if present).
		 *
		 * You can change the link text by using the "puc_view_details_link-$slug" filter.
		 * Returning an empty string from the filter will disable the link.
		 *
		 * You can change the position of the link using the
		 * "puc_view_details_link_position-$slug" filter.
		 * Returning 'before' or 'after' will place the link immediately before/after
		 * the "Visit plugin site" link.
		 * Returning 'append' places the link after any existing links at the time of the hook.
		 * Returning 'replace' replaces the "Visit plugin site" link.
		 * Returning anything else disables the link when there is a "Visit plugin site" link.
		 *
		 * If there is no "Visit plugin site" link 'append' is always used!
		 *
		 * @param array $pluginMeta Array of meta links.
		 * @param string $pluginFile
		 * @param array $pluginData Array of plugin header data.
		 * @return array
		 */
		public function addViewDetailsLink($pluginMeta, $pluginFile, $pluginData = array()) {
			if ( $this->isMyPluginFile($pluginFile) && !isset($pluginData['slug']) ) {
				$linkText = apply_filters($this->updateChecker->getUniqueName('view_details_link'), __('View details'));
				if ( !empty($linkText) ) {
					$viewDetailsLinkPosition = 'append';

					//Find the "Visit plugin site" link (if present).
					$visitPluginSiteLinkIndex = count($pluginMeta) - 1;
					if ( $pluginData['PluginURI'] ) {
						$escapedPluginUri = esc_url($pluginData['PluginURI']);
						foreach ($pluginMeta as $linkIndex => $existingLink) {
							if ( strpos($existingLink, $escapedPluginUri) !== false ) {
								$visitPluginSiteLinkIndex = $linkIndex;
								$viewDetailsLinkPosition = apply_filters(
									$this->updateChecker->getUniqueName('view_details_link_position'),
									'before'
								);
								break;
							}
						}
					}

					$viewDetailsLink = sprintf('<a href="%s" class="thickbox open-plugin-details-modal" aria-label="%s" data-title="%s">%s</a>',
						esc_url(network_admin_url('plugin-install.php?tab=plugin-information&plugin=' . urlencode($this->updateChecker->slug) .
							'&TB_iframe=true&width=600&height=550')),
						esc_attr(sprintf(__('More information about %s'), $pluginData['Name'])),
						esc_attr($pluginData['Name']),
						$linkText
					);
					switch ($viewDetailsLinkPosition) {
						case 'before':
							array_splice($pluginMeta, $visitPluginSiteLinkIndex, 0, $viewDetailsLink);
							break;
						case 'after':
							array_splice($pluginMeta, $visitPluginSiteLinkIndex + 1, 0, $viewDetailsLink);
							break;
						case 'replace':
							$pluginMeta[$visitPluginSiteLinkIndex] = $viewDetailsLink;
							break;
						case 'append':
						default:
							$pluginMeta[] = $viewDetailsLink;
							break;
					}
				}
			}
			return $pluginMeta;
		}

		/**
		 * Add a "Check for updates" link to the plugin row in the "Plugins" page. By default,
		 * the new link will appear after the "Visit plugin site" link if present, otherwise
		 * after the "View plugin details" link.
		 *
		 * You can change the link text by using the "puc_manual_check_link-$slug" filter.
		 * Returning an empty string from the filter will disable the link.
		 *
		 * @param array $pluginMeta Array of meta links.
		 * @param string $pluginFile
		 * @return array
		 */
		public function addCheckForUpdatesLink($pluginMeta, $pluginFile) {
			if ( $this->isMyPluginFile($pluginFile) ) {
				$linkUrl = wp_nonce_url(
					add_query_arg(
						array(
							'puc_check_for_updates' => 1,
							'puc_slug'              => $this->updateChecker->slug,
						),
						self_admin_url('plugins.php')
					),
					'puc_check_for_updates'
				);

				$linkText = apply_filters(
					$this->updateChecker->getUniqueName('manual_check_link'),
					__('Check for updates', 'plugin-update-checker')
				);
				if ( !empty($linkText) ) {
					/** @noinspection HtmlUnknownTarget */
					$pluginMeta[] = sprintf('<a href="%s">%s</a>', esc_attr($linkUrl), $linkText);
				}
			}
			return $pluginMeta;
		}

		protected function isMyPluginFile($pluginFile) {
			return ($pluginFile == $this->updateChecker->pluginFile)
				|| (!empty($this->updateChecker->muPluginFile) && ($pluginFile == $this->updateChecker->muPluginFile));
		}

		/**
		 * Check for updates when the user clicks the "Check for updates" link.
		 *
		 * @see self::addCheckForUpdatesLink()
		 *
		 * @return void
		 */
		public function handleManualCheck() {
			$shouldCheck =
				isset($_GET['puc_check_for_updates'], $_GET['puc_slug'])
				&& $_GET['puc_slug'] == $this->updateChecker->slug
				&& check_admin_referer('puc_check_for_updates');

			if ( $shouldCheck ) {
				$update = $this->updateChecker->checkForUpdates();
				$status = ($update === null) ? 'no_update' : 'update_available';
				$lastRequestApiErrors = $this->updateChecker->getLastRequestApiErrors();

				if ( ($update === null) && !empty($lastRequestApiErrors) ) {
					//Some errors are not critical. For example, if PUC tries to retrieve the readme.txt
					//file from GitHub and gets a 404, that's an API error, but it doesn't prevent updates
					//from working. Maybe the plugin simply doesn't have a readme.
					//Let's only show important errors.
					$foundCriticalErrors = false;
					$questionableErrorCodes = array(
						'puc-github-http-error',
						'puc-gitlab-http-error',
						'puc-bitbucket-http-error',
					);

					foreach ($lastRequestApiErrors as $item) {
						$wpError = $item['error'];
						/** @var \WP_Error $wpError */
						if ( !in_array($wpError->get_error_code(), $questionableErrorCodes) ) {
							$foundCriticalErrors = true;
							break;
						}
					}

					if ( $foundCriticalErrors ) {
						$status = 'error';
						set_site_transient($this->manualCheckErrorTransient, $lastRequestApiErrors, 60);
					}
				}

				wp_safe_redirect(add_query_arg(
					array(
						'puc_update_check_result' => $status,
						'puc_slug'                => $this->updateChecker->slug,
					),
					self_admin_url('plugins.php')
				));
				exit;
			}
		}

		/**
		 * Display the results of a manual update check.
		 *
		 * @see self::handleManualCheck()
		 *
		 * You can change the result message by using the "puc_manual_check_message-$slug" filter.
		 */
		public function displayManualCheckResult() {
			//phpcs:disable WordPress.Security.NonceVerification.Recommended -- Just displaying a message.
			if ( isset($_GET['puc_update_check_result'], $_GET['puc_slug']) && ($_GET['puc_slug'] == $this->updateChecker->slug) ) {
				$status = sanitize_key($_GET['puc_update_check_result']);
				$title = $this->updateChecker->getInstalledPackage()->getPluginTitle();
				$noticeClass = 'updated notice-success';
				$details = '';

				if ( $status == 'no_update' ) {
					$message = sprintf(_x('The %s plugin is up to date.', 'the plugin title', 'plugin-update-checker'), $title);
				} else if ( $status == 'update_available' ) {
					$message = sprintf(_x('A new version of the %s plugin is available.', 'the plugin title', 'plugin-update-checker'), $title);
				} else if ( $status === 'error' ) {
					$message = sprintf(_x('Could not determine if updates are available for %s.', 'the plugin title', 'plugin-update-checker'), $title);
					$noticeClass = 'error notice-error';

					$details = $this->formatManualCheckErrors(get_site_transient($this->manualCheckErrorTransient));
					delete_site_transient($this->manualCheckErrorTransient);
				} else {
					$message = sprintf(__('Unknown update checker status "%s"', 'plugin-update-checker'), $status);
					$noticeClass = 'error notice-error';
				}

				$message = esc_html($message);

				//Plugins can replace the message with their own, including adding HTML.
				$message = apply_filters(
					$this->updateChecker->getUniqueName('manual_check_message'),
					$message,
					$status
				);

				printf(
					'<div class="notice %s is-dismissible"><p>%s</p>%s</div>',
					esc_attr($noticeClass),
					//phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped -- Was escaped above, and plugins can add HTML.
					$message,
					//phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped -- Contains HTML. Content should already be escaped.
					$details
				);
			}
			//phpcs:enable
		}

		/**
		 * Format the list of errors that were thrown during an update check.
		 *
		 * @param array $errors
		 * @return string
		 */
		protected function formatManualCheckErrors($errors) {
			if ( empty($errors) ) {
				return '';
			}
			$output = '';

			$showAsList = count($errors) > 1;
			if ( $showAsList ) {
				$output .= '<ol>';
				$formatString = '<li>%1$s <code>%2$s</code></li>';
			} else {
				$formatString = '<p>%1$s <code>%2$s</code></p>';
			}
			foreach ($errors as $item) {
				$wpError = $item['error'];
				/** @var \WP_Error $wpError */
				$output .= sprintf(
					$formatString,
					esc_html($wpError->get_error_message()),
					esc_html($wpError->get_error_code())
				);
			}
			if ( $showAsList ) {
				$output .= '</ol>';
			}

			return $output;
		}

		public function removeHooks() {
			remove_action('admin_init', array($this, 'onAdminInit'));
			remove_filter('plugin_row_meta', array($this, 'addViewDetailsLink'), 10);
			remove_filter('plugin_row_meta', array($this, 'addCheckForUpdatesLink'), 10);
			remove_action('all_admin_notices', array($this, 'displayManualCheckResult'));
		}
	}
endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Plugin\Update.php (3375 bytes, 117 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6\Plugin;

use YahnisElsts\PluginUpdateChecker\v5p6\Update as BaseUpdate;

if ( !class_exists(Update::class, false) ):

	/**
	 * A simple container class for holding information about an available update.
	 *
	 * @author Janis Elsts
	 * @copyright 2016
	 * @access public
	 */
	class Update extends BaseUpdate {
		public $id = 0;
		public $homepage;
		public $upgrade_notice;
		public $tested;
		public $requires_php = false;
		public $icons = array();
		public $filename; //Plugin filename relative to the plugins directory.

		protected static $extraFields = array(
			'id', 'homepage', 'tested', 'requires_php', 'upgrade_notice', 'icons', 'filename',
		);

		/**
		 * Create a new instance of PluginUpdate from its JSON-encoded representation.
		 *
		 * @param string $json
		 * @return self|null
		 */
		public static function fromJson($json){
			//Since update-related information is simply a subset of the full plugin info,
			//we can parse the update JSON as if it was a plugin info string, then copy over
			//the parts that we care about.
			$pluginInfo = PluginInfo::fromJson($json);
			if ( $pluginInfo !== null ) {
				return self::fromPluginInfo($pluginInfo);
			} else {
				return null;
			}
		}

		/**
		 * Create a new instance of PluginUpdate based on an instance of PluginInfo.
		 * Basically, this just copies a subset of fields from one object to another.
		 *
		 * @param PluginInfo $info
		 * @return static
		 */
		public static function fromPluginInfo($info){
			return static::fromObject($info);
		}

		/**
		 * Create a new instance by copying the necessary fields from another object.
		 *
		 * @param \StdClass|PluginInfo|self $object The source object.
		 * @return self The new copy.
		 */
		public static function fromObject($object) {
			$update = new self();
			$update->copyFields($object, $update);
			return $update;
		}

		/**
		 * @return string[]
		 */
		protected function getFieldNames() {
			return array_merge(parent::getFieldNames(), self::$extraFields);
		}

		/**
		 * Transform the update into the format used by WordPress native plugin API.
		 *
		 * @return object
		 */
		public function toWpFormat() {
			$update = parent::toWpFormat();

			$update->id = $this->id;
			$update->url = $this->homepage;
			$update->tested = $this->tested;
			$update->requires_php = $this->requires_php;
			$update->plugin = $this->filename;

			if ( !empty($this->upgrade_notice) ) {
				$update->upgrade_notice = $this->upgrade_notice;
			}

			if ( !empty($this->icons) && is_array($this->icons) ) {
				//This should be an array with up to 4 keys: 'svg', '1x', '2x' and 'default'.
				//Docs: https://developer.wordpress.org/plugins/wordpress-org/plugin-assets/#plugin-icons
				$icons = array_intersect_key(
					$this->icons,
					array('svg' => true, '1x' => true, '2x' => true, 'default' => true)
				);
				if ( !empty($icons) ) {
					$update->icons = $icons;

					//It appears that the 'default' icon isn't used anywhere in WordPress 4.9,
					//but lets set it just in case a future release needs it.
					if ( !isset($update->icons['default']) ) {
						$update->icons['default'] = current($update->icons);
					}
				}
			}

			return $update;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Plugin\UpdateChecker.php (13780 bytes, 426 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6\Plugin;

use YahnisElsts\PluginUpdateChecker\v5p6\InstalledPackage;
use YahnisElsts\PluginUpdateChecker\v5p6\UpdateChecker as BaseUpdateChecker;
use YahnisElsts\PluginUpdateChecker\v5p6\Scheduler;
use YahnisElsts\PluginUpdateChecker\v5p6\DebugBar;

if ( !class_exists(UpdateChecker::class, false) ):

	/**
	 * A custom plugin update checker.
	 *
	 * @author Janis Elsts
	 * @copyright 2018
	 * @access public
	 */
	class UpdateChecker extends BaseUpdateChecker {
		protected $updateTransient = 'update_plugins';
		protected $componentType = 'plugin';

		public $pluginAbsolutePath = ''; //Full path of the main plugin file.
		public $pluginFile = '';  //Plugin filename relative to the plugins directory. Many WP APIs use this to identify plugins.
		public $muPluginFile = ''; //For MU plugins, the plugin filename relative to the mu-plugins directory.

		/**
		 * @var Package
		 */
		protected $package;

		private $extraUi = null;

		/**
		 * Class constructor.
		 *
		 * @param string $metadataUrl The URL of the plugin's metadata file.
		 * @param string $pluginFile Fully qualified path to the main plugin file.
		 * @param string $slug The plugin's 'slug'. If not specified, the filename part of $pluginFile sans '.php' will be used as the slug.
		 * @param integer $checkPeriod How often to check for updates (in hours). Defaults to checking every 12 hours. Set to 0 to disable automatic update checks.
		 * @param string $optionName Where to store book-keeping info about update checks. Defaults to 'external_updates-$slug'.
		 * @param string $muPluginFile Optional. The plugin filename relative to the mu-plugins directory.
		 */
		public function __construct($metadataUrl, $pluginFile, $slug = '', $checkPeriod = 12, $optionName = '', $muPluginFile = ''){
			$this->pluginAbsolutePath = $pluginFile;
			$this->pluginFile = plugin_basename($this->pluginAbsolutePath);
			$this->muPluginFile = $muPluginFile;

			//If no slug is specified, use the name of the main plugin file as the slug.
			//For example, 'my-cool-plugin/cool-plugin.php' becomes 'cool-plugin'.
			if ( empty($slug) ){
				$slug = basename($this->pluginFile, '.php');
			}

			//Plugin slugs must be unique.
			$slugCheckFilter = 'puc_is_slug_in_use-' . $slug;
			$slugUsedBy = apply_filters($slugCheckFilter, false);
			if ( $slugUsedBy ) {
				$this->triggerError(sprintf(
					'Plugin slug "%s" is already in use by %s. Slugs must be unique.',
					$slug,
					$slugUsedBy
				), E_USER_ERROR);
			}
			add_filter($slugCheckFilter, array($this, 'getAbsolutePath'));

			parent::__construct($metadataUrl, dirname($this->pluginFile), $slug, $checkPeriod, $optionName);

			//Backwards compatibility: If the plugin is a mu-plugin but no $muPluginFile is specified, assume
			//it's the same as $pluginFile given that it's not in a subdirectory (WP only looks in the base dir).
			if ( (strpbrk($this->pluginFile, '/\\') === false) && $this->isUnknownMuPlugin() ) {
				$this->muPluginFile = $this->pluginFile;
			}

			//To prevent a crash during plugin uninstallation, remove updater hooks when the user removes the plugin.
			//Details: https://github.com/YahnisElsts/plugin-update-checker/issues/138#issuecomment-335590964
			add_action('uninstall_' . $this->pluginFile, array($this, 'removeHooks'));

			$this->extraUi = new Ui($this);
		}

		/**
		 * Create an instance of the scheduler.
		 *
		 * @param int $checkPeriod
		 * @return Scheduler
		 */
		protected function createScheduler($checkPeriod) {
			$scheduler = new Scheduler($this, $checkPeriod, array('load-plugins.php'));
			register_deactivation_hook($this->pluginFile, array($scheduler, 'removeUpdaterCron'));
			return $scheduler;
		}

		/**
		 * Install the hooks required to run periodic update checks and inject update info
		 * into WP data structures.
		 *
		 * @return void
		 */
		protected function installHooks(){
			//Override requests for plugin information
			add_filter('plugins_api', array($this, 'injectInfo'), 20, 3);

			parent::installHooks();
		}

		/**
		 * Remove update checker hooks.
		 *
		 * The intent is to prevent a fatal error that can happen if the plugin has an uninstall
		 * hook. During uninstallation, WP includes the main plugin file (which creates a PUC instance),
		 * the uninstall hook runs, WP deletes the plugin files and then updates some transients.
		 * If PUC hooks are still around at this time, they could throw an error while trying to
		 * autoload classes from files that no longer exist.
		 *
		 * The "site_transient_{$transient}" filter is the main problem here, but let's also remove
		 * most other PUC hooks to be safe.
		 *
		 * @internal
		 */
		public function removeHooks() {
			parent::removeHooks();
			$this->extraUi->removeHooks();
			$this->package->removeHooks();

			remove_filter('plugins_api', array($this, 'injectInfo'), 20);
		}

		/**
		 * Retrieve plugin info from the configured API endpoint.
		 *
		 * @uses wp_remote_get()
		 *
		 * @param array $queryArgs Additional query arguments to append to the request. Optional.
		 * @return PluginInfo
		 */
		public function requestInfo($queryArgs = array()) {
			list($pluginInfo, $result) = $this->requestMetadata(
				PluginInfo::class,
				'request_info',
				$queryArgs
			);

			if ( $pluginInfo !== null ) {
				/** @var PluginInfo $pluginInfo */
				$pluginInfo->filename = $this->pluginFile;
				$pluginInfo->slug = $this->slug;
			}

			$pluginInfo = apply_filters($this->getUniqueName('request_info_result'), $pluginInfo, $result);
			return $pluginInfo;
		}

		/**
		 * Retrieve the latest update (if any) from the configured API endpoint.
		 *
		 * @uses UpdateChecker::requestInfo()
		 *
		 * @return Update|null An instance of Plugin Update, or NULL when no updates are available.
		 */
		public function requestUpdate() {
			//For the sake of simplicity, this function just calls requestInfo()
			//and transforms the result accordingly.
			$pluginInfo = $this->requestInfo(array('checking_for_updates' => '1'));
			if ( $pluginInfo === null ){
				return null;
			}
			$update = Update::fromPluginInfo($pluginInfo);

			$update = $this->filterUpdateResult($update);

			return $update;
		}

		/**
		 * Intercept plugins_api() calls that request information about our plugin and
		 * use the configured API endpoint to satisfy them.
		 *
		 * @see plugins_api()
		 *
		 * @param mixed $result
		 * @param string $action
		 * @param array|object $args
		 * @return mixed
		 */
		public function injectInfo($result, $action = null, $args = null){
			$relevant = ($action == 'plugin_information') && isset($args->slug) && (
					($args->slug == $this->slug) || ($args->slug == dirname($this->pluginFile))
				);
			if ( !$relevant ) {
				return $result;
			}

			$pluginInfo = $this->requestInfo();
			$this->fixSupportedWordpressVersion($pluginInfo);

			$pluginInfo = apply_filters($this->getUniqueName('pre_inject_info'), $pluginInfo);
			if ( $pluginInfo ) {
				return $pluginInfo->toWpFormat();
			}

			return $result;
		}

		protected function shouldShowUpdates() {
			//No update notifications for mu-plugins unless explicitly enabled. The MU plugin file
			//is usually different from the main plugin file so the update wouldn't show up properly anyway.
			return !$this->isUnknownMuPlugin();
		}

		/**
		 * @param \stdClass|null $updates
		 * @param \stdClass $updateToAdd
		 * @return \stdClass
		 */
		protected function addUpdateToList($updates, $updateToAdd) {
			if ( $this->package->isMuPlugin() ) {
				//WP does not support automatic update installation for mu-plugins, but we can
				//still display a notice.
				$updateToAdd->package = null;
			}
			return parent::addUpdateToList($updates, $updateToAdd);
		}

		/**
		 * @param \stdClass|null $updates
		 * @return \stdClass|null
		 */
		protected function removeUpdateFromList($updates) {
			$updates = parent::removeUpdateFromList($updates);
			if ( !empty($this->muPluginFile) && isset($updates, $updates->response) ) {
				unset($updates->response[$this->muPluginFile]);
			}
			return $updates;
		}

		/**
		 * For plugins, the update array is indexed by the plugin filename relative to the "plugins"
		 * directory. Example: "plugin-name/plugin.php".
		 *
		 * @return string
		 */
		protected function getUpdateListKey() {
			if ( $this->package->isMuPlugin() ) {
				return $this->muPluginFile;
			}
			return $this->pluginFile;
		}

		protected function getNoUpdateItemFields() {
			return array_merge(
				parent::getNoUpdateItemFields(),
				array(
					'id'            => $this->pluginFile,
					'slug'          => $this->slug,
					'plugin'        => $this->pluginFile,
					'icons'         => array(),
					'banners'       => array(),
					'banners_rtl'   => array(),
					'tested'        => '',
					'compatibility' => new \stdClass(),
				)
			);
		}

		/**
		 * Alias for isBeingUpgraded().
		 *
		 * @deprecated
		 * @param \WP_Upgrader|null $upgrader The upgrader that's performing the current update.
		 * @return bool
		 */
		public function isPluginBeingUpgraded($upgrader = null) {
			return $this->isBeingUpgraded($upgrader);
		}

		/**
		 * Is there an update being installed for this plugin, right now?
		 *
		 * @param \WP_Upgrader|null $upgrader
		 * @return bool
		 */
		public function isBeingUpgraded($upgrader = null) {
			return $this->upgraderStatus->isPluginBeingUpgraded($this->pluginFile, $upgrader);
		}

		/**
		 * Get the details of the currently available update, if any.
		 *
		 * If no updates are available, or if the last known update version is below or equal
		 * to the currently installed version, this method will return NULL.
		 *
		 * Uses cached update data. To retrieve update information straight from
		 * the metadata URL, call requestUpdate() instead.
		 *
		 * @return Update|null
		 */
		public function getUpdate() {
			$update = parent::getUpdate();
			if ( isset($update) ) {
				/** @var Update $update */
				$update->filename = $this->pluginFile;
			}
			return $update;
		}

		/**
		 * Get the translated plugin title.
		 *
		 * @deprecated
		 * @return string
		 */
		public function getPluginTitle() {
			return $this->package->getPluginTitle();
		}

		/**
		 * Check if the current user has the required permissions to install updates.
		 *
		 * @return bool
		 */
		public function userCanInstallUpdates() {
			return current_user_can('update_plugins');
		}

		/**
		 * Check if the plugin file is inside the mu-plugins directory.
		 *
		 * @deprecated
		 * @return bool
		 */
		protected function isMuPlugin() {
			return $this->package->isMuPlugin();
		}

		/**
		 * MU plugins are partially supported, but only when we know which file in mu-plugins
		 * corresponds to this plugin.
		 *
		 * @return bool
		 */
		protected function isUnknownMuPlugin() {
			return empty($this->muPluginFile) && $this->package->isMuPlugin();
		}

		/**
		 * Get absolute path to the main plugin file.
		 *
		 * @return string
		 */
		public function getAbsolutePath() {
			return $this->pluginAbsolutePath;
		}

		/**
		 * Register a callback for filtering query arguments.
		 *
		 * The callback function should take one argument - an associative array of query arguments.
		 * It should return a modified array of query arguments.
		 *
		 * @uses add_filter() This method is a convenience wrapper for add_filter().
		 *
		 * @param callable $callback
		 * @return void
		 */
		public function addQueryArgFilter($callback){
			$this->addFilter('request_info_query_args', $callback);
		}

		/**
		 * Register a callback for filtering arguments passed to wp_remote_get().
		 *
		 * The callback function should take one argument - an associative array of arguments -
		 * and return a modified array or arguments. See the WP documentation on wp_remote_get()
		 * for details on what arguments are available and how they work.
		 *
		 * @uses add_filter() This method is a convenience wrapper for add_filter().
		 *
		 * @param callable $callback
		 * @return void
		 */
		public function addHttpRequestArgFilter($callback) {
			$this->addFilter('request_info_options', $callback);
		}

		/**
		 * Register a callback for filtering the plugin info retrieved from the external API.
		 *
		 * The callback function should take two arguments. If the plugin info was retrieved
		 * successfully, the first argument passed will be an instance of  PluginInfo. Otherwise,
		 * it will be NULL. The second argument will be the corresponding return value of
		 * wp_remote_get (see WP docs for details).
		 *
		 * The callback function should return a new or modified instance of PluginInfo or NULL.
		 *
		 * @uses add_filter() This method is a convenience wrapper for add_filter().
		 *
		 * @param callable $callback
		 * @return void
		 */
		public function addResultFilter($callback) {
			$this->addFilter('request_info_result', $callback, 10, 2);
		}

		protected function createDebugBarExtension() {
			return new DebugBar\PluginExtension($this);
		}

		/**
		 * Create a package instance that represents this plugin or theme.
		 *
		 * @return InstalledPackage
		 */
		protected function createInstalledPackage() {
			return new Package($this->pluginAbsolutePath, $this);
		}

		/**
		 * @return Package
		 */
		public function getInstalledPackage() {
			return $this->package;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Theme\Package.php (1898 bytes, 70 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6\Theme;

use YahnisElsts\PluginUpdateChecker\v5p6\InstalledPackage;

if ( !class_exists(Package::class, false) ):

	class Package extends InstalledPackage {
		/**
		 * @var string Theme directory name.
		 */
		protected $stylesheet;

		/**
		 * @var \WP_Theme Theme object.
		 */
		protected $theme;

		public function __construct($stylesheet, $updateChecker) {
			$this->stylesheet = $stylesheet;
			$this->theme = wp_get_theme($this->stylesheet);

			parent::__construct($updateChecker);
		}

		public function getInstalledVersion() {
			return $this->theme->get('Version');
		}

		public function getAbsoluteDirectoryPath() {
			if ( method_exists($this->theme, 'get_stylesheet_directory') ) {
				return $this->theme->get_stylesheet_directory(); //Available since WP 3.4.
			}
			return get_theme_root($this->stylesheet) . '/' . $this->stylesheet;
		}

		/**
		 * Get the value of a specific plugin or theme header.
		 *
		 * @param string $headerName
		 * @param string $defaultValue
		 * @return string Either the value of the header, or $defaultValue if the header doesn't exist or is empty.
		 */
		public function getHeaderValue($headerName, $defaultValue = '') {
			$value = $this->theme->get($headerName);
			if ( ($headerName === false) || ($headerName === '') ) {
				return $defaultValue;
			}
			return $value;
		}

		protected function getHeaderNames() {
			return array(
				'Name'        => 'Theme Name',
				'ThemeURI'    => 'Theme URI',
				'Description' => 'Description',
				'Author'      => 'Author',
				'AuthorURI'   => 'Author URI',
				'Version'     => 'Version',
				'Template'    => 'Template',
				'Status'      => 'Status',
				'Tags'        => 'Tags',
				'TextDomain'  => 'Text Domain',
				'DomainPath'  => 'Domain Path',
			);
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Theme\Update.php (2299 bytes, 89 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\Theme;

use YahnisElsts\PluginUpdateChecker\v5p6\Update as BaseUpdate;

if ( !class_exists(Update::class, false) ):

	class Update extends BaseUpdate {
		public $details_url = '';

		protected static $extraFields = array('details_url');

		/**
		 * Transform the metadata into the format used by WordPress core.
		 * Note the inconsistency: WP stores plugin updates as objects and theme updates as arrays.
		 *
		 * @return array
		 */
		public function toWpFormat() {
			$update = array(
				'theme' => $this->slug,
				'new_version' => $this->version,
				'url' => $this->details_url,
			);

			if ( !empty($this->download_url) ) {
				$update['package'] = $this->download_url;
			}

			return $update;
		}

		/**
		 * Create a new instance of Theme_Update from its JSON-encoded representation.
		 *
		 * @param string $json Valid JSON string representing a theme information object.
		 * @return self New instance of ThemeUpdate, or NULL on error.
		 */
		public static function fromJson($json) {
			$instance = new self();
			if ( !parent::createFromJson($json, $instance) ) {
				return null;
			}
			return $instance;
		}

		/**
		 * Create a new instance by copying the necessary fields from another object.
		 *
		 * @param \StdClass|self $object The source object.
		 * @return self The new copy.
		 */
		public static function fromObject($object) {
			$update = new self();
			$update->copyFields($object, $update);
			return $update;
		}

		/**
		 * Basic validation.
		 *
		 * @param \StdClass $apiResponse
		 * @return bool|\WP_Error
		 */
		protected function validateMetadata($apiResponse) {
			$required = array('version', 'details_url');
			foreach($required as $key) {
				if ( !isset($apiResponse->$key) || empty($apiResponse->$key) ) {
					return new \WP_Error(
						'tuc-invalid-metadata',
						sprintf('The theme metadata is missing the required "%s" key.', $key)
					);
				}
			}
			return true;
		}

		protected function getFieldNames() {
			return array_merge(parent::getFieldNames(), self::$extraFields);
		}

		protected function getPrefixedFilter($tag) {
			return parent::getPrefixedFilter($tag) . '_theme';
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Theme\UpdateChecker.php (4837 bytes, 160 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\Theme;

use YahnisElsts\PluginUpdateChecker\v5p6\UpdateChecker as BaseUpdateChecker;
use YahnisElsts\PluginUpdateChecker\v5p6\InstalledPackage;
use YahnisElsts\PluginUpdateChecker\v5p6\Scheduler;
use YahnisElsts\PluginUpdateChecker\v5p6\DebugBar;

if ( !class_exists(UpdateChecker::class, false) ):

	class UpdateChecker extends BaseUpdateChecker {
		protected $filterSuffix = 'theme';
		protected $updateTransient = 'update_themes';
		protected $componentType = 'theme';

		/**
		 * @var string Theme directory name.
		 */
		protected $stylesheet;

		public function __construct($metadataUrl, $stylesheet = null, $customSlug = null, $checkPeriod = 12, $optionName = '') {
			if ( $stylesheet === null ) {
				$stylesheet = get_stylesheet();
			}
			$this->stylesheet = $stylesheet;

			parent::__construct(
				$metadataUrl,
				$stylesheet,
				$customSlug ? $customSlug : $stylesheet,
				$checkPeriod,
				$optionName
			);
		}

		/**
		 * For themes, the update array is indexed by theme directory name.
		 *
		 * @return string
		 */
		protected function getUpdateListKey() {
			return $this->directoryName;
		}

		/**
		 * Retrieve the latest update (if any) from the configured API endpoint.
		 *
		 * @return Update|null An instance of Update, or NULL when no updates are available.
		 */
		public function requestUpdate() {
			list($themeUpdate, $result) = $this->requestMetadata(Update::class, 'request_update');

			if ( $themeUpdate !== null ) {
				/** @var Update $themeUpdate */
				$themeUpdate->slug = $this->slug;
			}

			$themeUpdate = $this->filterUpdateResult($themeUpdate, $result);
			return $themeUpdate;
		}

		protected function getNoUpdateItemFields() {
			return array_merge(
				parent::getNoUpdateItemFields(),
				array(
					'theme'        => $this->directoryName,
					'requires'     => '',
				)
			);
		}

		public function userCanInstallUpdates() {
			return current_user_can('update_themes');
		}

		/**
		 * Create an instance of the scheduler.
		 *
		 * @param int $checkPeriod
		 * @return Scheduler
		 */
		protected function createScheduler($checkPeriod) {
			return new Scheduler($this, $checkPeriod, array('load-themes.php'));
		}

		/**
		 * Is there an update being installed right now for this theme?
		 *
		 * @param \WP_Upgrader|null $upgrader The upgrader that's performing the current update.
		 * @return bool
		 */
		public function isBeingUpgraded($upgrader = null) {
			return $this->upgraderStatus->isThemeBeingUpgraded($this->stylesheet, $upgrader);
		}

		protected function createDebugBarExtension() {
			return new DebugBar\Extension($this, DebugBar\ThemePanel::class);
		}

		/**
		 * Register a callback for filtering query arguments.
		 *
		 * The callback function should take one argument - an associative array of query arguments.
		 * It should return a modified array of query arguments.
		 *
		 * @param callable $callback
		 * @return void
		 */
		public function addQueryArgFilter($callback){
			$this->addFilter('request_update_query_args', $callback);
		}

		/**
		 * Register a callback for filtering arguments passed to wp_remote_get().
		 *
		 * The callback function should take one argument - an associative array of arguments -
		 * and return a modified array or arguments. See the WP documentation on wp_remote_get()
		 * for details on what arguments are available and how they work.
		 *
		 * @uses add_filter() This method is a convenience wrapper for add_filter().
		 *
		 * @param callable $callback
		 * @return void
		 */
		public function addHttpRequestArgFilter($callback) {
			$this->addFilter('request_update_options', $callback);
		}

		/**
		 * Register a callback for filtering theme updates retrieved from the external API.
		 *
		 * The callback function should take two arguments. If the theme update was retrieved
		 * successfully, the first argument passed will be an instance of Theme_Update. Otherwise,
		 * it will be NULL. The second argument will be the corresponding return value of
		 * wp_remote_get (see WP docs for details).
		 *
		 * The callback function should return a new or modified instance of Theme_Update or NULL.
		 *
		 * @uses add_filter() This method is a convenience wrapper for add_filter().
		 *
		 * @param callable $callback
		 * @return void
		 */
		public function addResultFilter($callback) {
			$this->addFilter('request_update_result', $callback, 10, 2);
		}

		/**
		 * Create a package instance that represents this plugin or theme.
		 *
		 * @return InstalledPackage
		 */
		protected function createInstalledPackage() {
			return new Package($this->stylesheet, $this);
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Vcs\Api.php (10264 bytes, 380 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

use Parsedown;
use PucReadmeParser;

if ( !class_exists(Api::class, false) ):

	abstract class Api {
		const STRATEGY_LATEST_RELEASE = 'latest_release';
		const STRATEGY_LATEST_TAG = 'latest_tag';
		const STRATEGY_STABLE_TAG = 'stable_tag';
		const STRATEGY_BRANCH = 'branch';

		/**
		 * Consider all releases regardless of their version number or prerelease/upcoming
		 * release status.
		 */
		const RELEASE_FILTER_ALL = 3;

		/**
		 * Exclude releases that have the "prerelease" or "upcoming release" flag.
		 *
		 * This does *not* look for prerelease keywords like "beta" in the version number.
		 * It only uses the data provided by the API. For example, on GitHub, you can
		 * manually mark a release as a prerelease.
		 */
		const RELEASE_FILTER_SKIP_PRERELEASE = 1;

		/**
		 * If there are no release assets or none of them match the configured filter,
		 * fall back to the automatically generated source code archive.
		 */
		const PREFER_RELEASE_ASSETS = 1;
		/**
		 * Skip releases that don't have any matching release assets.
		 */
		const REQUIRE_RELEASE_ASSETS = 2;

		protected $tagNameProperty = 'name';
		protected $slug = '';

		/**
		 * @var string
		 */
		protected $repositoryUrl = '';

		/**
		 * @var mixed Authentication details for private repositories. Format depends on service.
		 */
		protected $credentials = null;

		/**
		 * @var string The filter tag that's used to filter options passed to wp_remote_get.
		 * For example, "puc_request_info_options-slug" or "puc_request_update_options_theme-slug".
		 */
		protected $httpFilterName = '';

		/**
		 * @var string The filter applied to the list of update detection strategies that
		 * are used to find the latest version.
		 */
		protected $strategyFilterName = '';

		/**
		 * @var string|null
		 */
		protected $localDirectory = null;

		/**
		 * Api constructor.
		 *
		 * @param string $repositoryUrl
		 * @param array|string|null $credentials
		 */
		public function __construct($repositoryUrl, $credentials = null) {
			$this->repositoryUrl = $repositoryUrl;
			$this->setAuthentication($credentials);
		}

		/**
		 * @return string
		 */
		public function getRepositoryUrl() {
			return $this->repositoryUrl;
		}

		/**
		 * Figure out which reference (i.e. tag or branch) contains the latest version.
		 *
		 * @param string $configBranch Start looking in this branch.
		 * @return null|Reference
		 */
		public function chooseReference($configBranch) {
			$strategies = $this->getUpdateDetectionStrategies($configBranch);

			if ( !empty($this->strategyFilterName) ) {
				$strategies = apply_filters(
					$this->strategyFilterName,
					$strategies,
					$this->slug
				);
			}

			foreach ($strategies as $strategy) {
				$reference = call_user_func($strategy);
				if ( !empty($reference) ) {
					return $reference;
				}
			}
			return null;
		}

		/**
		 * Get an ordered list of strategies that can be used to find the latest version.
		 *
		 * The update checker will try each strategy in order until one of them
		 * returns a valid reference.
		 *
		 * @param string $configBranch
		 * @return array<callable> Array of callables that return Vcs_Reference objects.
		 */
		abstract protected function getUpdateDetectionStrategies($configBranch);

		/**
		 * Get the readme.txt file from the remote repository and parse it
		 * according to the plugin readme standard.
		 *
		 * @param string $ref Tag or branch name.
		 * @return array Parsed readme.
		 */
		public function getRemoteReadme($ref = 'master') {
			$fileContents = $this->getRemoteFile($this->getLocalReadmeName(), $ref);
			if ( empty($fileContents) ) {
				return array();
			}

			$parser = new PucReadmeParser();
			return $parser->parse_readme_contents($fileContents);
		}

		/**
		 * Get the case-sensitive name of the local readme.txt file.
		 *
		 * In most cases it should just be called "readme.txt", but some plugins call it "README.txt",
		 * "README.TXT", or even "Readme.txt". Most VCS are case-sensitive so we need to know the correct
		 * capitalization.
		 *
		 * Defaults to "readme.txt" (all lowercase).
		 *
		 * @return string
		 */
		public function getLocalReadmeName() {
			static $fileName = null;
			if ( $fileName !== null ) {
				return $fileName;
			}

			$fileName = 'readme.txt';
			if ( isset($this->localDirectory) ) {
				$files = scandir($this->localDirectory);
				if ( !empty($files) ) {
					foreach ($files as $possibleFileName) {
						if ( strcasecmp($possibleFileName, 'readme.txt') === 0 ) {
							$fileName = $possibleFileName;
							break;
						}
					}
				}
			}
			return $fileName;
		}

		/**
		 * Get a branch.
		 *
		 * @param string $branchName
		 * @return Reference|null
		 */
		abstract public function getBranch($branchName);

		/**
		 * Get a specific tag.
		 *
		 * @param string $tagName
		 * @return Reference|null
		 */
		abstract public function getTag($tagName);

		/**
		 * Get the tag that looks like the highest version number.
		 * (Implementations should skip pre-release versions if possible.)
		 *
		 * @return Reference|null
		 */
		abstract public function getLatestTag();

		/**
		 * Check if a tag name string looks like a version number.
		 *
		 * @param string $name
		 * @return bool
		 */
		protected function looksLikeVersion($name) {
			//Tag names may be prefixed with "v", e.g. "v1.2.3".
			$name = ltrim($name, 'v');

			//The version string must start with a number.
			if ( !is_numeric(substr($name, 0, 1)) ) {
				return false;
			}

			//The goal is to accept any SemVer-compatible or "PHP-standardized" version number.
			return (preg_match('@^(\d{1,5}?)(\.\d{1,10}?){0,4}?($|[abrdp+_\-]|\s)@i', $name) === 1);
		}

		/**
		 * Check if a tag appears to be named like a version number.
		 *
		 * @param \stdClass $tag
		 * @return bool
		 */
		protected function isVersionTag($tag) {
			$property = $this->tagNameProperty;
			return isset($tag->$property) && $this->looksLikeVersion($tag->$property);
		}

		/**
		 * Sort a list of tags as if they were version numbers.
		 * Tags that don't look like version number will be removed.
		 *
		 * @param \stdClass[] $tags Array of tag objects.
		 * @return \stdClass[] Filtered array of tags sorted in descending order.
		 */
		protected function sortTagsByVersion($tags) {
			//Keep only those tags that look like version numbers.
			$versionTags = array_filter($tags, array($this, 'isVersionTag'));
			//Sort them in descending order.
			usort($versionTags, array($this, 'compareTagNames'));

			return $versionTags;
		}

		/**
		 * Compare two tags as if they were version number.
		 *
		 * @param \stdClass $tag1 Tag object.
		 * @param \stdClass $tag2 Another tag object.
		 * @return int
		 */
		protected function compareTagNames($tag1, $tag2) {
			$property = $this->tagNameProperty;
			if ( !isset($tag1->$property) ) {
				return 1;
			}
			if ( !isset($tag2->$property) ) {
				return -1;
			}
			return -version_compare(ltrim($tag1->$property, 'v'), ltrim($tag2->$property, 'v'));
		}

		/**
		 * Get the contents of a file from a specific branch or tag.
		 *
		 * @param string $path File name.
		 * @param string $ref
		 * @return null|string Either the contents of the file, or null if the file doesn't exist or there's an error.
		 */
		abstract public function getRemoteFile($path, $ref = 'master');

		/**
		 * Get the timestamp of the latest commit that changed the specified branch or tag.
		 *
		 * @param string $ref Reference name (e.g. branch or tag).
		 * @return string|null
		 */
		abstract public function getLatestCommitTime($ref);

		/**
		 * Get the contents of the changelog file from the repository.
		 *
		 * @param string $ref
		 * @param string $localDirectory Full path to the local plugin or theme directory.
		 * @return null|string The HTML contents of the changelog.
		 */
		public function getRemoteChangelog($ref, $localDirectory) {
			$filename = $this->findChangelogName($localDirectory);
			if ( empty($filename) ) {
				return null;
			}

			$changelog = $this->getRemoteFile($filename, $ref);
			if ( $changelog === null ) {
				return null;
			}

			return Parsedown::instance()->text($changelog);
		}

		/**
		 * Guess the name of the changelog file.
		 *
		 * @param string $directory
		 * @return string|null
		 */
		protected function findChangelogName($directory = null) {
			if ( !isset($directory) ) {
				$directory = $this->localDirectory;
			}
			if ( empty($directory) || !is_dir($directory) || ($directory === '.') ) {
				return null;
			}

			$possibleNames = array('CHANGES.md', 'CHANGELOG.md', 'changes.md', 'changelog.md');
			$files = scandir($directory);
			$foundNames = array_intersect($possibleNames, $files);

			if ( !empty($foundNames) ) {
				return reset($foundNames);
			}
			return null;
		}

		/**
		 * Set authentication credentials.
		 *
		 * @param $credentials
		 */
		public function setAuthentication($credentials) {
			$this->credentials = $credentials;
		}

		public function isAuthenticationEnabled() {
			return !empty($this->credentials);
		}

		/**
		 * @param string $url
		 * @return string
		 */
		public function signDownloadUrl($url) {
			return $url;
		}

		/**
		 * @param string $filterName
		 */
		public function setHttpFilterName($filterName) {
			$this->httpFilterName = $filterName;
		}

		/**
		 * @param string $filterName
		 */
		public function setStrategyFilterName($filterName) {
			$this->strategyFilterName = $filterName;
		}

		/**
		 * @param string $directory
		 */
		public function setLocalDirectory($directory) {
			if ( empty($directory) || !is_dir($directory) || ($directory === '.') ) {
				$this->localDirectory = null;
			} else {
				$this->localDirectory = $directory;
			}
		}

		/**
		 * @param string $slug
		 */
		public function setSlug($slug) {
			$this->slug = $slug;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Vcs\BaseChecker.php (576 bytes, 30 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

if ( !interface_exists(BaseChecker::class, false) ):

	interface BaseChecker {
		/**
		 * Set the repository branch to use for updates. Defaults to 'master'.
		 *
		 * @param string $branch
		 * @return $this
		 */
		public function setBranch($branch);

		/**
		 * Set authentication credentials.
		 *
		 * @param array|string $credentials
		 * @return $this
		 */
		public function setAuthentication($credentials);

		/**
		 * @return Api
		 */
		public function getVcsApi();
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Vcs\BitBucketApi.php (7626 bytes, 273 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

use YahnisElsts\PluginUpdateChecker\v5p6\OAuthSignature;
use YahnisElsts\PluginUpdateChecker\v5p6\Utils;

if ( !class_exists(BitBucketApi::class, false) ):

	class BitBucketApi extends Api {
		/**
		 * @var OAuthSignature
		 */
		private $oauth = null;

		/**
		 * @var string
		 */
		private $username;

		/**
		 * @var string
		 */
		private $repository;

		public function __construct($repositoryUrl, $credentials = array()) {
			$path = wp_parse_url($repositoryUrl, PHP_URL_PATH);
			if ( preg_match('@^/?(?P<username>[^/]+?)/(?P<repository>[^/#?&]+?)/?$@', $path, $matches) ) {
				$this->username = $matches['username'];
				$this->repository = $matches['repository'];
			} else {
				throw new \InvalidArgumentException('Invalid BitBucket repository URL: "' . $repositoryUrl . '"');
			}

			parent::__construct($repositoryUrl, $credentials);
		}

		protected function getUpdateDetectionStrategies($configBranch) {
			$strategies = array(
				self::STRATEGY_STABLE_TAG => function () use ($configBranch) {
					return $this->getStableTag($configBranch);
				},
			);

			if ( ($configBranch === 'master' || $configBranch === 'main') ) {
				$strategies[self::STRATEGY_LATEST_TAG] = array($this, 'getLatestTag');
			}

			$strategies[self::STRATEGY_BRANCH] = function () use ($configBranch) {
				return $this->getBranch($configBranch);
			};
			return $strategies;
		}

		public function getBranch($branchName) {
			$branch = $this->api('/refs/branches/' . $branchName);
			if ( is_wp_error($branch) || empty($branch) ) {
				return null;
			}

			//The "/src/{stuff}/{path}" endpoint doesn't seem to handle branch names that contain slashes.
			//If we don't encode the slash, we get a 404. If we encode it as "%2F", we get a 401.
			//To avoid issues, if the branch name is not URL-safe, let's use the commit hash instead.
			$ref = $branch->name;
			if ((urlencode($ref) !== $ref) && isset($branch->target->hash)) {
				$ref = $branch->target->hash;
			}

			return new Reference(array(
				'name' => $ref,
				'updated' => $branch->target->date,
				'downloadUrl' => $this->getDownloadUrl($branch->name),
			));
		}

		/**
		 * Get a specific tag.
		 *
		 * @param string $tagName
		 * @return Reference|null
		 */
		public function getTag($tagName) {
			$tag = $this->api('/refs/tags/' . $tagName);
			if ( is_wp_error($tag) || empty($tag) ) {
				return null;
			}

			return new Reference(array(
				'name' => $tag->name,
				'version' => ltrim($tag->name, 'v'),
				'updated' => $tag->target->date,
				'downloadUrl' => $this->getDownloadUrl($tag->name),
			));
		}

		/**
		 * Get the tag that looks like the highest version number.
		 *
		 * @return Reference|null
		 */
		public function getLatestTag() {
			$tags = $this->api('/refs/tags?sort=-target.date');
			if ( !isset($tags, $tags->values) || !is_array($tags->values) ) {
				return null;
			}

			//Filter and sort the list of tags.
			$versionTags = $this->sortTagsByVersion($tags->values);

			//Return the first result.
			if ( !empty($versionTags) ) {
				$tag = $versionTags[0];
				return new Reference(array(
					'name' => $tag->name,
					'version' => ltrim($tag->name, 'v'),
					'updated' => $tag->target->date,
					'downloadUrl' => $this->getDownloadUrl($tag->name),
				));
			}
			return null;
		}

		/**
		 * Get the tag/ref specified by the "Stable tag" header in the readme.txt of a given branch.
		 *
		 * @param string $branch
		 * @return null|Reference
		 */
		protected function getStableTag($branch) {
			$remoteReadme = $this->getRemoteReadme($branch);
			if ( !empty($remoteReadme['stable_tag']) ) {
				$tag = $remoteReadme['stable_tag'];

				//You can explicitly opt out of using tags by setting "Stable tag" to
				//"trunk" or the name of the current branch.
				if ( ($tag === $branch) || ($tag === 'trunk') ) {
					return $this->getBranch($branch);
				}

				return $this->getTag($tag);
			}

			return null;
		}

		/**
		 * @param string $ref
		 * @return string
		 */
		protected function getDownloadUrl($ref) {
			return sprintf(
				'https://bitbucket.org/%s/%s/get/%s.zip',
				$this->username,
				$this->repository,
				$ref
			);
		}

		/**
		 * Get the contents of a file from a specific branch or tag.
		 *
		 * @param string $path File name.
		 * @param string $ref
		 * @return null|string Either the contents of the file, or null if the file doesn't exist or there's an error.
		 */
		public function getRemoteFile($path, $ref = 'master') {
			$response = $this->api('src/' . $ref . '/' . ltrim($path));
			if ( is_wp_error($response) || !is_string($response) ) {
				return null;
			}
			return $response;
		}

		/**
		 * Get the timestamp of the latest commit that changed the specified branch or tag.
		 *
		 * @param string $ref Reference name (e.g. branch or tag).
		 * @return string|null
		 */
		public function getLatestCommitTime($ref) {
			$response = $this->api('commits/' . $ref);
			if ( isset($response->values, $response->values[0], $response->values[0]->date) ) {
				return $response->values[0]->date;
			}
			return null;
		}

		/**
		 * Perform a BitBucket API 2.0 request.
		 *
		 * @param string $url
		 * @param string $version
		 * @return mixed|\WP_Error
		 */
		public function api($url, $version = '2.0') {
			$url = ltrim($url, '/');
			$isSrcResource = Utils::startsWith($url, 'src/');

			$url = implode('/', array(
				'https://api.bitbucket.org',
				$version,
				'repositories',
				$this->username,
				$this->repository,
				$url
			));
			$baseUrl = $url;

			if ( $this->oauth ) {
				$url = $this->oauth->sign($url,'GET');
			}

			$options = array('timeout' => wp_doing_cron() ? 10 : 3);
			if ( !empty($this->httpFilterName) ) {
				$options = apply_filters($this->httpFilterName, $options);
			}
			$response = wp_remote_get($url, $options);
			if ( is_wp_error($response) ) {
				do_action('puc_api_error', $response, null, $url, $this->slug);
				return $response;
			}

			$code = wp_remote_retrieve_response_code($response);
			$body = wp_remote_retrieve_body($response);
			if ( $code === 200 ) {
				if ( $isSrcResource ) {
					//Most responses are JSON-encoded, but src resources just
					//return raw file contents.
					$document = $body;
				} else {
					$document = json_decode($body);
				}
				return $document;
			}

			$error = new \WP_Error(
				'puc-bitbucket-http-error',
				sprintf('BitBucket API error. Base URL: "%s",  HTTP status code: %d.', $baseUrl, $code)
			);
			do_action('puc_api_error', $error, $response, $url, $this->slug);

			return $error;
		}

		/**
		 * @param array $credentials
		 */
		public function setAuthentication($credentials) {
			parent::setAuthentication($credentials);

			if ( !empty($credentials) && !empty($credentials['consumer_key']) ) {
				$this->oauth = new OAuthSignature(
					$credentials['consumer_key'],
					$credentials['consumer_secret']
				);
			} else {
				$this->oauth = null;
			}
		}

		public function signDownloadUrl($url) {
			//Add authentication data to download URLs. Since OAuth signatures incorporate
			//timestamps, we have to do this immediately before inserting the update. Otherwise,
			//authentication could fail due to a stale timestamp.
			if ( $this->oauth ) {
				$url = $this->oauth->sign($url);
			}
			return $url;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Vcs\GitHubApi.php (14207 bytes, 468 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

use Parsedown;

if ( !class_exists(GitHubApi::class, false) ):

	class GitHubApi extends Api {
		use ReleaseAssetSupport;
		use ReleaseFilteringFeature;

		/**
		 * @var string GitHub username.
		 */
		protected $userName;
		/**
		 * @var string GitHub repository name.
		 */
		protected $repositoryName;

		/**
		 * @var string Either a fully qualified repository URL, or just "user/repo-name".
		 */
		protected $repositoryUrl;

		/**
		 * @var string GitHub authentication token. Optional.
		 */
		protected $accessToken;

		/**
		 * @var bool
		 */
		private $downloadFilterAdded = false;

		public function __construct($repositoryUrl, $accessToken = null) {
			$path = wp_parse_url($repositoryUrl, PHP_URL_PATH);
			if ( preg_match('@^/?(?P<username>[^/]+?)/(?P<repository>[^/#?&]+?)/?$@', $path, $matches) ) {
				$this->userName = $matches['username'];
				$this->repositoryName = $matches['repository'];
			} else {
				throw new \InvalidArgumentException('Invalid GitHub repository URL: "' . $repositoryUrl . '"');
			}

			parent::__construct($repositoryUrl, $accessToken);
		}

		/**
		 * Get the latest release from GitHub.
		 *
		 * @return Reference|null
		 */
		public function getLatestRelease() {
			//The "latest release" endpoint returns one release and always skips pre-releases,
			//so we can only use it if that's compatible with the current filter settings.
			if (
				$this->shouldSkipPreReleases()
				&& (
					($this->releaseFilterMaxReleases === 1) || !$this->hasCustomReleaseFilter()
				)
			) {
				//Just get the latest release.
				$release = $this->api('/repos/:user/:repo/releases/latest');
				if ( is_wp_error($release) || !is_object($release) || !isset($release->tag_name) ) {
					return null;
				}
				$foundReleases = array($release);
			} else {
				//Get a list of the most recent releases.
				$foundReleases = $this->api(
					'/repos/:user/:repo/releases',
					array('per_page' => $this->releaseFilterMaxReleases)
				);
				if ( is_wp_error($foundReleases) || !is_array($foundReleases) ) {
					return null;
				}
			}

			foreach ($foundReleases as $release) {
				//Always skip drafts.
				if ( isset($release->draft) && !empty($release->draft) ) {
					continue;
				}

				//Skip pre-releases unless specifically included.
				if (
					$this->shouldSkipPreReleases()
					&& isset($release->prerelease)
					&& !empty($release->prerelease)
				) {
					continue;
				}

				$versionNumber = ltrim($release->tag_name, 'v'); //Remove the "v" prefix from "v1.2.3".

				//Custom release filtering.
				if ( !$this->matchesCustomReleaseFilter($versionNumber, $release) ) {
					continue;
				}

				$reference = new Reference(array(
					'name'        => $release->tag_name,
					'version'     => $versionNumber,
					'downloadUrl' => $release->zipball_url,
					'updated'     => $release->created_at,
					'apiResponse' => $release,
				));

				if ( isset($release->assets[0]) ) {
					$reference->downloadCount = $release->assets[0]->download_count;
				}

				if ( $this->releaseAssetsEnabled ) {
					//Use the first release asset that matches the specified regular expression.
					if ( isset($release->assets, $release->assets[0]) ) {
						$matchingAssets = array_values(array_filter($release->assets, array($this, 'matchesAssetFilter')));
					} else {
						$matchingAssets = array();
					}

					if ( !empty($matchingAssets) ) {
						if ( $this->isAuthenticationEnabled() ) {
							/**
							 * Keep in mind that we'll need to add an "Accept" header to download this asset.
							 *
							 * @see setUpdateDownloadHeaders()
							 */
							$reference->downloadUrl = $matchingAssets[0]->url;
						} else {
							//It seems that browser_download_url only works for public repositories.
							//Using an access_token doesn't help. Maybe OAuth would work?
							$reference->downloadUrl = $matchingAssets[0]->browser_download_url;
						}

						$reference->downloadCount = $matchingAssets[0]->download_count;
					} else if ( $this->releaseAssetPreference === Api::REQUIRE_RELEASE_ASSETS ) {
						//None of the assets match the filter, and we're not allowed
						//to fall back to the auto-generated source ZIP.
						return null;
					}
				}

				if ( !empty($release->body) ) {
					$reference->changelog = Parsedown::instance()->text($release->body);
				}

				return $reference;
			}

			return null;
		}

		/**
		 * Get the tag that looks like the highest version number.
		 *
		 * @return Reference|null
		 */
		public function getLatestTag() {
			$tags = $this->api('/repos/:user/:repo/tags');

			if ( is_wp_error($tags) || !is_array($tags) ) {
				return null;
			}

			$versionTags = $this->sortTagsByVersion($tags);
			if ( empty($versionTags) ) {
				return null;
			}

			$tag = $versionTags[0];
			return new Reference(array(
				'name'        => $tag->name,
				'version'     => ltrim($tag->name, 'v'),
				'downloadUrl' => $tag->zipball_url,
				'apiResponse' => $tag,
			));
		}

		/**
		 * Get a branch by name.
		 *
		 * @param string $branchName
		 * @return null|Reference
		 */
		public function getBranch($branchName) {
			$branch = $this->api('/repos/:user/:repo/branches/' . $branchName);
			if ( is_wp_error($branch) || empty($branch) ) {
				return null;
			}

			$reference = new Reference(array(
				'name'        => $branch->name,
				'downloadUrl' => $this->buildArchiveDownloadUrl($branch->name),
				'apiResponse' => $branch,
			));

			if ( isset($branch->commit, $branch->commit->commit, $branch->commit->commit->author->date) ) {
				$reference->updated = $branch->commit->commit->author->date;
			}

			return $reference;
		}

		/**
		 * Get the latest commit that changed the specified file.
		 *
		 * @param string $filename
		 * @param string $ref Reference name (e.g. branch or tag).
		 * @return \StdClass|null
		 */
		public function getLatestCommit($filename, $ref = 'master') {
			$commits = $this->api(
				'/repos/:user/:repo/commits',
				array(
					'path' => $filename,
					'sha'  => $ref,
				)
			);
			if ( !is_wp_error($commits) && isset($commits[0]) ) {
				return $commits[0];
			}
			return null;
		}

		/**
		 * Get the timestamp of the latest commit that changed the specified branch or tag.
		 *
		 * @param string $ref Reference name (e.g. branch or tag).
		 * @return string|null
		 */
		public function getLatestCommitTime($ref) {
			$commits = $this->api('/repos/:user/:repo/commits', array('sha' => $ref));
			if ( !is_wp_error($commits) && isset($commits[0]) ) {
				return $commits[0]->commit->author->date;
			}
			return null;
		}

		/**
		 * Perform a GitHub API request.
		 *
		 * @param string $url
		 * @param array $queryParams
		 * @return mixed|\WP_Error
		 */
		protected function api($url, $queryParams = array()) {
			$baseUrl = $url;
			$url = $this->buildApiUrl($url, $queryParams);

			$options = array('timeout' => wp_doing_cron() ? 10 : 3);
			if ( $this->isAuthenticationEnabled() ) {
				$options['headers'] = array('Authorization' => $this->getAuthorizationHeader());
			}

			if ( !empty($this->httpFilterName) ) {
				$options = apply_filters($this->httpFilterName, $options);
			}
			$response = wp_remote_get($url, $options);
			if ( is_wp_error($response) ) {
				do_action('puc_api_error', $response, null, $url, $this->slug);
				return $response;
			}

			$code = wp_remote_retrieve_response_code($response);
			$body = wp_remote_retrieve_body($response);
			if ( $code === 200 ) {
				$document = json_decode($body);
				return $document;
			}

			$error = new \WP_Error(
				'puc-github-http-error',
				sprintf('GitHub API error. Base URL: "%s",  HTTP status code: %d.', $baseUrl, $code)
			);
			do_action('puc_api_error', $error, $response, $url, $this->slug);

			return $error;
		}

		/**
		 * Build a fully qualified URL for an API request.
		 *
		 * @param string $url
		 * @param array $queryParams
		 * @return string
		 */
		protected function buildApiUrl($url, $queryParams) {
			$variables = array(
				'user' => $this->userName,
				'repo' => $this->repositoryName,
			);
			foreach ($variables as $name => $value) {
				$url = str_replace('/:' . $name, '/' . urlencode($value), $url);
			}
			$url = 'https://api.github.com' . $url;

			if ( !empty($queryParams) ) {
				$url = add_query_arg($queryParams, $url);
			}

			return $url;
		}

		/**
		 * Get the contents of a file from a specific branch or tag.
		 *
		 * @param string $path File name.
		 * @param string $ref
		 * @return null|string Either the contents of the file, or null if the file doesn't exist or there's an error.
		 */
		public function getRemoteFile($path, $ref = 'master') {
			$apiUrl = '/repos/:user/:repo/contents/' . $path;
			$response = $this->api($apiUrl, array('ref' => $ref));

			if ( is_wp_error($response) || !isset($response->content) || ($response->encoding !== 'base64') ) {
				return null;
			}
			return base64_decode($response->content);
		}

		/**
		 * Generate a URL to download a ZIP archive of the specified branch/tag/etc.
		 *
		 * @param string $ref
		 * @return string
		 */
		public function buildArchiveDownloadUrl($ref = 'master') {
			$url = sprintf(
				'https://api.github.com/repos/%1$s/%2$s/zipball/%3$s',
				urlencode($this->userName),
				urlencode($this->repositoryName),
				urlencode($ref)
			);
			return $url;
		}

		/**
		 * Get a specific tag.
		 *
		 * @param string $tagName
		 * @return void
		 */
		public function getTag($tagName) {
			//The current GitHub update checker doesn't use getTag, so I didn't bother to implement it.
			throw new \LogicException('The ' . __METHOD__ . ' method is not implemented and should not be used.');
		}

		public function setAuthentication($credentials) {
			parent::setAuthentication($credentials);
			$this->accessToken = is_string($credentials) ? $credentials : null;

			//Optimization: Instead of filtering all HTTP requests, let's do it only when
			//WordPress is about to download an update.
			add_filter('upgrader_pre_download', array($this, 'addHttpRequestFilter'), 10, 1); //WP 3.7+
		}

		protected function getUpdateDetectionStrategies($configBranch) {
			$strategies = array();

			if ( $configBranch === 'master' || $configBranch === 'main') {
				//Use the latest release.
				$strategies[self::STRATEGY_LATEST_RELEASE] = array($this, 'getLatestRelease');
				//Failing that, use the tag with the highest version number.
				$strategies[self::STRATEGY_LATEST_TAG] = array($this, 'getLatestTag');
			}

			//Alternatively, just use the branch itself.
			$strategies[self::STRATEGY_BRANCH] = function () use ($configBranch) {
				return $this->getBranch($configBranch);
			};

			return $strategies;
		}

		/**
		 * Get the unchanging part of a release asset URL. Used to identify download attempts.
		 *
		 * @return string
		 */
		protected function getAssetApiBaseUrl() {
			return sprintf(
				'//api.github.com/repos/%1$s/%2$s/releases/assets/',
				$this->userName,
				$this->repositoryName
			);
		}

		protected function getFilterableAssetName($releaseAsset) {
			if ( isset($releaseAsset->name) ) {
				return $releaseAsset->name;
			}
			return null;
		}

		/**
		 * @param bool $result
		 * @return bool
		 * @internal
		 */
		public function addHttpRequestFilter($result) {
			if ( !$this->downloadFilterAdded && $this->isAuthenticationEnabled() ) {
				//phpcs:ignore WordPressVIPMinimum.Hooks.RestrictedHooks.http_request_args -- The callback doesn't change the timeout.
				add_filter('http_request_args', array($this, 'setUpdateDownloadHeaders'), 10, 2);
				add_action('requests-requests.before_redirect', array($this, 'removeAuthHeaderFromRedirects'), 10, 4);
				$this->downloadFilterAdded = true;
			}
			return $result;
		}

		/**
		 * Set the HTTP headers that are necessary to download updates from private repositories.
		 *
		 * See GitHub docs:
		 *
		 * @link https://developer.github.com/v3/repos/releases/#get-a-single-release-asset
		 * @link https://developer.github.com/v3/auth/#basic-authentication
		 *
		 * @internal
		 * @param array $requestArgs
		 * @param string $url
		 * @return array
		 */
		public function setUpdateDownloadHeaders($requestArgs, $url = '') {
			//Is WordPress trying to download one of our release assets?
			if ( $this->releaseAssetsEnabled && (strpos($url, $this->getAssetApiBaseUrl()) !== false) ) {
				$requestArgs['headers']['Accept'] = 'application/octet-stream';
			}
			//Use Basic authentication, but only if the download is from our repository.
			$repoApiBaseUrl = $this->buildApiUrl('/repos/:user/:repo/', array());
			if ( $this->isAuthenticationEnabled() && (strpos($url, $repoApiBaseUrl)) === 0 ) {
				$requestArgs['headers']['Authorization'] = $this->getAuthorizationHeader();
			}
			return $requestArgs;
		}

		/**
		 * When following a redirect, the Requests library will automatically forward
		 * the authorization header to other hosts. We don't want that because it breaks
		 * AWS downloads and can leak authorization information.
		 *
		 * @param string $location
		 * @param array $headers
		 * @internal
		 */
		public function removeAuthHeaderFromRedirects(&$location, &$headers) {
			$repoApiBaseUrl = $this->buildApiUrl('/repos/:user/:repo/', array());
			if ( strpos($location, $repoApiBaseUrl) === 0 ) {
				return; //This request is going to GitHub, so it's fine.
			}
			//Remove the header.
			if ( isset($headers['Authorization']) ) {
				unset($headers['Authorization']);
			}
		}

		/**
		 * Generate the value of the "Authorization" header.
		 *
		 * @return string
		 */
		protected function getAuthorizationHeader() {
			return 'Basic ' . base64_encode($this->userName . ':' . $this->accessToken);
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Vcs\GitLabApi.php (12135 bytes, 415 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

if ( !class_exists(GitLabApi::class, false) ):

	class GitLabApi extends Api {
		use ReleaseAssetSupport;
		use ReleaseFilteringFeature;

		/**
		 * @var string GitLab username.
		 */
		protected $userName;

		/**
		 * @var string GitLab server host.
		 */
		protected $repositoryHost;

		/**
		 * @var string Protocol used by this GitLab server: "http" or "https".
		 */
		protected $repositoryProtocol = 'https';

		/**
		 * @var string GitLab repository name.
		 */
		protected $repositoryName;

		/**
		 * @var string GitLab authentication token. Optional.
		 */
		protected $accessToken;

		/**
		 * @deprecated
		 * @var bool No longer used.
		 */
		protected $releasePackageEnabled = false;

		public function __construct($repositoryUrl, $accessToken = null, $subgroup = null) {
			//Parse the repository host to support custom hosts.
			$port = wp_parse_url($repositoryUrl, PHP_URL_PORT);
			if ( !empty($port) ) {
				$port = ':' . $port;
			}
			$this->repositoryHost = wp_parse_url($repositoryUrl, PHP_URL_HOST) . $port;

			if ( $this->repositoryHost !== 'gitlab.com' ) {
				$this->repositoryProtocol = wp_parse_url($repositoryUrl, PHP_URL_SCHEME);
			}

			//Find the repository information
			$path = wp_parse_url($repositoryUrl, PHP_URL_PATH);
			if ( preg_match('@^/?(?P<username>[^/]+?)/(?P<repository>[^/#?&]+?)/?$@', $path, $matches) ) {
				$this->userName = $matches['username'];
				$this->repositoryName = $matches['repository'];
			} elseif ( ($this->repositoryHost === 'gitlab.com') ) {
				//This is probably a repository in a subgroup, e.g. "/organization/category/repo".
				$parts = explode('/', trim($path, '/'));
				if ( count($parts) < 3 ) {
					throw new \InvalidArgumentException('Invalid GitLab.com repository URL: "' . $repositoryUrl . '"');
				}
				$lastPart = array_pop($parts);
				$this->userName = implode('/', $parts);
				$this->repositoryName = $lastPart;
			} else {
				//There could be subgroups in the URL:  gitlab.domain.com/group/subgroup/subgroup2/repository
				if ( $subgroup !== null ) {
					$path = str_replace(trailingslashit($subgroup), '', $path);
				}

				//This is not a traditional url, it could be gitlab is in a deeper subdirectory.
				//Get the path segments.
				$segments = explode('/', untrailingslashit(ltrim($path, '/')));

				//We need at least /user-name/repository-name/
				if ( count($segments) < 2 ) {
					throw new \InvalidArgumentException('Invalid GitLab repository URL: "' . $repositoryUrl . '"');
				}

				//Get the username and repository name.
				$usernameRepo = array_splice($segments, -2, 2);
				$this->userName = $usernameRepo[0];
				$this->repositoryName = $usernameRepo[1];

				//Append the remaining segments to the host if there are segments left.
				if ( count($segments) > 0 ) {
					$this->repositoryHost = trailingslashit($this->repositoryHost) . implode('/', $segments);
				}

				//Add subgroups to username.
				if ( $subgroup !== null ) {
					$this->userName = $usernameRepo[0] . '/' . untrailingslashit($subgroup);
				}
			}

			parent::__construct($repositoryUrl, $accessToken);
		}

		/**
		 * Get the latest release from GitLab.
		 *
		 * @return Reference|null
		 */
		public function getLatestRelease() {
			$releases = $this->api('/:id/releases', array('per_page' => $this->releaseFilterMaxReleases));
			if ( is_wp_error($releases) || empty($releases) || !is_array($releases) ) {
				return null;
			}

			foreach ($releases as $release) {
				if (
					//Skip invalid/unsupported releases.
					!is_object($release)
					|| !isset($release->tag_name)
					//Skip upcoming releases.
					|| (
						!empty($release->upcoming_release)
						&& $this->shouldSkipPreReleases()
					)
				) {
					continue;
				}

				$versionNumber = ltrim($release->tag_name, 'v'); //Remove the "v" prefix from "v1.2.3".

				//Apply custom filters.
				if ( !$this->matchesCustomReleaseFilter($versionNumber, $release) ) {
					continue;
				}

				$downloadUrl = $this->findReleaseDownloadUrl($release);
				if ( empty($downloadUrl) ) {
					//The latest release doesn't have valid download URL.
					return null;
				}

				if ( !empty($this->accessToken) ) {
					$downloadUrl = add_query_arg('private_token', $this->accessToken, $downloadUrl);
				}

				return new Reference(array(
					'name'        => $release->tag_name,
					'version'     => $versionNumber,
					'downloadUrl' => $downloadUrl,
					'updated'     => $release->released_at,
					'apiResponse' => $release,
				));
			}

			return null;
		}

		/**
		 * @param object $release
		 * @return string|null
		 */
		protected function findReleaseDownloadUrl($release) {
			if ( $this->releaseAssetsEnabled ) {
				if ( isset($release->assets, $release->assets->links) ) {
					//Use the first asset link where the URL matches the filter.
					foreach ($release->assets->links as $link) {
						if ( $this->matchesAssetFilter($link) ) {
							return $link->url;
						}
					}
				}

				if ( $this->releaseAssetPreference === Api::REQUIRE_RELEASE_ASSETS ) {
					//Falling back to source archives is not allowed, so give up.
					return null;
				}
			}

			//Use the first source code archive that's in ZIP format.
			foreach ($release->assets->sources as $source) {
				if ( isset($source->format) && ($source->format === 'zip') ) {
					return $source->url;
				}
			}

			return null;
		}

		/**
		 * Get the tag that looks like the highest version number.
		 *
		 * @return Reference|null
		 */
		public function getLatestTag() {
			$tags = $this->api('/:id/repository/tags');
			if ( is_wp_error($tags) || empty($tags) || !is_array($tags) ) {
				return null;
			}

			$versionTags = $this->sortTagsByVersion($tags);
			if ( empty($versionTags) ) {
				return null;
			}

			$tag = $versionTags[0];
			return new Reference(array(
				'name'        => $tag->name,
				'version'     => ltrim($tag->name, 'v'),
				'downloadUrl' => $this->buildArchiveDownloadUrl($tag->name),
				'apiResponse' => $tag,
			));
		}

		/**
		 * Get a branch by name.
		 *
		 * @param string $branchName
		 * @return null|Reference
		 */
		public function getBranch($branchName) {
			$branch = $this->api('/:id/repository/branches/' . $branchName);
			if ( is_wp_error($branch) || empty($branch) ) {
				return null;
			}

			$reference = new Reference(array(
				'name'        => $branch->name,
				'downloadUrl' => $this->buildArchiveDownloadUrl($branch->name),
				'apiResponse' => $branch,
			));

			if ( isset($branch->commit, $branch->commit->committed_date) ) {
				$reference->updated = $branch->commit->committed_date;
			}

			return $reference;
		}

		/**
		 * Get the timestamp of the latest commit that changed the specified branch or tag.
		 *
		 * @param string $ref Reference name (e.g. branch or tag).
		 * @return string|null
		 */
		public function getLatestCommitTime($ref) {
			$commits = $this->api('/:id/repository/commits/', array('ref_name' => $ref));
			if ( is_wp_error($commits) || !is_array($commits) || !isset($commits[0]) ) {
				return null;
			}

			return $commits[0]->committed_date;
		}

		/**
		 * Perform a GitLab API request.
		 *
		 * @param string $url
		 * @param array $queryParams
		 * @return mixed|\WP_Error
		 */
		protected function api($url, $queryParams = array()) {
			$baseUrl = $url;
			$url = $this->buildApiUrl($url, $queryParams);

			$options = array('timeout' => wp_doing_cron() ? 10 : 3);
			if ( !empty($this->httpFilterName) ) {
				$options = apply_filters($this->httpFilterName, $options);
			}

			$response = wp_remote_get($url, $options);
			if ( is_wp_error($response) ) {
				do_action('puc_api_error', $response, null, $url, $this->slug);
				return $response;
			}

			$code = wp_remote_retrieve_response_code($response);
			$body = wp_remote_retrieve_body($response);
			if ( $code === 200 ) {
				return json_decode($body);
			}

			$error = new \WP_Error(
				'puc-gitlab-http-error',
				sprintf('GitLab API error. URL: "%s",  HTTP status code: %d.', $baseUrl, $code)
			);
			do_action('puc_api_error', $error, $response, $url, $this->slug);

			return $error;
		}

		/**
		 * Build a fully qualified URL for an API request.
		 *
		 * @param string $url
		 * @param array $queryParams
		 * @return string
		 */
		protected function buildApiUrl($url, $queryParams) {
			$variables = array(
				'user' => $this->userName,
				'repo' => $this->repositoryName,
				'id'   => $this->userName . '/' . $this->repositoryName,
			);

			foreach ($variables as $name => $value) {
				$url = str_replace("/:{$name}", '/' . urlencode($value), $url);
			}

			$url = substr($url, 1);
			$url = sprintf('%1$s://%2$s/api/v4/projects/%3$s', $this->repositoryProtocol, $this->repositoryHost, $url);

			if ( !empty($this->accessToken) ) {
				$queryParams['private_token'] = $this->accessToken;
			}

			if ( !empty($queryParams) ) {
				$url = add_query_arg($queryParams, $url);
			}

			return $url;
		}

		/**
		 * Get the contents of a file from a specific branch or tag.
		 *
		 * @param string $path File name.
		 * @param string $ref
		 * @return null|string Either the contents of the file, or null if the file doesn't exist or there's an error.
		 */
		public function getRemoteFile($path, $ref = 'master') {
			$response = $this->api('/:id/repository/files/' . $path, array('ref' => $ref));
			if ( is_wp_error($response) || !isset($response->content) || $response->encoding !== 'base64' ) {
				return null;
			}

			return base64_decode($response->content);
		}

		/**
		 * Generate a URL to download a ZIP archive of the specified branch/tag/etc.
		 *
		 * @param string $ref
		 * @return string
		 */
		public function buildArchiveDownloadUrl($ref = 'master') {
			$url = sprintf(
				'%1$s://%2$s/api/v4/projects/%3$s/repository/archive.zip',
				$this->repositoryProtocol,
				$this->repositoryHost,
				urlencode($this->userName . '/' . $this->repositoryName)
			);
			$url = add_query_arg('sha', urlencode($ref), $url);

			if ( !empty($this->accessToken) ) {
				$url = add_query_arg('private_token', $this->accessToken, $url);
			}

			return $url;
		}

		/**
		 * Get a specific tag.
		 *
		 * @param string $tagName
		 * @return void
		 */
		public function getTag($tagName) {
			throw new \LogicException('The ' . __METHOD__ . ' method is not implemented and should not be used.');
		}

		protected function getUpdateDetectionStrategies($configBranch) {
			$strategies = array();

			if ( ($configBranch === 'main') || ($configBranch === 'master') ) {
				$strategies[self::STRATEGY_LATEST_RELEASE] = array($this, 'getLatestRelease');
				$strategies[self::STRATEGY_LATEST_TAG] = array($this, 'getLatestTag');
			}

			$strategies[self::STRATEGY_BRANCH] = function () use ($configBranch) {
				return $this->getBranch($configBranch);
			};

			return $strategies;
		}

		public function setAuthentication($credentials) {
			parent::setAuthentication($credentials);
			$this->accessToken = is_string($credentials) ? $credentials : null;
		}

		/**
		 * Use release assets that link to GitLab generic packages (e.g. .zip files)
		 * instead of automatically generated source archives.
		 *
		 * This is included for backwards compatibility with older versions of PUC.
		 *
		 * @return void
		 * @deprecated   Use enableReleaseAssets() instead.
		 * @noinspection PhpUnused -- Public API
		 */
		public function enableReleasePackages() {
			$this->enableReleaseAssets(
			/** @lang RegExp */ '/\.zip($|[?&#])/i',
				Api::REQUIRE_RELEASE_ASSETS
			);
		}

		protected function getFilterableAssetName($releaseAsset) {
			if ( isset($releaseAsset->url) ) {
				return $releaseAsset->url;
			}
			return null;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Vcs\PluginUpdateChecker.php (9381 bytes, 276 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

use YahnisElsts\PluginUpdateChecker\v5p6\Plugin;

if ( !class_exists(PluginUpdateChecker::class, false) ):

	class PluginUpdateChecker extends Plugin\UpdateChecker implements BaseChecker {
		use VcsCheckerMethods;

		/**
		 * PluginUpdateChecker constructor.
		 *
		 * @param Api $api
		 * @param string $pluginFile
		 * @param string $slug
		 * @param int $checkPeriod
		 * @param string $optionName
		 * @param string $muPluginFile
		 */
		public function __construct($api, $pluginFile, $slug = '', $checkPeriod = 12, $optionName = '', $muPluginFile = '') {
			$this->api = $api;

			parent::__construct($api->getRepositoryUrl(), $pluginFile, $slug, $checkPeriod, $optionName, $muPluginFile);

			$this->api->setHttpFilterName($this->getUniqueName('request_info_options'));
			$this->api->setStrategyFilterName($this->getUniqueName('vcs_update_detection_strategies'));
			$this->api->setSlug($this->slug);
		}

		public function requestInfo($unusedParameter = null) {
			//We have to make several remote API requests to gather all the necessary info
			//which can take a while on slow networks.
			if ( function_exists('set_time_limit') ) {
				@set_time_limit(60);
			}

			$api = $this->api;
			$api->setLocalDirectory($this->package->getAbsoluteDirectoryPath());

			$info = new Plugin\PluginInfo();
			$info->filename = $this->pluginFile;
			$info->slug = $this->slug;

			$this->setInfoFromHeader($this->package->getPluginHeader(), $info);
			$this->setIconsFromLocalAssets($info);
			$this->setBannersFromLocalAssets($info);

			//Pick a branch or tag.
			$updateSource = $api->chooseReference($this->branch);
			if ( $updateSource ) {
				$ref = $updateSource->name;
				$info->version = $updateSource->version;
				$info->last_updated = $updateSource->updated;
				$info->download_url = $updateSource->downloadUrl;

				if ( !empty($updateSource->changelog) ) {
					$info->sections['changelog'] = $updateSource->changelog;
				}
				if ( isset($updateSource->downloadCount) ) {
					$info->downloaded = $updateSource->downloadCount;
				}
			} else {
				//There's probably a network problem or an authentication error.
				do_action(
					'puc_api_error',
					new \WP_Error(
						'puc-no-update-source',
						'Could not retrieve version information from the repository. '
						. 'This usually means that the update checker either can\'t connect '
						. 'to the repository or it\'s configured incorrectly.'
					),
					null, null, $this->slug
				);
				return null;
			}

			//Get headers from the main plugin file in this branch/tag. Its "Version" header and other metadata
			//are what the WordPress install will actually see after upgrading, so they take precedence over releases/tags.
			$mainPluginFile = basename($this->pluginFile);
			$remotePlugin = $api->getRemoteFile($mainPluginFile, $ref);
			if ( !empty($remotePlugin) ) {
				$remoteHeader = $this->package->getFileHeader($remotePlugin);
				$this->setInfoFromHeader($remoteHeader, $info);
			}

			//Sanity check: Reject updates that don't have a version number.
			//This can happen when we're using a branch, and we either fail to retrieve the main plugin
			//file or the file doesn't have a "Version" header.
			if ( empty($info->version) ) {
				do_action(
					'puc_api_error',
					new \WP_Error(
						'puc-no-plugin-version',
						'Could not find the version number in the repository.'
					),
					null, null, $this->slug
				);
				return null;
			}

			//Try parsing readme.txt. If it's formatted according to WordPress.org standards, it will contain
			//a lot of useful information like the required/tested WP version, changelog, and so on.
			if ( $this->readmeTxtExistsLocally() ) {
				$this->setInfoFromRemoteReadme($ref, $info);
			}

			//The changelog might be in a separate file.
			if ( empty($info->sections['changelog']) ) {
				$info->sections['changelog'] = $api->getRemoteChangelog($ref, $this->package->getAbsoluteDirectoryPath());
				if ( empty($info->sections['changelog']) ) {
					$info->sections['changelog'] = __('There is no changelog available.', 'plugin-update-checker');
				}
			}

			if ( empty($info->last_updated) ) {
				//Fetch the latest commit that changed the tag or branch and use it as the "last_updated" date.
				$latestCommitTime = $api->getLatestCommitTime($ref);
				if ( $latestCommitTime !== null ) {
					$info->last_updated = $latestCommitTime;
				}
			}

			$info = apply_filters($this->getUniqueName('request_info_result'), $info, null);
			return $info;
		}

		/**
		 * Check if the currently installed version has a readme.txt file.
		 *
		 * @return bool
		 */
		protected function readmeTxtExistsLocally() {
			return $this->package->fileExists($this->api->getLocalReadmeName());
		}

		/**
		 * Copy plugin metadata from a file header to a Plugin Info object.
		 *
		 * @param array $fileHeader
		 * @param Plugin\PluginInfo $pluginInfo
		 */
		protected function setInfoFromHeader($fileHeader, $pluginInfo) {
			$headerToPropertyMap = array(
				'Version' => 'version',
				'Name' => 'name',
				'PluginURI' => 'homepage',
				'Author' => 'author',
				'AuthorName' => 'author',
				'AuthorURI' => 'author_homepage',

				'Requires WP' => 'requires',
				'Tested WP' => 'tested',
				'Requires at least' => 'requires',
				'Tested up to' => 'tested',

				'Requires PHP' => 'requires_php',
			);
			foreach ($headerToPropertyMap as $headerName => $property) {
				if ( isset($fileHeader[$headerName]) && !empty($fileHeader[$headerName]) ) {
					$pluginInfo->$property = $fileHeader[$headerName];
				}
			}

			if ( !empty($fileHeader['Description']) ) {
				$pluginInfo->sections['description'] = $fileHeader['Description'];
			}
		}

		/**
		 * Copy plugin metadata from the remote readme.txt file.
		 *
		 * @param string $ref GitHub tag or branch where to look for the readme.
		 * @param Plugin\PluginInfo $pluginInfo
		 */
		protected function setInfoFromRemoteReadme($ref, $pluginInfo) {
			$readme = $this->api->getRemoteReadme($ref);
			if ( empty($readme) ) {
				return;
			}

			if ( isset($readme['sections']) ) {
				$pluginInfo->sections = array_merge($pluginInfo->sections, $readme['sections']);
			}
			if ( !empty($readme['tested_up_to']) ) {
				$pluginInfo->tested = $readme['tested_up_to'];
			}
			if ( !empty($readme['requires_at_least']) ) {
				$pluginInfo->requires = $readme['requires_at_least'];
			}
			if ( !empty($readme['requires_php']) ) {
				$pluginInfo->requires_php = $readme['requires_php'];
			}

			if ( isset($readme['upgrade_notice'], $readme['upgrade_notice'][$pluginInfo->version]) ) {
				$pluginInfo->upgrade_notice = $readme['upgrade_notice'][$pluginInfo->version];
			}
		}

		/**
		 * Add icons from the currently installed version to a Plugin Info object.
		 *
		 * The icons should be in a subdirectory named "assets". Supported image formats
		 * and file names are described here:
		 * @link https://developer.wordpress.org/plugins/wordpress-org/plugin-assets/#plugin-icons
		 *
		 * @param Plugin\PluginInfo $pluginInfo
		 */
		protected function setIconsFromLocalAssets($pluginInfo) {
			$icons = $this->getLocalAssetUrls(array(
				'icon.svg'         => 'svg',
				'icon-256x256.png' => '2x',
				'icon-256x256.jpg' => '2x',
				'icon-128x128.png' => '1x',
				'icon-128x128.jpg' => '1x',
			));

			if ( !empty($icons) ) {
				//The "default" key seems to be used only as last-resort fallback in WP core (5.8/5.9),
				//but we'll set it anyway in case some code somewhere needs it.
				reset($icons);
				$firstKey = key($icons);
				$icons['default'] = $icons[$firstKey];

				$pluginInfo->icons = $icons;
			}
		}

		/**
		 * Add banners from the currently installed version to a Plugin Info object.
		 *
		 * The banners should be in a subdirectory named "assets". Supported image formats
		 * and file names are described here:
		 * @link https://developer.wordpress.org/plugins/wordpress-org/plugin-assets/#plugin-headers
		 *
		 * @param Plugin\PluginInfo $pluginInfo
		 */
		protected function setBannersFromLocalAssets($pluginInfo) {
			$banners = $this->getLocalAssetUrls(array(
				'banner-772x250.png' => 'high',
				'banner-772x250.jpg' => 'high',
				'banner-1544x500.png' => 'low',
				'banner-1544x500.jpg' => 'low',
			));

			if ( !empty($banners) ) {
				$pluginInfo->banners = $banners;
			}
		}

		/**
		 * @param array<string, string> $filesToKeys
		 * @return array<string, string>
		 */
		protected function getLocalAssetUrls($filesToKeys) {
			$assetDirectory = $this->package->getAbsoluteDirectoryPath() . DIRECTORY_SEPARATOR . 'assets';
			if ( !is_dir($assetDirectory) ) {
				return array();
			}
			$assetBaseUrl = trailingslashit(plugins_url('', $assetDirectory . '/imaginary.file'));

			$foundAssets = array();
			foreach ($filesToKeys as $fileName => $key) {
				$fullBannerPath = $assetDirectory . DIRECTORY_SEPARATOR . $fileName;
				if ( !isset($icons[$key]) && is_file($fullBannerPath) ) {
					$foundAssets[$key] = $assetBaseUrl . $fileName;
				}
			}

			return $foundAssets;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Vcs\Reference.php (1173 bytes, 52 lines) =====
`$ext
<?php
namespace YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

if ( !class_exists(Reference::class, false) ):

	/**
	 * This class represents a VCS branch or tag. It's intended as a read only, short-lived container
	 * that only exists to provide a limited degree of type checking.
	 *
	 * @property string $name
	 * @property string|null version
	 * @property string $downloadUrl
	 * @property string $updated
	 *
	 * @property string|null $changelog
	 * @property int|null $downloadCount
	 */
	class Reference {
		private $properties = array();

		public function __construct($properties = array()) {
			$this->properties = $properties;
		}

		/**
		 * @param string $name
		 * @return mixed|null
		 */
		public function __get($name) {
			return array_key_exists($name, $this->properties) ? $this->properties[$name] : null;
		}

		/**
		 * @param string $name
		 * @param mixed $value
		 */
		public function __set($name, $value) {
			$this->properties[$name] = $value;
		}

		/**
		 * @param string $name
		 * @return bool
		 */
		public function __isset($name) {
			return isset($this->properties[$name]);
		}

	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Vcs\ReleaseAssetSupport.php (2465 bytes, 83 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

if ( !trait_exists(ReleaseAssetSupport::class, false) ) :

	trait ReleaseAssetSupport {
		/**
		 * @var bool Whether to download release assets instead of the auto-generated
		 *           source code archives.
		 */
		protected $releaseAssetsEnabled = false;

		/**
		 * @var string|null Regular expression that's used to filter release assets
		 *                  by file name or URL. Optional.
		 */
		protected $assetFilterRegex = null;

		/**
		 * How to handle releases that don't have any matching release assets.
		 *
		 * @var int
		 */
		protected $releaseAssetPreference = Api::PREFER_RELEASE_ASSETS;

		/**
		 * Enable updating via release assets.
		 *
		 * If the latest release contains no usable assets, the update checker
		 * will fall back to using the automatically generated ZIP archive.
		 *
		 * @param string|null $nameRegex Optional. Use only those assets where
		 *                               the file name or URL matches this regex.
		 * @param int $preference Optional. How to handle releases that don't have
		 *                        any matching release assets.
		 */
		public function enableReleaseAssets($nameRegex = null, $preference = Api::PREFER_RELEASE_ASSETS) {
			$this->releaseAssetsEnabled = true;
			$this->assetFilterRegex = $nameRegex;
			$this->releaseAssetPreference = $preference;
		}

		/**
		 * Disable release assets.
		 *
		 * @return void
		 * @noinspection PhpUnused -- Public API
		 */
		public function disableReleaseAssets() {
			$this->releaseAssetsEnabled = false;
			$this->assetFilterRegex = null;
		}

		/**
		 * Does the specified asset match the name regex?
		 *
		 * @param mixed $releaseAsset Data type and structure depend on the host/API.
		 * @return bool
		 */
		protected function matchesAssetFilter($releaseAsset) {
			if ( $this->assetFilterRegex === null ) {
				//The default is to accept all assets.
				return true;
			}

			$name = $this->getFilterableAssetName($releaseAsset);
			if ( !is_string($name) ) {
				return false;
			}
			return (bool)preg_match($this->assetFilterRegex, $releaseAsset->name);
		}

		/**
		 * Get the part of asset data that will be checked against the filter regex.
		 *
		 * @param mixed $releaseAsset
		 * @return string|null
		 */
		abstract protected function getFilterableAssetName($releaseAsset);
	}

endif;
`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Vcs\ReleaseFilteringFeature.php (3287 bytes, 108 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

if ( !trait_exists(ReleaseFilteringFeature::class, false) ) :

	trait ReleaseFilteringFeature {
		/**
		 * @var callable|null
		 */
		protected $releaseFilterCallback = null;
		/**
		 * @var int
		 */
		protected $releaseFilterMaxReleases = 1;
		/**
		 * @var string One of the Api::RELEASE_FILTER_* constants.
		 */
		protected $releaseFilterByType = Api::RELEASE_FILTER_SKIP_PRERELEASE;

		/**
		 * Set a custom release filter.
		 *
		 * Setting a new filter will override the old filter, if any.
		 *
		 * @param callable $callback A callback that accepts a version number and a release
		 *                           object, and returns a boolean.
		 * @param int $releaseTypes  One of the Api::RELEASE_FILTER_* constants.
		 * @param int $maxReleases   Optional. The maximum number of recent releases to examine
		 *                           when trying to find a release that matches the filter. 1 to 100.
		 * @return $this
		 */
		public function setReleaseFilter(
			$callback,
			$releaseTypes = Api::RELEASE_FILTER_SKIP_PRERELEASE,
			$maxReleases = 20
		) {
			if ( $maxReleases > 100 ) {
				throw new \InvalidArgumentException(sprintf(
					'The max number of releases is too high (%d). It must be 100 or less.',
					$maxReleases
				));
			} else if ( $maxReleases < 1 ) {
				throw new \InvalidArgumentException(sprintf(
					'The max number of releases is too low (%d). It must be at least 1.',
					$maxReleases
				));
			}

			$this->releaseFilterCallback = $callback;
			$this->releaseFilterByType = $releaseTypes;
			$this->releaseFilterMaxReleases = $maxReleases;
			return $this;
		}

		/**
		 * Filter releases by their version number.
		 *
		 * @param string $regex A regular expression. The release version number must match this regex.
		 * @param int $releaseTypes
		 * @param int $maxReleasesToExamine
		 * @return $this
		 * @noinspection PhpUnused -- Public API
		 */
		public function setReleaseVersionFilter(
			$regex,
			$releaseTypes = Api::RELEASE_FILTER_SKIP_PRERELEASE,
			$maxReleasesToExamine = 20
		) {
			return $this->setReleaseFilter(
				function ($versionNumber) use ($regex) {
					return (preg_match($regex, $versionNumber) === 1);
				},
				$releaseTypes,
				$maxReleasesToExamine
			);
		}

		/**
		 * @param string $versionNumber The detected release version number.
		 * @param object $releaseObject Varies depending on the host/API.
		 * @return bool
		 */
		protected function matchesCustomReleaseFilter($versionNumber, $releaseObject) {
			if ( !is_callable($this->releaseFilterCallback) ) {
				return true; //No custom filter.
			}
			return call_user_func($this->releaseFilterCallback, $versionNumber, $releaseObject);
		}

		/**
		 * @return bool
		 */
		protected function shouldSkipPreReleases() {
			//Maybe this could be a bitfield in the future, if we need to support
			//more release types.
			return ($this->releaseFilterByType !== Api::RELEASE_FILTER_ALL);
		}

		/**
		 * @return bool
		 */
		protected function hasCustomReleaseFilter() {
			return isset($this->releaseFilterCallback) && is_callable($this->releaseFilterCallback);
		}
	}

endif;
`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Vcs\ThemeUpdateChecker.php (2786 bytes, 84 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

use YahnisElsts\PluginUpdateChecker\v5p6\Theme;
use YahnisElsts\PluginUpdateChecker\v5p6\Utils;

if ( !class_exists(ThemeUpdateChecker::class, false) ):

	class ThemeUpdateChecker extends Theme\UpdateChecker implements BaseChecker {
		use VcsCheckerMethods;

		/**
		 * ThemeUpdateChecker constructor.
		 *
		 * @param Api $api
		 * @param null $stylesheet
		 * @param null $customSlug
		 * @param int $checkPeriod
		 * @param string $optionName
		 */
		public function __construct($api, $stylesheet = null, $customSlug = null, $checkPeriod = 12, $optionName = '') {
			$this->api = $api;

			parent::__construct($api->getRepositoryUrl(), $stylesheet, $customSlug, $checkPeriod, $optionName);

			$this->api->setHttpFilterName($this->getUniqueName('request_update_options'));
			$this->api->setStrategyFilterName($this->getUniqueName('vcs_update_detection_strategies'));
			$this->api->setSlug($this->slug);
		}

		public function requestUpdate() {
			$api = $this->api;
			$api->setLocalDirectory($this->package->getAbsoluteDirectoryPath());

			$update = new Theme\Update();
			$update->slug = $this->slug;

			//Figure out which reference (tag or branch) we'll use to get the latest version of the theme.
			$updateSource = $api->chooseReference($this->branch);
			if ( $updateSource ) {
				$ref = $updateSource->name;
				$update->download_url = $updateSource->downloadUrl;
			} else {
				do_action(
					'puc_api_error',
					new \WP_Error(
						'puc-no-update-source',
						'Could not retrieve version information from the repository. '
						. 'This usually means that the update checker either can\'t connect '
						. 'to the repository or it\'s configured incorrectly.'
					),
					null, null, $this->slug
				);
				$ref = $this->branch;
			}

			//Get headers from the main stylesheet in this branch/tag. Its "Version" header and other metadata
			//are what the WordPress install will actually see after upgrading, so they take precedence over releases/tags.
			$remoteHeader = $this->package->getFileHeader($api->getRemoteFile('style.css', $ref));
			$update->version = Utils::findNotEmpty(array(
				$remoteHeader['Version'],
				Utils::get($updateSource, 'version'),
			));

			//The details URL defaults to the Theme URI header or the repository URL.
			$update->details_url = Utils::findNotEmpty(array(
				$remoteHeader['ThemeURI'],
				$this->package->getHeaderValue('ThemeURI'),
				$this->metadataUrl,
			));

			if ( empty($update->version) ) {
				//It looks like we didn't find a valid update after all.
				$update = null;
			}

			$update = $this->filterUpdateResult($update);
			return $update;
		}
	}

endif;

`$nl
===== FILE: berrywalk-feedback-acf\plugin-update-checker\Puc\v5p6\Vcs\VcsCheckerMethods.php (1344 bytes, 59 lines) =====
`$ext
<?php

namespace YahnisElsts\PluginUpdateChecker\v5p6\Vcs;

if ( !trait_exists(VcsCheckerMethods::class, false) ) :

	trait VcsCheckerMethods {
		/**
		 * @var string The branch where to look for updates. Defaults to "master".
		 */
		protected $branch = 'master';

		/**
		 * @var Api Repository API client.
		 */
		protected $api = null;

		public function setBranch($branch) {
			$this->branch = $branch;
			return $this;
		}

		/**
		 * Set authentication credentials.
		 *
		 * @param array|string $credentials
		 * @return $this
		 */
		public function setAuthentication($credentials) {
			$this->api->setAuthentication($credentials);
			return $this;
		}

		/**
		 * @return Api
		 */
		public function getVcsApi() {
			return $this->api;
		}

		public function getUpdate() {
			$update = parent::getUpdate();

			if ( isset($update) && !empty($update->download_url) ) {
				$update->download_url = $this->api->signDownloadUrl($update->download_url);
			}

			return $update;
		}

		public function onDisplayConfiguration($panel) {
			parent::onDisplayConfiguration($panel);
			$panel->row('Branch', $this->branch);
			$panel->row('Authentication enabled', $this->api->isAuthenticationEnabled() ? 'Yes' : 'No');
			$panel->row('API client', get_class($this->api));
		}
	}

endif;
`$nl
